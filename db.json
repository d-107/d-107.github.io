{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/about/index/wx.jpg","path":"about/index/wx.jpg","modified":0,"renderable":0},{"_id":"source/about/index/happy-codding.jpg","path":"about/index/happy-codding.jpg","modified":0,"renderable":0},{"_id":"themes/hexo-theme-sense/source/css/content.css.map","path":"css/content.css.map","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/content.css","path":"css/content.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/content.scss","path":"css/content.scss","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/footer.css.map","path":"css/footer.css.map","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/footer.css","path":"css/footer.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/footer.scss","path":"css/footer.scss","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/go-top.css","path":"css/go-top.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/go-top.css.map","path":"css/go-top.css.map","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/go-top.scss","path":"css/go-top.scss","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/fonts.css","path":"css/fonts.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/fonts.css.map","path":"css/fonts.css.map","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/header.css.map","path":"css/header.css.map","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/fonts.scss","path":"css/fonts.scss","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/highlight.css","path":"css/highlight.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/header.css","path":"css/header.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/highlight.css.map","path":"css/highlight.css.map","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/image-view.css.map","path":"css/image-view.css.map","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/header.scss","path":"css/header.scss","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/highlight.scss","path":"css/highlight.scss","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/page.css","path":"css/page.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/page.css.map","path":"css/page.css.map","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/scrollbar.css","path":"css/scrollbar.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/scrollbar.css.map","path":"css/scrollbar.css.map","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/scrollbar.scss","path":"css/scrollbar.scss","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/search.css","path":"css/search.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/search.css.map","path":"css/search.css.map","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/page.scss","path":"css/page.scss","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/search.scss","path":"css/search.scss","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/sense.css","path":"css/sense.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/image-view.css","path":"css/image-view.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/image-view.scss","path":"css/image-view.scss","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/video.css.map","path":"css/video.css.map","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/video.scss","path":"css/video.scss","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/sense.scss","path":"css/sense.scss","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/cursor/No_Disponible.cur","path":"cursor/No_Disponible.cur","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/cursor/ayuda.cur","path":"cursor/ayuda.cur","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/cursor/texto.cur","path":"cursor/texto.cur","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/cursor/normal.cur","path":"cursor/normal.cur","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/cursor/work.cur","path":"cursor/work.cur","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/font/iconfont.eot","path":"font/iconfont.eot","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/font/iconfont.svg","path":"font/iconfont.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/font/iconfont.ttf","path":"font/iconfont.ttf","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/sense.css.map","path":"css/sense.css.map","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/css/video.css","path":"css/video.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/images/loading.gif","path":"images/loading.gif","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/images/photoTheater.png","path":"images/photoTheater.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/images/d-107.png","path":"images/d-107.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/images/rotate.png","path":"images/rotate.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/images/scroll.png","path":"images/scroll.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/js/image-view.js","path":"js/image-view.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/js/sakura.js","path":"js/sakura.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/js/firework.js","path":"js/firework.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/images/overlay-hero.png","path":"images/overlay-hero.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/font/iconfont.woff","path":"font/iconfont.woff","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/js/sense.js","path":"js/sense.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/images/favicon.ico","path":"images/favicon.ico","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/js/jquery-3.4.1.min.js","path":"js/jquery-3.4.1.min.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/js/snow.js","path":"js/snow.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/video/sense.ogv","path":"video/sense.ogv","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/video/sense.webm","path":"video/sense.webm","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/images/sense.png","path":"images/sense.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-sense/source/video/sense.mp4","path":"video/sense.mp4","modified":0,"renderable":1}],"Cache":[{"_id":"themes/hexo-theme-sense/.gitignore","hash":"d49f1bb616546a62989c76f742471e51151bd12c","modified":1567559514923},{"_id":"themes/hexo-theme-sense/README.md","hash":"81e52b5ad941d37c096e2e58c10059bbe50db3a8","modified":1569743499882},{"_id":"themes/hexo-theme-sense/package.json","hash":"ad737acf3e7ff243870a22f294b5a9d986b59ed2","modified":1567559514933},{"_id":"themes/hexo-theme-sense/_config.yml","hash":"5dce9e482bcb06d6e7235d0e7972075fe74ba8ad","modified":1572327272173},{"_id":"source/_posts/hello-dotnet.md","hash":"4d9f18a4fa9325b28daa0292e1204420f317ffcc","modified":1572596979292},{"_id":"source/_posts/hello-php.md","hash":"049de9f86fb76abc885351cdfac9d799055e8c35","modified":1567588102631},{"_id":"source/_posts/another-year-1024.md","hash":"02a7aad380c8f90c7d518bf58429a6648eb53dae","modified":1572316360043},{"_id":"source/_posts/laravel-broadcasting.md","hash":"b6a96b34fb44d866c7a23405bf8e2f01ea827d2e","modified":1569822602230},{"_id":"source/_data/temp.yml","hash":"2b48d23caa9be6fd242baaf21a4630f7874630bb","modified":1572328182140},{"_id":"themes/hexo-theme-sense/package-lock.json","hash":"6f88399c8a5db9a916a39456ee9db8250c9b1e67","modified":1567559514933},{"_id":"source/_posts/laravel-events.md","hash":"db18b63f15916aaba6130c146245bb337ef82570","modified":1569822646249},{"_id":"source/_posts/laravel-swoole-in-laradock.md","hash":"ace18985fabfa85e39e16634b9a290f05921ced5","modified":1569822653805},{"_id":"source/_posts/hello-world.md","hash":"5bf71067859cba9b13543ed08b7ec921286c8927","modified":1567146762442},{"_id":"source/_posts/laravel-mix.md","hash":"a37f9638cce6068974f0d2fc69be958f78011fa8","modified":1569822648652},{"_id":"source/_posts/laravel-vue-svg.md","hash":"dbefa3c63f214e6a190c4a6b7ad624b225320cd6","modified":1572315958673},{"_id":"source/_posts/laravel-swoole-socket-in-laradock.md","hash":"457a4ccafa1860b8cc6c7b27100a89aaca8d7402","modified":1572593322215},{"_id":"source/_posts/net-core-april-util-update-1.md","hash":"112581d8878586b703e2cf4d30d86eb18ec8dfb6","modified":1574391578663},{"_id":"source/_posts/net-core-april-util.md","hash":"b01fa8ea7e618d066b6a96665f41d9b07eb0a8b4","modified":1574391419686},{"_id":"source/_posts/net-core-aop-2.md","hash":"6636c073fde5646b8724e412f9f8eaa6ac3e52cb","modified":1569822360986},{"_id":"source/_posts/net-core-aop-1.md","hash":"56274af4ff4eb4cc6a250e6084e739b967c2bfda","modified":1569822357927},{"_id":"source/_posts/net-core-createprogram.md","hash":"4e3b213e5b48efcdd9a8ac9de679d7323d99e4b6","modified":1569822366972},{"_id":"source/_posts/net-core-filedownload.md","hash":"926ad935733f8bd61510b04807f9e27c78bb0b0a","modified":1569822371076},{"_id":"source/_posts/net-core-fileuploader-and-cors.md","hash":"1644934af37fabaefd913bf580cd89be317bd714","modified":1569822377961},{"_id":"source/_posts/laravel-queues.md","hash":"ddf9ab9e4f533c4817f78b4ef128a136c79cb96a","modified":1569822650872},{"_id":"source/_posts/net-core-cache.md","hash":"a3fcf3bac88b7277d76a1dc01cf5c183361e28f4","modified":1569822363903},{"_id":"source/_posts/net-core-quartz.md","hash":"36de6d89cf13d541c319f8ebc5141d480e938cda","modified":1569822383853},{"_id":"source/_posts/net-core-qywx-application.md","hash":"74f1c162593be8262002e1b6eb2141136e88b738","modified":1569822386760},{"_id":"source/_posts/net-core-redis.md","hash":"64d6719581c9640862e40f157736f65ef678de21","modified":1569822427993},{"_id":"source/_posts/net-core-swagger.md","hash":"effd9d775ea9cb47623f93064b1d1d19e4849ab7","modified":1569822440933},{"_id":"source/_posts/net-core-log4net.md","hash":"60c4bd75d5dbcc4e45c7d9d604c89a2e2d15616e","modified":1569822381165},{"_id":"source/_posts/net-core-unittest.md","hash":"9430a63b9db38faa039d7bce4947bc0a736fb85f","modified":1574391369685},{"_id":"source/_posts/net-core-tools-and-environment.md","hash":"15cf98e096e5b87a8d0052f88fdcf9717ff51fd8","modified":1569822444237},{"_id":"source/_posts/net-core-sqlsugar-1.md","hash":"faadc87330935ab98f81da809ae5aefed67155e6","modified":1569822431049},{"_id":"source/_posts/net-core-sqlsugar-2.md","hash":"3dc3dcaaf79313708d2bcc886a40272eb75a0fda","modified":1569822437978},{"_id":"source/_posts/net-core-v3-april-webapi.md","hash":"4e27c3c3e77f166b35bf93a99588fdfffdda1391","modified":1570689198348},{"_id":"source/_posts/net-core-v3-swagger.md","hash":"730d19c92d0ecbd7450f028acc9a2d37de2c2795","modified":1570688201489},{"_id":"source/_posts/net-core-v3-npoi.md","hash":"92c0cf62868a748c2a043435e46e409cf2cd3d81","modified":1572316092302},{"_id":"source/_posts/net-core-webapi-main.md","hash":"f62aa4d3c4843b1fecc8233826cf5ae4797dffbb","modified":1569822447733},{"_id":"source/_posts/use-laravel-permission-can-tag-in-vue.md","hash":"137bcc409c2faa2a4fe64dfaae87dd8965e5dc15","modified":1569822656797},{"_id":"source/_posts/vmare-docker.md","hash":"b2e842f78da840ece254fa99e5dc7973207b837e","modified":1572316841957},{"_id":"source/_posts/tp5-fileupload-requestfile-is-null.md","hash":"bd7e4eb6e496832bddb2cf8af5f8535ef9ba2299","modified":1569822334549},{"_id":"source/_posts/net-core-v3-publish.md","hash":"5805b281a92b4648f898bfd1dc4ea6c1bf60c3ee","modified":1572316868710},{"_id":"source/_posts/vmware-redis.md","hash":"5a699adc8290476228e3f11a6a4d3bd775cbb3fe","modified":1569822472646},{"_id":"source/about/index.md","hash":"1947402f5e9a290a11df0d431532cbb354c30cef","modified":1567587088399},{"_id":"themes/hexo-theme-sense/languages/default.yml","hash":"f26a34a7983d4bc17c65c7f0f14da598e62ce66d","modified":1567559514924},{"_id":"themes/hexo-theme-sense/languages/de.yml","hash":"d45cea36c5c83d7d09afcd1c26fff4a4c513c25b","modified":1567559514924},{"_id":"themes/hexo-theme-sense/languages/es.yml","hash":"e3b4937da4cd2d0393b8a0ba310e70fc605cc431","modified":1567559514924},{"_id":"themes/hexo-theme-sense/languages/fr.yml","hash":"8cb0fe4b6913b4d5b662cdd0108a923c90025f85","modified":1567559514924},{"_id":"themes/hexo-theme-sense/languages/ko.yml","hash":"11330316e3c1262474a2b496e40dbc29f93fe01b","modified":1567559514925},{"_id":"themes/hexo-theme-sense/languages/ja.yml","hash":"3e2fedca096678c0c234ebffa4637828979296fa","modified":1567559514925},{"_id":"themes/hexo-theme-sense/languages/nl.yml","hash":"3d82ec703d0b3287739d7cb4750a715ae83bfcb3","modified":1567559514925},{"_id":"themes/hexo-theme-sense/languages/no.yml","hash":"ddf2035e920a5ecb9076138c184257d9f51896a7","modified":1567559514926},{"_id":"themes/hexo-theme-sense/languages/pt.yml","hash":"ae2c61b30e638f74f1a42c9ce39ac08d063b30f5","modified":1567559514926},{"_id":"themes/hexo-theme-sense/languages/ru.yml","hash":"2a476b4c6e04900914c81378941640ac5d58a1f0","modified":1567559514926},{"_id":"themes/hexo-theme-sense/languages/zh-CN.yml","hash":"b057f389c6713010f97d461e48ec959b0b6f3b44","modified":1567559514927},{"_id":"source/_posts/vmware-use-centos.md","hash":"a527ca4202de8a3f5bfa049ab4fe89d2e16ba682","modified":1569822477694},{"_id":"themes/hexo-theme-sense/languages/zh-TW.yml","hash":"f5f0ca88185da7a8457760d84bf221781473bd7c","modified":1567559514927},{"_id":"source/_posts/vmware-nginx.md","hash":"0f9ec28a2cab2e2c9bb9bac184eae1978e62d4df","modified":1569822469277},{"_id":"themes/hexo-theme-sense/layout/index.ejs","hash":"f937fcb3d7da3b3650f80c253150c206b5dbaef7","modified":1567559514928},{"_id":"themes/hexo-theme-sense/layout/layout.ejs","hash":"56ddbd02f545ec7770709fcba8c0c8345be45176","modified":1567559514930},{"_id":"themes/hexo-theme-sense/layout/page.ejs","hash":"f21852dfc6cedbb4a3c5fa8ba3cb011f30076ab8","modified":1569735776450},{"_id":"themes/hexo-theme-sense/layout/category.ejs","hash":"a25191ef4250c5dcf07c1b5eb7804753386c7e10","modified":1567587088401},{"_id":"themes/hexo-theme-sense/layout/tag.ejs","hash":"89487a6b87eff85ca16f44717eb03696641511d3","modified":1567587088404},{"_id":"themes/hexo-theme-sense/scripts/scripts.js","hash":"14bbc924253d6572cbefa752b910eba524c2424f","modified":1567559514934},{"_id":"themes/hexo-theme-sense/layout/archive.ejs","hash":"7b865c4a55eebed683513155320892dfc34266c3","modified":1567587088400},{"_id":"themes/hexo-theme-sense/layout/post.ejs","hash":"0a8046eab866835b1cb5d4a4dd88ae89ce2d0c32","modified":1572327761692},{"_id":"source/_posts/vmware-mysql.md","hash":"d5b0daaf0f98e22240f2d79c265a549a8837d22a","modified":1569822465453},{"_id":"source/_posts/laravel-broadcasting/new.png","hash":"be082f8430fe87420a8a2d0b80c5ec7174dd3509","modified":1569735776419},{"_id":"source/_posts/laravel-events/new-event.png","hash":"ebbfcf9dea64da8f3a1e27ea6a87e76a56e68eab","modified":1569735776428},{"_id":"source/_posts/laravel-broadcasting/mes.png","hash":"eb6c38d51e7d0a24485473216abc88855dc3de01","modified":1569735776342},{"_id":"source/_posts/laravel-mix/laravel-mix.png","hash":"8d39264428735ea937bf1ded9d095e430b289a17","modified":1569735776433},{"_id":"source/_posts/laravel-events/out.png","hash":"d13d91bff2c56ce2d01eb03564ebf3cf7e8abc33","modified":1569735776430},{"_id":"source/_posts/laravel-queues/email.png","hash":"bfdca4ff3f9c2fdc46e6775c37961022683f0cce","modified":1569735776437},{"_id":"source/_posts/laravel-swoole-in-laradock/laradock.png","hash":"fb249a240bae786470099b0cf554d89b446c3623","modified":1569735776446},{"_id":"source/_posts/net-core-aop-1/1.png","hash":"780ee9b44c3d6533493db6ec477bd18d1b4bb8c3","modified":1569303506569},{"_id":"source/_posts/laravel-swoole-socket-in-laradock/laradock.png","hash":"fb249a240bae786470099b0cf554d89b446c3623","modified":1571638132162},{"_id":"source/_posts/net-core-aop-1/4.png","hash":"26f9cd36f1b1c24bd1bb5d86501ea3f0f782b41f","modified":1569303518688},{"_id":"source/_posts/net-core-aop-1/2.png","hash":"607142672012cedc5b9f9450deb41b2641f5b318","modified":1569303512321},{"_id":"source/_posts/net-core-aop-1/3.png","hash":"c556fcdcbb2d5750441ed6be369d56ffb67bfd0f","modified":1569303514602},{"_id":"source/_posts/net-core-aop-1/6.png","hash":"27485076145c47bc7ac144314283eb64f1fae528","modified":1569303525000},{"_id":"source/_posts/net-core-aop-1/5.png","hash":"79cbd9e4133871bacce3f6ec00cd78466fbc844b","modified":1569303520640},{"_id":"source/_posts/net-core-aop-2/3.png","hash":"60bd9e5674c9bbb875e24cca4fec4e2803942dda","modified":1569303717272},{"_id":"source/_posts/net-core-aop-2/4.png","hash":"16c11cee5fdac52efea7daff78fc1f5d6c33752b","modified":1569303719820},{"_id":"source/_posts/net-core-april-util/1.png","hash":"1d0ebc979af27ad3373eaba012ffac1ee974cab7","modified":1574391296638},{"_id":"source/_posts/net-core-april-util/2.png","hash":"051932c78473a6dbaa5241c6b4e62d46f5119b42","modified":1574391317685},{"_id":"source/_posts/net-core-april-util/3.png","hash":"e913f70abf0e10f71deb3bf69173a2a7b24eaa45","modified":1574391321152},{"_id":"source/_posts/net-core-april-util/4.png","hash":"7571d00feebf631f7de20f908dfd7fc216bbe826","modified":1574391325444},{"_id":"source/_posts/net-core-april-util/5.png","hash":"aa2841aba09d3d87cb67d957d7c110fc29414b45","modified":1574391327816},{"_id":"source/_posts/net-core-april-util/7.png","hash":"9724996f89b8b5bcb3ee2b86ee22c3a620ecc60b","modified":1574391333646},{"_id":"source/_posts/net-core-april-util-update-1/1.png","hash":"78a5c54ab470f86efa9a2a5280b6f4be961b3787","modified":1574391490335},{"_id":"source/_posts/net-core-april-util-update-1/2.png","hash":"99e3cbf4912b681ce83dce60c3c092e7326c1932","modified":1574391497151},{"_id":"source/_posts/net-core-april-util-update-1/3.png","hash":"2197a2a6d56fd5c78724a45e9ff0931021ec8aa4","modified":1574391500158},{"_id":"source/_posts/net-core-april-util-update-1/4.png","hash":"090c35650ba92e31b1c29bef38200ecd392a923a","modified":1574391503265},{"_id":"source/_posts/net-core-april-util-update-1/5.png","hash":"23cd7418044e9c85429e265f8dd34af5366ad243","modified":1574391506502},{"_id":"source/_posts/net-core-april-util-update-1/6.png","hash":"9388b2e7d4008675bdc2f1c67f0d3b40987a5531","modified":1574391509286},{"_id":"source/_posts/net-core-april-util-update-1/7.png","hash":"30d14f4054e57d8e0d549f7fa88959b120e202a9","modified":1574391511702},{"_id":"source/_posts/net-core-april-util-update-1/8.png","hash":"b76f9d6f0a3349e5d84870086ff43fc4a916d8b1","modified":1574391514527},{"_id":"source/_posts/net-core-aop-1/8.png","hash":"dc7c175d3adce6952a30cac8b09e7c980a19bf28","modified":1569303530032},{"_id":"source/_posts/net-core-aop-2/2.png","hash":"e824a22aa3daabfdfd82597ffc32fc2faf657897","modified":1569303714225},{"_id":"source/_posts/net-core-aop-2/1.png","hash":"610d9aaf433b99426ce2c1ac797de152c3677458","modified":1569303703969},{"_id":"source/_posts/net-core-cache/10.png","hash":"f5fb591e06416155bdd21eb8305fc712a4fa9e40","modified":1569296430470},{"_id":"source/_posts/net-core-cache/3.png","hash":"3b5ae85764678cdb4b30d2089ec572ee471d0dd1","modified":1569296406209},{"_id":"source/_posts/net-core-cache/6.png","hash":"d16a90da59ce4495d05b7c0bb890894cfd84ae3e","modified":1569296417766},{"_id":"source/_posts/net-core-cache/2.png","hash":"9c319a60c2132a6147fe3301dbf838d7dc7783d0","modified":1569296403383},{"_id":"source/_posts/net-core-cache/8.png","hash":"bd8212b2da92788304d4ee2614080799f7d639cc","modified":1569296423554},{"_id":"source/_posts/net-core-cache/9.png","hash":"c67d5edd0413b96a45f080335a7c60190bcaa3ce","modified":1569296426206},{"_id":"source/_posts/net-core-cache/7.png","hash":"cd2263013bb301a04fb042eec76decf6755625ab","modified":1569296420902},{"_id":"source/_posts/net-core-cache/4.png","hash":"cb5eb9561be2b3a00c0c68197a77bfde73a8dfb7","modified":1569296408783},{"_id":"source/_posts/net-core-createprogram/2.png","hash":"b25635ba96c0ce5aed1eee36e97322a7df9ed869","modified":1569294365103},{"_id":"source/_posts/net-core-createprogram/4.png","hash":"07a4bf94522f46145a4b4f2b121963ba52def540","modified":1569294373007},{"_id":"source/_posts/net-core-createprogram/5.png","hash":"764930797950d619723fa5b511f722f61048d63b","modified":1569294376775},{"_id":"source/_posts/net-core-fileuploader-and-cors/3.png","hash":"ec2442681b8acef0b506cb2940e229b0ef4dcd8b","modified":1569740804646},{"_id":"source/_posts/net-core-fileuploader-and-cors/5.png","hash":"0b0985b2605936e0d5eea3a903ed4761105e309c","modified":1569740813331},{"_id":"source/_posts/net-core-log4net/6.png","hash":"03ac034d208930dc33e87dad46bf0b579fd8146a","modified":1569295374728},{"_id":"source/_posts/net-core-log4net/7.png","hash":"5c773c349de4f13989b45b812825a8b78ee8ec68","modified":1569295377287},{"_id":"source/_posts/net-core-log4net/3.png","hash":"adecebc640cb2f6cd1521d055be4d38ad0443028","modified":1569295364711},{"_id":"source/_posts/net-core-log4net/8.png","hash":"81f7653f0230b215a879105617c5e89e4713c878","modified":1569295383390},{"_id":"source/_posts/net-core-log4net/9.png","hash":"08b8960af698827b185afb2349852afe9e94ed95","modified":1569295386096},{"_id":"source/_posts/net-core-quartz/2.png","hash":"50ff5d7f73baff0a8be28dce8583348ffb7ec429","modified":1569741810226},{"_id":"source/_posts/net-core-fileuploader-and-cors/6.png","hash":"613681b41bb8fdda37d5ca5f098c7f8fb4527562","modified":1569740816158},{"_id":"source/_posts/net-core-quartz/3.png","hash":"91d084c223092b41a2f2290c3b2021cc26c10e9d","modified":1569741813266},{"_id":"source/_posts/net-core-qywx-application/4.png","hash":"9648d286d27cda5574f7dc5e061fcb0a4509cac3","modified":1569741166492},{"_id":"source/_posts/net-core-redis/1.png","hash":"209e482551cef09a8c27567e2e9f129cc446e986","modified":1569741598219},{"_id":"source/_posts/net-core-redis/10.png","hash":"e7988db5c32cc2cf4273496e95fa2513a1b6b57d","modified":1569741629626},{"_id":"source/_posts/net-core-qywx-application/3.png","hash":"d890289b77284becf2f7df75b3f314bc208a1031","modified":1569741157880},{"_id":"source/_posts/net-core-redis/2.png","hash":"4037276da508ec51c10306d6bb95bf545d8e0891","modified":1569741607587},{"_id":"source/_posts/net-core-redis/3.png","hash":"8790491f1234cf77e6d763f145e2bd366f3c07e6","modified":1569741610044},{"_id":"source/_posts/net-core-redis/4.png","hash":"e612f7c27802dd49b658ab1c908e47731b712f24","modified":1569741614779},{"_id":"source/_posts/net-core-redis/11.png","hash":"aa36d1931ca167a1c0cdc77e69893a78a0c46453","modified":1569741632072},{"_id":"source/_posts/net-core-redis/6.png","hash":"0992e1076913f055bc6de00ab0de29fb45a4ba38","modified":1569741619315},{"_id":"source/_posts/net-core-redis/7.png","hash":"eb87146fdf60ebc5602c741ed676e34263574dde","modified":1569741621755},{"_id":"source/_posts/net-core-redis/8.png","hash":"b207a19bbcd1518f08b5d67b45318c93a84aaec0","modified":1569741624469},{"_id":"source/_posts/net-core-qywx-application/5.png","hash":"49da1cc17350531ced6271845f474ba18e67fba5","modified":1569741169499},{"_id":"source/_posts/net-core-redis/9.png","hash":"dd70bcc095a85e653031d4f725f733205849efc9","modified":1569741627012},{"_id":"source/_posts/net-core-sqlsugar-2/1.png","hash":"630441202ba307ce76d84294fadd4a6c1e1765b4","modified":1569303171289},{"_id":"source/_posts/net-core-quartz/1.png","hash":"502387fb7e13509cdd91d18cc553630d8655a2fb","modified":1569741801915},{"_id":"source/_posts/net-core-sqlsugar-2/3.png","hash":"e46d3a11a79a1c7d1ea14b6130236572604b2372","modified":1569303188825},{"_id":"source/_posts/net-core-redis/5.png","hash":"50250d27abd71b62090637f312e14be015a70391","modified":1569741617142},{"_id":"source/_posts/net-core-sqlsugar-2/5.png","hash":"736e78dbe1772106261da7485a33625ad2e7681b","modified":1569303195537},{"_id":"source/_posts/net-core-sqlsugar-2/6.png","hash":"d52bbf5fe75da6ba89b5f252ce53fe7caff58c44","modified":1569303199729},{"_id":"source/_posts/net-core-sqlsugar-1/1.png","hash":"0325e5226b78756888892a943746e0b3e7a90dc6","modified":1569302969384},{"_id":"source/_posts/net-core-sqlsugar-2/2.png","hash":"79089c07c66273eb5bc29618f908696a9424c5a6","modified":1569303186241},{"_id":"source/_posts/net-core-sqlsugar-2/7.png","hash":"e300f42ea58e301fe874787a4e4f59177d309ce5","modified":1569303202241},{"_id":"source/_posts/net-core-swagger/2.png","hash":"2b046851b1f7d0597d88a40505f34d77b41f0f9c","modified":1569294986327},{"_id":"source/_posts/net-core-swagger/4.png","hash":"4ae10e844646e674e7720292c1f87587e4f496ed","modified":1569295110303},{"_id":"source/_posts/net-core-swagger/5.png","hash":"c786e273da05b663def626c29ca2f10d6875cd51","modified":1569294994161},{"_id":"source/_posts/net-core-swagger/6.png","hash":"7e0e29516e770a9f58ef582c8adeae8de903f242","modified":1569294996809},{"_id":"source/_posts/net-core-unittest/2.png","hash":"3f126c7a1478e824343f7d558bebc5db6dd0d3c4","modified":1574391191231},{"_id":"source/_posts/net-core-sqlsugar-2/8.png","hash":"4433496696f19adc838f5b53ba4879a1d561a3ba","modified":1569303205000},{"_id":"source/_posts/net-core-v3-april-webapi/1.png","hash":"288fdcf52de6001f0a9416a785b4e3b53a32143b","modified":1570688214067},{"_id":"source/_posts/net-core-sqlsugar-2/4.png","hash":"621c9ad39819aaa926067b7e6952b565798c9712","modified":1569303191232},{"_id":"source/_posts/net-core-v3-april-webapi/14.png","hash":"a8fb68acb992ebf79093ca5a7c5a8b4a90e9f8b0","modified":1570688259067},{"_id":"source/_posts/net-core-v3-april-webapi/4.png","hash":"8acc62b0a6e2de78f87d23fad4b24baa7b4a28ef","modified":1570688227291},{"_id":"source/_posts/net-core-v3-april-webapi/5.png","hash":"31fb36021993347cccab289ceb4068d31fe71658","modified":1570688229539},{"_id":"source/_posts/net-core-v3-april-webapi/6.png","hash":"d0f7bf6e9cbfe150d5d37dc78fb38d95d6814f53","modified":1570688231724},{"_id":"source/_posts/net-core-v3-april-webapi/2.png","hash":"09b26f046720cb296e313698de7c90820ef05607","modified":1570688222099},{"_id":"source/_posts/net-core-v3-april-webapi/8.png","hash":"784947e4f69237b243e8236632fa47750be00ef0","modified":1570688236542},{"_id":"source/_posts/net-core-v3-april-webapi/3.png","hash":"9351f2b9509b2d92e062dd4677e79dc40a04621e","modified":1570688224605},{"_id":"source/_posts/net-core-v3-npoi/1.png","hash":"7d1610c413b9711c951790e69ae4e2184cfbfc65","modified":1572315840695},{"_id":"source/_posts/net-core-v3-npoi/4.png","hash":"da02a80495673a50f976ce6beecbc53e26c6d7e9","modified":1572315855274},{"_id":"source/_posts/net-core-v3-npoi/3.png","hash":"95aa031cc436a110ab1be1ebdd39c9e229018590","modified":1572315852388},{"_id":"source/_posts/net-core-v3-publish/1.png","hash":"b2b9467900dadc0ccff0240fe92535e87d26619a","modified":1572316542336},{"_id":"source/_posts/net-core-v3-npoi/5.png","hash":"e49c5277d73a9a31fae212cc9b0077e4f704f6d9","modified":1572315857777},{"_id":"source/_posts/net-core-v3-npoi/6.png","hash":"d4500b2be47d2695c10c0e169f09c186247b50a7","modified":1572315860586},{"_id":"source/_posts/net-core-v3-publish/10.png","hash":"b305ca9e7901cfe9f22fbdb3faa55e62dbccd6e0","modified":1572316569615},{"_id":"source/_posts/net-core-v3-publish/13.png","hash":"bed93329822f73d1408ceacaec406a124dec6d10","modified":1572316579311},{"_id":"source/_posts/net-core-v3-publish/14.png","hash":"27940498d049fc563ee43cace6fb647652c0ed1b","modified":1572316582064},{"_id":"source/_posts/net-core-v3-publish/16.png","hash":"f05606fffce3c0190398cb27f2ac877f48ba7f7b","modified":1572316587679},{"_id":"source/_posts/net-core-v3-publish/5.png","hash":"cefc281247099c073bcf88191eefc82cc718ec22","modified":1572316554261},{"_id":"source/_posts/net-core-v3-publish/2.png","hash":"9f07f5eebe7c90ff448d24d62c3d07e00df5e0c7","modified":1572316545347},{"_id":"source/_posts/net-core-v3-publish/3.png","hash":"8e753b8a3369912fd562a2ef39aa0add7aedcbbc","modified":1572316547848},{"_id":"source/_posts/net-core-v3-publish/6.png","hash":"460d303f305c4e0d0dca16ef806aef79573a3d92","modified":1572316556727},{"_id":"source/_posts/net-core-v3-swagger/3.png","hash":"666f1c4124227c59dd7f32d98a8362c25bd65b59","modified":1570688041756},{"_id":"source/_posts/net-core-v3-swagger/2.png","hash":"a443eaa200178d2fbaf6ee7293c46f8fc1fb31ce","modified":1570688035284},{"_id":"source/_posts/net-core-v3-swagger/1.png","hash":"e1a2763d0f234104fd17c973101fc18c851d9da8","modified":1570688026161},{"_id":"source/_posts/net-core-v3-swagger/4.png","hash":"4247acd36126ca96a977cad4da951685064e878d","modified":1570688046244},{"_id":"source/_posts/net-core-v3-swagger/6.png","hash":"4b395c7a99002c5839938641b164831ca4fb5414","modified":1570688052091},{"_id":"source/_posts/net-core-v3-swagger/7.png","hash":"c810f821e1005a4760fee352f12cbc2285a7f6a3","modified":1570688054876},{"_id":"source/_posts/net-core-v3-swagger/8.png","hash":"baf11ea180a26400032a13624f6121b580b55a2b","modified":1570688057876},{"_id":"source/_posts/net-core-v3-swagger/5.png","hash":"c5b745437efa0b117e4ea78ea22651a8ee25e12e","modified":1570688048884},{"_id":"source/_posts/vmware-nginx/1.png","hash":"0857666689c2b57c1407b70f4799247304d65c09","modified":1569740538269},{"_id":"source/_posts/vmware-mysql/1.png","hash":"6682860a646fa767e334b0bf0fdfb448e09caf13","modified":1569741286515},{"_id":"source/_posts/vmware-redis/3.png","hash":"e35188a3a1f4d1bfbff1a80d31c2d77cf2d37aa7","modified":1569741453411},{"_id":"source/_posts/tp5-fileupload-requestfile-is-null/1.png","hash":"cfcbee0dab551f4fa0afaf1c3d66b6177be69aa3","modified":1569302789953},{"_id":"source/_posts/vmware-redis/1.png","hash":"ed1c1ce3f2f3d6b6a660417e9926fc1f8b3192a8","modified":1569741443539},{"_id":"source/_posts/vmware-redis/2.png","hash":"a42414a12bce7a4b00b0a662ae25699902933d58","modified":1569741451278},{"_id":"source/_posts/vmware-use-centos/1.png","hash":"1f00c1d62ac91ec292c9f5957e60df5edbc2e7f0","modified":1569739652604},{"_id":"source/_posts/vmware-use-centos/10.png","hash":"7552c75d907ec841b61591ee049090bba058b58e","modified":1569739702779},{"_id":"source/_posts/vmware-use-centos/11.png","hash":"aa7ea5b2c097632116ea63a16f4c3ca746fdcde2","modified":1569739706660},{"_id":"source/_posts/vmware-use-centos/12.png","hash":"7c2f414b6d04209621a8838350146468489ca48f","modified":1569739709903},{"_id":"source/_posts/vmware-use-centos/13.png","hash":"1dcd76e6dd51de390d571216e5bdf973927c40c8","modified":1569739712827},{"_id":"source/_posts/vmware-use-centos/14.png","hash":"4d656461046ae0f08cc94c7f0abf6fa4a1d5cc1b","modified":1569739716012},{"_id":"source/_posts/vmware-use-centos/15.png","hash":"939f47ad58a4306bec48e38ada0d493986065102","modified":1569739719115},{"_id":"source/_posts/vmware-use-centos/16.png","hash":"7e7684ef893cdc80d725be893a394fd565e10a9c","modified":1569739722091},{"_id":"source/_posts/vmware-use-centos/18.png","hash":"db41a8512339613cd81ce54822701bf083b72802","modified":1569739728764},{"_id":"source/_posts/vmware-use-centos/19.png","hash":"3a3be9dcf9212f997c1890ca285cb76dca5e241f","modified":1569739732094},{"_id":"source/_posts/vmware-use-centos/20.png","hash":"947c2709978510bf9fda9ce8edbed7b636335901","modified":1569739735331},{"_id":"source/_posts/vmware-use-centos/2.png","hash":"320676acabe88c6242bfd4a8db777a5551f07c11","modified":1569739678495},{"_id":"source/_posts/vmware-use-centos/3.png","hash":"66a9ec58048436c11403e67bf05ac4568089a69d","modified":1569739681837},{"_id":"source/_posts/vmware-use-centos/5.png","hash":"4bb9b7a7c0313788910476c97de92f4dfc60fbea","modified":1569739688043},{"_id":"source/_posts/vmware-use-centos/6.png","hash":"9a23ae855e996f477c04526d8f09bfb026c6fcf6","modified":1569739690900},{"_id":"source/_posts/vmware-use-centos/7.png","hash":"045e8afeb219a0299c93e436863f95774c83851b","modified":1569739693980},{"_id":"source/_posts/vmware-use-centos/8.png","hash":"ce118940cf8a0291e02baac825fdf2428fda6bcf","modified":1569739696492},{"_id":"source/_posts/vmware-use-centos/9.png","hash":"f64b9f4e9957550ac7abfcbea0e69d3a011170ae","modified":1569739699306},{"_id":"source/_posts/vmware-use-centos/4.png","hash":"b50d669e5024a4826da426a200077421b6adbef7","modified":1569739685102},{"_id":"source/about/index/wx.jpg","hash":"e47f93f7ba8106dacb51826e297d3a6f15b9fd92","modified":1567559514922},{"_id":"themes/hexo-theme-sense/layout/partials/head.ejs","hash":"d2ae018a96006341184fddc3aa5dcecdf0899670","modified":1567591398998},{"_id":"source/about/index/happy-codding.jpg","hash":"11d988eddee95f9f03c186f303560d5c6f8c6415","modified":1567559514922},{"_id":"themes/hexo-theme-sense/layout/partials/header.ejs","hash":"01f1edaa8230b51522540ee309c5d5fb87275309","modified":1567587088402},{"_id":"themes/hexo-theme-sense/layout/partials/search.ejs","hash":"54a7d801aaf0d5010a92b6d60f86470c14bfe8f1","modified":1567559514932},{"_id":"themes/hexo-theme-sense/layout/partials/toc.ejs","hash":"1487a67ad468fbbbd4f56cd8c81523ef023cdc6c","modified":1567590684320},{"_id":"themes/hexo-theme-sense/layout/partials/recent-posts.ejs","hash":"1b4650d3d32568cd567a753ba5039f95b7807cb5","modified":1567587088403},{"_id":"themes/hexo-theme-sense/source/css/content.css.map","hash":"5ce694e0e32dffdd39b1f3813da7db0a1322ba3e","modified":1567559514935},{"_id":"themes/hexo-theme-sense/layout/partials/comment.ejs","hash":"7e3e9de45ec12781af337dfefb351930bb942bc1","modified":1567587088401},{"_id":"themes/hexo-theme-sense/source/css/content.css","hash":"60578e84d12da2b5c9898ac153176ea8cd69a765","modified":1569747897409},{"_id":"themes/hexo-theme-sense/layout/partials/footer.ejs","hash":"6cf63f68a2c9aac0fcc00f1ea9eab14dd783838e","modified":1572327285023},{"_id":"themes/hexo-theme-sense/source/css/content.scss","hash":"6c05f008be83645dd4e1efa306936434d58924b2","modified":1569747897344},{"_id":"themes/hexo-theme-sense/source/css/footer.css.map","hash":"9b3d2ae535903d7db247c7f28ce6665ffd43ccd4","modified":1567559514937},{"_id":"themes/hexo-theme-sense/source/css/footer.css","hash":"dfdb090da7e7cfe218e4a0c8690b83551bcdc2a5","modified":1567559514937},{"_id":"themes/hexo-theme-sense/source/css/footer.scss","hash":"aaa31206291e7f0c98c7664b9263602b69b5842b","modified":1567587088405},{"_id":"themes/hexo-theme-sense/source/css/go-top.css","hash":"9a0ba2ae0638db983c59116aa48de6322f829ae7","modified":1567559514938},{"_id":"themes/hexo-theme-sense/source/css/go-top.css.map","hash":"9547bfdbbcc05d5def3d86888cc7ba67e4cbab19","modified":1567559514938},{"_id":"themes/hexo-theme-sense/source/css/go-top.scss","hash":"addc9afc8f2fb7c52e4860b34a12222ee52d642e","modified":1569743499884},{"_id":"themes/hexo-theme-sense/source/css/fonts.css","hash":"e084a05fbeccddc27171e91c9694af3e52253e86","modified":1567559514936},{"_id":"themes/hexo-theme-sense/source/css/fonts.css.map","hash":"edbd3d240685ba52f8c89efc3e9c65f9ebf60686","modified":1567559514936},{"_id":"themes/hexo-theme-sense/source/css/header.css.map","hash":"7e402242a5038043557928eca7081bdef4be63ea","modified":1567559514939},{"_id":"themes/hexo-theme-sense/source/css/fonts.scss","hash":"3936a09c983e6f8aba87ea7c23ef9f96fe9bcfe1","modified":1567559514936},{"_id":"themes/hexo-theme-sense/source/css/highlight.css","hash":"139b2196453477649eaf70d07a448f6e4bcc61cf","modified":1567559514939},{"_id":"themes/hexo-theme-sense/source/css/header.css","hash":"a7142c64ed8f67c140989d9d4518eae9e4adcb6d","modified":1567559514938},{"_id":"themes/hexo-theme-sense/source/css/highlight.css.map","hash":"40ac1e0dd065c115bd064aa7e75786501b03ee74","modified":1567559514940},{"_id":"themes/hexo-theme-sense/source/css/image-view.css.map","hash":"b30aaeb395a49b42beab32f17dc6de09d798bbf8","modified":1567559514940},{"_id":"themes/hexo-theme-sense/source/css/header.scss","hash":"4f0bf6295a75a4496e775a5a4eefc6b826adf2fc","modified":1569735776629},{"_id":"themes/hexo-theme-sense/source/css/highlight.scss","hash":"dabe04ee69f4f98e42fd214bb0fe35e03be96309","modified":1569735776631},{"_id":"themes/hexo-theme-sense/source/css/page.css","hash":"a7b3879dee5373e1e470f2227a04fab6780a9e4e","modified":1572330841744},{"_id":"themes/hexo-theme-sense/source/css/page.css.map","hash":"29075c3b780bfe2698161d6d7e2a86a05acf8d14","modified":1567559514941},{"_id":"themes/hexo-theme-sense/source/css/scrollbar.css","hash":"a4ae873b8411389516259fc82d84df9f02c29a72","modified":1567559514942},{"_id":"themes/hexo-theme-sense/source/css/scrollbar.css.map","hash":"49bcd83b0babc06af761f7c0ff132f3df18bfe3b","modified":1567559514942},{"_id":"themes/hexo-theme-sense/source/css/scrollbar.scss","hash":"1c22f37d62221f6119765da954cc9d704461d4bf","modified":1569735776634},{"_id":"themes/hexo-theme-sense/source/css/search.css","hash":"3a34e9468c0a627d3b2981b24ea6f6e7346d4cf3","modified":1569735776636},{"_id":"themes/hexo-theme-sense/source/css/search.css.map","hash":"330c71b92978d83e8b188a4bc00fe65f86558b14","modified":1567559514943},{"_id":"themes/hexo-theme-sense/source/css/page.scss","hash":"c480aabd2877ecfd3baec6674c5d52f350d7fe27","modified":1572330841710},{"_id":"themes/hexo-theme-sense/source/css/search.scss","hash":"eb44955a8f70a36db93687594933bc24261b383a","modified":1567588600611},{"_id":"themes/hexo-theme-sense/source/css/sense.css","hash":"0d79fd29a7358073bb270da9b07f0078b87e6af6","modified":1572330853578},{"_id":"themes/hexo-theme-sense/source/css/image-view.css","hash":"759c5add3037a51f142e2d619e26cc8b711897a2","modified":1567559514940},{"_id":"themes/hexo-theme-sense/source/css/image-view.scss","hash":"375977ba6690d8a859f145b67d5e97214fcfcd67","modified":1567559514941},{"_id":"themes/hexo-theme-sense/source/css/video.css.map","hash":"2b2e67a9580cf378d3782158791abec89072847d","modified":1567559514945},{"_id":"themes/hexo-theme-sense/source/css/video.scss","hash":"e045a57dc0f711cd2411bc58828385e761cb995b","modified":1569735776753},{"_id":"themes/hexo-theme-sense/source/css/sense.scss","hash":"f295cf27cbcd710dc3d6dfbe01fbb13626b9977b","modified":1572330853316},{"_id":"themes/hexo-theme-sense/source/cursor/No_Disponible.cur","hash":"52685e4ee4ec0aa172d99c9f1fa002f9662f47d6","modified":1567559514946},{"_id":"themes/hexo-theme-sense/source/cursor/ayuda.cur","hash":"3b2f2cc7a36b8f958a7c3672a0407a59e187f314","modified":1567559514946},{"_id":"themes/hexo-theme-sense/source/cursor/texto.cur","hash":"514f4d81a9d7149912d6f217e5392a0e2606de45","modified":1567559514947},{"_id":"themes/hexo-theme-sense/source/cursor/normal.cur","hash":"4e784fa1e9630f782a379667423c4886b02c5545","modified":1567559514947},{"_id":"themes/hexo-theme-sense/source/cursor/work.cur","hash":"d98137bb1c2a8d844678ef660ff46fad2f66e982","modified":1567559514947},{"_id":"themes/hexo-theme-sense/source/font/iconfont.eot","hash":"bc8c5e88f4994a852041b4d83f126d9c4d419b4a","modified":1567559514948},{"_id":"themes/hexo-theme-sense/source/font/iconfont.svg","hash":"75767c904d483d9b93469afb6b92bb6bdface639","modified":1567559514972},{"_id":"themes/hexo-theme-sense/source/font/iconfont.ttf","hash":"f342ac8bf4d937f42a7d6a0032ad267ab47eb7f2","modified":1567559514973},{"_id":"themes/hexo-theme-sense/source/css/sense.css.map","hash":"6cc526da51f9321415842d9cf0e6e363d438baaf","modified":1569743499886},{"_id":"themes/hexo-theme-sense/source/css/video.css","hash":"5ece82e457135212d6ab107ad61beeadb152a12c","modified":1567559514945},{"_id":"themes/hexo-theme-sense/source/images/loading.gif","hash":"a6621b4c1ea148c727cc2b1a360261b9e1317c8b","modified":1567559514974},{"_id":"themes/hexo-theme-sense/source/images/photoTheater.png","hash":"628f6893e72a527c2848bad5a692d1a6028792a4","modified":1567559514975},{"_id":"themes/hexo-theme-sense/source/images/d-107.png","hash":"caf7a2c65d9c14a72b9bb918396e5b9f431eae45","modified":1567559514974},{"_id":"themes/hexo-theme-sense/source/images/rotate.png","hash":"b1dad4b8a32e3b75dcda803bceee345c623cd1e1","modified":1567559514976},{"_id":"themes/hexo-theme-sense/source/images/scroll.png","hash":"443930af0ee54778babad7724291bfed9b431dd5","modified":1567559514976},{"_id":"themes/hexo-theme-sense/source/js/image-view.js","hash":"360903330219d62fee011666b16331488e347451","modified":1567559514986},{"_id":"themes/hexo-theme-sense/source/js/sakura.js","hash":"5d1d89b159902af57c378e76ab917a07f9b28319","modified":1567559514988},{"_id":"themes/hexo-theme-sense/source/js/firework.js","hash":"177da6d8e35d393b4eee8fcd2613db24fae24b8d","modified":1567559514986},{"_id":"themes/hexo-theme-sense/source/images/overlay-hero.png","hash":"92481a1848c35be96a693af11f77265323a7c189","modified":1567559514975},{"_id":"themes/hexo-theme-sense/source/font/iconfont.woff","hash":"aa9672cb097f7fd73ae5a03bcd3d9d726935bc0a","modified":1567559514973},{"_id":"themes/hexo-theme-sense/source/js/sense.js","hash":"a0eb917ad1f92fa6a83640419390612d51e9eab8","modified":1569735776757},{"_id":"source/_posts/laravel-swoole-socket-in-laradock/demo.png","hash":"9a688590704b071f85991b730048c186778491b5","modified":1571638132153},{"_id":"source/_posts/net-core-aop-1/7.png","hash":"4f0e79859e777044cfb88d030f96bb602a333643","modified":1569303527595},{"_id":"source/_posts/net-core-april-util/6.png","hash":"f6a8a78f321386ee7c24ce97b80823541fe21a53","modified":1574391330736},{"_id":"source/_posts/net-core-april-util/8.png","hash":"3b9e69f5f3ac2488e721521b9cd5a5126e97de99","modified":1574391336640},{"_id":"source/_posts/net-core-april-util/9.png","hash":"84815d18570f47ad2b35bd3932a8770b23deb11c","modified":1574391341191},{"_id":"source/_posts/net-core-cache/5.png","hash":"3ce1c4c6abd19d1ce24036a3b0c14bf9fe72497a","modified":1569296412270},{"_id":"source/_posts/net-core-createprogram/3.png","hash":"cd920812998ab69e2e6ee1396b6fed47a8f68eab","modified":1569294369375},{"_id":"source/_posts/net-core-createprogram/1.png","hash":"707e456cc8a0dbdd4fc65920bb95c365eabf7584","modified":1569294351941},{"_id":"source/_posts/net-core-filedownload/1.png","hash":"1b43cc018b69827766b7f80985a2e27b1191628e","modified":1569740998139},{"_id":"source/_posts/net-core-fileuploader-and-cors/1.png","hash":"499abae2479a65094fac19ad9e3851d7c182b0a9","modified":1569740793675},{"_id":"source/_posts/net-core-fileuploader-and-cors/2.png","hash":"a7f0038ef8a87e11609a323aaf3c729bcefd6fe0","modified":1569740801363},{"_id":"source/_posts/net-core-fileuploader-and-cors/4.png","hash":"f5c704318be389f66f1174685548a71f40eec9f4","modified":1569740808285},{"_id":"source/_posts/net-core-fileuploader-and-cors/7.png","hash":"7f7c53c79ec6496b1c005b484c6ab6ee3b92238c","modified":1569740818771},{"_id":"source/_posts/net-core-log4net/2.png","hash":"1a66e0ccb372fc8478e075ba0510685881c241d9","modified":1569295360095},{"_id":"source/_posts/net-core-log4net/4.png","hash":"cac15d9f1c2f2700f852a8025f7aa2999c55b113","modified":1569295369095},{"_id":"source/_posts/net-core-qywx-application/1.png","hash":"8fea9ce99c9fd470da2aac30c72440f57ac62f2a","modified":1569741148940},{"_id":"source/_posts/net-core-qywx-application/2.png","hash":"95be0070c47e158a55bc4c09f929e3cd347c1e3e","modified":1569741154979},{"_id":"source/_posts/net-core-swagger/3.png","hash":"a28e37ab042ce9f184e6815c3c714044d9283604","modified":1569294990383},{"_id":"source/_posts/net-core-unittest/1.png","hash":"eb83902f70d92e068d767d90e569344a3cc07300","modified":1574391170879},{"_id":"source/_posts/net-core-v3-april-webapi/10.png","hash":"3f910a19757c05db95fb217f1498544ca66cb52a","modified":1570688241092},{"_id":"source/_posts/net-core-v3-april-webapi/11.png","hash":"06ca681028c4b3393e8afce06762295ca1d32233","modified":1570688249894},{"_id":"source/_posts/net-core-v3-april-webapi/15.png","hash":"125220d5c1baa51fbbcbf4e8cf1f265d1265ab6f","modified":1570688261947},{"_id":"source/_posts/net-core-v3-npoi/2.png","hash":"f4b348da37be2e9e1958f27d5e46244606becb74","modified":1572315849936},{"_id":"source/_posts/net-core-v3-publish/11.png","hash":"6bf210851fb3a63f1743a7b8a738df93274ac99b","modified":1572316572294},{"_id":"source/_posts/net-core-v3-publish/12.png","hash":"56d1aafb8e47874ff199f3696e76b08af7b145f1","modified":1572316576312},{"_id":"source/_posts/net-core-v3-publish/15.png","hash":"0701edd7b46514ba88e3cc68871be5f5af8ffc47","modified":1572316584912},{"_id":"source/_posts/net-core-v3-publish/4.png","hash":"66d9728a56307e97e40c799d8ea9407be03148e6","modified":1572316551541},{"_id":"source/_posts/net-core-v3-publish/7.png","hash":"690ae612d8cc801598882bff1da12a2c59b833b1","modified":1572316559346},{"_id":"source/_posts/net-core-v3-publish/8.png","hash":"eb79f423d8f6afd5928a7a7553702c4dde571dae","modified":1572316561864},{"_id":"source/_posts/net-core-v3-publish/9.png","hash":"3a875cd264a52c1e95ecd81d27fa0a4defb6701f","modified":1572316564479},{"_id":"source/_posts/vmware-nginx/2.png","hash":"84cb75bd62291252c6b853fca4b0c14498cc4252","modified":1569740547915},{"_id":"source/_posts/vmware-use-centos/17.png","hash":"7b611096d2c76a466df6754f465a83f1f4b918b4","modified":1569739725564},{"_id":"source/_posts/vmware-use-centos/27.png","hash":"be132ffc76d09cea3de4a50cc10b39b4e937ae89","modified":1569739756475},{"_id":"source/_posts/vmware-use-centos/29.png","hash":"3bee8b57281134b935ad187e52573bb56765af32","modified":1569739762606},{"_id":"source/_posts/vmware-use-centos/30.png","hash":"3f7663b620adfb84696333ff3c69983807f2eb5a","modified":1569739765758},{"_id":"source/_posts/vmware-use-centos/33.png","hash":"eb229f69972840b72b68402f53ef95b920a95c57","modified":1569739774387},{"_id":"source/_posts/vmware-use-centos/32.png","hash":"e79f05fb41debe05f4b2e82401785f08d44dda57","modified":1569739771607},{"_id":"source/_posts/vmware-use-centos/34.png","hash":"c9b260d9ef358b4e878e30b731c75c7a1e28588b","modified":1569739777116},{"_id":"source/_posts/vmware-use-centos/35.png","hash":"5c1ead565ac1af94cf00142fe07ecace95e88f12","modified":1569739780547},{"_id":"themes/hexo-theme-sense/source/images/favicon.ico","hash":"518569cc5ab05fd566fa75e2ff4ec3848e0db86c","modified":1567559514974},{"_id":"themes/hexo-theme-sense/source/js/jquery-3.4.1.min.js","hash":"b15f7cfa79519756dff1ad22553fd0ed09024343","modified":1567559514987},{"_id":"themes/hexo-theme-sense/source/js/snow.js","hash":"38f8daf47ad2142767f308d0afe2d59a64d214e3","modified":1567559514988},{"_id":"source/_posts/net-core-sqlsugar-2/9.png","hash":"f81c395c34d8d91bc0e46b6385acbff6a9bf4d0d","modified":1569303208011},{"_id":"source/_posts/net-core-cache/11.png","hash":"30871d0648957618d51a3b416e719f31506ea35a","modified":1569296435615},{"_id":"source/_posts/net-core-v3-april-webapi/7.png","hash":"32aefad1eb13ef53add8440dde9c8df88fd30e08","modified":1570688234301},{"_id":"source/_posts/vmware-use-centos/21.png","hash":"219886b48108df4c342096591cb977cc45034065","modified":1569739738723},{"_id":"source/_posts/vmware-use-centos/22.png","hash":"94fba928439540459948b0593ebad8e9159d4c81","modified":1569739741652},{"_id":"source/_posts/vmware-use-centos/26.png","hash":"bef2d9e05eb92eb98cebcb956c8f7186a977ffe4","modified":1569739753268},{"_id":"source/_posts/vmware-use-centos/28.png","hash":"f5b69a213612bd171c6441cdb1781a491126f7fb","modified":1569739759436},{"_id":"source/_posts/laravel-broadcasting/laravel.jpg","hash":"8a747edce2085347b73fc8d73cb3f97dc4f53fd6","modified":1569735776341},{"_id":"source/_posts/net-core-log4net/1.png","hash":"7f400c19dc25559421a04bf28928b3b6fa7bd19f","modified":1569295349703},{"_id":"source/_posts/net-core-swagger/1.png","hash":"189e129ee49fa2359378f0c82c3e6f92b0c6af30","modified":1569294977863},{"_id":"source/_posts/net-core-cache/1.png","hash":"3ff63dbf5e4442b701313f33da796099f0dc068f","modified":1569296395687},{"_id":"source/_posts/net-core-v3-april-webapi/13.png","hash":"9a8e2abd35b4b453cf75bc19e5be598b62b91e13","modified":1570688255956},{"_id":"source/_posts/vmware-use-centos/24.png","hash":"886b97cee7e03b4bf5d335b62f8f1bab147c8f5c","modified":1569739747195},{"_id":"source/_posts/vmware-use-centos/25.png","hash":"7ef502b9f2383eb5599e73d5bcd5234ae07fd3f0","modified":1569739750187},{"_id":"source/_posts/vmware-use-centos/31.png","hash":"e96a5e06b2a6519b012ed2eb505e4d464d928ccd","modified":1569739768741},{"_id":"source/_posts/laravel-events/laravel.jpg","hash":"8a747edce2085347b73fc8d73cb3f97dc4f53fd6","modified":1569735776426},{"_id":"source/_posts/net-core-log4net/5.png","hash":"744685637d45bb3cee6a96e2a6126c724b1f4a80","modified":1569295372191},{"_id":"source/_posts/net-core-v3-april-webapi/9.png","hash":"ebbf2241c43fb24d0161ed7e98969d4c2bd43b01","modified":1570688238807},{"_id":"source/_posts/vmware-use-centos/23.png","hash":"6e6dbf100eb33929e1b86a41e6e28d618b93cd10","modified":1569739744414},{"_id":"source/_posts/laravel-queues/laravel.jpg","hash":"8a747edce2085347b73fc8d73cb3f97dc4f53fd6","modified":1569735776444},{"_id":"source/_posts/hello-php/cover.png","hash":"35bc00e68fb2981cc9c28af3a54771388de600d4","modified":1567587088398},{"_id":"source/_posts/vmware-use-centos/36.png","hash":"1c6d1b9af03836042720fc49472ab6b66ac8ee4f","modified":1569739783285},{"_id":"source/_posts/net-core-v3-april-webapi/12.png","hash":"a0cb48585c50d9304d6d0a4dd440cc1f73ddf677","modified":1570688252637},{"_id":"themes/hexo-theme-sense/source/video/sense.ogv","hash":"efab3470e2c35435d173a38675e0e0dac39678a9","modified":1567559515055},{"_id":"themes/hexo-theme-sense/source/video/sense.webm","hash":"bf4f3c81cb2c48b252cf3d9a533a456b56550a99","modified":1567559515068},{"_id":"themes/hexo-theme-sense/source/images/sense.png","hash":"ace522ebcec8f6f5642354581036d80ef03d6168","modified":1567559514985},{"_id":"themes/hexo-theme-sense/source/video/sense.mp4","hash":"cb47e08ec8d4383af81fa52dacbad1319548719c","modified":1567559515037},{"_id":"public/about/index.html","hash":"eb6e17aefd1c463ecfa6d85ae43953dbbcb98a92","modified":1574391588530},{"_id":"public/2019/10/29/net-core-v3-publish/index.html","hash":"25380012e945127784dc7959ba83331e2240afb2","modified":1574391588531},{"_id":"public/2019/10/28/laravel-vue-svg/index.html","hash":"bb21b4f2fcc1dc1e53b5d7d19d3ab7e89e29b8da","modified":1574391588592},{"_id":"public/2019/10/18/net-core-v3-npoi/index.html","hash":"03702c2a90958d337bbfab29412dbafce732702a","modified":1574391588622},{"_id":"public/2019/10/28/vmare-docker/index.html","hash":"e2263f78dc37598db428dd6ffe934790120c5184","modified":1574391588622},{"_id":"public/2019/10/12/laravel-swoole-socket-in-laradock/index.html","hash":"768d18404b3b7f743e185f85455e7631d355fdc4","modified":1574391588627},{"_id":"public/2019/10/24/another-year-1024/index.html","hash":"802192f87acdfec0ecfac21bce8368c6af665d41","modified":1574391588629},{"_id":"public/2019/10/09/net-core-v3-april-webapi/index.html","hash":"1abf4a91ab766a97fed3ba6c1210aaf126fbbdca","modified":1574391588629},{"_id":"public/2019/10/07/net-core-v3-swagger/index.html","hash":"437a5e27378023f1011c2d61d5ce8062d73fc5dc","modified":1574391588629},{"_id":"public/2019/09/26/net-core-quartz/index.html","hash":"666accc2594239a965673a4cbd15a9aef0d00070","modified":1574391588629},{"_id":"public/2019/09/23/net-core-redis/index.html","hash":"ce7d28eb995a3052410c3751f2df0e3f705d7e32","modified":1574391588629},{"_id":"public/2019/09/12/vmware-redis/index.html","hash":"f316dfa8afcaf2089925f12db4f8a6b4e1d3d50f","modified":1574391588629},{"_id":"public/2019/09/12/vmware-mysql/index.html","hash":"60a44fb6634db900fcb0e403c0ef1dba0152d4af","modified":1574391588630},{"_id":"public/2019/09/04/hello-dotnet/index.html","hash":"a0a1bd93d63e84debc05f96c0e68ea2a9eab159b","modified":1574391588630},{"_id":"public/2019/09/03/hello-php/index.html","hash":"aaa00c68eacd4b30605cdd8dacd44434385d505b","modified":1574391588630},{"_id":"public/2019/09/02/net-core-qywx-application/index.html","hash":"8ce2d65631a48ae02d1a0a34f0108c075187e13d","modified":1574391588630},{"_id":"public/2019/08/27/net-core-filedownload/index.html","hash":"092e94195e900bd2c6c0a167f2f257a0ebd68b87","modified":1574391588630},{"_id":"public/2019/08/23/net-core-fileuploader-and-cors/index.html","hash":"6b5d533c6b59c0582986264f15d11fee9b7cd850","modified":1574391588630},{"_id":"public/2019/08/23/laravel-swoole-in-laradock/index.html","hash":"f2cfb0d0d187c5296176bed2ac4cd6ff0549b996","modified":1574391588630},{"_id":"public/2019/08/21/vmware-nginx/index.html","hash":"25a18d44cd65aa515d89cd1f3617e5fe7ec271a0","modified":1574391588630},{"_id":"public/2019/08/21/vmware-use-centos/index.html","hash":"4bb7155c9a08b5be472b6939e1563b9d6136e5c8","modified":1574391588630},{"_id":"public/2019/08/01/net-core-aop-2/index.html","hash":"0e85e9651425ea88000a1442f9dae14cd7288186","modified":1574391588630},{"_id":"public/2019/07/30/net-core-aop-1/index.html","hash":"3aee6a7d471252511a818badf2a4cdd1f517217f","modified":1574391588630},{"_id":"public/2019/08/02/use-laravel-permission-can-tag-in-vue/index.html","hash":"b597878baa7eaf435c538a6423a560d28554ff87","modified":1574391588630},{"_id":"public/2019/07/19/net-core-sqlsugar-2/index.html","hash":"3e302612c5e8e2c82d62e31b81fa55d0c141fdfe","modified":1574391588630},{"_id":"public/2019/07/19/net-core-webapi-main/index.html","hash":"d62e3a53edad091d6446c52637c084368db7d833","modified":1574391588630},{"_id":"public/2019/07/18/net-core-sqlsugar-1/index.html","hash":"cdb8e6431eb9a1cc6f740feb73c3e74933adfe90","modified":1574391588630},{"_id":"public/2019/07/11/tp5-fileupload-requestfile-is-null/index.html","hash":"fab8a9dd6b5093faf99132255895e22656b60830","modified":1574391588631},{"_id":"public/2019/07/10/net-core-cache/index.html","hash":"2acd849d037e22d8f2c4fd5b2858adc4a940ca45","modified":1574391588631},{"_id":"public/2019/07/04/net-core-log4net/index.html","hash":"13bb193ccd523ff36802644e191f35081c235100","modified":1574391588631},{"_id":"public/2019/07/02/net-core-swagger/index.html","hash":"f3389f2376e35aa7a2a80020d843e323038639f2","modified":1574391588631},{"_id":"public/2019/07/02/net-core-createprogram/index.html","hash":"7f1443827369b61e061c3afa13a753cd3baa2e5e","modified":1574391588631},{"_id":"public/2019/07/02/net-core-tools-and-environment/index.html","hash":"6640bf274b94084094633815ccbc7106313a1c65","modified":1574391588631},{"_id":"public/2019/04/12/laravel-broadcasting/index.html","hash":"548dc367c79a32538edd08f562908cd7172852af","modified":1574391588631},{"_id":"public/2019/04/09/laravel-queues/index.html","hash":"5b7d0a86d216504f92748b3709e56179c28c0a36","modified":1574391588631},{"_id":"public/2019/04/03/laravel-events/index.html","hash":"fb9ccfd5e2f28ace4bf24083761a6a49d0115682","modified":1574391588631},{"_id":"public/archives/index.html","hash":"4977b1007d3b778181ff64a452c3f107cb189d89","modified":1574391588631},{"_id":"public/2019/03/15/laravel-mix/index.html","hash":"0e428d48b29bd304be5cec0f5dfbdd14f16e41c8","modified":1574391588631},{"_id":"public/2018/02/13/hello-world/index.html","hash":"b33d9a62854ccab501332fd3994b66236523b5b8","modified":1574391588631},{"_id":"public/archives/page/2/index.html","hash":"fa1ea74c5346327adfad4d7b9eba27d39adf8a32","modified":1574391588631},{"_id":"public/archives/page/4/index.html","hash":"5c5878dbf868273460def29d4226979097586d42","modified":1574391588631},{"_id":"public/archives/page/3/index.html","hash":"0a8d25a459228b09e90d539da85a2773dae77f07","modified":1574391588631},{"_id":"public/archives/2018/index.html","hash":"d39c51e8a539ed1dc5ec3d3c0a954474c5b74dd0","modified":1574391588631},{"_id":"public/archives/2019/index.html","hash":"d70d3b78a8ced3885aca1b52e52fe6b076b7b6cb","modified":1574391588631},{"_id":"public/archives/2018/02/index.html","hash":"fd6fc6f4f1b2feb7161011a9d540cb929038064f","modified":1574391588631},{"_id":"public/archives/2019/page/2/index.html","hash":"44f921e6a1217a3f7979e0555c21737b3b17bd9e","modified":1574391588631},{"_id":"public/archives/2019/03/index.html","hash":"2d540bd4e649c45a9c5929e432ff098882de1555","modified":1574391588631},{"_id":"public/archives/2019/page/4/index.html","hash":"de16f60071af024c81f1399dda429b5b4ae81daf","modified":1574391588632},{"_id":"public/archives/2019/04/index.html","hash":"7e3ca74dc7e7ea8835400c08397f5bb8c5a03f1c","modified":1574391588632},{"_id":"public/archives/2019/page/3/index.html","hash":"62804cabe9866bc3ba7514795adad6064cd0b8cc","modified":1574391588632},{"_id":"public/archives/2019/07/index.html","hash":"fc35ecd317a809e70448ac124f0d090d52cc7486","modified":1574391588632},{"_id":"public/archives/2019/08/index.html","hash":"b75c67cc114b8ee0275bbe49ae803eac308ef839","modified":1574391588632},{"_id":"public/archives/2019/09/index.html","hash":"42e295fc1a3eb549642b6813712ca144ae79fe36","modified":1574391588632},{"_id":"public/archives/2019/10/index.html","hash":"28fc8c5ebe32bf13b7863a44b8d644e4f75d3102","modified":1574391588632},{"_id":"public/index.html","hash":"8bd8c675488e5181a04cf01b00402ed599e69c93","modified":1574391588632},{"_id":"public/page/2/index.html","hash":"8a23fbe5e907bc70dde08763427af8c1f4130ef4","modified":1574391588632},{"_id":"public/page/3/index.html","hash":"f6e4f801a455035481a812b02885256f1ae0c5ce","modified":1574391588632},{"_id":"public/page/4/index.html","hash":"37efcc492247fd50b512e08034ee33b06fdb81bd","modified":1574391588632},{"_id":"public/categories/AprilBlank/index.html","hash":"e4340d7ffcbfd4aa79fd725c7c803ff0549e5afe","modified":1574391588632},{"_id":"public/categories//index.html","hash":"3f69661300ccd7afc532a3b03c73cacee7fa0dcc","modified":1574391588632},{"_id":"public/categories/AprilBlank/page/2/index.html","hash":"2c9785040a625fd959e9c539c42baadfaf62d4d0","modified":1574391588632},{"_id":"public/categories/AprilBlank/page/3/index.html","hash":"7ca11f914ef47add6c34923dcf561bc2fcfdbfca","modified":1574391588632},{"_id":"public/tags/test/index.html","hash":"6bf94ae1bcb14b284206156aabe7baf99ccf1054","modified":1574391588632},{"_id":"public/tags//index.html","hash":"9b3c898389d314c273bf3ff1f4c84085ed472951","modified":1574391588632},{"_id":"public/tags/laravel/index.html","hash":"ed61be5dc9505987d5ac4936b3bcbbdd37b4d209","modified":1574391588632},{"_id":"public/tags/swoole/index.html","hash":"b46ff432ce7b2befec9f69a2761c85cb7700c088","modified":1574391588632},{"_id":"public/tags/net-core/index.html","hash":"b5b389b766cbd08ab75bf9e45faba2a509d3a2f4","modified":1574391588632},{"_id":"public/tags/docker/index.html","hash":"ed631f84751adee63954a71762bd58411c388188","modified":1574391588632},{"_id":"public/2019/11/10/net-core-april-util-update-1/index.html","hash":"eebf748bf2bee6662545892218a443e079cd91ce","modified":1574391588647},{"_id":"public/2019/11/07/net-core-april-util/index.html","hash":"47dcd3f352f9c5d5fdcce56a4d16672c66c15adc","modified":1574391588647},{"_id":"public/2019/11/05/net-core-unittest/index.html","hash":"b870babd47d2754a73741fe4d2f2c0275c5aa96e","modified":1574391588647},{"_id":"public/archives/2019/11/index.html","hash":"305d1f8dee4a216fa6e422a15aeb28191debfa2f","modified":1574391588647},{"_id":"public/tags/net-core/page/3/index.html","hash":"406fb61363aeaaa44dec2b3df6111f0d10fe97c6","modified":1574391588647},{"_id":"public/tags/vmware/index.html","hash":"8d30ea66d0571ec0d10bd53e862eb958fa062808","modified":1574391588647},{"_id":"public/tags/net-core/page/2/index.html","hash":"5431e20c02f18dba5a22d55b18ad2eb9e8cf9214","modified":1574391588648},{"_id":"public/tags//index.html","hash":"608b35c0cb692bc3c3fe046d3e53b2519565c32b","modified":1574391588648},{"_id":"public/tags/vue/index.html","hash":"0e0ac54bcb3844d0cdeb374dd2972615dc706b84","modified":1574391588648},{"_id":"public/tags/php/index.html","hash":"b46978b580b19ccb02a7cd727cc4ecf0861f120c","modified":1574391588648},{"_id":"public/tags//index.html","hash":"553cc6e5cc18b6d24b8e5cd9d798bc24f0faddab","modified":1574391588648},{"_id":"public/about/index/happy-codding.jpg","hash":"11d988eddee95f9f03c186f303560d5c6f8c6415","modified":1574391588688},{"_id":"public/css/content.css.map","hash":"5ce694e0e32dffdd39b1f3813da7db0a1322ba3e","modified":1574391588688},{"_id":"public/css/content.scss","hash":"6c05f008be83645dd4e1efa306936434d58924b2","modified":1574391588688},{"_id":"public/css/footer.css.map","hash":"9b3d2ae535903d7db247c7f28ce6665ffd43ccd4","modified":1574391588688},{"_id":"public/css/footer.scss","hash":"aaa31206291e7f0c98c7664b9263602b69b5842b","modified":1574391588688},{"_id":"public/css/go-top.css.map","hash":"9547bfdbbcc05d5def3d86888cc7ba67e4cbab19","modified":1574391588688},{"_id":"public/css/go-top.scss","hash":"addc9afc8f2fb7c52e4860b34a12222ee52d642e","modified":1574391588688},{"_id":"public/css/fonts.css.map","hash":"edbd3d240685ba52f8c89efc3e9c65f9ebf60686","modified":1574391588688},{"_id":"public/css/header.css.map","hash":"7e402242a5038043557928eca7081bdef4be63ea","modified":1574391588688},{"_id":"public/css/fonts.scss","hash":"3936a09c983e6f8aba87ea7c23ef9f96fe9bcfe1","modified":1574391588688},{"_id":"public/css/highlight.css.map","hash":"40ac1e0dd065c115bd064aa7e75786501b03ee74","modified":1574391588688},{"_id":"public/css/image-view.css.map","hash":"b30aaeb395a49b42beab32f17dc6de09d798bbf8","modified":1574391588688},{"_id":"public/css/header.scss","hash":"4f0bf6295a75a4496e775a5a4eefc6b826adf2fc","modified":1574391588689},{"_id":"public/css/scrollbar.scss","hash":"1c22f37d62221f6119765da954cc9d704461d4bf","modified":1574391588689},{"_id":"public/css/scrollbar.css.map","hash":"49bcd83b0babc06af761f7c0ff132f3df18bfe3b","modified":1574391588689},{"_id":"public/css/highlight.scss","hash":"dabe04ee69f4f98e42fd214bb0fe35e03be96309","modified":1574391588689},{"_id":"public/css/search.css.map","hash":"330c71b92978d83e8b188a4bc00fe65f86558b14","modified":1574391588689},{"_id":"public/css/page.css.map","hash":"29075c3b780bfe2698161d6d7e2a86a05acf8d14","modified":1574391588689},{"_id":"public/css/page.scss","hash":"c480aabd2877ecfd3baec6674c5d52f350d7fe27","modified":1574391588689},{"_id":"public/css/search.scss","hash":"eb44955a8f70a36db93687594933bc24261b383a","modified":1574391588689},{"_id":"public/css/image-view.scss","hash":"375977ba6690d8a859f145b67d5e97214fcfcd67","modified":1574391588689},{"_id":"public/css/video.scss","hash":"e045a57dc0f711cd2411bc58828385e761cb995b","modified":1574391588689},{"_id":"public/css/video.css.map","hash":"2b2e67a9580cf378d3782158791abec89072847d","modified":1574391588689},{"_id":"public/css/sense.scss","hash":"f295cf27cbcd710dc3d6dfbe01fbb13626b9977b","modified":1574391588689},{"_id":"public/cursor/No_Disponible.cur","hash":"52685e4ee4ec0aa172d99c9f1fa002f9662f47d6","modified":1574391588689},{"_id":"public/cursor/ayuda.cur","hash":"3b2f2cc7a36b8f958a7c3672a0407a59e187f314","modified":1574391588689},{"_id":"public/cursor/normal.cur","hash":"4e784fa1e9630f782a379667423c4886b02c5545","modified":1574391588689},{"_id":"public/cursor/work.cur","hash":"d98137bb1c2a8d844678ef660ff46fad2f66e982","modified":1574391588689},{"_id":"public/cursor/texto.cur","hash":"514f4d81a9d7149912d6f217e5392a0e2606de45","modified":1574391588690},{"_id":"public/font/iconfont.eot","hash":"bc8c5e88f4994a852041b4d83f126d9c4d419b4a","modified":1574391588690},{"_id":"public/font/iconfont.svg","hash":"75767c904d483d9b93469afb6b92bb6bdface639","modified":1574391588690},{"_id":"public/css/sense.css.map","hash":"6cc526da51f9321415842d9cf0e6e363d438baaf","modified":1574391588690},{"_id":"public/images/loading.gif","hash":"a6621b4c1ea148c727cc2b1a360261b9e1317c8b","modified":1574391588690},{"_id":"public/font/iconfont.ttf","hash":"f342ac8bf4d937f42a7d6a0032ad267ab47eb7f2","modified":1574391588690},{"_id":"public/images/photoTheater.png","hash":"628f6893e72a527c2848bad5a692d1a6028792a4","modified":1574391588690},{"_id":"public/images/d-107.png","hash":"caf7a2c65d9c14a72b9bb918396e5b9f431eae45","modified":1574391588690},{"_id":"public/images/rotate.png","hash":"b1dad4b8a32e3b75dcda803bceee345c623cd1e1","modified":1574391588690},{"_id":"public/images/scroll.png","hash":"443930af0ee54778babad7724291bfed9b431dd5","modified":1574391588690},{"_id":"public/images/overlay-hero.png","hash":"92481a1848c35be96a693af11f77265323a7c189","modified":1574391588690},{"_id":"public/font/iconfont.woff","hash":"aa9672cb097f7fd73ae5a03bcd3d9d726935bc0a","modified":1574391588690},{"_id":"public/2019/08/23/laravel-swoole-in-laradock/laradock.png","hash":"fb249a240bae786470099b0cf554d89b446c3623","modified":1574391588708},{"_id":"public/2019/03/15/laravel-mix/laravel-mix.png","hash":"8d39264428735ea937bf1ded9d095e430b289a17","modified":1574391588708},{"_id":"public/2019/04/09/laravel-queues/email.png","hash":"bfdca4ff3f9c2fdc46e6775c37961022683f0cce","modified":1574391588708},{"_id":"public/2019/07/11/tp5-fileupload-requestfile-is-null/1.png","hash":"cfcbee0dab551f4fa0afaf1c3d66b6177be69aa3","modified":1574391588708},{"_id":"public/2019/10/12/laravel-swoole-socket-in-laradock/laradock.png","hash":"fb249a240bae786470099b0cf554d89b446c3623","modified":1574391588708},{"_id":"public/2019/04/12/laravel-broadcasting/mes.png","hash":"eb6c38d51e7d0a24485473216abc88855dc3de01","modified":1574391588708},{"_id":"public/2019/04/12/laravel-broadcasting/new.png","hash":"be082f8430fe87420a8a2d0b80c5ec7174dd3509","modified":1574391588708},{"_id":"public/2019/08/21/vmware-nginx/1.png","hash":"0857666689c2b57c1407b70f4799247304d65c09","modified":1574391588709},{"_id":"public/2019/04/03/laravel-events/new-event.png","hash":"ebbfcf9dea64da8f3a1e27ea6a87e76a56e68eab","modified":1574391588710},{"_id":"public/2019/04/03/laravel-events/out.png","hash":"d13d91bff2c56ce2d01eb03564ebf3cf7e8abc33","modified":1574391588710},{"_id":"public/2019/09/12/vmware-redis/2.png","hash":"a42414a12bce7a4b00b0a662ae25699902933d58","modified":1574391588710},{"_id":"public/2019/09/12/vmware-redis/1.png","hash":"ed1c1ce3f2f3d6b6a660417e9926fc1f8b3192a8","modified":1574391588710},{"_id":"public/2019/09/12/vmware-redis/3.png","hash":"e35188a3a1f4d1bfbff1a80d31c2d77cf2d37aa7","modified":1574391588710},{"_id":"public/2019/08/01/net-core-aop-2/4.png","hash":"16c11cee5fdac52efea7daff78fc1f5d6c33752b","modified":1574391588710},{"_id":"public/2019/08/01/net-core-aop-2/1.png","hash":"610d9aaf433b99426ce2c1ac797de152c3677458","modified":1574391588710},{"_id":"public/2019/08/01/net-core-aop-2/2.png","hash":"e824a22aa3daabfdfd82597ffc32fc2faf657897","modified":1574391588710},{"_id":"public/2019/08/01/net-core-aop-2/3.png","hash":"60bd9e5674c9bbb875e24cca4fec4e2803942dda","modified":1574391588710},{"_id":"public/2019/07/02/net-core-createprogram/2.png","hash":"b25635ba96c0ce5aed1eee36e97322a7df9ed869","modified":1574391588710},{"_id":"public/2019/07/02/net-core-createprogram/5.png","hash":"764930797950d619723fa5b511f722f61048d63b","modified":1574391588710},{"_id":"public/2019/07/02/net-core-createprogram/4.png","hash":"07a4bf94522f46145a4b4f2b121963ba52def540","modified":1574391588710},{"_id":"public/2019/07/02/net-core-swagger/4.png","hash":"4ae10e844646e674e7720292c1f87587e4f496ed","modified":1574391588710},{"_id":"public/2019/07/02/net-core-swagger/2.png","hash":"2b046851b1f7d0597d88a40505f34d77b41f0f9c","modified":1574391588710},{"_id":"public/2019/07/02/net-core-swagger/6.png","hash":"7e0e29516e770a9f58ef582c8adeae8de903f242","modified":1574391588710},{"_id":"public/2019/07/30/net-core-aop-1/4.png","hash":"26f9cd36f1b1c24bd1bb5d86501ea3f0f782b41f","modified":1574391588711},{"_id":"public/2019/07/30/net-core-aop-1/1.png","hash":"780ee9b44c3d6533493db6ec477bd18d1b4bb8c3","modified":1574391588711},{"_id":"public/2019/07/02/net-core-swagger/5.png","hash":"c786e273da05b663def626c29ca2f10d6875cd51","modified":1574391588711},{"_id":"public/2019/07/30/net-core-aop-1/3.png","hash":"c556fcdcbb2d5750441ed6be369d56ffb67bfd0f","modified":1574391588711},{"_id":"public/2019/07/30/net-core-aop-1/5.png","hash":"79cbd9e4133871bacce3f6ec00cd78466fbc844b","modified":1574391588711},{"_id":"public/2019/07/30/net-core-aop-1/2.png","hash":"607142672012cedc5b9f9450deb41b2641f5b318","modified":1574391588711},{"_id":"public/2019/07/30/net-core-aop-1/6.png","hash":"27485076145c47bc7ac144314283eb64f1fae528","modified":1574391588711},{"_id":"public/2019/07/30/net-core-aop-1/8.png","hash":"dc7c175d3adce6952a30cac8b09e7c980a19bf28","modified":1574391588711},{"_id":"public/2019/10/07/net-core-v3-swagger/3.png","hash":"666f1c4124227c59dd7f32d98a8362c25bd65b59","modified":1574391588711},{"_id":"public/2019/10/07/net-core-v3-swagger/1.png","hash":"e1a2763d0f234104fd17c973101fc18c851d9da8","modified":1574391588711},{"_id":"public/2019/10/07/net-core-v3-swagger/2.png","hash":"a443eaa200178d2fbaf6ee7293c46f8fc1fb31ce","modified":1574391588711},{"_id":"public/2019/10/07/net-core-v3-swagger/7.png","hash":"c810f821e1005a4760fee352f12cbc2285a7f6a3","modified":1574391588711},{"_id":"public/2019/10/07/net-core-v3-swagger/4.png","hash":"4247acd36126ca96a977cad4da951685064e878d","modified":1574391588711},{"_id":"public/2019/10/07/net-core-v3-swagger/5.png","hash":"c5b745437efa0b117e4ea78ea22651a8ee25e12e","modified":1574391588711},{"_id":"public/2019/10/07/net-core-v3-swagger/6.png","hash":"4b395c7a99002c5839938641b164831ca4fb5414","modified":1574391588711},{"_id":"public/2019/10/07/net-core-v3-swagger/8.png","hash":"baf11ea180a26400032a13624f6121b580b55a2b","modified":1574391588711},{"_id":"public/2019/07/04/net-core-log4net/3.png","hash":"adecebc640cb2f6cd1521d055be4d38ad0443028","modified":1574391588711},{"_id":"public/2019/07/04/net-core-log4net/6.png","hash":"03ac034d208930dc33e87dad46bf0b579fd8146a","modified":1574391588711},{"_id":"public/2019/07/04/net-core-log4net/7.png","hash":"5c773c349de4f13989b45b812825a8b78ee8ec68","modified":1574391588711},{"_id":"public/2019/07/04/net-core-log4net/8.png","hash":"81f7653f0230b215a879105617c5e89e4713c878","modified":1574391588711},{"_id":"public/2019/10/09/net-core-v3-april-webapi/1.png","hash":"288fdcf52de6001f0a9416a785b4e3b53a32143b","modified":1574391588711},{"_id":"public/2019/07/04/net-core-log4net/9.png","hash":"08b8960af698827b185afb2349852afe9e94ed95","modified":1574391588711},{"_id":"public/2019/10/09/net-core-v3-april-webapi/14.png","hash":"a8fb68acb992ebf79093ca5a7c5a8b4a90e9f8b0","modified":1574391588711},{"_id":"public/2019/10/09/net-core-v3-april-webapi/3.png","hash":"9351f2b9509b2d92e062dd4677e79dc40a04621e","modified":1574391588711},{"_id":"public/2019/10/09/net-core-v3-april-webapi/4.png","hash":"8acc62b0a6e2de78f87d23fad4b24baa7b4a28ef","modified":1574391588711},{"_id":"public/2019/10/09/net-core-v3-april-webapi/2.png","hash":"09b26f046720cb296e313698de7c90820ef05607","modified":1574391588711},{"_id":"public/2019/10/09/net-core-v3-april-webapi/5.png","hash":"31fb36021993347cccab289ceb4068d31fe71658","modified":1574391588711},{"_id":"public/2019/10/09/net-core-v3-april-webapi/6.png","hash":"d0f7bf6e9cbfe150d5d37dc78fb38d95d6814f53","modified":1574391588712},{"_id":"public/2019/10/09/net-core-v3-april-webapi/8.png","hash":"784947e4f69237b243e8236632fa47750be00ef0","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/1.png","hash":"1f00c1d62ac91ec292c9f5957e60df5edbc2e7f0","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/10.png","hash":"7552c75d907ec841b61591ee049090bba058b58e","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/11.png","hash":"aa7ea5b2c097632116ea63a16f4c3ca746fdcde2","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/12.png","hash":"7c2f414b6d04209621a8838350146468489ca48f","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/13.png","hash":"1dcd76e6dd51de390d571216e5bdf973927c40c8","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/14.png","hash":"4d656461046ae0f08cc94c7f0abf6fa4a1d5cc1b","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/15.png","hash":"939f47ad58a4306bec48e38ada0d493986065102","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/16.png","hash":"7e7684ef893cdc80d725be893a394fd565e10a9c","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/18.png","hash":"db41a8512339613cd81ce54822701bf083b72802","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/19.png","hash":"3a3be9dcf9212f997c1890ca285cb76dca5e241f","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/2.png","hash":"320676acabe88c6242bfd4a8db777a5551f07c11","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/20.png","hash":"947c2709978510bf9fda9ce8edbed7b636335901","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/3.png","hash":"66a9ec58048436c11403e67bf05ac4568089a69d","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/4.png","hash":"b50d669e5024a4826da426a200077421b6adbef7","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/5.png","hash":"4bb9b7a7c0313788910476c97de92f4dfc60fbea","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/6.png","hash":"9a23ae855e996f477c04526d8f09bfb026c6fcf6","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/7.png","hash":"045e8afeb219a0299c93e436863f95774c83851b","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/8.png","hash":"ce118940cf8a0291e02baac825fdf2428fda6bcf","modified":1574391588712},{"_id":"public/2019/08/21/vmware-use-centos/9.png","hash":"f64b9f4e9957550ac7abfcbea0e69d3a011170ae","modified":1574391588712},{"_id":"public/2019/09/12/vmware-mysql/1.png","hash":"6682860a646fa767e334b0bf0fdfb448e09caf13","modified":1574391588712},{"_id":"public/2019/09/26/net-core-quartz/1.png","hash":"502387fb7e13509cdd91d18cc553630d8655a2fb","modified":1574391588712},{"_id":"public/2019/09/26/net-core-quartz/2.png","hash":"50ff5d7f73baff0a8be28dce8583348ffb7ec429","modified":1574391588712},{"_id":"public/2019/09/26/net-core-quartz/3.png","hash":"91d084c223092b41a2f2290c3b2021cc26c10e9d","modified":1574391588712},{"_id":"public/2019/09/02/net-core-qywx-application/3.png","hash":"d890289b77284becf2f7df75b3f314bc208a1031","modified":1574391588713},{"_id":"public/2019/09/02/net-core-qywx-application/5.png","hash":"49da1cc17350531ced6271845f474ba18e67fba5","modified":1574391588713},{"_id":"public/2019/09/02/net-core-qywx-application/4.png","hash":"9648d286d27cda5574f7dc5e061fcb0a4509cac3","modified":1574391588713},{"_id":"public/2019/10/18/net-core-v3-npoi/4.png","hash":"da02a80495673a50f976ce6beecbc53e26c6d7e9","modified":1574391588713},{"_id":"public/2019/10/18/net-core-v3-npoi/3.png","hash":"95aa031cc436a110ab1be1ebdd39c9e229018590","modified":1574391588713},{"_id":"public/2019/10/18/net-core-v3-npoi/1.png","hash":"7d1610c413b9711c951790e69ae4e2184cfbfc65","modified":1574391588713},{"_id":"public/2019/10/18/net-core-v3-npoi/5.png","hash":"e49c5277d73a9a31fae212cc9b0077e4f704f6d9","modified":1574391588713},{"_id":"public/2019/10/18/net-core-v3-npoi/6.png","hash":"d4500b2be47d2695c10c0e169f09c186247b50a7","modified":1574391588713},{"_id":"public/2019/07/19/net-core-sqlsugar-2/2.png","hash":"79089c07c66273eb5bc29618f908696a9424c5a6","modified":1574391588713},{"_id":"public/2019/07/19/net-core-sqlsugar-2/1.png","hash":"630441202ba307ce76d84294fadd4a6c1e1765b4","modified":1574391588713},{"_id":"public/2019/07/19/net-core-sqlsugar-2/5.png","hash":"736e78dbe1772106261da7485a33625ad2e7681b","modified":1574391588713},{"_id":"public/2019/07/19/net-core-sqlsugar-2/3.png","hash":"e46d3a11a79a1c7d1ea14b6130236572604b2372","modified":1574391588713},{"_id":"public/2019/07/19/net-core-sqlsugar-2/6.png","hash":"d52bbf5fe75da6ba89b5f252ce53fe7caff58c44","modified":1574391588713},{"_id":"public/2019/07/19/net-core-sqlsugar-2/7.png","hash":"e300f42ea58e301fe874787a4e4f59177d309ce5","modified":1574391588713},{"_id":"public/2019/07/19/net-core-sqlsugar-2/4.png","hash":"621c9ad39819aaa926067b7e6952b565798c9712","modified":1574391588713},{"_id":"public/2019/07/19/net-core-sqlsugar-2/8.png","hash":"4433496696f19adc838f5b53ba4879a1d561a3ba","modified":1574391588713},{"_id":"public/2019/07/10/net-core-cache/10.png","hash":"f5fb591e06416155bdd21eb8305fc712a4fa9e40","modified":1574391588713},{"_id":"public/2019/07/10/net-core-cache/2.png","hash":"9c319a60c2132a6147fe3301dbf838d7dc7783d0","modified":1574391588713},{"_id":"public/2019/07/10/net-core-cache/3.png","hash":"3b5ae85764678cdb4b30d2089ec572ee471d0dd1","modified":1574391588713},{"_id":"public/2019/07/10/net-core-cache/4.png","hash":"cb5eb9561be2b3a00c0c68197a77bfde73a8dfb7","modified":1574391588713},{"_id":"public/2019/07/10/net-core-cache/6.png","hash":"d16a90da59ce4495d05b7c0bb890894cfd84ae3e","modified":1574391588713},{"_id":"public/2019/07/10/net-core-cache/7.png","hash":"cd2263013bb301a04fb042eec76decf6755625ab","modified":1574391588713},{"_id":"public/2019/07/10/net-core-cache/8.png","hash":"bd8212b2da92788304d4ee2614080799f7d639cc","modified":1574391588713},{"_id":"public/2019/07/10/net-core-cache/9.png","hash":"c67d5edd0413b96a45f080335a7c60190bcaa3ce","modified":1574391588713},{"_id":"public/2019/09/23/net-core-redis/1.png","hash":"209e482551cef09a8c27567e2e9f129cc446e986","modified":1574391588713},{"_id":"public/2019/09/23/net-core-redis/11.png","hash":"aa36d1931ca167a1c0cdc77e69893a78a0c46453","modified":1574391588713},{"_id":"public/2019/09/23/net-core-redis/2.png","hash":"4037276da508ec51c10306d6bb95bf545d8e0891","modified":1574391588713},{"_id":"public/2019/09/23/net-core-redis/10.png","hash":"e7988db5c32cc2cf4273496e95fa2513a1b6b57d","modified":1574391588713},{"_id":"public/2019/09/23/net-core-redis/3.png","hash":"8790491f1234cf77e6d763f145e2bd366f3c07e6","modified":1574391588714},{"_id":"public/2019/09/23/net-core-redis/4.png","hash":"e612f7c27802dd49b658ab1c908e47731b712f24","modified":1574391588714},{"_id":"public/2019/09/23/net-core-redis/5.png","hash":"50250d27abd71b62090637f312e14be015a70391","modified":1574391588714},{"_id":"public/2019/09/23/net-core-redis/6.png","hash":"0992e1076913f055bc6de00ab0de29fb45a4ba38","modified":1574391588714},{"_id":"public/2019/09/23/net-core-redis/7.png","hash":"eb87146fdf60ebc5602c741ed676e34263574dde","modified":1574391588714},{"_id":"public/2019/09/23/net-core-redis/8.png","hash":"b207a19bbcd1518f08b5d67b45318c93a84aaec0","modified":1574391588714},{"_id":"public/2019/09/23/net-core-redis/9.png","hash":"dd70bcc095a85e653031d4f725f733205849efc9","modified":1574391588714},{"_id":"public/2019/10/29/net-core-v3-publish/1.png","hash":"b2b9467900dadc0ccff0240fe92535e87d26619a","modified":1574391588714},{"_id":"public/2019/10/29/net-core-v3-publish/10.png","hash":"b305ca9e7901cfe9f22fbdb3faa55e62dbccd6e0","modified":1574391588714},{"_id":"public/2019/10/29/net-core-v3-publish/13.png","hash":"bed93329822f73d1408ceacaec406a124dec6d10","modified":1574391588714},{"_id":"public/2019/10/29/net-core-v3-publish/14.png","hash":"27940498d049fc563ee43cace6fb647652c0ed1b","modified":1574391588714},{"_id":"public/2019/10/29/net-core-v3-publish/16.png","hash":"f05606fffce3c0190398cb27f2ac877f48ba7f7b","modified":1574391588714},{"_id":"public/2019/10/29/net-core-v3-publish/2.png","hash":"9f07f5eebe7c90ff448d24d62c3d07e00df5e0c7","modified":1574391588714},{"_id":"public/2019/10/29/net-core-v3-publish/3.png","hash":"8e753b8a3369912fd562a2ef39aa0add7aedcbbc","modified":1574391588714},{"_id":"public/2019/10/29/net-core-v3-publish/5.png","hash":"cefc281247099c073bcf88191eefc82cc718ec22","modified":1574391588714},{"_id":"public/2019/10/29/net-core-v3-publish/6.png","hash":"460d303f305c4e0d0dca16ef806aef79573a3d92","modified":1574391588714},{"_id":"public/2019/07/18/net-core-sqlsugar-1/1.png","hash":"0325e5226b78756888892a943746e0b3e7a90dc6","modified":1574391588714},{"_id":"public/2019/08/23/net-core-fileuploader-and-cors/3.png","hash":"ec2442681b8acef0b506cb2940e229b0ef4dcd8b","modified":1574391588714},{"_id":"public/2019/08/23/net-core-fileuploader-and-cors/5.png","hash":"0b0985b2605936e0d5eea3a903ed4761105e309c","modified":1574391588714},{"_id":"public/2019/08/23/net-core-fileuploader-and-cors/6.png","hash":"613681b41bb8fdda37d5ca5f098c7f8fb4527562","modified":1574391588714},{"_id":"public/live2dw/assets/mtn/idle_02.mtn","hash":"865874c50848fbc9a55011391531e2ec171c9b91","modified":1574391588714},{"_id":"public/live2dw/assets/mtn/idle_01.mtn","hash":"908abce18f6cf7fd4bc1486f048c25a517f4a34a","modified":1574391588714},{"_id":"public/live2dw/assets/mtn/shake_01.mtn","hash":"dffc54733127832f8f5e91aced55a83da58fa215","modified":1574391588714},{"_id":"public/live2dw/assets/mtn/shake_02.mtn","hash":"7b6c914f6c33450eda2e53d9b638fd7045c0f683","modified":1574391588714},{"_id":"public/live2dw/assets/mtn/touch_01.mtn","hash":"99270ea8fe1f8f5d88eadb94f36bd0810009d1e6","modified":1574391588714},{"_id":"public/live2dw/assets/mtn/idle_04.mtn","hash":"78e22091792abb0600f724a5dfd60371257954e8","modified":1574391588714},{"_id":"public/live2dw/assets/mtn/touch_03.mtn","hash":"9c394975083915f0f3786caff1762381348b041e","modified":1574391588714},{"_id":"public/live2dw/assets/mtn/touch_02.mtn","hash":"4d1f099fbd18d15c598a644227ed5bf942a2ba71","modified":1574391588714},{"_id":"public/live2dw/assets/mtn/touch_04.mtn","hash":"8d2302cfdaec698e575048797ff4f30ae4d202de","modified":1574391588714},{"_id":"public/live2dw/assets/mtn/idle_03.mtn","hash":"84684914ebf5dc5b2df160338bb97dcc0a978476","modified":1574391588715},{"_id":"public/live2dw/assets/mtn/touch_05.mtn","hash":"9610bb8a937ba9b11445a3894d8cc0733a2b67e5","modified":1574391588715},{"_id":"public/live2dw/lib/L2Dwidget.min.js","hash":"5f1a807437cc723bcadc3791d37add5ceed566a2","modified":1574391588715},{"_id":"public/live2dw/assets/wanko.model.json","hash":"b98a8ce54fbcf1606a489f1bc5f26b1a18c82d79","modified":1574391588715},{"_id":"public/2019/11/05/net-core-unittest/2.png","hash":"3f126c7a1478e824343f7d558bebc5db6dd0d3c4","modified":1574391588715},{"_id":"public/2019/11/07/net-core-april-util/1.png","hash":"1d0ebc979af27ad3373eaba012ffac1ee974cab7","modified":1574391588715},{"_id":"public/2019/11/07/net-core-april-util/4.png","hash":"7571d00feebf631f7de20f908dfd7fc216bbe826","modified":1574391588715},{"_id":"public/2019/11/07/net-core-april-util/3.png","hash":"e913f70abf0e10f71deb3bf69173a2a7b24eaa45","modified":1574391588715},{"_id":"public/2019/11/07/net-core-april-util/2.png","hash":"051932c78473a6dbaa5241c6b4e62d46f5119b42","modified":1574391588715},{"_id":"public/2019/11/07/net-core-april-util/5.png","hash":"aa2841aba09d3d87cb67d957d7c110fc29414b45","modified":1574391588715},{"_id":"public/2019/11/07/net-core-april-util/7.png","hash":"9724996f89b8b5bcb3ee2b86ee22c3a620ecc60b","modified":1574391588715},{"_id":"public/2019/11/07/net-core-april-util/9.png","hash":"84815d18570f47ad2b35bd3932a8770b23deb11c","modified":1574391588715},{"_id":"public/2019/11/10/net-core-april-util-update-1/1.png","hash":"78a5c54ab470f86efa9a2a5280b6f4be961b3787","modified":1574391588715},{"_id":"public/2019/11/10/net-core-april-util-update-1/2.png","hash":"99e3cbf4912b681ce83dce60c3c092e7326c1932","modified":1574391588715},{"_id":"public/2019/11/10/net-core-april-util-update-1/3.png","hash":"2197a2a6d56fd5c78724a45e9ff0931021ec8aa4","modified":1574391588715},{"_id":"public/2019/11/10/net-core-april-util-update-1/4.png","hash":"090c35650ba92e31b1c29bef38200ecd392a923a","modified":1574391588715},{"_id":"public/2019/11/10/net-core-april-util-update-1/5.png","hash":"23cd7418044e9c85429e265f8dd34af5366ad243","modified":1574391588715},{"_id":"public/2019/11/10/net-core-april-util-update-1/6.png","hash":"9388b2e7d4008675bdc2f1c67f0d3b40987a5531","modified":1574391588715},{"_id":"public/2019/11/10/net-core-april-util-update-1/7.png","hash":"30d14f4054e57d8e0d549f7fa88959b120e202a9","modified":1574391588715},{"_id":"public/2019/11/10/net-core-april-util-update-1/8.png","hash":"b76f9d6f0a3349e5d84870086ff43fc4a916d8b1","modified":1574391588715},{"_id":"public/about/index/wx.jpg","hash":"e47f93f7ba8106dacb51826e297d3a6f15b9fd92","modified":1574391588856},{"_id":"public/css/footer.css","hash":"79f7e986bbaf7cb410f30667e3b8e7406ce78bf5","modified":1574391588868},{"_id":"public/css/go-top.css","hash":"35ce47c65393c4306fbf7d1f3fb3d43e53125150","modified":1574391588868},{"_id":"public/css/fonts.css","hash":"2995be5d872a03b7c85f638c8849b91bb0ea6bf2","modified":1574391588868},{"_id":"public/css/highlight.css","hash":"84ffe2d488f4b5172f9e80f34d7277129c358b53","modified":1574391588869},{"_id":"public/css/header.css","hash":"3f6559eb5ce13dfe86243a01dd18e47b20748fa0","modified":1574391588869},{"_id":"public/css/page.css","hash":"a7b3879dee5373e1e470f2227a04fab6780a9e4e","modified":1574391588869},{"_id":"public/css/scrollbar.css","hash":"bf6f7df5ae452765763384a1e8453224b66003b5","modified":1574391588869},{"_id":"public/css/search.css","hash":"e63a99a2901aac1bf0627f7d4a95161f2a0a139f","modified":1574391588869},{"_id":"public/css/image-view.css","hash":"4a09197f4938491edef346ed35e901e4d698631c","modified":1574391588869},{"_id":"public/css/video.css","hash":"f7ae31aa4b16e1869d73009dde5ad3366c599ec7","modified":1574391588869},{"_id":"public/images/favicon.ico","hash":"518569cc5ab05fd566fa75e2ff4ec3848e0db86c","modified":1574391588869},{"_id":"public/2019/10/12/laravel-swoole-socket-in-laradock/demo.png","hash":"9a688590704b071f85991b730048c186778491b5","modified":1574391588869},{"_id":"public/2019/08/21/vmware-nginx/2.png","hash":"84cb75bd62291252c6b853fca4b0c14498cc4252","modified":1574391588869},{"_id":"public/2019/07/02/net-core-createprogram/1.png","hash":"707e456cc8a0dbdd4fc65920bb95c365eabf7584","modified":1574391588869},{"_id":"public/2019/07/02/net-core-createprogram/3.png","hash":"cd920812998ab69e2e6ee1396b6fed47a8f68eab","modified":1574391588869},{"_id":"public/2019/07/02/net-core-swagger/3.png","hash":"a28e37ab042ce9f184e6815c3c714044d9283604","modified":1574391588869},{"_id":"public/2019/07/30/net-core-aop-1/7.png","hash":"4f0e79859e777044cfb88d030f96bb602a333643","modified":1574391588870},{"_id":"public/2019/07/04/net-core-log4net/2.png","hash":"1a66e0ccb372fc8478e075ba0510685881c241d9","modified":1574391588870},{"_id":"public/2019/07/04/net-core-log4net/4.png","hash":"cac15d9f1c2f2700f852a8025f7aa2999c55b113","modified":1574391588870},{"_id":"public/2019/10/09/net-core-v3-april-webapi/10.png","hash":"3f910a19757c05db95fb217f1498544ca66cb52a","modified":1574391588870},{"_id":"public/2019/10/09/net-core-v3-april-webapi/11.png","hash":"06ca681028c4b3393e8afce06762295ca1d32233","modified":1574391588870},{"_id":"public/2019/10/09/net-core-v3-april-webapi/15.png","hash":"125220d5c1baa51fbbcbf4e8cf1f265d1265ab6f","modified":1574391588870},{"_id":"public/2019/08/21/vmware-use-centos/17.png","hash":"7b611096d2c76a466df6754f465a83f1f4b918b4","modified":1574391588870},{"_id":"public/2019/08/21/vmware-use-centos/27.png","hash":"be132ffc76d09cea3de4a50cc10b39b4e937ae89","modified":1574391588871},{"_id":"public/2019/08/21/vmware-use-centos/30.png","hash":"3f7663b620adfb84696333ff3c69983807f2eb5a","modified":1574391588871},{"_id":"public/2019/08/21/vmware-use-centos/29.png","hash":"3bee8b57281134b935ad187e52573bb56765af32","modified":1574391588871},{"_id":"public/2019/08/21/vmware-use-centos/32.png","hash":"e79f05fb41debe05f4b2e82401785f08d44dda57","modified":1574391588871},{"_id":"public/2019/08/21/vmware-use-centos/33.png","hash":"eb229f69972840b72b68402f53ef95b920a95c57","modified":1574391588871},{"_id":"public/2019/08/21/vmware-use-centos/34.png","hash":"c9b260d9ef358b4e878e30b731c75c7a1e28588b","modified":1574391588871},{"_id":"public/2019/08/21/vmware-use-centos/35.png","hash":"5c1ead565ac1af94cf00142fe07ecace95e88f12","modified":1574391588872},{"_id":"public/2019/08/27/net-core-filedownload/1.png","hash":"1b43cc018b69827766b7f80985a2e27b1191628e","modified":1574391588872},{"_id":"public/2019/09/02/net-core-qywx-application/1.png","hash":"8fea9ce99c9fd470da2aac30c72440f57ac62f2a","modified":1574391588872},{"_id":"public/2019/09/02/net-core-qywx-application/2.png","hash":"95be0070c47e158a55bc4c09f929e3cd347c1e3e","modified":1574391588872},{"_id":"public/2019/10/18/net-core-v3-npoi/2.png","hash":"f4b348da37be2e9e1958f27d5e46244606becb74","modified":1574391588872},{"_id":"public/js/firework.js","hash":"805caed95829fccafc74c7d741c6e2c00953998d","modified":1574391588882},{"_id":"public/js/sense.js","hash":"fc79b9c402f5711b1381c521e6e25d0a1490bb9f","modified":1574391588882},{"_id":"public/js/snow.js","hash":"e442240cb39d66d9ef4841f8a38a884ec05b7020","modified":1574391588882},{"_id":"public/2019/07/19/net-core-sqlsugar-2/9.png","hash":"f81c395c34d8d91bc0e46b6385acbff6a9bf4d0d","modified":1574391588882},{"_id":"public/2019/07/10/net-core-cache/5.png","hash":"3ce1c4c6abd19d1ce24036a3b0c14bf9fe72497a","modified":1574391588882},{"_id":"public/2019/10/29/net-core-v3-publish/11.png","hash":"6bf210851fb3a63f1743a7b8a738df93274ac99b","modified":1574391588882},{"_id":"public/2019/10/29/net-core-v3-publish/12.png","hash":"56d1aafb8e47874ff199f3696e76b08af7b145f1","modified":1574391588883},{"_id":"public/2019/10/29/net-core-v3-publish/15.png","hash":"0701edd7b46514ba88e3cc68871be5f5af8ffc47","modified":1574391588883},{"_id":"public/2019/10/29/net-core-v3-publish/4.png","hash":"66d9728a56307e97e40c799d8ea9407be03148e6","modified":1574391588883},{"_id":"public/2019/10/29/net-core-v3-publish/7.png","hash":"690ae612d8cc801598882bff1da12a2c59b833b1","modified":1574391588883},{"_id":"public/2019/10/29/net-core-v3-publish/8.png","hash":"eb79f423d8f6afd5928a7a7553702c4dde571dae","modified":1574391588883},{"_id":"public/2019/10/29/net-core-v3-publish/9.png","hash":"3a875cd264a52c1e95ecd81d27fa0a4defb6701f","modified":1574391588883},{"_id":"public/2019/08/23/net-core-fileuploader-and-cors/1.png","hash":"499abae2479a65094fac19ad9e3851d7c182b0a9","modified":1574391588883},{"_id":"public/2019/08/23/net-core-fileuploader-and-cors/2.png","hash":"a7f0038ef8a87e11609a323aaf3c729bcefd6fe0","modified":1574391588883},{"_id":"public/2019/08/23/net-core-fileuploader-and-cors/4.png","hash":"f5c704318be389f66f1174685548a71f40eec9f4","modified":1574391588883},{"_id":"public/2019/08/23/net-core-fileuploader-and-cors/7.png","hash":"7f7c53c79ec6496b1c005b484c6ab6ee3b92238c","modified":1574391588883},{"_id":"public/live2dw/assets/moc/wanko.1024/texture_00.png","hash":"c405c1eeb82bcced7aa7a20f04a76168f60ad561","modified":1574391588883},{"_id":"public/live2dw/assets/moc/wanko.moc","hash":"7b188cd4dcddfe5bdba8ec51a65cb1c21cd2e57a","modified":1574391588884},{"_id":"public/live2dw/lib/L2Dwidget.min.js.map","hash":"3290fe2df45f065b51a1cd7b24ec325cbf9bb5ce","modified":1574391588884},{"_id":"public/2019/11/05/net-core-unittest/1.png","hash":"eb83902f70d92e068d767d90e569344a3cc07300","modified":1574391588884},{"_id":"public/2019/11/07/net-core-april-util/6.png","hash":"f6a8a78f321386ee7c24ce97b80823541fe21a53","modified":1574391588884},{"_id":"public/2019/11/07/net-core-april-util/8.png","hash":"3b9e69f5f3ac2488e721521b9cd5a5126e97de99","modified":1574391588884},{"_id":"public/live2dw/assets/mtn/touch_06.mtn","hash":"feb9237c73f2045ed1704c01b5362c9a54ee5a18","modified":1574391588884},{"_id":"public/css/content.css","hash":"60578e84d12da2b5c9898ac153176ea8cd69a765","modified":1574391588915},{"_id":"public/js/image-view.js","hash":"fb3325240c6db34f3369236826ef277fd4276f58","modified":1574391588915},{"_id":"public/2019/07/04/net-core-log4net/1.png","hash":"7f400c19dc25559421a04bf28928b3b6fa7bd19f","modified":1574391588916},{"_id":"public/2019/07/10/net-core-cache/1.png","hash":"3ff63dbf5e4442b701313f33da796099f0dc068f","modified":1574391588916},{"_id":"public/2019/07/02/net-core-swagger/1.png","hash":"189e129ee49fa2359378f0c82c3e6f92b0c6af30","modified":1574391588942},{"_id":"public/2019/08/21/vmware-use-centos/24.png","hash":"886b97cee7e03b4bf5d335b62f8f1bab147c8f5c","modified":1574391588942},{"_id":"public/2019/08/21/vmware-use-centos/25.png","hash":"7ef502b9f2383eb5599e73d5bcd5234ae07fd3f0","modified":1574391588947},{"_id":"public/2019/10/09/net-core-v3-april-webapi/13.png","hash":"9a8e2abd35b4b453cf75bc19e5be598b62b91e13","modified":1574391588947},{"_id":"public/2019/10/09/net-core-v3-april-webapi/9.png","hash":"ebbf2241c43fb24d0161ed7e98969d4c2bd43b01","modified":1574391588956},{"_id":"public/2019/04/09/laravel-queues/laravel.jpg","hash":"8a747edce2085347b73fc8d73cb3f97dc4f53fd6","modified":1574391588957},{"_id":"public/2019/10/09/net-core-v3-april-webapi/7.png","hash":"32aefad1eb13ef53add8440dde9c8df88fd30e08","modified":1574391588958},{"_id":"public/2019/08/21/vmware-use-centos/21.png","hash":"219886b48108df4c342096591cb977cc45034065","modified":1574391588959},{"_id":"public/2019/07/10/net-core-cache/11.png","hash":"30871d0648957618d51a3b416e719f31506ea35a","modified":1574391588959},{"_id":"public/2019/04/12/laravel-broadcasting/laravel.jpg","hash":"8a747edce2085347b73fc8d73cb3f97dc4f53fd6","modified":1574391589177},{"_id":"public/2019/08/21/vmware-use-centos/31.png","hash":"e96a5e06b2a6519b012ed2eb505e4d464d928ccd","modified":1574391589177},{"_id":"public/2019/04/03/laravel-events/laravel.jpg","hash":"8a747edce2085347b73fc8d73cb3f97dc4f53fd6","modified":1574391589177},{"_id":"public/2019/08/21/vmware-use-centos/22.png","hash":"94fba928439540459948b0593ebad8e9159d4c81","modified":1574391589177},{"_id":"public/2019/08/21/vmware-use-centos/26.png","hash":"bef2d9e05eb92eb98cebcb956c8f7186a977ffe4","modified":1574391589178},{"_id":"public/2019/08/21/vmware-use-centos/28.png","hash":"f5b69a213612bd171c6441cdb1781a491126f7fb","modified":1574391589178},{"_id":"public/live2dw/lib/L2Dwidget.0.min.js","hash":"35bb5b588b6de25c9be2dd51d3fd331feafac02d","modified":1574391589218},{"_id":"public/2019/08/21/vmware-use-centos/23.png","hash":"6e6dbf100eb33929e1b86a41e6e28d618b93cd10","modified":1574391589218},{"_id":"public/2019/07/04/net-core-log4net/5.png","hash":"744685637d45bb3cee6a96e2a6126c724b1f4a80","modified":1574391589366},{"_id":"public/css/sense.css","hash":"0d79fd29a7358073bb270da9b07f0078b87e6af6","modified":1574391589396},{"_id":"public/2019/09/03/hello-php/cover.png","hash":"35bc00e68fb2981cc9c28af3a54771388de600d4","modified":1574391589396},{"_id":"public/2019/08/21/vmware-use-centos/36.png","hash":"1c6d1b9af03836042720fc49472ab6b66ac8ee4f","modified":1574391589396},{"_id":"public/2019/10/09/net-core-v3-april-webapi/12.png","hash":"a0cb48585c50d9304d6d0a4dd440cc1f73ddf677","modified":1574391589402},{"_id":"public/js/sakura.js","hash":"940475057a9aa808f1a2ddceda1b6de99b7cac7d","modified":1574391589412},{"_id":"public/js/jquery-3.4.1.min.js","hash":"88523924351bac0b5d560fe0c5781e2556e7693d","modified":1574391589437},{"_id":"public/live2dw/lib/L2Dwidget.0.min.js.map","hash":"35e71cc2a130199efb167b9a06939576602f0d75","modified":1574391589452},{"_id":"public/video/sense.ogv","hash":"efab3470e2c35435d173a38675e0e0dac39678a9","modified":1574391589453},{"_id":"public/video/sense.webm","hash":"bf4f3c81cb2c48b252cf3d9a533a456b56550a99","modified":1574391589455},{"_id":"public/images/sense.png","hash":"ace522ebcec8f6f5642354581036d80ef03d6168","modified":1574391589458},{"_id":"public/video/sense.mp4","hash":"cb47e08ec8d4383af81fa52dacbad1319548719c","modified":1574391589468}],"Category":[{"name":"AprilBlank","_id":"ck39k3m0m00049sv78byu6ib2"},{"name":"","_id":"ck39k3m1v000e9sv7iwv05w3a"}],"Data":[{"_id":"temp","data":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}],"Page":[{"title":"","date":"2018-02-14T05:11:41.000Z","_content":"\nD-107 3wly \n\n\n* PHP\n* JAVA\n* .NET\n* Android\n\n\n![](index/happy-codding.jpg)\n","source":"about/index.md","raw":"---\ntitle: \ndate: 2018-02-14 13:11:41\n---\n\nD-107 3wly \n\n\n* PHP\n* JAVA\n* .NET\n* Android\n\n\n![](index/happy-codding.jpg)\n","updated":"2019-09-04T08:51:28.399Z","path":"about/index.html","comments":1,"layout":"page","_id":"ck39k3m1p000c9sv7g0tzeauc","content":"<p>D-107 3wly </p>\n<p></p>\n<ul>\n<li>PHP</li>\n<li>JAVA</li>\n<li>.NET</li>\n<li>Android</li>\n</ul>\n<p><img src=\"/about/index/happy-codding.jpg\" alt=\"\"></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<p>D-107 3wly </p>\n<p></p>\n<ul>\n<li>PHP</li>\n<li>JAVA</li>\n<li>.NET</li>\n<li>Android</li>\n</ul>\n<p><img src=\"/about/index/happy-codding.jpg\" alt=\"\"></p>\n"}],"Post":[{"title":"Hello Dotnet","date":"2019-09-04T08:56:38.000Z","_content":"\n### \n\n```csharp\nstring name = \"\";\nConsole.WriteLine($\"Hello {name}\");\n```","source":"_posts/hello-dotnet.md","raw":"---\ntitle: Hello Dotnet\ndate: 2019-09-04 16:56:38\ntags: test\n---\n\n### \n\n```csharp\nstring name = \"\";\nConsole.WriteLine($\"Hello {name}\");\n```","slug":"hello-dotnet","published":1,"updated":"2019-11-01T08:29:39.292Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m0400009sv76adr5fdc","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">string</span> name = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">Console.WriteLine(<span class=\"string\">$\"Hello <span class=\"subst\">&#123;name&#125;</span>\"</span>);</span><br></pre></td></tr></table></figure>","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">string</span> name = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">Console.WriteLine(<span class=\"string\">$\"Hello <span class=\"subst\">&#123;name&#125;</span>\"</span>);</span><br></pre></td></tr></table></figure>"},{"title":"Hello PHP","date":"2019-09-03T15:59:00.000Z","_content":"\n\n\n\n\n![](hello-php/cover.png)\n\n\n```php\n$hello = '';\necho $hello;\n```\n\n> D-107\n\n`D-107`\n","source":"_posts/hello-php.md","raw":"---\ntitle: Hello PHP\ndate: 2019-09-03 23:59:00\ntags: test\n---\n\n\n\n\n\n![](hello-php/cover.png)\n\n\n```php\n$hello = '';\necho $hello;\n```\n\n> D-107\n\n`D-107`\n","slug":"hello-php","published":1,"updated":"2019-09-04T09:08:22.631Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m0d00019sv7lk362q5o","content":"<p></p>\n<p></p>\n<p><img src=\"/2019/09/03/hello-php/cover.png\" alt></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$hello = <span class=\"string\">''</span>;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> $hello;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>D-107</p>\n</blockquote>\n<p><code>D-107</code></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<p></p>\n<p></p>\n<p><img src=\"/2019/09/03/hello-php/cover.png\" alt></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$hello = <span class=\"string\">''</span>;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> $hello;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>D-107</p>\n</blockquote>\n<p><code>D-107</code></p>\n"},{"title":"1024","date":"2019-10-24T00:44:42.000Z","_content":"\n### \n\n1024**bug** \n\n### \n\n20\n\n16.net18.net\n\nC#phpjavapythongodemoworld\n\nsqlemm==\"\"== ==\"996ICU\"== \n\n****\n\n### \n\n.net\n\n | \n---|---\nnetframework | \nnetframeword | \nlayui | \n | \n | \nnet core2.1 | 1810\nApril.WebApi | 7\n\n\n\n7\n\n\n\n### \n\n.netnet core\n\n\n\n\n\n### \n\n> ps:\n\n****\n","source":"_posts/another-year-1024.md","raw":"---\ntitle: 1024\ndate: 2019-10-24 08:44:42\ntags: \ncategories: AprilBlank\n---\n\n### \n\n1024**bug** \n\n### \n\n20\n\n16.net18.net\n\nC#phpjavapythongodemoworld\n\nsqlemm==\"\"== ==\"996ICU\"== \n\n****\n\n### \n\n.net\n\n | \n---|---\nnetframework | \nnetframeword | \nlayui | \n | \n | \nnet core2.1 | 1810\nApril.WebApi | 7\n\n\n\n7\n\n\n\n### \n\n.netnet core\n\n\n\n\n\n### \n\n> ps:\n\n****\n","slug":"another-year-1024","published":1,"updated":"2019-10-29T02:32:40.043Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m0k00039sv778kskwgm","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>1024<strong>bug</strong> </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>20</p>\n<p>16.net18.net</p>\n<p>C#phpjavapythongodemoworld</p>\n<p>sqlemm==== ==996ICU== </p>\n<p><strong></strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>.net</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>netframework</td>\n<td></td>\n</tr>\n<tr>\n<td>netframeword</td>\n<td></td>\n</tr>\n<tr>\n<td>layui</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>net core2.1</td>\n<td>1810</td>\n</tr>\n<tr>\n<td>April.WebApi</td>\n<td>7</td>\n</tr>\n</tbody></table>\n<p></p>\n<p>7</p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>.netnet core</p>\n<p></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>ps:</p>\n</blockquote>\n<p><strong></strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>1024<strong>bug</strong> </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>20</p>\n<p>16.net18.net</p>\n<p>C#phpjavapythongodemoworld</p>\n<p>sqlemm==== ==996ICU== </p>\n<p><strong></strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>.net</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>netframework</td>\n<td></td>\n</tr>\n<tr>\n<td>netframeword</td>\n<td></td>\n</tr>\n<tr>\n<td>layui</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>net core2.1</td>\n<td>1810</td>\n</tr>\n<tr>\n<td>April.WebApi</td>\n<td>7</td>\n</tr>\n</tbody></table>\n<p></p>\n<p>7</p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>.netnet core</p>\n<p></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>ps:</p>\n</blockquote>\n<p><strong></strong></p>\n"},{"title":"laravel ","date":"2019-04-12T15:59:59.000Z","_content":"\n\n\n websocket \n\n![](laravel-broadcasting/laravel.jpg)\n<!-- more -->\n\nlaravel \n\n\n#### \n `config/broadcasting.php` \n\n```php\n<?php\n\nreturn [\n\n    /*\n    |--------------------------------------------------------------------------\n    | Default Broadcaster\n    |--------------------------------------------------------------------------\n    |\n    | This option controls the default broadcaster that will be used by the\n    | framework when an event needs to be broadcast. You may set this to\n    | any of the connections defined in the \"connections\" array below.\n    |\n    | Supported: \"pusher\", \"redis\", \"log\", \"null\"\n    |\n    */\n\n    'default' => env('BROADCAST_DRIVER', 'null'),\n\n    /*\n    |--------------------------------------------------------------------------\n    | Broadcast Connections\n    |--------------------------------------------------------------------------\n    |\n    | Here you may define all of the broadcast connections that will be used\n    | to broadcast events to other systems or over websockets. Samples of\n    | each available type of connection are provided inside this array.\n    |\n    */\n\n    'connections' => [\n\n        'pusher' => [\n            'driver' => 'pusher',\n            'key' => env('PUSHER_APP_KEY'),\n            'secret' => env('PUSHER_APP_SECRET'),\n            'app_id' => env('PUSHER_APP_ID'),\n            'options' => [\n                'cluster' => env('PUSHER_APP_CLUSTER'),\n                'encrypted' => true,\n            ],\n        ],\n\n        'redis' => [\n            'driver' => 'redis',\n            'connection' => 'default',\n        ],\n\n        'log' => [\n            'driver' => 'log',\n        ],\n\n        'null' => [\n            'driver' => 'null',\n        ],\n\n    ],\n\n];\n\n```\n\nlaravel \n\n`env`  `log` log  `pusher` \n\n\n\n#### \n `App\\Providers\\BroadcastServiceProvider` `config/app.php`  `providers` \n\n:[ [ pusher ] ](https://dashboard.pusher.com)\n\n `.env` \n\n#### \n```php\ncomposer require pusher/pusher-php-server\nnpm install --save laravel-echo pusher-js\n```\n\n migratecontrollermodelview  router \n\n\n#### \n```php\nphp artisan make:event NewArticleNotificationEvent\n\n// \n<?php\n\nnamespace App\\Events;\n\nuse Illuminate\\Queue\\SerializesModels;\nuse Illuminate\\Broadcasting\\Channel;\nuse Illuminate\\Broadcasting\\PrivateChannel;\nuse Illuminate\\Foundation\\Events\\Dispatchable;\nuse Illuminate\\Broadcasting\\InteractsWithSockets;\nuse Illuminate\\Contracts\\Broadcasting\\ShouldBroadcast;\nuse App\\Article;\n\nclass NewArticleNotificationEvent implements ShouldBroadcast\n{\n    use Dispatchable, InteractsWithSockets, SerializesModels;\n\n    private $article;\n    /**\n     * Create a new event instance.\n     *\n     * @return void\n     */\n    public function __construct(Article $article)\n    {\n        $this->article = $article;\n    }\n\n    public function broadcastWith()\n    {\n        return [\n            'title' => $this->article->title,\n            'content' => $this->article->content,\n            'author' => $this->article->user->name\n        ];\n    }\n\n\n    /**\n     * Get the channels the event should broadcast on.\n     *\n     * @return \\Illuminate\\Broadcasting\\Channel|array\n     */\n    public function broadcastOn()\n    {\n        return new Channel('articles');\n    }\n}\n\n```\n\n#### \n\n```php\n$data = array_merge($request->only(['title', 'content']), ['uid' => Auth::id()]);\n$article = Article::create($data);\nbroadcast(new NewArticleNotificationEvent($article));\n```\n\n#### \n\nvue\n```vue\n<template>\n    <div class=\"container\">\n        <table class=\"table table-striped\">\n            <tr>\n                <th>ID</th>\n                <th>Author</th>\n                <th>Title</th>\n                <th>Content</th>\n                <th>Created At</th>\n            </tr>\n            <tr v-for=\"article in articles\">\n                <td>{{article.id}}</td>\n                <td>{{article.user.name}}</td>\n                <td>{{article.title}}</td>\n                <td>{{article.content}}</td>\n                <td>{{article.created_at}}</td>\n            </tr>\n        </table>\n    </div>\n</template>\n\n<script>\nexport default {\n    props: ['articles'],\n    created() {\n        Echo.channel('articles').listen('NewArticleNotificationEvent', (article) => {\n            console.log(article);\n        })\n    }\n}\n</script>\n\n<style scoped>\n\n</style>\n```\n\n npm run watch-poll \n\n#### \n\n![](laravel-broadcasting/new.png)\n\n![](laravel-broadcasting/mes.png)\n\n#### \n*  channel \n* \n* \n","source":"_posts/laravel-broadcasting.md","raw":"---\ntitle: laravel \ndate: 2019-04-12 23:59:59\ntags: laravel\ncategories: \n---\n\n\n\n websocket \n\n![](laravel-broadcasting/laravel.jpg)\n<!-- more -->\n\nlaravel \n\n\n#### \n `config/broadcasting.php` \n\n```php\n<?php\n\nreturn [\n\n    /*\n    |--------------------------------------------------------------------------\n    | Default Broadcaster\n    |--------------------------------------------------------------------------\n    |\n    | This option controls the default broadcaster that will be used by the\n    | framework when an event needs to be broadcast. You may set this to\n    | any of the connections defined in the \"connections\" array below.\n    |\n    | Supported: \"pusher\", \"redis\", \"log\", \"null\"\n    |\n    */\n\n    'default' => env('BROADCAST_DRIVER', 'null'),\n\n    /*\n    |--------------------------------------------------------------------------\n    | Broadcast Connections\n    |--------------------------------------------------------------------------\n    |\n    | Here you may define all of the broadcast connections that will be used\n    | to broadcast events to other systems or over websockets. Samples of\n    | each available type of connection are provided inside this array.\n    |\n    */\n\n    'connections' => [\n\n        'pusher' => [\n            'driver' => 'pusher',\n            'key' => env('PUSHER_APP_KEY'),\n            'secret' => env('PUSHER_APP_SECRET'),\n            'app_id' => env('PUSHER_APP_ID'),\n            'options' => [\n                'cluster' => env('PUSHER_APP_CLUSTER'),\n                'encrypted' => true,\n            ],\n        ],\n\n        'redis' => [\n            'driver' => 'redis',\n            'connection' => 'default',\n        ],\n\n        'log' => [\n            'driver' => 'log',\n        ],\n\n        'null' => [\n            'driver' => 'null',\n        ],\n\n    ],\n\n];\n\n```\n\nlaravel \n\n`env`  `log` log  `pusher` \n\n\n\n#### \n `App\\Providers\\BroadcastServiceProvider` `config/app.php`  `providers` \n\n:[ [ pusher ] ](https://dashboard.pusher.com)\n\n `.env` \n\n#### \n```php\ncomposer require pusher/pusher-php-server\nnpm install --save laravel-echo pusher-js\n```\n\n migratecontrollermodelview  router \n\n\n#### \n```php\nphp artisan make:event NewArticleNotificationEvent\n\n// \n<?php\n\nnamespace App\\Events;\n\nuse Illuminate\\Queue\\SerializesModels;\nuse Illuminate\\Broadcasting\\Channel;\nuse Illuminate\\Broadcasting\\PrivateChannel;\nuse Illuminate\\Foundation\\Events\\Dispatchable;\nuse Illuminate\\Broadcasting\\InteractsWithSockets;\nuse Illuminate\\Contracts\\Broadcasting\\ShouldBroadcast;\nuse App\\Article;\n\nclass NewArticleNotificationEvent implements ShouldBroadcast\n{\n    use Dispatchable, InteractsWithSockets, SerializesModels;\n\n    private $article;\n    /**\n     * Create a new event instance.\n     *\n     * @return void\n     */\n    public function __construct(Article $article)\n    {\n        $this->article = $article;\n    }\n\n    public function broadcastWith()\n    {\n        return [\n            'title' => $this->article->title,\n            'content' => $this->article->content,\n            'author' => $this->article->user->name\n        ];\n    }\n\n\n    /**\n     * Get the channels the event should broadcast on.\n     *\n     * @return \\Illuminate\\Broadcasting\\Channel|array\n     */\n    public function broadcastOn()\n    {\n        return new Channel('articles');\n    }\n}\n\n```\n\n#### \n\n```php\n$data = array_merge($request->only(['title', 'content']), ['uid' => Auth::id()]);\n$article = Article::create($data);\nbroadcast(new NewArticleNotificationEvent($article));\n```\n\n#### \n\nvue\n```vue\n<template>\n    <div class=\"container\">\n        <table class=\"table table-striped\">\n            <tr>\n                <th>ID</th>\n                <th>Author</th>\n                <th>Title</th>\n                <th>Content</th>\n                <th>Created At</th>\n            </tr>\n            <tr v-for=\"article in articles\">\n                <td>{{article.id}}</td>\n                <td>{{article.user.name}}</td>\n                <td>{{article.title}}</td>\n                <td>{{article.content}}</td>\n                <td>{{article.created_at}}</td>\n            </tr>\n        </table>\n    </div>\n</template>\n\n<script>\nexport default {\n    props: ['articles'],\n    created() {\n        Echo.channel('articles').listen('NewArticleNotificationEvent', (article) => {\n            console.log(article);\n        })\n    }\n}\n</script>\n\n<style scoped>\n\n</style>\n```\n\n npm run watch-poll \n\n#### \n\n![](laravel-broadcasting/new.png)\n\n![](laravel-broadcasting/mes.png)\n\n#### \n*  channel \n* \n* \n","slug":"laravel-broadcasting","published":1,"updated":"2019-09-30T05:50:02.230Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m1n000b9sv7zuidy2sl","content":"<p></p>\n<p> websocket </p>\n<p><img src=\"/2019/04/12/laravel-broadcasting/laravel.jpg\" alt></p>\n<a id=\"more\"></a>\n\n<p>laravel </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> <code>config/broadcasting.php</code> </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">return</span> [</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    |--------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">    | Default Broadcaster</span></span><br><span class=\"line\"><span class=\"comment\">    |--------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">    |</span></span><br><span class=\"line\"><span class=\"comment\">    | This option controls the default broadcaster that will be used by the</span></span><br><span class=\"line\"><span class=\"comment\">    | framework when an event needs to be broadcast. You may set this to</span></span><br><span class=\"line\"><span class=\"comment\">    | any of the connections defined in the \"connections\" array below.</span></span><br><span class=\"line\"><span class=\"comment\">    |</span></span><br><span class=\"line\"><span class=\"comment\">    | Supported: \"pusher\", \"redis\", \"log\", \"null\"</span></span><br><span class=\"line\"><span class=\"comment\">    |</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'default'</span> =&gt; env(<span class=\"string\">'BROADCAST_DRIVER'</span>, <span class=\"string\">'null'</span>),</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    |--------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">    | Broadcast Connections</span></span><br><span class=\"line\"><span class=\"comment\">    |--------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">    |</span></span><br><span class=\"line\"><span class=\"comment\">    | Here you may define all of the broadcast connections that will be used</span></span><br><span class=\"line\"><span class=\"comment\">    | to broadcast events to other systems or over websockets. Samples of</span></span><br><span class=\"line\"><span class=\"comment\">    | each available type of connection are provided inside this array.</span></span><br><span class=\"line\"><span class=\"comment\">    |</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'connections'</span> =&gt; [</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"string\">'pusher'</span> =&gt; [</span><br><span class=\"line\">            <span class=\"string\">'driver'</span> =&gt; <span class=\"string\">'pusher'</span>,</span><br><span class=\"line\">            <span class=\"string\">'key'</span> =&gt; env(<span class=\"string\">'PUSHER_APP_KEY'</span>),</span><br><span class=\"line\">            <span class=\"string\">'secret'</span> =&gt; env(<span class=\"string\">'PUSHER_APP_SECRET'</span>),</span><br><span class=\"line\">            <span class=\"string\">'app_id'</span> =&gt; env(<span class=\"string\">'PUSHER_APP_ID'</span>),</span><br><span class=\"line\">            <span class=\"string\">'options'</span> =&gt; [</span><br><span class=\"line\">                <span class=\"string\">'cluster'</span> =&gt; env(<span class=\"string\">'PUSHER_APP_CLUSTER'</span>),</span><br><span class=\"line\">                <span class=\"string\">'encrypted'</span> =&gt; <span class=\"keyword\">true</span>,</span><br><span class=\"line\">            ],</span><br><span class=\"line\">        ],</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"string\">'redis'</span> =&gt; [</span><br><span class=\"line\">            <span class=\"string\">'driver'</span> =&gt; <span class=\"string\">'redis'</span>,</span><br><span class=\"line\">            <span class=\"string\">'connection'</span> =&gt; <span class=\"string\">'default'</span>,</span><br><span class=\"line\">        ],</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"string\">'log'</span> =&gt; [</span><br><span class=\"line\">            <span class=\"string\">'driver'</span> =&gt; <span class=\"string\">'log'</span>,</span><br><span class=\"line\">        ],</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"string\">'null'</span> =&gt; [</span><br><span class=\"line\">            <span class=\"string\">'driver'</span> =&gt; <span class=\"string\">'null'</span>,</span><br><span class=\"line\">        ],</span><br><span class=\"line\"></span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n\n<p>laravel </p>\n<p><code>env</code>  <code>log</code> log  <code>pusher</code> </p>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> <code>App\\Providers\\BroadcastServiceProvider</code> <code>config/app.php</code>  <code>providers</code> </p>\n<p>:<a href=\"https://dashboard.pusher.com\" target=\"_blank\" rel=\"noopener\"> [ pusher ] </a></p>\n<p> <code>.env</code> </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">composer <span class=\"keyword\">require</span> pusher/pusher-php-server</span><br><span class=\"line\">npm install --save laravel-<span class=\"keyword\">echo</span> pusher-js</span><br></pre></td></tr></table></figure>\n\n<p> migratecontrollermodelview  router </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php artisan make:event NewArticleNotificationEvent</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">App</span>\\<span class=\"title\">Events</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Queue</span>\\<span class=\"title\">SerializesModels</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Broadcasting</span>\\<span class=\"title\">Channel</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Broadcasting</span>\\<span class=\"title\">PrivateChannel</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Foundation</span>\\<span class=\"title\">Events</span>\\<span class=\"title\">Dispatchable</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Broadcasting</span>\\<span class=\"title\">InteractsWithSockets</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Contracts</span>\\<span class=\"title\">Broadcasting</span>\\<span class=\"title\">ShouldBroadcast</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">App</span>\\<span class=\"title\">Article</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NewArticleNotificationEvent</span> <span class=\"keyword\">implements</span> <span class=\"title\">ShouldBroadcast</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">use</span> <span class=\"title\">Dispatchable</span>, <span class=\"title\">InteractsWithSockets</span>, <span class=\"title\">SerializesModels</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> $article;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Create a new event instance.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> void</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span><span class=\"params\">(Article $article)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;article = $article;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">broadcastWith</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> [</span><br><span class=\"line\">            <span class=\"string\">'title'</span> =&gt; <span class=\"keyword\">$this</span>-&gt;article-&gt;title,</span><br><span class=\"line\">            <span class=\"string\">'content'</span> =&gt; <span class=\"keyword\">$this</span>-&gt;article-&gt;content,</span><br><span class=\"line\">            <span class=\"string\">'author'</span> =&gt; <span class=\"keyword\">$this</span>-&gt;article-&gt;user-&gt;name</span><br><span class=\"line\">        ];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Get the channels the event should broadcast on.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> \\Illuminate\\Broadcasting\\Channel|array</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">broadcastOn</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Channel(<span class=\"string\">'articles'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$data = array_merge($request-&gt;only([<span class=\"string\">'title'</span>, <span class=\"string\">'content'</span>]), [<span class=\"string\">'uid'</span> =&gt; Auth::id()]);</span><br><span class=\"line\">$article = Article::create($data);</span><br><span class=\"line\">broadcast(<span class=\"keyword\">new</span> NewArticleNotificationEvent($article));</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>vue</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">    &lt;div class=&quot;container&quot;&gt;</span><br><span class=\"line\">        &lt;table class=&quot;table table-striped&quot;&gt;</span><br><span class=\"line\">            &lt;tr&gt;</span><br><span class=\"line\">                &lt;th&gt;ID&lt;/th&gt;</span><br><span class=\"line\">                &lt;th&gt;Author&lt;/th&gt;</span><br><span class=\"line\">                &lt;th&gt;Title&lt;/th&gt;</span><br><span class=\"line\">                &lt;th&gt;Content&lt;/th&gt;</span><br><span class=\"line\">                &lt;th&gt;Created At&lt;/th&gt;</span><br><span class=\"line\">            &lt;/tr&gt;</span><br><span class=\"line\">            &lt;tr v-for=&quot;article in articles&quot;&gt;</span><br><span class=\"line\">                &lt;td&gt;&#123;&#123;article.id&#125;&#125;&lt;/td&gt;</span><br><span class=\"line\">                &lt;td&gt;&#123;&#123;article.user.name&#125;&#125;&lt;/td&gt;</span><br><span class=\"line\">                &lt;td&gt;&#123;&#123;article.title&#125;&#125;&lt;/td&gt;</span><br><span class=\"line\">                &lt;td&gt;&#123;&#123;article.content&#125;&#125;&lt;/td&gt;</span><br><span class=\"line\">                &lt;td&gt;&#123;&#123;article.created_at&#125;&#125;&lt;/td&gt;</span><br><span class=\"line\">            &lt;/tr&gt;</span><br><span class=\"line\">        &lt;/table&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">export default &#123;</span><br><span class=\"line\">    props: [&apos;articles&apos;],</span><br><span class=\"line\">    created() &#123;</span><br><span class=\"line\">        Echo.channel(&apos;articles&apos;).listen(&apos;NewArticleNotificationEvent&apos;, (article) =&gt; &#123;</span><br><span class=\"line\">            console.log(article);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style scoped&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>\n\n<p> npm run watch-poll </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><br><img src=\"/2019/04/12/laravel-broadcasting/new.png\" alt></p>\n<p><img src=\"/2019/04/12/laravel-broadcasting/mes.png\" alt></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li> channel </li>\n<li></li>\n<li></li>\n</ul>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"<p></p>\n<p> websocket </p>\n<p><img src=\"/2019/04/12/laravel-broadcasting/laravel.jpg\" alt></p>","more":"<p>laravel </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> <code>config/broadcasting.php</code> </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">return</span> [</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    |--------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">    | Default Broadcaster</span></span><br><span class=\"line\"><span class=\"comment\">    |--------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">    |</span></span><br><span class=\"line\"><span class=\"comment\">    | This option controls the default broadcaster that will be used by the</span></span><br><span class=\"line\"><span class=\"comment\">    | framework when an event needs to be broadcast. You may set this to</span></span><br><span class=\"line\"><span class=\"comment\">    | any of the connections defined in the \"connections\" array below.</span></span><br><span class=\"line\"><span class=\"comment\">    |</span></span><br><span class=\"line\"><span class=\"comment\">    | Supported: \"pusher\", \"redis\", \"log\", \"null\"</span></span><br><span class=\"line\"><span class=\"comment\">    |</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'default'</span> =&gt; env(<span class=\"string\">'BROADCAST_DRIVER'</span>, <span class=\"string\">'null'</span>),</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    |--------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">    | Broadcast Connections</span></span><br><span class=\"line\"><span class=\"comment\">    |--------------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">    |</span></span><br><span class=\"line\"><span class=\"comment\">    | Here you may define all of the broadcast connections that will be used</span></span><br><span class=\"line\"><span class=\"comment\">    | to broadcast events to other systems or over websockets. Samples of</span></span><br><span class=\"line\"><span class=\"comment\">    | each available type of connection are provided inside this array.</span></span><br><span class=\"line\"><span class=\"comment\">    |</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'connections'</span> =&gt; [</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"string\">'pusher'</span> =&gt; [</span><br><span class=\"line\">            <span class=\"string\">'driver'</span> =&gt; <span class=\"string\">'pusher'</span>,</span><br><span class=\"line\">            <span class=\"string\">'key'</span> =&gt; env(<span class=\"string\">'PUSHER_APP_KEY'</span>),</span><br><span class=\"line\">            <span class=\"string\">'secret'</span> =&gt; env(<span class=\"string\">'PUSHER_APP_SECRET'</span>),</span><br><span class=\"line\">            <span class=\"string\">'app_id'</span> =&gt; env(<span class=\"string\">'PUSHER_APP_ID'</span>),</span><br><span class=\"line\">            <span class=\"string\">'options'</span> =&gt; [</span><br><span class=\"line\">                <span class=\"string\">'cluster'</span> =&gt; env(<span class=\"string\">'PUSHER_APP_CLUSTER'</span>),</span><br><span class=\"line\">                <span class=\"string\">'encrypted'</span> =&gt; <span class=\"keyword\">true</span>,</span><br><span class=\"line\">            ],</span><br><span class=\"line\">        ],</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"string\">'redis'</span> =&gt; [</span><br><span class=\"line\">            <span class=\"string\">'driver'</span> =&gt; <span class=\"string\">'redis'</span>,</span><br><span class=\"line\">            <span class=\"string\">'connection'</span> =&gt; <span class=\"string\">'default'</span>,</span><br><span class=\"line\">        ],</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"string\">'log'</span> =&gt; [</span><br><span class=\"line\">            <span class=\"string\">'driver'</span> =&gt; <span class=\"string\">'log'</span>,</span><br><span class=\"line\">        ],</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"string\">'null'</span> =&gt; [</span><br><span class=\"line\">            <span class=\"string\">'driver'</span> =&gt; <span class=\"string\">'null'</span>,</span><br><span class=\"line\">        ],</span><br><span class=\"line\"></span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n\n<p>laravel </p>\n<p><code>env</code>  <code>log</code> log  <code>pusher</code> </p>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> <code>App\\Providers\\BroadcastServiceProvider</code> <code>config/app.php</code>  <code>providers</code> </p>\n<p>:<a href=\"https://dashboard.pusher.com\" target=\"_blank\" rel=\"noopener\"> [ pusher ] </a></p>\n<p> <code>.env</code> </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">composer <span class=\"keyword\">require</span> pusher/pusher-php-server</span><br><span class=\"line\">npm install --save laravel-<span class=\"keyword\">echo</span> pusher-js</span><br></pre></td></tr></table></figure>\n\n<p> migratecontrollermodelview  router </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php artisan make:event NewArticleNotificationEvent</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">App</span>\\<span class=\"title\">Events</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Queue</span>\\<span class=\"title\">SerializesModels</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Broadcasting</span>\\<span class=\"title\">Channel</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Broadcasting</span>\\<span class=\"title\">PrivateChannel</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Foundation</span>\\<span class=\"title\">Events</span>\\<span class=\"title\">Dispatchable</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Broadcasting</span>\\<span class=\"title\">InteractsWithSockets</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Contracts</span>\\<span class=\"title\">Broadcasting</span>\\<span class=\"title\">ShouldBroadcast</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">App</span>\\<span class=\"title\">Article</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NewArticleNotificationEvent</span> <span class=\"keyword\">implements</span> <span class=\"title\">ShouldBroadcast</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">use</span> <span class=\"title\">Dispatchable</span>, <span class=\"title\">InteractsWithSockets</span>, <span class=\"title\">SerializesModels</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> $article;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Create a new event instance.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> void</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span><span class=\"params\">(Article $article)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;article = $article;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">broadcastWith</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> [</span><br><span class=\"line\">            <span class=\"string\">'title'</span> =&gt; <span class=\"keyword\">$this</span>-&gt;article-&gt;title,</span><br><span class=\"line\">            <span class=\"string\">'content'</span> =&gt; <span class=\"keyword\">$this</span>-&gt;article-&gt;content,</span><br><span class=\"line\">            <span class=\"string\">'author'</span> =&gt; <span class=\"keyword\">$this</span>-&gt;article-&gt;user-&gt;name</span><br><span class=\"line\">        ];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Get the channels the event should broadcast on.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> \\Illuminate\\Broadcasting\\Channel|array</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">broadcastOn</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Channel(<span class=\"string\">'articles'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$data = array_merge($request-&gt;only([<span class=\"string\">'title'</span>, <span class=\"string\">'content'</span>]), [<span class=\"string\">'uid'</span> =&gt; Auth::id()]);</span><br><span class=\"line\">$article = Article::create($data);</span><br><span class=\"line\">broadcast(<span class=\"keyword\">new</span> NewArticleNotificationEvent($article));</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>vue</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">    &lt;div class=&quot;container&quot;&gt;</span><br><span class=\"line\">        &lt;table class=&quot;table table-striped&quot;&gt;</span><br><span class=\"line\">            &lt;tr&gt;</span><br><span class=\"line\">                &lt;th&gt;ID&lt;/th&gt;</span><br><span class=\"line\">                &lt;th&gt;Author&lt;/th&gt;</span><br><span class=\"line\">                &lt;th&gt;Title&lt;/th&gt;</span><br><span class=\"line\">                &lt;th&gt;Content&lt;/th&gt;</span><br><span class=\"line\">                &lt;th&gt;Created At&lt;/th&gt;</span><br><span class=\"line\">            &lt;/tr&gt;</span><br><span class=\"line\">            &lt;tr v-for=&quot;article in articles&quot;&gt;</span><br><span class=\"line\">                &lt;td&gt;&#123;&#123;article.id&#125;&#125;&lt;/td&gt;</span><br><span class=\"line\">                &lt;td&gt;&#123;&#123;article.user.name&#125;&#125;&lt;/td&gt;</span><br><span class=\"line\">                &lt;td&gt;&#123;&#123;article.title&#125;&#125;&lt;/td&gt;</span><br><span class=\"line\">                &lt;td&gt;&#123;&#123;article.content&#125;&#125;&lt;/td&gt;</span><br><span class=\"line\">                &lt;td&gt;&#123;&#123;article.created_at&#125;&#125;&lt;/td&gt;</span><br><span class=\"line\">            &lt;/tr&gt;</span><br><span class=\"line\">        &lt;/table&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">export default &#123;</span><br><span class=\"line\">    props: [&apos;articles&apos;],</span><br><span class=\"line\">    created() &#123;</span><br><span class=\"line\">        Echo.channel(&apos;articles&apos;).listen(&apos;NewArticleNotificationEvent&apos;, (article) =&gt; &#123;</span><br><span class=\"line\">            console.log(article);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style scoped&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>\n\n<p> npm run watch-poll </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><br><img src=\"/2019/04/12/laravel-broadcasting/new.png\" alt></p>\n<p><img src=\"/2019/04/12/laravel-broadcasting/mes.png\" alt></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li> channel </li>\n<li></li>\n<li></li>\n</ul>"},{"title":"laravel ","date":"2019-04-03T15:00:00.000Z","_content":"\n laravel \n![](laravel-events/laravel.jpg)\n<!-- more -->\n\nLaravel \n\n\n\n####  && \n\n app\\Providers\\EventServiceProvider.php \n```php\nprotected $listen = [\n    Registered::class => [\n        SendEmailVerificationNotification::class,\n    ],\n    'App\\Events\\LoginEvent' => [\n        'App\\Listeners\\LoginListener'\n    ]\n];\n```\n\n\n\n```php\nphp artisan event:generate\n```\n\n\n![](laravel-events/new-event.png)\n\n log info('user login event')\n\n\n\n`event(new LoginEvent());`\n\n log \n\n>[2019-03-27 08:16:21] local.INFO: user login event\n\n larave \n\n#### \n Laravel   \n EventServiceProvider \n[](https://laravel.com/docs/5.8/authentication#events)\n\n```php\n/**\n * \n *\n * @var array\n */\nprotected $listen = [\n    'Illuminate\\Auth\\Events\\Registered' => [\n        'App\\Listeners\\LogRegisteredUser',\n    ],\n\n    'Illuminate\\Auth\\Events\\Attempting' => [\n        'App\\Listeners\\LogAuthenticationAttempt',\n    ],\n\n    'Illuminate\\Auth\\Events\\Authenticated' => [\n        'App\\Listeners\\LogAuthenticated',\n    ],\n\n    'Illuminate\\Auth\\Events\\Login' => [\n        'App\\Listeners\\LogSuccessfulLogin',\n    ],\n\n    'Illuminate\\Auth\\Events\\Failed' => [\n        'App\\Listeners\\LogFailedLogin',\n    ],\n\n    'Illuminate\\Auth\\Events\\Logout' => [\n        'App\\Listeners\\LogSuccessfulLogout',\n    ],\n\n    'Illuminate\\Auth\\Events\\Lockout' => [\n        'App\\Listeners\\LogLockout',\n    ],\n\n    'Illuminate\\Auth\\Events\\PasswordReset' => [\n        'App\\Listeners\\LogPasswordReset',\n    ],\n];\n```\n\n\n EventServiceProvider\n\n```php\n'Illuminate\\Auth\\Events\\Login' => [\n    'App\\Listeners\\LoginListener'\n]\n```\n\n listener\n```php\npublic function handle($guard) {\n    info('user login event', ['username'=>$guard->user->name]);\n    dd($guard);\n}\n```\n\n#### \n\n![](laravel-events/out.png)\n\n\n```php\npublic function handle($guard) {\n    $log = [\n        'name' => $guard->user->name,\n        'email'=> $guard->user->email,\n        'ip'=> \\Request::getClientIp(true),\n        'datetime' => Carbon::now()\n    ];\n    info('user login event', $log);\n}\n```\n\n log  mysql \n\n","source":"_posts/laravel-events.md","raw":"---\ntitle: laravel \ndate: 2019-04-03 23:00:00\ntags: laravel\ncategories: \n---\n\n laravel \n![](laravel-events/laravel.jpg)\n<!-- more -->\n\nLaravel \n\n\n\n####  && \n\n app\\Providers\\EventServiceProvider.php \n```php\nprotected $listen = [\n    Registered::class => [\n        SendEmailVerificationNotification::class,\n    ],\n    'App\\Events\\LoginEvent' => [\n        'App\\Listeners\\LoginListener'\n    ]\n];\n```\n\n\n\n```php\nphp artisan event:generate\n```\n\n\n![](laravel-events/new-event.png)\n\n log info('user login event')\n\n\n\n`event(new LoginEvent());`\n\n log \n\n>[2019-03-27 08:16:21] local.INFO: user login event\n\n larave \n\n#### \n Laravel   \n EventServiceProvider \n[](https://laravel.com/docs/5.8/authentication#events)\n\n```php\n/**\n * \n *\n * @var array\n */\nprotected $listen = [\n    'Illuminate\\Auth\\Events\\Registered' => [\n        'App\\Listeners\\LogRegisteredUser',\n    ],\n\n    'Illuminate\\Auth\\Events\\Attempting' => [\n        'App\\Listeners\\LogAuthenticationAttempt',\n    ],\n\n    'Illuminate\\Auth\\Events\\Authenticated' => [\n        'App\\Listeners\\LogAuthenticated',\n    ],\n\n    'Illuminate\\Auth\\Events\\Login' => [\n        'App\\Listeners\\LogSuccessfulLogin',\n    ],\n\n    'Illuminate\\Auth\\Events\\Failed' => [\n        'App\\Listeners\\LogFailedLogin',\n    ],\n\n    'Illuminate\\Auth\\Events\\Logout' => [\n        'App\\Listeners\\LogSuccessfulLogout',\n    ],\n\n    'Illuminate\\Auth\\Events\\Lockout' => [\n        'App\\Listeners\\LogLockout',\n    ],\n\n    'Illuminate\\Auth\\Events\\PasswordReset' => [\n        'App\\Listeners\\LogPasswordReset',\n    ],\n];\n```\n\n\n EventServiceProvider\n\n```php\n'Illuminate\\Auth\\Events\\Login' => [\n    'App\\Listeners\\LoginListener'\n]\n```\n\n listener\n```php\npublic function handle($guard) {\n    info('user login event', ['username'=>$guard->user->name]);\n    dd($guard);\n}\n```\n\n#### \n\n![](laravel-events/out.png)\n\n\n```php\npublic function handle($guard) {\n    $log = [\n        'name' => $guard->user->name,\n        'email'=> $guard->user->email,\n        'ip'=> \\Request::getClientIp(true),\n        'datetime' => Carbon::now()\n    ];\n    info('user login event', $log);\n}\n```\n\n log  mysql \n\n","slug":"laravel-events","published":1,"updated":"2019-09-30T05:50:46.249Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m1r000d9sv78xzcivyf","content":"<p> laravel <br><img src=\"/2019/04/03/laravel-events/laravel.jpg\" alt></p>\n<a id=\"more\"></a>\n\n<p>Laravel </p>\n<p></p>\n<h4 id=\"-amp-amp-\"><a href=\"#-amp-amp-\" class=\"headerlink\" title=\" &amp;&amp; \"></a> &amp;&amp; </h4><p> app\\Providers\\EventServiceProvider.php </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">protected</span> $listen = [</span><br><span class=\"line\">    Registered::class =&gt; [</span><br><span class=\"line\">        SendEmailVerificationNotification::class,</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"string\">'App\\Events\\LoginEvent'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LoginListener'</span></span><br><span class=\"line\">    ]</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php artisan event:generate</span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/2019/04/03/laravel-events/new-event.png\" alt></p>\n<p> log info(user login event)</p>\n<p></p>\n<p><code>event(new LoginEvent());</code></p>\n<p> log </p>\n<blockquote>\n<p>[2019-03-27 08:16:21] local.INFO: user login event</p>\n</blockquote>\n<p> larave </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> Laravel  <br> EventServiceProvider <br><a href=\"https://laravel.com/docs/5.8/authentication#events\" target=\"_blank\" rel=\"noopener\"></a></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@var</span> array</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">protected</span> $listen = [</span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\Registered'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogRegisteredUser'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\Attempting'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogAuthenticationAttempt'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\Authenticated'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogAuthenticated'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\Login'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogSuccessfulLogin'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\Failed'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogFailedLogin'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\Logout'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogSuccessfulLogout'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\Lockout'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogLockout'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\PasswordReset'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogPasswordReset'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n\n<p><br> EventServiceProvider</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">'Illuminate\\Auth\\Events\\Login'</span> =&gt; [</span><br><span class=\"line\">    <span class=\"string\">'App\\Listeners\\LoginListener'</span></span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n\n<p> listener</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">handle</span><span class=\"params\">($guard)</span> </span>&#123;</span><br><span class=\"line\">    info(<span class=\"string\">'user login event'</span>, [<span class=\"string\">'username'</span>=&gt;$guard-&gt;user-&gt;name]);</span><br><span class=\"line\">    dd($guard);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><br><img src=\"/2019/04/03/laravel-events/out.png\" alt=\"\"></p>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">handle</span><span class=\"params\">($guard)</span> </span>&#123;</span><br><span class=\"line\">    $log = [</span><br><span class=\"line\">        <span class=\"string\">'name'</span> =&gt; $guard-&gt;user-&gt;name,</span><br><span class=\"line\">        <span class=\"string\">'email'</span>=&gt; $guard-&gt;user-&gt;email,</span><br><span class=\"line\">        <span class=\"string\">'ip'</span>=&gt; \\Request::getClientIp(<span class=\"keyword\">true</span>),</span><br><span class=\"line\">        <span class=\"string\">'datetime'</span> =&gt; Carbon::now()</span><br><span class=\"line\">    ];</span><br><span class=\"line\">    info(<span class=\"string\">'user login event'</span>, $log);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> log  mysql </p>\n<p></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"<p> laravel <br><img src=\"/2019/04/03/laravel-events/laravel.jpg\" alt></p>","more":"<p>Laravel </p>\n<p></p>\n<h4 id=\"-amp-amp-\"><a href=\"#-amp-amp-\" class=\"headerlink\" title=\" &amp;&amp; \"></a> &amp;&amp; </h4><p> app\\Providers\\EventServiceProvider.php </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">protected</span> $listen = [</span><br><span class=\"line\">    Registered::class =&gt; [</span><br><span class=\"line\">        SendEmailVerificationNotification::class,</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"string\">'App\\Events\\LoginEvent'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LoginListener'</span></span><br><span class=\"line\">    ]</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php artisan event:generate</span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/2019/04/03/laravel-events/new-event.png\" alt></p>\n<p> log info(user login event)</p>\n<p></p>\n<p><code>event(new LoginEvent());</code></p>\n<p> log </p>\n<blockquote>\n<p>[2019-03-27 08:16:21] local.INFO: user login event</p>\n</blockquote>\n<p> larave </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> Laravel  <br> EventServiceProvider <br><a href=\"https://laravel.com/docs/5.8/authentication#events\" target=\"_blank\" rel=\"noopener\"></a></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@var</span> array</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">protected</span> $listen = [</span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\Registered'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogRegisteredUser'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\Attempting'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogAuthenticationAttempt'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\Authenticated'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogAuthenticated'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\Login'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogSuccessfulLogin'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\Failed'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogFailedLogin'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\Logout'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogSuccessfulLogout'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\Lockout'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogLockout'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">'Illuminate\\Auth\\Events\\PasswordReset'</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">'App\\Listeners\\LogPasswordReset'</span>,</span><br><span class=\"line\">    ],</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n\n<p><br> EventServiceProvider</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">'Illuminate\\Auth\\Events\\Login'</span> =&gt; [</span><br><span class=\"line\">    <span class=\"string\">'App\\Listeners\\LoginListener'</span></span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n\n<p> listener</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">handle</span><span class=\"params\">($guard)</span> </span>&#123;</span><br><span class=\"line\">    info(<span class=\"string\">'user login event'</span>, [<span class=\"string\">'username'</span>=&gt;$guard-&gt;user-&gt;name]);</span><br><span class=\"line\">    dd($guard);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><br><img src=\"/2019/04/03/laravel-events/out.png\" alt=\"\"></p>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">handle</span><span class=\"params\">($guard)</span> </span>&#123;</span><br><span class=\"line\">    $log = [</span><br><span class=\"line\">        <span class=\"string\">'name'</span> =&gt; $guard-&gt;user-&gt;name,</span><br><span class=\"line\">        <span class=\"string\">'email'</span>=&gt; $guard-&gt;user-&gt;email,</span><br><span class=\"line\">        <span class=\"string\">'ip'</span>=&gt; \\Request::getClientIp(<span class=\"keyword\">true</span>),</span><br><span class=\"line\">        <span class=\"string\">'datetime'</span> =&gt; Carbon::now()</span><br><span class=\"line\">    ];</span><br><span class=\"line\">    info(<span class=\"string\">'user login event'</span>, $log);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> log  mysql </p>\n<p></p>"},{"title":" laradock  laravel-swoole  laravel ","date":"2019-08-23T01:20:00.000Z","_content":"\n laradock  laravel-swoole  laravel \n![](laravel-swoole-in-laradock/laradock.png)\n<!-- more -->\n\n#### laravel-swoole\n```\ncomposer require swooletw/laravel-swoole\nphp artisan vendor:publish --tag=laravel-swoole\n```\n\n####  workspace \n `laradock/workspace/Dockerfile` \n```\nEXPOSE 1215\n```\n\n build workspace \n\n\n####  nginx \n```\nupstream swoole-http {\n    server workspace:1215;\n}\n\nmap $http_upgrade $connection_upgrade {\n    default upgrade;\n    ''      close;\n}\n\nserver {\n\n    listen 80;\n    listen [::]:80;\n\n    # For https\n    # listen 443 ssl;\n    # listen [::]:443 ssl ipv6only=on;\n    # ssl_certificate /etc/nginx/ssl/default.crt;\n    # ssl_certificate_key /etc/nginx/ssl/default.key;\n\n\n    server_name study.test;\n    root /var/www/laravel-learn/public;\n    index index.php index.html index.htm;\n\n    location = /index.php {\n            # Ensure that there is no such file named \"not_exists\"\n            # in your \"public\" directory.\n            try_files /not_exists @swoole;\n    }\n\n    location / {\n        try_files $uri $uri/ @swoole;\n    }\n\n    location @swoole {\n        set $suffix \"\";\n\n        if ($uri = /index.php) {\n            set $suffix \"/\";\n        }\n        proxy_set_header Host $http_host;\n        proxy_set_header Scheme $scheme;\n        proxy_set_header SERVER_PORT $server_port;\n        proxy_set_header REMOTE_ADDR $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection $connection_upgrade;\n\n        # IF https\n        # proxy_set_header HTTPS \"on\";\n\n        charset utf-8;\n\n        proxy_pass http://swoole-http$suffix;\n    }\n}\n```\n\n nginx\n\n####  laravel env\n```\nSWOOLE_HTTP_HOST=workspace\nSWOOLE_HTTP_DAEMONIZE=true\nSWOOLE_HOT_RELOAD_ENABLE=true\n```\n\n####  swoole\n```\nphp artisan swoole:http start | stop | restart | resload\n```\n\n# \n swoole_http  `max_request = 1`\n","source":"_posts/laravel-swoole-in-laradock.md","raw":"---\ntitle:  laradock  laravel-swoole  laravel \ndate: 2019-08-23 09:20:00\ntags: [laravel, swoole, docker]\ncategories: \n---\n\n laradock  laravel-swoole  laravel \n![](laravel-swoole-in-laradock/laradock.png)\n<!-- more -->\n\n#### laravel-swoole\n```\ncomposer require swooletw/laravel-swoole\nphp artisan vendor:publish --tag=laravel-swoole\n```\n\n####  workspace \n `laradock/workspace/Dockerfile` \n```\nEXPOSE 1215\n```\n\n build workspace \n\n\n####  nginx \n```\nupstream swoole-http {\n    server workspace:1215;\n}\n\nmap $http_upgrade $connection_upgrade {\n    default upgrade;\n    ''      close;\n}\n\nserver {\n\n    listen 80;\n    listen [::]:80;\n\n    # For https\n    # listen 443 ssl;\n    # listen [::]:443 ssl ipv6only=on;\n    # ssl_certificate /etc/nginx/ssl/default.crt;\n    # ssl_certificate_key /etc/nginx/ssl/default.key;\n\n\n    server_name study.test;\n    root /var/www/laravel-learn/public;\n    index index.php index.html index.htm;\n\n    location = /index.php {\n            # Ensure that there is no such file named \"not_exists\"\n            # in your \"public\" directory.\n            try_files /not_exists @swoole;\n    }\n\n    location / {\n        try_files $uri $uri/ @swoole;\n    }\n\n    location @swoole {\n        set $suffix \"\";\n\n        if ($uri = /index.php) {\n            set $suffix \"/\";\n        }\n        proxy_set_header Host $http_host;\n        proxy_set_header Scheme $scheme;\n        proxy_set_header SERVER_PORT $server_port;\n        proxy_set_header REMOTE_ADDR $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection $connection_upgrade;\n\n        # IF https\n        # proxy_set_header HTTPS \"on\";\n\n        charset utf-8;\n\n        proxy_pass http://swoole-http$suffix;\n    }\n}\n```\n\n nginx\n\n####  laravel env\n```\nSWOOLE_HTTP_HOST=workspace\nSWOOLE_HTTP_DAEMONIZE=true\nSWOOLE_HOT_RELOAD_ENABLE=true\n```\n\n####  swoole\n```\nphp artisan swoole:http start | stop | restart | resload\n```\n\n# \n swoole_http  `max_request = 1`\n","slug":"laravel-swoole-in-laradock","published":1,"updated":"2019-09-30T05:50:53.805Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m1w000g9sv7gp6wsup7","content":"<p> laradock  laravel-swoole  laravel <br><img src=\"/2019/08/23/laravel-swoole-in-laradock/laradock.png\" alt></p>\n<a id=\"more\"></a>\n\n<h4 id=\"laravel-swoole\"><a href=\"#laravel-swoole\" class=\"headerlink\" title=\"laravel-swoole\"></a>laravel-swoole</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">composer require swooletw/laravel-swoole</span><br><span class=\"line\">php artisan vendor:publish --tag=laravel-swoole</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-workspace-\"><a href=\"#-workspace-\" class=\"headerlink\" title=\" workspace \"></a> workspace </h4><p> <code>laradock/workspace/Dockerfile</code> </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EXPOSE 1215</span><br></pre></td></tr></table></figure>\n\n<p> build workspace </p>\n<h4 id=\"-nginx-\"><a href=\"#-nginx-\" class=\"headerlink\" title=\" nginx \"></a> nginx </h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream swoole-http &#123;</span><br><span class=\"line\">    server workspace:1215;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">map $http_upgrade $connection_upgrade &#123;</span><br><span class=\"line\">    default upgrade;</span><br><span class=\"line\">    &apos;&apos;      close;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    listen [::]:80;</span><br><span class=\"line\"></span><br><span class=\"line\">    # For https</span><br><span class=\"line\">    # listen 443 ssl;</span><br><span class=\"line\">    # listen [::]:443 ssl ipv6only=on;</span><br><span class=\"line\">    # ssl_certificate /etc/nginx/ssl/default.crt;</span><br><span class=\"line\">    # ssl_certificate_key /etc/nginx/ssl/default.key;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    server_name study.test;</span><br><span class=\"line\">    root /var/www/laravel-learn/public;</span><br><span class=\"line\">    index index.php index.html index.htm;</span><br><span class=\"line\"></span><br><span class=\"line\">    location = /index.php &#123;</span><br><span class=\"line\">            # Ensure that there is no such file named &quot;not_exists&quot;</span><br><span class=\"line\">            # in your &quot;public&quot; directory.</span><br><span class=\"line\">            try_files /not_exists @swoole;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        try_files $uri $uri/ @swoole;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location @swoole &#123;</span><br><span class=\"line\">        set $suffix &quot;&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">        if ($uri = /index.php) &#123;</span><br><span class=\"line\">            set $suffix &quot;/&quot;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        proxy_set_header Host $http_host;</span><br><span class=\"line\">        proxy_set_header Scheme $scheme;</span><br><span class=\"line\">        proxy_set_header SERVER_PORT $server_port;</span><br><span class=\"line\">        proxy_set_header REMOTE_ADDR $remote_addr;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">        proxy_set_header Upgrade $http_upgrade;</span><br><span class=\"line\">        proxy_set_header Connection $connection_upgrade;</span><br><span class=\"line\"></span><br><span class=\"line\">        # IF https</span><br><span class=\"line\">        # proxy_set_header HTTPS &quot;on&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">        charset utf-8;</span><br><span class=\"line\"></span><br><span class=\"line\">        proxy_pass http://swoole-http$suffix;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> nginx</p>\n<h4 id=\"-laravel-env\"><a href=\"#-laravel-env\" class=\"headerlink\" title=\" laravel env\"></a> laravel env</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SWOOLE_HTTP_HOST=workspace</span><br><span class=\"line\">SWOOLE_HTTP_DAEMONIZE=true</span><br><span class=\"line\">SWOOLE_HOT_RELOAD_ENABLE=true</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-swoole\"><a href=\"#-swoole\" class=\"headerlink\" title=\" swoole\"></a> swoole</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php artisan swoole:http start | stop | restart | resload</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> swoole_http  <code>max_request = 1</code></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"<p> laradock  laravel-swoole  laravel <br><img src=\"/2019/08/23/laravel-swoole-in-laradock/laradock.png\" alt></p>","more":"<h4 id=\"laravel-swoole\"><a href=\"#laravel-swoole\" class=\"headerlink\" title=\"laravel-swoole\"></a>laravel-swoole</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">composer require swooletw/laravel-swoole</span><br><span class=\"line\">php artisan vendor:publish --tag=laravel-swoole</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-workspace-\"><a href=\"#-workspace-\" class=\"headerlink\" title=\" workspace \"></a> workspace </h4><p> <code>laradock/workspace/Dockerfile</code> </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EXPOSE 1215</span><br></pre></td></tr></table></figure>\n\n<p> build workspace </p>\n<h4 id=\"-nginx-\"><a href=\"#-nginx-\" class=\"headerlink\" title=\" nginx \"></a> nginx </h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream swoole-http &#123;</span><br><span class=\"line\">    server workspace:1215;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">map $http_upgrade $connection_upgrade &#123;</span><br><span class=\"line\">    default upgrade;</span><br><span class=\"line\">    &apos;&apos;      close;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    listen [::]:80;</span><br><span class=\"line\"></span><br><span class=\"line\">    # For https</span><br><span class=\"line\">    # listen 443 ssl;</span><br><span class=\"line\">    # listen [::]:443 ssl ipv6only=on;</span><br><span class=\"line\">    # ssl_certificate /etc/nginx/ssl/default.crt;</span><br><span class=\"line\">    # ssl_certificate_key /etc/nginx/ssl/default.key;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    server_name study.test;</span><br><span class=\"line\">    root /var/www/laravel-learn/public;</span><br><span class=\"line\">    index index.php index.html index.htm;</span><br><span class=\"line\"></span><br><span class=\"line\">    location = /index.php &#123;</span><br><span class=\"line\">            # Ensure that there is no such file named &quot;not_exists&quot;</span><br><span class=\"line\">            # in your &quot;public&quot; directory.</span><br><span class=\"line\">            try_files /not_exists @swoole;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        try_files $uri $uri/ @swoole;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location @swoole &#123;</span><br><span class=\"line\">        set $suffix &quot;&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">        if ($uri = /index.php) &#123;</span><br><span class=\"line\">            set $suffix &quot;/&quot;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        proxy_set_header Host $http_host;</span><br><span class=\"line\">        proxy_set_header Scheme $scheme;</span><br><span class=\"line\">        proxy_set_header SERVER_PORT $server_port;</span><br><span class=\"line\">        proxy_set_header REMOTE_ADDR $remote_addr;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">        proxy_set_header Upgrade $http_upgrade;</span><br><span class=\"line\">        proxy_set_header Connection $connection_upgrade;</span><br><span class=\"line\"></span><br><span class=\"line\">        # IF https</span><br><span class=\"line\">        # proxy_set_header HTTPS &quot;on&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">        charset utf-8;</span><br><span class=\"line\"></span><br><span class=\"line\">        proxy_pass http://swoole-http$suffix;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> nginx</p>\n<h4 id=\"-laravel-env\"><a href=\"#-laravel-env\" class=\"headerlink\" title=\" laravel env\"></a> laravel env</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SWOOLE_HTTP_HOST=workspace</span><br><span class=\"line\">SWOOLE_HTTP_DAEMONIZE=true</span><br><span class=\"line\">SWOOLE_HOT_RELOAD_ENABLE=true</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-swoole\"><a href=\"#-swoole\" class=\"headerlink\" title=\" swoole\"></a> swoole</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php artisan swoole:http start | stop | restart | resload</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> swoole_http  <code>max_request = 1</code></p>"},{"title":"Hello World","date":"2018-02-13T10:44:28.000Z","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n\n```csharp\npublic void SanHa()\n{\n    private int id;\n    private string name;\n}\n```","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\ndate: 2018-02-13 18:44:28\ntags: test\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n\n```csharp\npublic void SanHa()\n{\n    private int id;\n    private string name;\n}\n```","slug":"hello-world","published":1,"updated":"2019-08-30T06:32:42.442Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m20000h9sv7axlp8zjo","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">SanHa</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> name;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">SanHa</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> name;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":" laravel mix ","date":"2019-03-15T15:00:00.000Z","_content":"\n laravel  laravel mix \n\n![](laravel-mix/laravel-mix.png)\n<!-- more -->\n\n#### \n laradock laradock\n\nworkspace  node package.json  webpack.mix.js laravel \n```bash\nnpm install\n```\n\n webpack.mix.js \n```javascript\nmix.js('resources/js/app.js', 'public/js')\n   .sass('resources/sass/app.scss', 'public/css');\n```\n\n\n\n sass \n\n\n```javascript\nmix.less('resources/assets/less/app.less', 'public/stylesheets/styles.css');\n\nmix.styles([\n    'public/css/vendor/normalize.css',\n    'public/css/vendor/videojs.css'\n], 'public/css/all.css');\n```\n\n#### \n```bash\nnpm run dev\nnpm run watch\n```\n mix \n\n#### \n laravel  mix  [[ learnku ]](https://learnku.com/docs/laravel-mix/4.0)\n\n","source":"_posts/laravel-mix.md","raw":"---\ntitle:  laravel mix \ndate: 2019-03-15 23:00:00\ntags: laravel\ncategories: \n---\n\n laravel  laravel mix \n\n![](laravel-mix/laravel-mix.png)\n<!-- more -->\n\n#### \n laradock laradock\n\nworkspace  node package.json  webpack.mix.js laravel \n```bash\nnpm install\n```\n\n webpack.mix.js \n```javascript\nmix.js('resources/js/app.js', 'public/js')\n   .sass('resources/sass/app.scss', 'public/css');\n```\n\n\n\n sass \n\n\n```javascript\nmix.less('resources/assets/less/app.less', 'public/stylesheets/styles.css');\n\nmix.styles([\n    'public/css/vendor/normalize.css',\n    'public/css/vendor/videojs.css'\n], 'public/css/all.css');\n```\n\n#### \n```bash\nnpm run dev\nnpm run watch\n```\n mix \n\n#### \n laravel  mix  [[ learnku ]](https://learnku.com/docs/laravel-mix/4.0)\n\n","slug":"laravel-mix","published":1,"updated":"2019-09-30T05:50:48.652Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m22000i9sv7hiueiqcs","content":"<p> laravel  laravel mix </p>\n<p><img src=\"/2019/03/15/laravel-mix/laravel-mix.png\" alt></p>\n<a id=\"more\"></a>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> laradock laradock</p>\n<p>workspace  node package.json  webpack.mix.js laravel </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install</span><br></pre></td></tr></table></figure>\n\n<p> webpack.mix.js </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mix.js(<span class=\"string\">'resources/js/app.js'</span>, <span class=\"string\">'public/js'</span>)</span><br><span class=\"line\">   .sass(<span class=\"string\">'resources/sass/app.scss'</span>, <span class=\"string\">'public/css'</span>);</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p> sass </p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mix.less(<span class=\"string\">'resources/assets/less/app.less'</span>, <span class=\"string\">'public/stylesheets/styles.css'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">mix.styles([</span><br><span class=\"line\">    <span class=\"string\">'public/css/vendor/normalize.css'</span>,</span><br><span class=\"line\">    <span class=\"string\">'public/css/vendor/videojs.css'</span></span><br><span class=\"line\">], <span class=\"string\">'public/css/all.css'</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm run dev</span><br><span class=\"line\">npm run watch</span><br></pre></td></tr></table></figure>\n\n<p> mix </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> laravel  mix  <a href=\"https://learnku.com/docs/laravel-mix/4.0\" target=\"_blank\" rel=\"noopener\">[ learnku ]</a></p>\n<p></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"<p> laravel  laravel mix </p>\n<p><img src=\"/2019/03/15/laravel-mix/laravel-mix.png\" alt></p>","more":"<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> laradock laradock</p>\n<p>workspace  node package.json  webpack.mix.js laravel </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install</span><br></pre></td></tr></table></figure>\n\n<p> webpack.mix.js </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mix.js(<span class=\"string\">'resources/js/app.js'</span>, <span class=\"string\">'public/js'</span>)</span><br><span class=\"line\">   .sass(<span class=\"string\">'resources/sass/app.scss'</span>, <span class=\"string\">'public/css'</span>);</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p> sass </p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mix.less(<span class=\"string\">'resources/assets/less/app.less'</span>, <span class=\"string\">'public/stylesheets/styles.css'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">mix.styles([</span><br><span class=\"line\">    <span class=\"string\">'public/css/vendor/normalize.css'</span>,</span><br><span class=\"line\">    <span class=\"string\">'public/css/vendor/videojs.css'</span></span><br><span class=\"line\">], <span class=\"string\">'public/css/all.css'</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm run dev</span><br><span class=\"line\">npm run watch</span><br></pre></td></tr></table></figure>\n\n<p> mix </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> laravel  mix  <a href=\"https://learnku.com/docs/laravel-mix/4.0\" target=\"_blank\" rel=\"noopener\">[ learnku ]</a></p>\n<p></p>"},{"title":" laravel vue  svg ","date":"2019-10-28T13:21:59.000Z","_content":"\n#### \n```\nnpm install laravel-mix-svg-vue\nor\nyarn add laravel-mix-svg-vue\n```\n\n####  webpack.mix.js \n```\nconst mix = require('laravel-mix');\nrequire('laravel-mix-svg-vue');\n\nmix.js('resources/js/app.js', 'public/js')\n    .svgVue();\n```\n\n####  app.js \n```\nimport Vue from 'vue';\nimport SvgVue from 'svg-vue';\n\nVue.use(SvgVue);\n```\n\n#### svg \n```\n<svg-vue icon=\"avatar\"></svg-vue>\n```\n\n#### \n```\n{\n    svgPath: 'resources/svg',\n    extract: false,\n    svgoSettings: [\n        { removeTitle: true },\n        { removeViewBox: false },\n        { removeDimensions: true }\n    ]\n}\n```\n\n\n |  | | \n----  | ----    | -----   | ----\nsvgPath | String | resources/svg | svg \nextract | Boolean | false |   svg \nsvgoSettings | Array | [{ removeTitle: true }, { removeViewBox: false }, { removeDimensions: true }] | svgo \n\n#### \n svg \n","source":"_posts/laravel-vue-svg.md","raw":"---\ntitle:  laravel vue  svg \ndate: 2019-10-28 21:21:59\ntags: laravel\ncategories: \n---\n\n#### \n```\nnpm install laravel-mix-svg-vue\nor\nyarn add laravel-mix-svg-vue\n```\n\n####  webpack.mix.js \n```\nconst mix = require('laravel-mix');\nrequire('laravel-mix-svg-vue');\n\nmix.js('resources/js/app.js', 'public/js')\n    .svgVue();\n```\n\n####  app.js \n```\nimport Vue from 'vue';\nimport SvgVue from 'svg-vue';\n\nVue.use(SvgVue);\n```\n\n#### svg \n```\n<svg-vue icon=\"avatar\"></svg-vue>\n```\n\n#### \n```\n{\n    svgPath: 'resources/svg',\n    extract: false,\n    svgoSettings: [\n        { removeTitle: true },\n        { removeViewBox: false },\n        { removeDimensions: true }\n    ]\n}\n```\n\n\n |  | | \n----  | ----    | -----   | ----\nsvgPath | String | resources/svg | svg \nextract | Boolean | false |   svg \nsvgoSettings | Array | [{ removeTitle: true }, { removeViewBox: false }, { removeDimensions: true }] | svgo \n\n#### \n svg \n","slug":"laravel-vue-svg","published":1,"updated":"2019-10-29T02:25:58.673Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m25000m9sv7hl15y81v","content":"<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install laravel-mix-svg-vue</span><br><span class=\"line\">or</span><br><span class=\"line\">yarn add laravel-mix-svg-vue</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-webpack-mix-js-\"><a href=\"#-webpack-mix-js-\" class=\"headerlink\" title=\" webpack.mix.js \"></a> webpack.mix.js </h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const mix = require(&apos;laravel-mix&apos;);</span><br><span class=\"line\">require(&apos;laravel-mix-svg-vue&apos;);</span><br><span class=\"line\"></span><br><span class=\"line\">mix.js(&apos;resources/js/app.js&apos;, &apos;public/js&apos;)</span><br><span class=\"line\">    .svgVue();</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-app-js-\"><a href=\"#-app-js-\" class=\"headerlink\" title=\" app.js \"></a> app.js </h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import Vue from &apos;vue&apos;;</span><br><span class=\"line\">import SvgVue from &apos;svg-vue&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">Vue.use(SvgVue);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"svg-\"><a href=\"#svg-\" class=\"headerlink\" title=\"svg \"></a>svg </h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;svg-vue icon=&quot;avatar&quot;&gt;&lt;/svg-vue&gt;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    svgPath: &apos;resources/svg&apos;,</span><br><span class=\"line\">    extract: false,</span><br><span class=\"line\">    svgoSettings: [</span><br><span class=\"line\">        &#123; removeTitle: true &#125;,</span><br><span class=\"line\">        &#123; removeViewBox: false &#125;,</span><br><span class=\"line\">        &#123; removeDimensions: true &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>svgPath</td>\n<td>String</td>\n<td>resources/svg</td>\n<td>svg </td>\n</tr>\n<tr>\n<td>extract</td>\n<td>Boolean</td>\n<td>false</td>\n<td> svg </td>\n</tr>\n<tr>\n<td>svgoSettings</td>\n<td>Array</td>\n<td>[{ removeTitle: true }, { removeViewBox: false }, { removeDimensions: true }]</td>\n<td>svgo </td>\n</tr>\n</tbody></table>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> svg </p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install laravel-mix-svg-vue</span><br><span class=\"line\">or</span><br><span class=\"line\">yarn add laravel-mix-svg-vue</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-webpack-mix-js-\"><a href=\"#-webpack-mix-js-\" class=\"headerlink\" title=\" webpack.mix.js \"></a> webpack.mix.js </h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const mix = require(&apos;laravel-mix&apos;);</span><br><span class=\"line\">require(&apos;laravel-mix-svg-vue&apos;);</span><br><span class=\"line\"></span><br><span class=\"line\">mix.js(&apos;resources/js/app.js&apos;, &apos;public/js&apos;)</span><br><span class=\"line\">    .svgVue();</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-app-js-\"><a href=\"#-app-js-\" class=\"headerlink\" title=\" app.js \"></a> app.js </h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import Vue from &apos;vue&apos;;</span><br><span class=\"line\">import SvgVue from &apos;svg-vue&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">Vue.use(SvgVue);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"svg-\"><a href=\"#svg-\" class=\"headerlink\" title=\"svg \"></a>svg </h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;svg-vue icon=&quot;avatar&quot;&gt;&lt;/svg-vue&gt;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    svgPath: &apos;resources/svg&apos;,</span><br><span class=\"line\">    extract: false,</span><br><span class=\"line\">    svgoSettings: [</span><br><span class=\"line\">        &#123; removeTitle: true &#125;,</span><br><span class=\"line\">        &#123; removeViewBox: false &#125;,</span><br><span class=\"line\">        &#123; removeDimensions: true &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>svgPath</td>\n<td>String</td>\n<td>resources/svg</td>\n<td>svg </td>\n</tr>\n<tr>\n<td>extract</td>\n<td>Boolean</td>\n<td>false</td>\n<td> svg </td>\n</tr>\n<tr>\n<td>svgoSettings</td>\n<td>Array</td>\n<td>[{ removeTitle: true }, { removeViewBox: false }, { removeDimensions: true }]</td>\n<td>svgo </td>\n</tr>\n</tbody></table>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> svg </p>\n"},{"title":" laradock  laravel-swoole  websocket","date":"2019-10-12T07:24:36.000Z","_content":" [ laradock  laravel-swoole  laravel ](https://www.m-finder.com/2019/08/23/laravel-swoole-in-laradock/)  laravel-swoole  websocket \n\n![](laravel-swoole-in-laradock/laradock.png)\n<!-- more -->\n\n####  laravel-swoole\n\n\n####  socket\n laravel  env \n```env\nSWOOLE_HTTP_WEBSOCKET=true\n```\n\n `php artisan swoole:http infos` \n```shell\n+-----------------+-----------------------------------------------------+\n| Name            | Value                                               |\n+-----------------+-----------------------------------------------------+\n| PHP Version     | 7.2.21-1+ubuntu16.04.1+deb.sury.org+1               |\n| Swoole Version  | 4.4.4                                               |\n| Laravel Version | 5.8.33                                              |\n| Listen IP       | workspace                                           |\n| Listen Port     | 1215                                                |\n| Server Status   | Online                                              |\n| Reactor Num     | 2                                                   |\n| Worker Num      | 2                                                   |\n| Task Worker Num | 2                                                   |\n| Websocket Mode  | On                                                  |\n| Master PID      | 326                                                 |\n| Manager PID     | 327                                                 |\n| Log Path        | /var/www/laravel-learn/storage/logs/swoole_http.log |\n+-----------------+-----------------------------------------------------+\n```\n\n `Websocket Mode` \n####  socket \n `routes/websocket.php` :\n```php\nWebsocket::on('connect', function ($websocket, Request $request) {\n    // called while socket on connect\n    $websocket->emit('message', 'welcome');\n});\n\nWebsocket::on('disconnect', function ($websocket) {\n    // called while socket on disconnect\n    $websocket->emit('message', 'server is gone, bye~');\n});\n\nWebsocket::on('example', function ($websocket, $data) {\n    $websocket->emit('message', $data);\n});\n\n```\n `swoole:http`\n\n####  socket\n laravel-swoole  `Socket.io`\n```html\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js\"></script>\n<script type=\"text/javascript\">\n    var socket = io('http://study.test:8080/', {transports: ['websocket'], reconnection: true});\n\n    socket.on('connect', function () {\n        socket.emit('example', 'hi');\n\n        socket.on('disconnect', function () {\n            console.log('disconnect');\n        });\n\n        socket.on('message', function (msg) {\n            console.log(msg)\n        });\n    });\n</script>\n```\n\n####  nginx\n swoole  ` 4.4.4` nginx \n```\n proxy_http_version 1.1;\n```\n\n `proxy_pass http://swoole-http$suffix;` \n\n log \n\nemmm issue \n\n![](laravel-swoole-socket-in-laradock/demo.png)\n","source":"_posts/laravel-swoole-socket-in-laradock.md","raw":"---\ntitle:  laradock  laravel-swoole  websocket\ndate: 2019-10-12 15:24:36\ntags: [laravel, swoole, docker]\ncategories: \n---\n [ laradock  laravel-swoole  laravel ](https://www.m-finder.com/2019/08/23/laravel-swoole-in-laradock/)  laravel-swoole  websocket \n\n![](laravel-swoole-in-laradock/laradock.png)\n<!-- more -->\n\n####  laravel-swoole\n\n\n####  socket\n laravel  env \n```env\nSWOOLE_HTTP_WEBSOCKET=true\n```\n\n `php artisan swoole:http infos` \n```shell\n+-----------------+-----------------------------------------------------+\n| Name            | Value                                               |\n+-----------------+-----------------------------------------------------+\n| PHP Version     | 7.2.21-1+ubuntu16.04.1+deb.sury.org+1               |\n| Swoole Version  | 4.4.4                                               |\n| Laravel Version | 5.8.33                                              |\n| Listen IP       | workspace                                           |\n| Listen Port     | 1215                                                |\n| Server Status   | Online                                              |\n| Reactor Num     | 2                                                   |\n| Worker Num      | 2                                                   |\n| Task Worker Num | 2                                                   |\n| Websocket Mode  | On                                                  |\n| Master PID      | 326                                                 |\n| Manager PID     | 327                                                 |\n| Log Path        | /var/www/laravel-learn/storage/logs/swoole_http.log |\n+-----------------+-----------------------------------------------------+\n```\n\n `Websocket Mode` \n####  socket \n `routes/websocket.php` :\n```php\nWebsocket::on('connect', function ($websocket, Request $request) {\n    // called while socket on connect\n    $websocket->emit('message', 'welcome');\n});\n\nWebsocket::on('disconnect', function ($websocket) {\n    // called while socket on disconnect\n    $websocket->emit('message', 'server is gone, bye~');\n});\n\nWebsocket::on('example', function ($websocket, $data) {\n    $websocket->emit('message', $data);\n});\n\n```\n `swoole:http`\n\n####  socket\n laravel-swoole  `Socket.io`\n```html\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js\"></script>\n<script type=\"text/javascript\">\n    var socket = io('http://study.test:8080/', {transports: ['websocket'], reconnection: true});\n\n    socket.on('connect', function () {\n        socket.emit('example', 'hi');\n\n        socket.on('disconnect', function () {\n            console.log('disconnect');\n        });\n\n        socket.on('message', function (msg) {\n            console.log(msg)\n        });\n    });\n</script>\n```\n\n####  nginx\n swoole  ` 4.4.4` nginx \n```\n proxy_http_version 1.1;\n```\n\n `proxy_pass http://swoole-http$suffix;` \n\n log \n\nemmm issue \n\n![](laravel-swoole-socket-in-laradock/demo.png)\n","slug":"laravel-swoole-socket-in-laradock","published":1,"updated":"2019-11-01T07:28:42.215Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m27000o9sv701f9th0x","content":"<p> <a href=\"https://www.m-finder.com/2019/08/23/laravel-swoole-in-laradock/\" target=\"_blank\" rel=\"noopener\"> laradock  laravel-swoole  laravel </a>  laravel-swoole  websocket </p>\n<p><img src=\"/2019/10/12/laravel-swoole-socket-in-laradock/laradock.png\" alt></p>\n<a id=\"more\"></a>\n\n<h4 id=\"-laravel-swoole\"><a href=\"#-laravel-swoole\" class=\"headerlink\" title=\" laravel-swoole\"></a> laravel-swoole</h4><p></p>\n<h4 id=\"-socket\"><a href=\"#-socket\" class=\"headerlink\" title=\" socket\"></a> socket</h4><p> laravel  env </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SWOOLE_HTTP_WEBSOCKET=true</span><br></pre></td></tr></table></figure>\n\n<p> <code>php artisan swoole:http infos</code> </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">+-----------------+-----------------------------------------------------+</span><br><span class=\"line\">| Name            | Value                                               |</span><br><span class=\"line\">+-----------------+-----------------------------------------------------+</span><br><span class=\"line\">| PHP Version     | 7.2.21-1+ubuntu16.04.1+deb.sury.org+1               |</span><br><span class=\"line\">| Swoole Version  | 4.4.4                                               |</span><br><span class=\"line\">| Laravel Version | 5.8.33                                              |</span><br><span class=\"line\">| Listen IP       | workspace                                           |</span><br><span class=\"line\">| Listen Port     | 1215                                                |</span><br><span class=\"line\">| Server Status   | Online                                              |</span><br><span class=\"line\">| Reactor Num     | 2                                                   |</span><br><span class=\"line\">| Worker Num      | 2                                                   |</span><br><span class=\"line\">| Task Worker Num | 2                                                   |</span><br><span class=\"line\">| Websocket Mode  | On                                                  |</span><br><span class=\"line\">| Master PID      | 326                                                 |</span><br><span class=\"line\">| Manager PID     | 327                                                 |</span><br><span class=\"line\">| Log Path        | /var/www/laravel-learn/storage/logs/swoole_http.log |</span><br><span class=\"line\">+-----------------+-----------------------------------------------------+</span><br></pre></td></tr></table></figure>\n\n<p> <code>Websocket Mode</code> </p>\n<h4 id=\"-socket-\"><a href=\"#-socket-\" class=\"headerlink\" title=\" socket \"></a> socket </h4><p> <code>routes/websocket.php</code> :</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Websocket::on(<span class=\"string\">'connect'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($websocket, Request $request)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// called while socket on connect</span></span><br><span class=\"line\">    $websocket-&gt;emit(<span class=\"string\">'message'</span>, <span class=\"string\">'welcome'</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">Websocket::on(<span class=\"string\">'disconnect'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($websocket)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// called while socket on disconnect</span></span><br><span class=\"line\">    $websocket-&gt;emit(<span class=\"string\">'message'</span>, <span class=\"string\">'server is gone, bye~'</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">Websocket::on(<span class=\"string\">'example'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($websocket, $data)</span> </span>&#123;</span><br><span class=\"line\">    $websocket-&gt;emit(<span class=\"string\">'message'</span>, $data);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p> <code>swoole:http</code></p>\n<h4 id=\"-socket\"><a href=\"#-socket\" class=\"headerlink\" title=\" socket\"></a> socket</h4><p> laravel-swoole  <code>Socket.io</code></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> socket = io(<span class=\"string\">'http://study.test:8080/'</span>, &#123;<span class=\"attr\">transports</span>: [<span class=\"string\">'websocket'</span>], <span class=\"attr\">reconnection</span>: <span class=\"literal\">true</span>&#125;);</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"javascript\">    socket.on(<span class=\"string\">'connect'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        socket.emit(<span class=\"string\">'example'</span>, <span class=\"string\">'hi'</span>);</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"javascript\">        socket.on(<span class=\"string\">'disconnect'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">'disconnect'</span>);</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"javascript\">        socket.on(<span class=\"string\">'message'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">msg</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"built_in\">console</span>.log(msg)</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-nginx\"><a href=\"#-nginx\" class=\"headerlink\" title=\" nginx\"></a> nginx</h4><p> swoole  <code>4.4.4</code> nginx </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">proxy_http_version 1.1;</span><br></pre></td></tr></table></figure>\n\n<p> <code>proxy_pass http://swoole-http$suffix;</code> </p>\n<p> log </p>\n<p>emmm issue </p>\n<p><img src=\"/2019/10/12/laravel-swoole-socket-in-laradock/demo.png\" alt=\"\"></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"<p> <a href=\"https://www.m-finder.com/2019/08/23/laravel-swoole-in-laradock/\" target=\"_blank\" rel=\"noopener\"> laradock  laravel-swoole  laravel </a>  laravel-swoole  websocket </p>\n<p><img src=\"/2019/10/12/laravel-swoole-socket-in-laradock/laradock.png\" alt></p>","more":"<h4 id=\"-laravel-swoole\"><a href=\"#-laravel-swoole\" class=\"headerlink\" title=\" laravel-swoole\"></a> laravel-swoole</h4><p></p>\n<h4 id=\"-socket\"><a href=\"#-socket\" class=\"headerlink\" title=\" socket\"></a> socket</h4><p> laravel  env </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SWOOLE_HTTP_WEBSOCKET=true</span><br></pre></td></tr></table></figure>\n\n<p> <code>php artisan swoole:http infos</code> </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">+-----------------+-----------------------------------------------------+</span><br><span class=\"line\">| Name            | Value                                               |</span><br><span class=\"line\">+-----------------+-----------------------------------------------------+</span><br><span class=\"line\">| PHP Version     | 7.2.21-1+ubuntu16.04.1+deb.sury.org+1               |</span><br><span class=\"line\">| Swoole Version  | 4.4.4                                               |</span><br><span class=\"line\">| Laravel Version | 5.8.33                                              |</span><br><span class=\"line\">| Listen IP       | workspace                                           |</span><br><span class=\"line\">| Listen Port     | 1215                                                |</span><br><span class=\"line\">| Server Status   | Online                                              |</span><br><span class=\"line\">| Reactor Num     | 2                                                   |</span><br><span class=\"line\">| Worker Num      | 2                                                   |</span><br><span class=\"line\">| Task Worker Num | 2                                                   |</span><br><span class=\"line\">| Websocket Mode  | On                                                  |</span><br><span class=\"line\">| Master PID      | 326                                                 |</span><br><span class=\"line\">| Manager PID     | 327                                                 |</span><br><span class=\"line\">| Log Path        | /var/www/laravel-learn/storage/logs/swoole_http.log |</span><br><span class=\"line\">+-----------------+-----------------------------------------------------+</span><br></pre></td></tr></table></figure>\n\n<p> <code>Websocket Mode</code> </p>\n<h4 id=\"-socket-\"><a href=\"#-socket-\" class=\"headerlink\" title=\" socket \"></a> socket </h4><p> <code>routes/websocket.php</code> :</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Websocket::on(<span class=\"string\">'connect'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($websocket, Request $request)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// called while socket on connect</span></span><br><span class=\"line\">    $websocket-&gt;emit(<span class=\"string\">'message'</span>, <span class=\"string\">'welcome'</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">Websocket::on(<span class=\"string\">'disconnect'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($websocket)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// called while socket on disconnect</span></span><br><span class=\"line\">    $websocket-&gt;emit(<span class=\"string\">'message'</span>, <span class=\"string\">'server is gone, bye~'</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">Websocket::on(<span class=\"string\">'example'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($websocket, $data)</span> </span>&#123;</span><br><span class=\"line\">    $websocket-&gt;emit(<span class=\"string\">'message'</span>, $data);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p> <code>swoole:http</code></p>\n<h4 id=\"-socket\"><a href=\"#-socket\" class=\"headerlink\" title=\" socket\"></a> socket</h4><p> laravel-swoole  <code>Socket.io</code></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> socket = io(<span class=\"string\">'http://study.test:8080/'</span>, &#123;<span class=\"attr\">transports</span>: [<span class=\"string\">'websocket'</span>], <span class=\"attr\">reconnection</span>: <span class=\"literal\">true</span>&#125;);</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"javascript\">    socket.on(<span class=\"string\">'connect'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        socket.emit(<span class=\"string\">'example'</span>, <span class=\"string\">'hi'</span>);</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"javascript\">        socket.on(<span class=\"string\">'disconnect'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">'disconnect'</span>);</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"javascript\">        socket.on(<span class=\"string\">'message'</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">msg</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"built_in\">console</span>.log(msg)</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-nginx\"><a href=\"#-nginx\" class=\"headerlink\" title=\" nginx\"></a> nginx</h4><p> swoole  <code>4.4.4</code> nginx </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">proxy_http_version 1.1;</span><br></pre></td></tr></table></figure>\n\n<p> <code>proxy_pass http://swoole-http$suffix;</code> </p>\n<p> log </p>\n<p>emmm issue </p>\n<p><img src=\"/2019/10/12/laravel-swoole-socket-in-laradock/demo.png\" alt=\"\"></p>"},{"title":"net core WebApiApril.Util","date":"2019-11-07T07:18:21.000Z","_content":"\n### \n**April.WebApi**[April.Util_github](https://github.com/AprilBlank/April.Util.Public)[April.Util_gitee](https://gitee.com/AprilBlank/April.Util.Public)Utilmark\n\n### April.Util\nnetstandard 2.0\n![](net-core-april-util/1.png)\n\n\n-  **AprilConfigAprilEnums**\n-  **CacheUtilCookieUtilSessionUtilRedisUtil**\n-  **LogUtil**\n-  **UriUtil**\n-  **ResponseUtil**\n-  **DateUtil**\n-  **CodeUtil**\n-  **TokenUtil**\n-  **EncrypUtil**\n- Aop **AprilLogAttribute**\n- \n- **\n\nNuGetdll\n\n- log4net\n- Microsoft.AspNetCore.Http.Abstractions\n- Microsoft.AspNetCore.Http.Extensions\n- Microsoft.AspNetCore.Mvc.Abstractions\n- Microsoft.AspNetCore.Mvc.Core\n- Microsoft.AspNetCore.Session\n- Microsoft.Extensions.Caching.Memory\n- Microsoft.Extensions.Configuration\n- Newtonsoft.Json\n- QRCoder\n- StackExchange.Redis\n- System.Drawing.Common\n- **\n\nWebApi\n\ndlldllNuGet**April.Util**\n\n### \nUtil\n![](net-core-april-util/2.png)\n\n![](net-core-april-util/3.png)\n#### \nNuGetNuGet\n![](net-core-april-util/4.png)\n![](net-core-april-util/5.png)\nNuGet\n![](net-core-april-util/6.png)\n\n#### NuGet\nNuGet[NuGet](https://www.nuget.org/users/account/LogOn?returnUrl=%2F)google\n\n\n![](net-core-april-util/7.png)\nSubmit****\n![](net-core-april-util/8.png)\n\n### \nSimpleWebApiUtil**Startup**emm\n\n**Startup**\n\n```csharp\n        public Startup(IConfiguration configuration)\n        {\n            Configuration = configuration;\n\n            AprilConfig.Configuration = configuration;\n            LogUtil.InitLog();\n\n            RedisUtil.InitRedis();\n        }\n\t\t\n\t\tpublic void Configure(IApplicationBuilder app, IWebHostEnvironment env)\n        {\n            AprilConfig.ServiceProvider = app.ApplicationServices;\n            \n        }\n```\n\n![](net-core-april-util/9.png)\n```csharp\n/// <summary>\n        /// \n        /// </summary>\n        /// <returns></returns>\n        [HttpGet]\n        [AprilLog]\n        public ResponseDataEntity Get()\n        {\n            var rng = new Random();\n            var data = Enumerable.Range(1, 2).Select(index => new WeatherForecast\n            {\n                Date = DateTime.Now.AddDays(index),\n                TemperatureC = rng.Next(-20, 55),\n                Summary = Summaries[rng.Next(Summaries.Length)],\n                Timestamp = (int)DateUtil.ConvertToUnixTimestamp(DateTime.Now.AddDays(index))\n            })\n            .ToList();\n            return ResponseUtil.Success(\"\", data);\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"type\"></param>\n        /// <returns></returns>\n        [HttpGet]\n        [Route(\"Code\")]\n        public FileContentResult Code(int type)\n        {\n            string code = CodeUtil.GetSingleObj().CreateVerifyCode(CodeUtil.VerifyCodeType.MixVerifyCode, 6);\n            //LogUtil.Info($\"6:{code}\");\n            bool isAddLines = false;\n            if (type == 1)\n            {\n                isAddLines = true;\n            }\n            var bitmap = CodeUtil.GetSingleObj().CreateBitmapByImgVerifyCode(code, 100, 40, isAddLines);\n            code = EncryptUtil.EncryptDES(code, AprilConfig.SecurityKey);\n            CookieUtil.AddString(\"code\", code, 5);\n            MemoryStream stream = new MemoryStream();\n            bitmap.Save(stream, ImageFormat.Gif);\n            return File(stream.ToArray(), \"image/gif\");\n        }\n```\n\n### \nnetframeworknet coreUtil****\n","source":"_posts/net-core-april-util.md","raw":"---\ntitle: net core WebApiApril.Util\ndate: 2019-11-07 15:18:21\ntags: net core\ncategories: AprilBlank\n---\n\n### \n**April.WebApi**[April.Util_github](https://github.com/AprilBlank/April.Util.Public)[April.Util_gitee](https://gitee.com/AprilBlank/April.Util.Public)Utilmark\n\n### April.Util\nnetstandard 2.0\n![](net-core-april-util/1.png)\n\n\n-  **AprilConfigAprilEnums**\n-  **CacheUtilCookieUtilSessionUtilRedisUtil**\n-  **LogUtil**\n-  **UriUtil**\n-  **ResponseUtil**\n-  **DateUtil**\n-  **CodeUtil**\n-  **TokenUtil**\n-  **EncrypUtil**\n- Aop **AprilLogAttribute**\n- \n- **\n\nNuGetdll\n\n- log4net\n- Microsoft.AspNetCore.Http.Abstractions\n- Microsoft.AspNetCore.Http.Extensions\n- Microsoft.AspNetCore.Mvc.Abstractions\n- Microsoft.AspNetCore.Mvc.Core\n- Microsoft.AspNetCore.Session\n- Microsoft.Extensions.Caching.Memory\n- Microsoft.Extensions.Configuration\n- Newtonsoft.Json\n- QRCoder\n- StackExchange.Redis\n- System.Drawing.Common\n- **\n\nWebApi\n\ndlldllNuGet**April.Util**\n\n### \nUtil\n![](net-core-april-util/2.png)\n\n![](net-core-april-util/3.png)\n#### \nNuGetNuGet\n![](net-core-april-util/4.png)\n![](net-core-april-util/5.png)\nNuGet\n![](net-core-april-util/6.png)\n\n#### NuGet\nNuGet[NuGet](https://www.nuget.org/users/account/LogOn?returnUrl=%2F)google\n\n\n![](net-core-april-util/7.png)\nSubmit****\n![](net-core-april-util/8.png)\n\n### \nSimpleWebApiUtil**Startup**emm\n\n**Startup**\n\n```csharp\n        public Startup(IConfiguration configuration)\n        {\n            Configuration = configuration;\n\n            AprilConfig.Configuration = configuration;\n            LogUtil.InitLog();\n\n            RedisUtil.InitRedis();\n        }\n\t\t\n\t\tpublic void Configure(IApplicationBuilder app, IWebHostEnvironment env)\n        {\n            AprilConfig.ServiceProvider = app.ApplicationServices;\n            \n        }\n```\n\n![](net-core-april-util/9.png)\n```csharp\n/// <summary>\n        /// \n        /// </summary>\n        /// <returns></returns>\n        [HttpGet]\n        [AprilLog]\n        public ResponseDataEntity Get()\n        {\n            var rng = new Random();\n            var data = Enumerable.Range(1, 2).Select(index => new WeatherForecast\n            {\n                Date = DateTime.Now.AddDays(index),\n                TemperatureC = rng.Next(-20, 55),\n                Summary = Summaries[rng.Next(Summaries.Length)],\n                Timestamp = (int)DateUtil.ConvertToUnixTimestamp(DateTime.Now.AddDays(index))\n            })\n            .ToList();\n            return ResponseUtil.Success(\"\", data);\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"type\"></param>\n        /// <returns></returns>\n        [HttpGet]\n        [Route(\"Code\")]\n        public FileContentResult Code(int type)\n        {\n            string code = CodeUtil.GetSingleObj().CreateVerifyCode(CodeUtil.VerifyCodeType.MixVerifyCode, 6);\n            //LogUtil.Info($\"6:{code}\");\n            bool isAddLines = false;\n            if (type == 1)\n            {\n                isAddLines = true;\n            }\n            var bitmap = CodeUtil.GetSingleObj().CreateBitmapByImgVerifyCode(code, 100, 40, isAddLines);\n            code = EncryptUtil.EncryptDES(code, AprilConfig.SecurityKey);\n            CookieUtil.AddString(\"code\", code, 5);\n            MemoryStream stream = new MemoryStream();\n            bitmap.Save(stream, ImageFormat.Gif);\n            return File(stream.ToArray(), \"image/gif\");\n        }\n```\n\n### \nnetframeworknet coreUtil****\n","slug":"net-core-april-util","published":1,"updated":"2019-11-22T02:56:59.686Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2a000t9sv7ehyhy460","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>April.WebApi</strong><a href=\"https://github.com/AprilBlank/April.Util.Public\" target=\"_blank\" rel=\"noopener\">April.Util_github</a><a href=\"https://gitee.com/AprilBlank/April.Util.Public\" target=\"_blank\" rel=\"noopener\">April.Util_gitee</a>Utilmark</p>\n<h3 id=\"April-Util\"><a href=\"#April-Util\" class=\"headerlink\" title=\"April.Util\"></a>April.Util</h3><p>netstandard 2.0<br><img src=\"/2019/11/07/net-core-april-util/1.png\" alt=\"\"><br></p>\n<ul>\n<li> <strong>AprilConfigAprilEnums</strong></li>\n<li> <strong>CacheUtilCookieUtilSessionUtilRedisUtil</strong></li>\n<li> <strong>LogUtil</strong></li>\n<li> <strong>UriUtil</strong></li>\n<li> <strong>ResponseUtil</strong></li>\n<li> <strong>DateUtil</strong></li>\n<li> <strong>CodeUtil</strong></li>\n<li> <strong>TokenUtil</strong></li>\n<li> <strong>EncrypUtil</strong></li>\n<li>Aop <strong>AprilLogAttribute</strong></li>\n<li></li>\n<li><em></em></li>\n</ul>\n<p>NuGetdll</p>\n<ul>\n<li>log4net</li>\n<li>Microsoft.AspNetCore.Http.Abstractions</li>\n<li>Microsoft.AspNetCore.Http.Extensions</li>\n<li>Microsoft.AspNetCore.Mvc.Abstractions</li>\n<li>Microsoft.AspNetCore.Mvc.Core</li>\n<li>Microsoft.AspNetCore.Session</li>\n<li>Microsoft.Extensions.Caching.Memory</li>\n<li>Microsoft.Extensions.Configuration</li>\n<li>Newtonsoft.Json</li>\n<li>QRCoder</li>\n<li>StackExchange.Redis</li>\n<li>System.Drawing.Common</li>\n<li><em></em></li>\n</ul>\n<p>WebApi</p>\n<p>dlldllNuGet<strong>April.Util</strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Util<br><img src=\"/2019/11/07/net-core-april-util/2.png\" alt=\"\"><br><br><img src=\"/2019/11/07/net-core-april-util/3.png\" alt=\"\"></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>NuGetNuGet<br><img src=\"/2019/11/07/net-core-april-util/4.png\" alt=\"\"><br><img src=\"/2019/11/07/net-core-april-util/5.png\" alt=\"\"><br>NuGet<br><img src=\"/2019/11/07/net-core-april-util/6.png\" alt=\"\"></p>\n<h4 id=\"NuGet\"><a href=\"#NuGet\" class=\"headerlink\" title=\"NuGet\"></a>NuGet</h4><p>NuGet<a href=\"https://www.nuget.org/users/account/LogOn?returnUrl=%2F\" target=\"_blank\" rel=\"noopener\">NuGet</a>google</p>\n<p><br><img src=\"/2019/11/07/net-core-april-util/7.png\" alt=\"\"><br>Submit<strong></strong><br><img src=\"/2019/11/07/net-core-april-util/8.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>SimpleWebApiUtil<strong>Startup</strong>emm</p>\n<p><strong>Startup</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Startup</span>(<span class=\"params\">IConfiguration configuration</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          Configuration = configuration;</span><br><span class=\"line\"></span><br><span class=\"line\">          AprilConfig.Configuration = configuration;</span><br><span class=\"line\">          LogUtil.InitLog();</span><br><span class=\"line\"></span><br><span class=\"line\">          RedisUtil.InitRedis();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IWebHostEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          AprilConfig.ServiceProvider = app.ApplicationServices;</span><br><span class=\"line\">          </span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/11/07/net-core-april-util/9.png\" alt=\"\"></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        [<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\">        [<span class=\"meta\">AprilLog</span>]</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> ResponseDataEntity <span class=\"title\">Get</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> rng = <span class=\"keyword\">new</span> Random();</span><br><span class=\"line\">            <span class=\"keyword\">var</span> data = Enumerable.Range(<span class=\"number\">1</span>, <span class=\"number\">2</span>).Select(index =&gt; <span class=\"keyword\">new</span> WeatherForecast</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                Date = DateTime.Now.AddDays(index),</span><br><span class=\"line\">                TemperatureC = rng.Next(<span class=\"number\">-20</span>, <span class=\"number\">55</span>),</span><br><span class=\"line\">                Summary = Summaries[rng.Next(Summaries.Length)],</span><br><span class=\"line\">                Timestamp = (<span class=\"keyword\">int</span>)DateUtil.ConvertToUnixTimestamp(DateTime.Now.AddDays(index))</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">            .ToList();</span><br><span class=\"line\">            <span class=\"keyword\">return</span> ResponseUtil.Success(<span class=\"string\">\"\"</span>, data);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"type\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        [<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\">        [<span class=\"meta\">Route(<span class=\"meta-string\">\"Code\"</span>)</span>]</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> FileContentResult <span class=\"title\">Code</span>(<span class=\"params\"><span class=\"keyword\">int</span> type</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">string</span> code = CodeUtil.GetSingleObj().CreateVerifyCode(CodeUtil.VerifyCodeType.MixVerifyCode, <span class=\"number\">6</span>);</span><br><span class=\"line\">            <span class=\"comment\">//LogUtil.Info($\"6:&#123;code&#125;\");</span></span><br><span class=\"line\">            <span class=\"keyword\">bool</span> isAddLines = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (type == <span class=\"number\">1</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                isAddLines = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> bitmap = CodeUtil.GetSingleObj().CreateBitmapByImgVerifyCode(code, <span class=\"number\">100</span>, <span class=\"number\">40</span>, isAddLines);</span><br><span class=\"line\">            code = EncryptUtil.EncryptDES(code, AprilConfig.SecurityKey);</span><br><span class=\"line\">            CookieUtil.AddString(<span class=\"string\">\"code\"</span>, code, <span class=\"number\">5</span>);</span><br><span class=\"line\">            MemoryStream stream = <span class=\"keyword\">new</span> MemoryStream();</span><br><span class=\"line\">            bitmap.Save(stream, ImageFormat.Gif);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> File(stream.ToArray(), <span class=\"string\">\"image/gif\"</span>);</span><br><span class=\"line\">        &#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>netframeworknet coreUtil<strong></strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>April.WebApi</strong><a href=\"https://github.com/AprilBlank/April.Util.Public\" target=\"_blank\" rel=\"noopener\">April.Util_github</a><a href=\"https://gitee.com/AprilBlank/April.Util.Public\" target=\"_blank\" rel=\"noopener\">April.Util_gitee</a>Utilmark</p>\n<h3 id=\"April-Util\"><a href=\"#April-Util\" class=\"headerlink\" title=\"April.Util\"></a>April.Util</h3><p>netstandard 2.0<br><img src=\"/2019/11/07/net-core-april-util/1.png\" alt=\"\"><br></p>\n<ul>\n<li> <strong>AprilConfigAprilEnums</strong></li>\n<li> <strong>CacheUtilCookieUtilSessionUtilRedisUtil</strong></li>\n<li> <strong>LogUtil</strong></li>\n<li> <strong>UriUtil</strong></li>\n<li> <strong>ResponseUtil</strong></li>\n<li> <strong>DateUtil</strong></li>\n<li> <strong>CodeUtil</strong></li>\n<li> <strong>TokenUtil</strong></li>\n<li> <strong>EncrypUtil</strong></li>\n<li>Aop <strong>AprilLogAttribute</strong></li>\n<li></li>\n<li><em></em></li>\n</ul>\n<p>NuGetdll</p>\n<ul>\n<li>log4net</li>\n<li>Microsoft.AspNetCore.Http.Abstractions</li>\n<li>Microsoft.AspNetCore.Http.Extensions</li>\n<li>Microsoft.AspNetCore.Mvc.Abstractions</li>\n<li>Microsoft.AspNetCore.Mvc.Core</li>\n<li>Microsoft.AspNetCore.Session</li>\n<li>Microsoft.Extensions.Caching.Memory</li>\n<li>Microsoft.Extensions.Configuration</li>\n<li>Newtonsoft.Json</li>\n<li>QRCoder</li>\n<li>StackExchange.Redis</li>\n<li>System.Drawing.Common</li>\n<li><em></em></li>\n</ul>\n<p>WebApi</p>\n<p>dlldllNuGet<strong>April.Util</strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Util<br><img src=\"/2019/11/07/net-core-april-util/2.png\" alt=\"\"><br><br><img src=\"/2019/11/07/net-core-april-util/3.png\" alt=\"\"></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>NuGetNuGet<br><img src=\"/2019/11/07/net-core-april-util/4.png\" alt=\"\"><br><img src=\"/2019/11/07/net-core-april-util/5.png\" alt=\"\"><br>NuGet<br><img src=\"/2019/11/07/net-core-april-util/6.png\" alt=\"\"></p>\n<h4 id=\"NuGet\"><a href=\"#NuGet\" class=\"headerlink\" title=\"NuGet\"></a>NuGet</h4><p>NuGet<a href=\"https://www.nuget.org/users/account/LogOn?returnUrl=%2F\" target=\"_blank\" rel=\"noopener\">NuGet</a>google</p>\n<p><br><img src=\"/2019/11/07/net-core-april-util/7.png\" alt=\"\"><br>Submit<strong></strong><br><img src=\"/2019/11/07/net-core-april-util/8.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>SimpleWebApiUtil<strong>Startup</strong>emm</p>\n<p><strong>Startup</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Startup</span>(<span class=\"params\">IConfiguration configuration</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          Configuration = configuration;</span><br><span class=\"line\"></span><br><span class=\"line\">          AprilConfig.Configuration = configuration;</span><br><span class=\"line\">          LogUtil.InitLog();</span><br><span class=\"line\"></span><br><span class=\"line\">          RedisUtil.InitRedis();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IWebHostEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          AprilConfig.ServiceProvider = app.ApplicationServices;</span><br><span class=\"line\">          </span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/11/07/net-core-april-util/9.png\" alt=\"\"></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        [<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\">        [<span class=\"meta\">AprilLog</span>]</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> ResponseDataEntity <span class=\"title\">Get</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> rng = <span class=\"keyword\">new</span> Random();</span><br><span class=\"line\">            <span class=\"keyword\">var</span> data = Enumerable.Range(<span class=\"number\">1</span>, <span class=\"number\">2</span>).Select(index =&gt; <span class=\"keyword\">new</span> WeatherForecast</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                Date = DateTime.Now.AddDays(index),</span><br><span class=\"line\">                TemperatureC = rng.Next(<span class=\"number\">-20</span>, <span class=\"number\">55</span>),</span><br><span class=\"line\">                Summary = Summaries[rng.Next(Summaries.Length)],</span><br><span class=\"line\">                Timestamp = (<span class=\"keyword\">int</span>)DateUtil.ConvertToUnixTimestamp(DateTime.Now.AddDays(index))</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">            .ToList();</span><br><span class=\"line\">            <span class=\"keyword\">return</span> ResponseUtil.Success(<span class=\"string\">\"\"</span>, data);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"type\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        [<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\">        [<span class=\"meta\">Route(<span class=\"meta-string\">\"Code\"</span>)</span>]</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> FileContentResult <span class=\"title\">Code</span>(<span class=\"params\"><span class=\"keyword\">int</span> type</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">string</span> code = CodeUtil.GetSingleObj().CreateVerifyCode(CodeUtil.VerifyCodeType.MixVerifyCode, <span class=\"number\">6</span>);</span><br><span class=\"line\">            <span class=\"comment\">//LogUtil.Info($\"6:&#123;code&#125;\");</span></span><br><span class=\"line\">            <span class=\"keyword\">bool</span> isAddLines = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (type == <span class=\"number\">1</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                isAddLines = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> bitmap = CodeUtil.GetSingleObj().CreateBitmapByImgVerifyCode(code, <span class=\"number\">100</span>, <span class=\"number\">40</span>, isAddLines);</span><br><span class=\"line\">            code = EncryptUtil.EncryptDES(code, AprilConfig.SecurityKey);</span><br><span class=\"line\">            CookieUtil.AddString(<span class=\"string\">\"code\"</span>, code, <span class=\"number\">5</span>);</span><br><span class=\"line\">            MemoryStream stream = <span class=\"keyword\">new</span> MemoryStream();</span><br><span class=\"line\">            bitmap.Save(stream, ImageFormat.Gif);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> File(stream.ToArray(), <span class=\"string\">\"image/gif\"</span>);</span><br><span class=\"line\">        &#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>netframeworknet coreUtil<strong></strong></p>\n"},{"title":"net core WebapiAOP_Part 2","date":"2019-08-01T03:18:22.000Z","_content":"\n### \nAOPAOP**AspectoCore**\n\nAspectCore Project  net core  Aop(Aspect-oriented programming)  net core AspectCoreWeb\n\n### \nUtil\n![](net-core-aop-2/1.png)\nStartupConfigureServicesvoidIServiceProvider\n```csharp\n\tpublic IServiceProvider ConfigureServices(IServiceCollection services)\n\t{\n\t\t//...\n\t\tservices.AddAspectCoreContainer();\n        return services.BuildAspectInjectorProvider();\n\t}\n```\n\n### \nUtil**Attributes****AprilLogAttribute****AbstractInterceptorAttribute**\n```csharp\n    public class AprilLogAttribute : AbstractInterceptorAttribute\n    {\n        public async override Task Invoke(AspectContext context, AspectDelegate next)\n        {\n            LogUtil.Debug(\"AprilLogAttribute begin\");\n            await next(context);\n            LogUtil.Debug(\"AprilLogAttribute end\");\n        }\n    }\n```\nStudent\n```csharp\n    public interface IStudentService : IBaseService<StudentEntity>\n    {\n        [AprilLog]\n        void Test();\n    }\n```\nStudentService\n```csharp\n    public class StudentService : BaseService<StudentEntity>, IStudentService\n    {\n        public void Test()\n        {\n            LogUtil.Debug(\"StudentService Test\");\n        }\n    }\n```\n\n### \nValuesTest\n```csharp\n        [HttpGet]\n        public ActionResult<IEnumerable<string>> Get()\n        {\n            _service.Test();\n            return new string[] { \"value1\", \"value2\" };\n        }\n```\n\napplication.json\n```json\n{\n  \"Logging\": {\n    \"LogLevel\": {\n      \"Default\": \"Warning\"\n    }\n  },\n  \"AllowedHosts\": \"*\",\n  \"CommonSettings\": {\n    \"FilePath\": \"/uploads/files/\"\n  },\n  \"DefaultSqlConnectionString\": {\n    \"MySql\": \"server=127.0.0.1;userid=root;password=root;database=test;\"\n  },\n  \"AllowUrl\": \"/api/Values\" //\n}\n```\n\n![](net-core-aop-2/2.png)\n\n![](net-core-aop-2/3.png)\ncontext\n![](net-core-aop-2/4.png)\n\n### \nnet core webapi\n","source":"_posts/net-core-aop-2.md","raw":"---\ntitle: net core WebapiAOP_Part 2\ndate: 2019-08-01 11:18:22\ntags: net core\ncategories: AprilBlank\n---\n\n### \nAOPAOP**AspectoCore**\n\nAspectCore Project  net core  Aop(Aspect-oriented programming)  net core AspectCoreWeb\n\n### \nUtil\n![](net-core-aop-2/1.png)\nStartupConfigureServicesvoidIServiceProvider\n```csharp\n\tpublic IServiceProvider ConfigureServices(IServiceCollection services)\n\t{\n\t\t//...\n\t\tservices.AddAspectCoreContainer();\n        return services.BuildAspectInjectorProvider();\n\t}\n```\n\n### \nUtil**Attributes****AprilLogAttribute****AbstractInterceptorAttribute**\n```csharp\n    public class AprilLogAttribute : AbstractInterceptorAttribute\n    {\n        public async override Task Invoke(AspectContext context, AspectDelegate next)\n        {\n            LogUtil.Debug(\"AprilLogAttribute begin\");\n            await next(context);\n            LogUtil.Debug(\"AprilLogAttribute end\");\n        }\n    }\n```\nStudent\n```csharp\n    public interface IStudentService : IBaseService<StudentEntity>\n    {\n        [AprilLog]\n        void Test();\n    }\n```\nStudentService\n```csharp\n    public class StudentService : BaseService<StudentEntity>, IStudentService\n    {\n        public void Test()\n        {\n            LogUtil.Debug(\"StudentService Test\");\n        }\n    }\n```\n\n### \nValuesTest\n```csharp\n        [HttpGet]\n        public ActionResult<IEnumerable<string>> Get()\n        {\n            _service.Test();\n            return new string[] { \"value1\", \"value2\" };\n        }\n```\n\napplication.json\n```json\n{\n  \"Logging\": {\n    \"LogLevel\": {\n      \"Default\": \"Warning\"\n    }\n  },\n  \"AllowedHosts\": \"*\",\n  \"CommonSettings\": {\n    \"FilePath\": \"/uploads/files/\"\n  },\n  \"DefaultSqlConnectionString\": {\n    \"MySql\": \"server=127.0.0.1;userid=root;password=root;database=test;\"\n  },\n  \"AllowUrl\": \"/api/Values\" //\n}\n```\n\n![](net-core-aop-2/2.png)\n\n![](net-core-aop-2/3.png)\ncontext\n![](net-core-aop-2/4.png)\n\n### \nnet core webapi\n","slug":"net-core-aop-2","published":1,"updated":"2019-09-30T05:46:00.986Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2e000w9sv70srinq8d","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>AOPAOP<strong>AspectoCore</strong></p>\n<p>AspectCore Project  net core  Aop(Aspect-oriented programming)  net core AspectCoreWeb</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Util<br><img src=\"/2019/08/01/net-core-aop-2/1.png\" alt=\"\"><br>StartupConfigureServicesvoidIServiceProvider</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> IServiceProvider <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//...</span></span><br><span class=\"line\">\tservices.AddAspectCoreContainer();</span><br><span class=\"line\">       <span class=\"keyword\">return</span> services.BuildAspectInjectorProvider();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Util<strong>Attributes</strong><strong>AprilLogAttribute</strong><strong>AbstractInterceptorAttribute</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AprilLogAttribute</span> : <span class=\"title\">AbstractInterceptorAttribute</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> <span class=\"keyword\">override</span> Task <span class=\"title\">Invoke</span>(<span class=\"params\">AspectContext context, AspectDelegate next</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        LogUtil.Debug(<span class=\"string\">\"AprilLogAttribute begin\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">await</span> next(context);</span><br><span class=\"line\">        LogUtil.Debug(<span class=\"string\">\"AprilLogAttribute end\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Student</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public interface IStudentService : IBaseService&lt;StudentEntity&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    [<span class=\"meta\">AprilLog</span>]</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Test</span>(<span class=\"params\"></span>)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>StudentService</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class StudentService : BaseService&lt;StudentEntity&gt;, IStudentService</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Test</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        LogUtil.Debug(<span class=\"string\">\"StudentService Test\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ValuesTest</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\"><span class=\"keyword\">public</span> ActionResult&lt;IEnumerable&lt;<span class=\"keyword\">string</span>&gt;&gt; Get()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    _service.Test();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">string</span>[] &#123; <span class=\"string\">\"value1\"</span>, <span class=\"string\">\"value2\"</span> &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>application.json</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"Logging\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"LogLevel\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"Default\"</span>: <span class=\"string\">\"Warning\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"AllowedHosts\"</span>: <span class=\"string\">\"*\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"CommonSettings\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"FilePath\"</span>: <span class=\"string\">\"/uploads/files/\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"DefaultSqlConnectionString\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"MySql\"</span>: <span class=\"string\">\"server=127.0.0.1;userid=root;password=root;database=test;\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"AllowUrl\"</span>: <span class=\"string\">\"/api/Values\"</span> //</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/08/01/net-core-aop-2/2.png\" alt=\"\"><br><br><img src=\"/2019/08/01/net-core-aop-2/3.png\" alt=\"\"><br>context<br><img src=\"/2019/08/01/net-core-aop-2/4.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net core webapi</p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>AOPAOP<strong>AspectoCore</strong></p>\n<p>AspectCore Project  net core  Aop(Aspect-oriented programming)  net core AspectCoreWeb</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Util<br><img src=\"/2019/08/01/net-core-aop-2/1.png\" alt=\"\"><br>StartupConfigureServicesvoidIServiceProvider</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> IServiceProvider <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//...</span></span><br><span class=\"line\">\tservices.AddAspectCoreContainer();</span><br><span class=\"line\">       <span class=\"keyword\">return</span> services.BuildAspectInjectorProvider();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Util<strong>Attributes</strong><strong>AprilLogAttribute</strong><strong>AbstractInterceptorAttribute</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AprilLogAttribute</span> : <span class=\"title\">AbstractInterceptorAttribute</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> <span class=\"keyword\">override</span> Task <span class=\"title\">Invoke</span>(<span class=\"params\">AspectContext context, AspectDelegate next</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        LogUtil.Debug(<span class=\"string\">\"AprilLogAttribute begin\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">await</span> next(context);</span><br><span class=\"line\">        LogUtil.Debug(<span class=\"string\">\"AprilLogAttribute end\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Student</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public interface IStudentService : IBaseService&lt;StudentEntity&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    [<span class=\"meta\">AprilLog</span>]</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Test</span>(<span class=\"params\"></span>)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>StudentService</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class StudentService : BaseService&lt;StudentEntity&gt;, IStudentService</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Test</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        LogUtil.Debug(<span class=\"string\">\"StudentService Test\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ValuesTest</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\"><span class=\"keyword\">public</span> ActionResult&lt;IEnumerable&lt;<span class=\"keyword\">string</span>&gt;&gt; Get()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    _service.Test();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">string</span>[] &#123; <span class=\"string\">\"value1\"</span>, <span class=\"string\">\"value2\"</span> &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>application.json</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"Logging\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"LogLevel\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"Default\"</span>: <span class=\"string\">\"Warning\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"AllowedHosts\"</span>: <span class=\"string\">\"*\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"CommonSettings\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"FilePath\"</span>: <span class=\"string\">\"/uploads/files/\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"DefaultSqlConnectionString\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"MySql\"</span>: <span class=\"string\">\"server=127.0.0.1;userid=root;password=root;database=test;\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"AllowUrl\"</span>: <span class=\"string\">\"/api/Values\"</span> //</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/08/01/net-core-aop-2/2.png\" alt=\"\"><br><br><img src=\"/2019/08/01/net-core-aop-2/3.png\" alt=\"\"><br>context<br><img src=\"/2019/08/01/net-core-aop-2/4.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net core webapi</p>\n"},{"title":"net core WebapiAOP_Part 1","date":"2019-07-30T10:31:10.000Z","_content":"\n### \n\n\n### \nAOPAOP\n\nAOP\n\n### \n**Api**Filters**ExceptionFilter**\n\n\n```csharp\n    public class ExceptionFilter\n    {\n        private readonly RequestDelegate _next;\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"next\"></param>\n        public ExceptionFilter(RequestDelegate next)\n        {\n            _next = next;\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"context\"></param>\n        /// <returns></returns>\n        public async Task Invoke(HttpContext context)\n        {\n            try\n            {\n                await _next(context);\n            }\n            catch (Exception ex) //\n            {\n                context.Response.StatusCode = 500;\n                LogUtil.Error($\"response exception:{ex.Message}\");// {ex.StackTrace}\n                await ResponseUtil.HandleExceptionAsync(500, \"\");\n            }\n        }\n    }\n```\n\n**ResponseUtil**Util\n\n```csharp\n    public class ResponseUtil\n    {\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"statusCode\">html</param>\n        /// <param name=\"msg\"></param>\n        /// <returns></returns>\n        public static Task HandleExceptionAsync(int statusCode, string msg)\n        {\n            var data = new { code = statusCode, msg = msg };\n            string text = JsonConvert.SerializeObject(data);\n            var response = AprilConfig.HttpCurrent.Response;\n            if (string.IsNullOrEmpty(response.ContentType))\n            {\n                //header\n                response.Headers.Add(\"Access-Control-Allow-Origin\", \"*\");\n                response.Headers.Add(\"Access-Control-Allow-Credentials\", \"true\");\n                //json\n                response.ContentType = \"application/json;charset=utf-8\";\n                response.StatusCode = 200;\n                response.ContentLength = text.Length;\n                return response.WriteAsync(text);\n            }\n            else\n            {\n                return response.WriteAsync(text);\n            }\n        }\n    }\n```\n\nStartup\n\n```csharp\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n            app.UseMiddleware<ExceptionFilter>();\n\t\t\t\n        }\n```\n\n\n![Startup](net-core-aop-1/1.png)\n### \n![](net-core-aop-1/2.png)\n![](net-core-aop-1/3.png)\n\n\n### \n**AuthFilter**\n```csharp\n    public class AuthFilter\n    {\n        private readonly RequestDelegate _next;\n\n        public AuthFilter(RequestDelegate next)\n        {\n            _next = next;\n        }\n\n        public Task Invoke(HttpContext context)\n        {\n            if (context.Request.Method == \"OPTIONS\")\n            {\n                return _next(context);\n            }\n            var headers = context.Request.Headers;\n            //jwt token\n            if (!headers.ContainsKey(\"Authorization\"))\n            {\n                string path = context.Request.Path.Value;\n                if (!AprilConfig.AllowUrl.Contains(path) && path.IndexOf(\"swagger\") < 0)\n                {\n                    //\n                    return ResponseUtil.HandleExceptionAsync(401, \"\");\n                    \n                    //()\n                    return ResponseUtil.HandleExceptionAsync(-2, \"\");\n\n                }\n            }\n            return _next(context);\n        }\n    }\n```\n\nStartup\n```csharp\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n            app.UseMiddleware<ExceptionFilter>();\n            app.UseMiddleware<AuthFilter>();\n\t\t\t\n        }\n```\n\n### \n![](net-core-aop-1/4.png)\nSwagger\n![Swagger](net-core-aop-1/5.png)\n\n### \nAOPOOP1%30%**net core3.0ok**\nAOP**AspectCore**\n\n***\n\n###  2019-07-31\n\n![](net-core-aop-1/6.png)\n****ContentTypebugchrome\n\n![](net-core-aop-1/7.png)\nLength\n\n![](net-core-aop-1/8.png)","source":"_posts/net-core-aop-1.md","raw":"---\ntitle: net core WebapiAOP_Part 1\ndate: 2019-07-30 18:31:10\ntags: net core\ncategories: AprilBlank\n---\n\n### \n\n\n### \nAOPAOP\n\nAOP\n\n### \n**Api**Filters**ExceptionFilter**\n\n\n```csharp\n    public class ExceptionFilter\n    {\n        private readonly RequestDelegate _next;\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"next\"></param>\n        public ExceptionFilter(RequestDelegate next)\n        {\n            _next = next;\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"context\"></param>\n        /// <returns></returns>\n        public async Task Invoke(HttpContext context)\n        {\n            try\n            {\n                await _next(context);\n            }\n            catch (Exception ex) //\n            {\n                context.Response.StatusCode = 500;\n                LogUtil.Error($\"response exception:{ex.Message}\");// {ex.StackTrace}\n                await ResponseUtil.HandleExceptionAsync(500, \"\");\n            }\n        }\n    }\n```\n\n**ResponseUtil**Util\n\n```csharp\n    public class ResponseUtil\n    {\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"statusCode\">html</param>\n        /// <param name=\"msg\"></param>\n        /// <returns></returns>\n        public static Task HandleExceptionAsync(int statusCode, string msg)\n        {\n            var data = new { code = statusCode, msg = msg };\n            string text = JsonConvert.SerializeObject(data);\n            var response = AprilConfig.HttpCurrent.Response;\n            if (string.IsNullOrEmpty(response.ContentType))\n            {\n                //header\n                response.Headers.Add(\"Access-Control-Allow-Origin\", \"*\");\n                response.Headers.Add(\"Access-Control-Allow-Credentials\", \"true\");\n                //json\n                response.ContentType = \"application/json;charset=utf-8\";\n                response.StatusCode = 200;\n                response.ContentLength = text.Length;\n                return response.WriteAsync(text);\n            }\n            else\n            {\n                return response.WriteAsync(text);\n            }\n        }\n    }\n```\n\nStartup\n\n```csharp\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n            app.UseMiddleware<ExceptionFilter>();\n\t\t\t\n        }\n```\n\n\n![Startup](net-core-aop-1/1.png)\n### \n![](net-core-aop-1/2.png)\n![](net-core-aop-1/3.png)\n\n\n### \n**AuthFilter**\n```csharp\n    public class AuthFilter\n    {\n        private readonly RequestDelegate _next;\n\n        public AuthFilter(RequestDelegate next)\n        {\n            _next = next;\n        }\n\n        public Task Invoke(HttpContext context)\n        {\n            if (context.Request.Method == \"OPTIONS\")\n            {\n                return _next(context);\n            }\n            var headers = context.Request.Headers;\n            //jwt token\n            if (!headers.ContainsKey(\"Authorization\"))\n            {\n                string path = context.Request.Path.Value;\n                if (!AprilConfig.AllowUrl.Contains(path) && path.IndexOf(\"swagger\") < 0)\n                {\n                    //\n                    return ResponseUtil.HandleExceptionAsync(401, \"\");\n                    \n                    //()\n                    return ResponseUtil.HandleExceptionAsync(-2, \"\");\n\n                }\n            }\n            return _next(context);\n        }\n    }\n```\n\nStartup\n```csharp\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n            app.UseMiddleware<ExceptionFilter>();\n            app.UseMiddleware<AuthFilter>();\n\t\t\t\n        }\n```\n\n### \n![](net-core-aop-1/4.png)\nSwagger\n![Swagger](net-core-aop-1/5.png)\n\n### \nAOPOOP1%30%**net core3.0ok**\nAOP**AspectCore**\n\n***\n\n###  2019-07-31\n\n![](net-core-aop-1/6.png)\n****ContentTypebugchrome\n\n![](net-core-aop-1/7.png)\nLength\n\n![](net-core-aop-1/8.png)","slug":"net-core-aop-1","published":1,"updated":"2019-09-30T05:45:57.927Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2g00109sv7q0kk6866","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>AOPAOP</p>\n<p>AOP</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>Api</strong>Filters<strong>ExceptionFilter</strong></p>\n<p></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">ExceptionFilter</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> RequestDelegate _next;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"next\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ExceptionFilter</span>(<span class=\"params\">RequestDelegate next</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        _next = next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"context\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task <span class=\"title\">Invoke</span>(<span class=\"params\">HttpContext context</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">await</span> _next(context);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (Exception ex) <span class=\"comment\">//</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            context.Response.StatusCode = <span class=\"number\">500</span>;</span><br><span class=\"line\">            LogUtil.Error(<span class=\"string\">$\"response exception:<span class=\"subst\">&#123;ex.Message&#125;</span>\"</span>);<span class=\"comment\">// &#123;ex.StackTrace&#125;</span></span><br><span class=\"line\">            <span class=\"keyword\">await</span> ResponseUtil.HandleExceptionAsync(<span class=\"number\">500</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>ResponseUtil</strong>Util</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">ResponseUtil</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"statusCode\"&gt;</span>html<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"msg\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Task <span class=\"title\">HandleExceptionAsync</span>(<span class=\"params\"><span class=\"keyword\">int</span> statusCode, <span class=\"keyword\">string</span> msg</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> data = <span class=\"keyword\">new</span> &#123; code = statusCode, msg = msg &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">string</span> text = JsonConvert.SerializeObject(data);</span><br><span class=\"line\">        <span class=\"keyword\">var</span> response = AprilConfig.HttpCurrent.Response;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(response.ContentType))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">//header</span></span><br><span class=\"line\">            response.Headers.Add(<span class=\"string\">\"Access-Control-Allow-Origin\"</span>, <span class=\"string\">\"*\"</span>);</span><br><span class=\"line\">            response.Headers.Add(<span class=\"string\">\"Access-Control-Allow-Credentials\"</span>, <span class=\"string\">\"true\"</span>);</span><br><span class=\"line\">            <span class=\"comment\">//json</span></span><br><span class=\"line\">            response.ContentType = <span class=\"string\">\"application/json;charset=utf-8\"</span>;</span><br><span class=\"line\">            response.StatusCode = <span class=\"number\">200</span>;</span><br><span class=\"line\">            response.ContentLength = text.Length;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> response.WriteAsync(text);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> response.WriteAsync(text);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Startup</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">     <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IHostingEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>     &#123;</span><br><span class=\"line\">         app.UseMiddleware&lt;ExceptionFilter&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">     &#125;</span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/2019/07/30/net-core-aop-1/1.png\" alt=\"Startup\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/07/30/net-core-aop-1/2.png\" alt=\"\"><br><img src=\"/2019/07/30/net-core-aop-1/3.png\" alt=\"\"><br></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>AuthFilter</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AuthFilter</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> RequestDelegate _next;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">AuthFilter</span>(<span class=\"params\">RequestDelegate next</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        _next = next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Task <span class=\"title\">Invoke</span>(<span class=\"params\">HttpContext context</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (context.Request.Method == <span class=\"string\">\"OPTIONS\"</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> _next(context);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> headers = context.Request.Headers;</span><br><span class=\"line\">        <span class=\"comment\">//jwt token</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!headers.ContainsKey(<span class=\"string\">\"Authorization\"</span>))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">string</span> path = context.Request.Path.Value;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!AprilConfig.AllowUrl.Contains(path) &amp;&amp; path.IndexOf(<span class=\"string\">\"swagger\"</span>) &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">//</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> ResponseUtil.HandleExceptionAsync(<span class=\"number\">401</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">//()</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> ResponseUtil.HandleExceptionAsync(<span class=\"number\">-2</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> _next(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Startup</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">     <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IHostingEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>     &#123;</span><br><span class=\"line\">         app.UseMiddleware&lt;ExceptionFilter&gt;();</span><br><span class=\"line\">         app.UseMiddleware&lt;AuthFilter&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">     &#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/07/30/net-core-aop-1/4.png\" alt=\"\"><br>Swagger<br><img src=\"/2019/07/30/net-core-aop-1/5.png\" alt=\"Swagger\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>AOPOOP1%30%<strong>net core3.0ok</strong><br>AOP<strong>AspectCore</strong></p>\n<hr>\n<h3 id=\"-2019-07-31\"><a href=\"#-2019-07-31\" class=\"headerlink\" title=\" 2019-07-31\"></a> 2019-07-31</h3><p><br><img src=\"/2019/07/30/net-core-aop-1/6.png\" alt=\"\"><br><strong></strong>ContentTypebugchrome</p>\n<p><img src=\"/2019/07/30/net-core-aop-1/7.png\" alt=\"\"><br>Length</p>\n<p><img src=\"/2019/07/30/net-core-aop-1/8.png\" alt=\"\"></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>AOPAOP</p>\n<p>AOP</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>Api</strong>Filters<strong>ExceptionFilter</strong></p>\n<p></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">ExceptionFilter</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> RequestDelegate _next;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"next\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ExceptionFilter</span>(<span class=\"params\">RequestDelegate next</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        _next = next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"context\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task <span class=\"title\">Invoke</span>(<span class=\"params\">HttpContext context</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">await</span> _next(context);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (Exception ex) <span class=\"comment\">//</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            context.Response.StatusCode = <span class=\"number\">500</span>;</span><br><span class=\"line\">            LogUtil.Error(<span class=\"string\">$\"response exception:<span class=\"subst\">&#123;ex.Message&#125;</span>\"</span>);<span class=\"comment\">// &#123;ex.StackTrace&#125;</span></span><br><span class=\"line\">            <span class=\"keyword\">await</span> ResponseUtil.HandleExceptionAsync(<span class=\"number\">500</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>ResponseUtil</strong>Util</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">ResponseUtil</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"statusCode\"&gt;</span>html<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"msg\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Task <span class=\"title\">HandleExceptionAsync</span>(<span class=\"params\"><span class=\"keyword\">int</span> statusCode, <span class=\"keyword\">string</span> msg</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> data = <span class=\"keyword\">new</span> &#123; code = statusCode, msg = msg &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">string</span> text = JsonConvert.SerializeObject(data);</span><br><span class=\"line\">        <span class=\"keyword\">var</span> response = AprilConfig.HttpCurrent.Response;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(response.ContentType))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">//header</span></span><br><span class=\"line\">            response.Headers.Add(<span class=\"string\">\"Access-Control-Allow-Origin\"</span>, <span class=\"string\">\"*\"</span>);</span><br><span class=\"line\">            response.Headers.Add(<span class=\"string\">\"Access-Control-Allow-Credentials\"</span>, <span class=\"string\">\"true\"</span>);</span><br><span class=\"line\">            <span class=\"comment\">//json</span></span><br><span class=\"line\">            response.ContentType = <span class=\"string\">\"application/json;charset=utf-8\"</span>;</span><br><span class=\"line\">            response.StatusCode = <span class=\"number\">200</span>;</span><br><span class=\"line\">            response.ContentLength = text.Length;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> response.WriteAsync(text);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> response.WriteAsync(text);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Startup</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">     <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IHostingEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>     &#123;</span><br><span class=\"line\">         app.UseMiddleware&lt;ExceptionFilter&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">     &#125;</span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/2019/07/30/net-core-aop-1/1.png\" alt=\"Startup\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/07/30/net-core-aop-1/2.png\" alt=\"\"><br><img src=\"/2019/07/30/net-core-aop-1/3.png\" alt=\"\"><br></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>AuthFilter</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AuthFilter</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> RequestDelegate _next;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">AuthFilter</span>(<span class=\"params\">RequestDelegate next</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        _next = next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Task <span class=\"title\">Invoke</span>(<span class=\"params\">HttpContext context</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (context.Request.Method == <span class=\"string\">\"OPTIONS\"</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> _next(context);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> headers = context.Request.Headers;</span><br><span class=\"line\">        <span class=\"comment\">//jwt token</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!headers.ContainsKey(<span class=\"string\">\"Authorization\"</span>))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">string</span> path = context.Request.Path.Value;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!AprilConfig.AllowUrl.Contains(path) &amp;&amp; path.IndexOf(<span class=\"string\">\"swagger\"</span>) &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">//</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> ResponseUtil.HandleExceptionAsync(<span class=\"number\">401</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">//()</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> ResponseUtil.HandleExceptionAsync(<span class=\"number\">-2</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> _next(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Startup</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">     <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IHostingEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>     &#123;</span><br><span class=\"line\">         app.UseMiddleware&lt;ExceptionFilter&gt;();</span><br><span class=\"line\">         app.UseMiddleware&lt;AuthFilter&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">     &#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/07/30/net-core-aop-1/4.png\" alt=\"\"><br>Swagger<br><img src=\"/2019/07/30/net-core-aop-1/5.png\" alt=\"Swagger\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>AOPOOP1%30%<strong>net core3.0ok</strong><br>AOP<strong>AspectCore</strong></p>\n<hr>\n<h3 id=\"-2019-07-31\"><a href=\"#-2019-07-31\" class=\"headerlink\" title=\" 2019-07-31\"></a> 2019-07-31</h3><p><br><img src=\"/2019/07/30/net-core-aop-1/6.png\" alt=\"\"><br><strong></strong>ContentTypebugchrome</p>\n<p><img src=\"/2019/07/30/net-core-aop-1/7.png\" alt=\"\"><br>Length</p>\n<p><img src=\"/2019/07/30/net-core-aop-1/8.png\" alt=\"\"></p>\n"},{"title":"net core Webapi","date":"2019-07-02T10:16:23.000Z","_content":"\n### \nnet core[](/2019/07/02/net-core-tools-and-environment/)\n\n### \n\nvs2019->->->\n![](net-core-createprogram/1.png)\nWeb \n![](net-core-createprogram/2.png)\n\n![](net-core-createprogram/3.png)\nHTTPShttps://DockerDockerDocker\n\n![](net-core-createprogram/4.png)\n### \n- **Properties**\nlaunchSettings.jsoniis\n- **Controllers**\nmvcAPIMethodRouterApi\n- **appsettings.json**\nnet coreweb.configjson\n-  **Program.cs**\nStartup\n- **Startup.cs**\nLogSwaggerService\n![Startup.cs](net-core-createprogram/5.png)\n- Startup\n```csharp\n\t\tpublic Startup(IConfiguration configuration)\n        {\n            Configuration = configuration;\n        }\n```\n- ConfigureServices\n\nConfigurationConfigAppKeyappsettings.json.netframeworkAppSettings -,-||\n\n```csharp\n        public void ConfigureServices(IServiceCollection services)\n        {\n            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);\n        }\n```\n\nConfigureservicesSwaggerQuartz\n\n- Configure\n```csharp\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n            if (env.IsDevelopment())\n            {\n                app.UseDeveloperExceptionPage();\n            }\n            else\n            {\n                // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.\n                app.UseHsts();\n            }\n\n            app.UseHttpsRedirection();\n            app.UseMvc();\n        }\n```\nConfigureservicesUse\n\n### \nCtrl+F5ValuesControllerGETPropertiesjsonlaunchUrl\n\n### \n\n\n","source":"_posts/net-core-createprogram.md","raw":"---\ntitle: net core Webapi\ndate: 2019-07-02 18:16:23\ntags: net core\ncategories: AprilBlank\n---\n\n### \nnet core[](/2019/07/02/net-core-tools-and-environment/)\n\n### \n\nvs2019->->->\n![](net-core-createprogram/1.png)\nWeb \n![](net-core-createprogram/2.png)\n\n![](net-core-createprogram/3.png)\nHTTPShttps://DockerDockerDocker\n\n![](net-core-createprogram/4.png)\n### \n- **Properties**\nlaunchSettings.jsoniis\n- **Controllers**\nmvcAPIMethodRouterApi\n- **appsettings.json**\nnet coreweb.configjson\n-  **Program.cs**\nStartup\n- **Startup.cs**\nLogSwaggerService\n![Startup.cs](net-core-createprogram/5.png)\n- Startup\n```csharp\n\t\tpublic Startup(IConfiguration configuration)\n        {\n            Configuration = configuration;\n        }\n```\n- ConfigureServices\n\nConfigurationConfigAppKeyappsettings.json.netframeworkAppSettings -,-||\n\n```csharp\n        public void ConfigureServices(IServiceCollection services)\n        {\n            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);\n        }\n```\n\nConfigureservicesSwaggerQuartz\n\n- Configure\n```csharp\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n            if (env.IsDevelopment())\n            {\n                app.UseDeveloperExceptionPage();\n            }\n            else\n            {\n                // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.\n                app.UseHsts();\n            }\n\n            app.UseHttpsRedirection();\n            app.UseMvc();\n        }\n```\nConfigureservicesUse\n\n### \nCtrl+F5ValuesControllerGETPropertiesjsonlaunchUrl\n\n### \n\n\n","slug":"net-core-createprogram","published":1,"updated":"2019-09-30T05:46:06.972Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2j00129sv71s68td3s","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net core<a href=\"/2019/07/02/net-core-tools-and-environment/\"></a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br>vs2019-&gt;-&gt;-&gt;<br><img src=\"/2019/07/02/net-core-createprogram/1.png\" alt=\"\"><br>Web <br><img src=\"/2019/07/02/net-core-createprogram/2.png\" alt=\"\"><br><br><img src=\"/2019/07/02/net-core-createprogram/3.png\" alt=\"\"><br>HTTPShttps://DockerDockerDocker<br><br><img src=\"/2019/07/02/net-core-createprogram/4.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p><strong>Properties</strong><br>launchSettings.jsoniis</p>\n</li>\n<li><p><strong>Controllers</strong><br>mvcAPIMethodRouterApi</p>\n</li>\n<li><p><strong>appsettings.json</strong><br>net coreweb.configjson</p>\n</li>\n<li><p><strong>Program.cs</strong><br>Startup</p>\n</li>\n<li><p><strong>Startup.cs</strong><br>LogSwaggerService<br><img src=\"/2019/07/02/net-core-createprogram/5.png\" alt=\"Startup.cs\"></p>\n</li>\n<li><p>Startup</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Startup</span>(<span class=\"params\">IConfiguration configuration</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          Configuration = configuration;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>ConfigureServices</p>\n</li>\n</ul>\n<p>ConfigurationConfigAppKeyappsettings.json.netframeworkAppSettings -,-||</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ConfigureservicesSwaggerQuartz</p>\n<ul>\n<li>Configure<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IHostingEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (env.IsDevelopment())</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        app.UseDeveloperExceptionPage();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.</span></span><br><span class=\"line\">        app.UseHsts();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    app.UseHttpsRedirection();</span><br><span class=\"line\">    app.UseMvc();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p>ConfigureservicesUse</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Ctrl+F5ValuesControllerGETPropertiesjsonlaunchUrl</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net core<a href=\"/2019/07/02/net-core-tools-and-environment/\"></a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br>vs2019-&gt;-&gt;-&gt;<br><img src=\"/2019/07/02/net-core-createprogram/1.png\" alt=\"\"><br>Web <br><img src=\"/2019/07/02/net-core-createprogram/2.png\" alt=\"\"><br><br><img src=\"/2019/07/02/net-core-createprogram/3.png\" alt=\"\"><br>HTTPShttps://DockerDockerDocker<br><br><img src=\"/2019/07/02/net-core-createprogram/4.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p><strong>Properties</strong><br>launchSettings.jsoniis</p>\n</li>\n<li><p><strong>Controllers</strong><br>mvcAPIMethodRouterApi</p>\n</li>\n<li><p><strong>appsettings.json</strong><br>net coreweb.configjson</p>\n</li>\n<li><p><strong>Program.cs</strong><br>Startup</p>\n</li>\n<li><p><strong>Startup.cs</strong><br>LogSwaggerService<br><img src=\"/2019/07/02/net-core-createprogram/5.png\" alt=\"Startup.cs\"></p>\n</li>\n<li><p>Startup</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Startup</span>(<span class=\"params\">IConfiguration configuration</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          Configuration = configuration;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>ConfigureServices</p>\n</li>\n</ul>\n<p>ConfigurationConfigAppKeyappsettings.json.netframeworkAppSettings -,-||</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ConfigureservicesSwaggerQuartz</p>\n<ul>\n<li>Configure<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IHostingEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (env.IsDevelopment())</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        app.UseDeveloperExceptionPage();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.</span></span><br><span class=\"line\">        app.UseHsts();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    app.UseHttpsRedirection();</span><br><span class=\"line\">    app.UseMvc();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p>ConfigureservicesUse</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Ctrl+F5ValuesControllerGETPropertiesjsonlaunchUrl</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n"},{"title":"laravel ","date":"2019-04-09T15:00:00.000Z","_content":"\n laravel \n![](laravel-queues/laravel.jpg)\n\n Web \n\n BeanstalkAmazon SQSRedis \n<!-- more -->\n\n#### \nlaravel API `config/queue.php` \n\n queue \n\n```php\n// \nJob::dispatch();\n\n//  emails \nJob::dispatch()->onQueue('emails');\n```\n\n `QUEUE_DRIVER``QUEUE_CONNECTION` ,  `sync`\n\n redis \n\n laravel  redis  predis\n\n```composer\ncomposer require 'predis/predis'\n```\n\n\n```env\nMAIL_DRIVER=smtp\nMAIL_HOST=smtp.mxhichina.com\nMAIL_PORT=25\nMAIL_USERNAME=m@m-finder.com\nMAIL_PASSWORD=xxxxxx\nMAIL_ENCRYPTION=null\nMAIL_FROM_NAME=M-finder\nMAIL_FROM_ADDRESS=m@m-finder.com\n```\n\n#### \n`php artisan make:job EmailJob` `app/jobs` \n\n\n```php\npublic function handle() {\n    $email = $this->email;\n    $content = 'Laravel.';\n    Mail::raw($content, function ($message) use ($email) {\n        $message->subject('[  ] SendMail - ' . date('Y-m-d H:i:s'));\n        $message->to($email);\n    });\n}\n```\n\n#### \n\n\n\n```php\nEmailJob::dispatch($guard->user)->onQueue('emails');\n```\n\n#### \n```php\nphp artisan queue:work --tries=3 --timeout=30 --queue=emails \n```\n\n\n\n\n![](laravel-queues/email.png)\n\n\n","source":"_posts/laravel-queues.md","raw":"---\ntitle: laravel \ndate: 2019-04-09 23:00:00\ntags: laravel\ncategories: \n---\n\n laravel \n![](laravel-queues/laravel.jpg)\n\n Web \n\n BeanstalkAmazon SQSRedis \n<!-- more -->\n\n#### \nlaravel API `config/queue.php` \n\n queue \n\n```php\n// \nJob::dispatch();\n\n//  emails \nJob::dispatch()->onQueue('emails');\n```\n\n `QUEUE_DRIVER``QUEUE_CONNECTION` ,  `sync`\n\n redis \n\n laravel  redis  predis\n\n```composer\ncomposer require 'predis/predis'\n```\n\n\n```env\nMAIL_DRIVER=smtp\nMAIL_HOST=smtp.mxhichina.com\nMAIL_PORT=25\nMAIL_USERNAME=m@m-finder.com\nMAIL_PASSWORD=xxxxxx\nMAIL_ENCRYPTION=null\nMAIL_FROM_NAME=M-finder\nMAIL_FROM_ADDRESS=m@m-finder.com\n```\n\n#### \n`php artisan make:job EmailJob` `app/jobs` \n\n\n```php\npublic function handle() {\n    $email = $this->email;\n    $content = 'Laravel.';\n    Mail::raw($content, function ($message) use ($email) {\n        $message->subject('[  ] SendMail - ' . date('Y-m-d H:i:s'));\n        $message->to($email);\n    });\n}\n```\n\n#### \n\n\n\n```php\nEmailJob::dispatch($guard->user)->onQueue('emails');\n```\n\n#### \n```php\nphp artisan queue:work --tries=3 --timeout=30 --queue=emails \n```\n\n\n\n\n![](laravel-queues/email.png)\n\n\n","slug":"laravel-queues","published":1,"updated":"2019-09-30T05:50:50.872Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2k00159sv7y039seov","content":"<p> laravel <br><img src=\"/2019/04/09/laravel-queues/laravel.jpg\" alt></p>\n<p> Web </p>\n<p> BeanstalkAmazon SQSRedis </p>\n<a id=\"more\"></a>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>laravel API <code>config/queue.php</code> </p>\n<p> queue </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">Job::dispatch();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  emails </span></span><br><span class=\"line\">Job::dispatch()-&gt;onQueue(<span class=\"string\">'emails'</span>);</span><br></pre></td></tr></table></figure>\n\n<p> <code>QUEUE_DRIVER</code><code>QUEUE_CONNECTION</code> ,  <code>sync</code></p>\n<p> redis </p>\n<p> laravel  redis  predis</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">composer require &apos;predis/predis&apos;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MAIL_DRIVER=smtp</span><br><span class=\"line\">MAIL_HOST=smtp.mxhichina.com</span><br><span class=\"line\">MAIL_PORT=25</span><br><span class=\"line\">MAIL_USERNAME=m@m-finder.com</span><br><span class=\"line\">MAIL_PASSWORD=xxxxxx</span><br><span class=\"line\">MAIL_ENCRYPTION=null</span><br><span class=\"line\">MAIL_FROM_NAME=M-finder</span><br><span class=\"line\">MAIL_FROM_ADDRESS=m@m-finder.com</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><code>php artisan make:job EmailJob</code> <code>app/jobs</code> </p>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">handle</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    $email = <span class=\"keyword\">$this</span>-&gt;email;</span><br><span class=\"line\">    $content = <span class=\"string\">'Laravel.'</span>;</span><br><span class=\"line\">    Mail::raw($content, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($message)</span> <span class=\"title\">use</span> <span class=\"params\">($email)</span> </span>&#123;</span><br><span class=\"line\">        $message-&gt;subject(<span class=\"string\">'[  ] SendMail - '</span> . date(<span class=\"string\">'Y-m-d H:i:s'</span>));</span><br><span class=\"line\">        $message-&gt;to($email);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EmailJob::dispatch($guard-&gt;user)-&gt;onQueue(<span class=\"string\">'emails'</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php artisan queue:work --tries=<span class=\"number\">3</span> --timeout=<span class=\"number\">30</span> --queue=emails</span><br></pre></td></tr></table></figure>\n\n<p><br></p>\n<p><img src=\"/2019/04/09/laravel-queues/email.png\" alt=\"\"></p>\n<p></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"<p> laravel <br><img src=\"/2019/04/09/laravel-queues/laravel.jpg\" alt></p>\n<p> Web </p>\n<p> BeanstalkAmazon SQSRedis </p>","more":"<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>laravel API <code>config/queue.php</code> </p>\n<p> queue </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">Job::dispatch();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  emails </span></span><br><span class=\"line\">Job::dispatch()-&gt;onQueue(<span class=\"string\">'emails'</span>);</span><br></pre></td></tr></table></figure>\n\n<p> <code>QUEUE_DRIVER</code><code>QUEUE_CONNECTION</code> ,  <code>sync</code></p>\n<p> redis </p>\n<p> laravel  redis  predis</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">composer require &apos;predis/predis&apos;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MAIL_DRIVER=smtp</span><br><span class=\"line\">MAIL_HOST=smtp.mxhichina.com</span><br><span class=\"line\">MAIL_PORT=25</span><br><span class=\"line\">MAIL_USERNAME=m@m-finder.com</span><br><span class=\"line\">MAIL_PASSWORD=xxxxxx</span><br><span class=\"line\">MAIL_ENCRYPTION=null</span><br><span class=\"line\">MAIL_FROM_NAME=M-finder</span><br><span class=\"line\">MAIL_FROM_ADDRESS=m@m-finder.com</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><code>php artisan make:job EmailJob</code> <code>app/jobs</code> </p>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">handle</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    $email = <span class=\"keyword\">$this</span>-&gt;email;</span><br><span class=\"line\">    $content = <span class=\"string\">'Laravel.'</span>;</span><br><span class=\"line\">    Mail::raw($content, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($message)</span> <span class=\"title\">use</span> <span class=\"params\">($email)</span> </span>&#123;</span><br><span class=\"line\">        $message-&gt;subject(<span class=\"string\">'[  ] SendMail - '</span> . date(<span class=\"string\">'Y-m-d H:i:s'</span>));</span><br><span class=\"line\">        $message-&gt;to($email);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EmailJob::dispatch($guard-&gt;user)-&gt;onQueue(<span class=\"string\">'emails'</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php artisan queue:work --tries=<span class=\"number\">3</span> --timeout=<span class=\"number\">30</span> --queue=emails</span><br></pre></td></tr></table></figure>\n\n<p><br></p>\n<p><img src=\"/2019/04/09/laravel-queues/email.png\" alt=\"\"></p>\n<p></p>"},{"title":"net core WebapiSwagger","date":"2019-07-02T10:51:48.000Z","_content":"\n### \nJsonApi\n### Swagger\nSwaggerJsonSwaggerJava.net****\n### NuGet\n->NuGet->NuGet...\n****\"Swashbuckle.AspNetCore\"\n![](net-core-swagger/1.png)\nStartup.csConfigureServices\n```csharp\n        public void ConfigureServices(IServiceCollection services)\n        {\n            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);\n            \n           #region Swagger\n            services.AddSwaggerGen(options =>\n            {\n                options.SwaggerDoc(\"v1\", new Info\n                {\n                    Version = \"v1.1.0\",\n                    Title = \"April WebAPI\",\n                    Description = \"\",\n                    TermsOfService = \"None\",\n                    Contact = new Contact { Name = \"Blank\", Email = \"1829027193@qq.com\", Url = \"http://www.aprilblank.com\" }\n                });\n            });\n            #endregion \n        }\n```\nStartup.csConfigure\n```csharp\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n           \n           \n            #region Swagger\n            app.UseSwagger();\n            app.UseSwaggerUI(options =>\n            {\n                options.SwaggerEndpoint(\"/net-core-swagger/v1/swagger.json\", \"ApiHelp V1\");\n            });\n            #endregion\n\n            app.UseHttpsRedirection();\n            app.UseMvc();\n        }\n```\n\n/swagger\n![Swagger](net-core-swagger/2.png)\n### \n\n\n### \nStartup.csConfigureServices\n```csharp\n        public void ConfigureServices(IServiceCollection services)\n        {\n            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);\n            #region Swagger\n            services.AddSwaggerGen(options =>\n            {\n                options.SwaggerDoc(\"v1\", new Info\n                {\n                    Version = \"v1.1.0\",\n                    Title = \"April WebAPI\",\n                    Description = \"\",\n                    TermsOfService = \"None\",\n                    Contact = new Contact { Name = \"Blank\", Email = \"790048789@qq.com\", Url = \"http://www.aprilblank.com\" }\n                });\n                \n                //  Swagger JSON and UIxml\n                var basePath = Path.GetDirectoryName(AppContext.BaseDirectory);//\n                var xmlPath = Path.Combine(basePath, \"April.xml\");\n                options.IncludeXmlComments(xmlPath);\n                \n            });\n            #endregion\n        }\n```\n\nWebApi\n\n![XML](net-core-swagger/3.png)\n\nValues\n![Values](net-core-swagger/4.png)\nApirl.xml/Swagger\n![Swagger](net-core-swagger/5.png)\n/api/Values/{id}\n![Swagger](net-core-swagger/6.png)\n#### \nWebApiSwaggerPostman\n\n**Log**","source":"_posts/net-core-swagger.md","raw":"---\ntitle: net core WebapiSwagger\ndate: 2019-07-02 18:51:48\ntags: net core\ncategories: AprilBlank\n---\n\n### \nJsonApi\n### Swagger\nSwaggerJsonSwaggerJava.net****\n### NuGet\n->NuGet->NuGet...\n****\"Swashbuckle.AspNetCore\"\n![](net-core-swagger/1.png)\nStartup.csConfigureServices\n```csharp\n        public void ConfigureServices(IServiceCollection services)\n        {\n            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);\n            \n           #region Swagger\n            services.AddSwaggerGen(options =>\n            {\n                options.SwaggerDoc(\"v1\", new Info\n                {\n                    Version = \"v1.1.0\",\n                    Title = \"April WebAPI\",\n                    Description = \"\",\n                    TermsOfService = \"None\",\n                    Contact = new Contact { Name = \"Blank\", Email = \"1829027193@qq.com\", Url = \"http://www.aprilblank.com\" }\n                });\n            });\n            #endregion \n        }\n```\nStartup.csConfigure\n```csharp\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n           \n           \n            #region Swagger\n            app.UseSwagger();\n            app.UseSwaggerUI(options =>\n            {\n                options.SwaggerEndpoint(\"/net-core-swagger/v1/swagger.json\", \"ApiHelp V1\");\n            });\n            #endregion\n\n            app.UseHttpsRedirection();\n            app.UseMvc();\n        }\n```\n\n/swagger\n![Swagger](net-core-swagger/2.png)\n### \n\n\n### \nStartup.csConfigureServices\n```csharp\n        public void ConfigureServices(IServiceCollection services)\n        {\n            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);\n            #region Swagger\n            services.AddSwaggerGen(options =>\n            {\n                options.SwaggerDoc(\"v1\", new Info\n                {\n                    Version = \"v1.1.0\",\n                    Title = \"April WebAPI\",\n                    Description = \"\",\n                    TermsOfService = \"None\",\n                    Contact = new Contact { Name = \"Blank\", Email = \"790048789@qq.com\", Url = \"http://www.aprilblank.com\" }\n                });\n                \n                //  Swagger JSON and UIxml\n                var basePath = Path.GetDirectoryName(AppContext.BaseDirectory);//\n                var xmlPath = Path.Combine(basePath, \"April.xml\");\n                options.IncludeXmlComments(xmlPath);\n                \n            });\n            #endregion\n        }\n```\n\nWebApi\n\n![XML](net-core-swagger/3.png)\n\nValues\n![Values](net-core-swagger/4.png)\nApirl.xml/Swagger\n![Swagger](net-core-swagger/5.png)\n/api/Values/{id}\n![Swagger](net-core-swagger/6.png)\n#### \nWebApiSwaggerPostman\n\n**Log**","slug":"net-core-swagger","published":1,"updated":"2019-09-30T05:47:20.933Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2l00179sv7u7ejlici","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>JsonApi</p>\n<h3 id=\"Swagger\"><a href=\"#Swagger\" class=\"headerlink\" title=\"Swagger\"></a>Swagger</h3><p>SwaggerJsonSwaggerJava.net<strong></strong></p>\n<h3 id=\"NuGet\"><a href=\"#NuGet\" class=\"headerlink\" title=\"NuGet\"></a>NuGet</h3><p>-&gt;NuGet-&gt;NuGet<br><strong></strong>Swashbuckle.AspNetCore<br><img src=\"/2019/07/02/net-core-swagger/1.png\" alt=\"\"><br>Startup.csConfigureServices</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);</span><br><span class=\"line\">    </span><br><span class=\"line\">   <span class=\"meta\">#<span class=\"meta-keyword\">region</span> Swagger</span></span><br><span class=\"line\">    services.AddSwaggerGen(options =&gt;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        options.SwaggerDoc(<span class=\"string\">\"v1\"</span>, <span class=\"keyword\">new</span> Info</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Version = <span class=\"string\">\"v1.1.0\"</span>,</span><br><span class=\"line\">            Title = <span class=\"string\">\"April WebAPI\"</span>,</span><br><span class=\"line\">            Description = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">            TermsOfService = <span class=\"string\">\"None\"</span>,</span><br><span class=\"line\">            Contact = <span class=\"keyword\">new</span> Contact &#123; Name = <span class=\"string\">\"Blank\"</span>, Email = <span class=\"string\">\"1829027193@qq.com\"</span>, Url = <span class=\"string\">\"http://www.aprilblank.com\"</span> &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endregion</span> </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Startup.csConfigure</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IHostingEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">   </span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">region</span> Swagger</span></span><br><span class=\"line\">    app.UseSwagger();</span><br><span class=\"line\">    app.UseSwaggerUI(options =&gt;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        options.SwaggerEndpoint(<span class=\"string\">\"/net-core-swagger/v1/swagger.json\"</span>, <span class=\"string\">\"ApiHelp V1\"</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">    app.UseHttpsRedirection();</span><br><span class=\"line\">    app.UseMvc();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>/swagger<br><img src=\"/2019/07/02/net-core-swagger/2.png\" alt=\"Swagger\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Startup.csConfigureServices</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">region</span> Swagger</span></span><br><span class=\"line\">    services.AddSwaggerGen(options =&gt;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        options.SwaggerDoc(<span class=\"string\">\"v1\"</span>, <span class=\"keyword\">new</span> Info</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Version = <span class=\"string\">\"v1.1.0\"</span>,</span><br><span class=\"line\">            Title = <span class=\"string\">\"April WebAPI\"</span>,</span><br><span class=\"line\">            Description = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">            TermsOfService = <span class=\"string\">\"None\"</span>,</span><br><span class=\"line\">            Contact = <span class=\"keyword\">new</span> Contact &#123; Name = <span class=\"string\">\"Blank\"</span>, Email = <span class=\"string\">\"790048789@qq.com\"</span>, Url = <span class=\"string\">\"http://www.aprilblank.com\"</span> &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">//  Swagger JSON and UIxml</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> basePath = Path.GetDirectoryName(AppContext.BaseDirectory);<span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> xmlPath = Path.Combine(basePath, <span class=\"string\">\"April.xml\"</span>);</span><br><span class=\"line\">        options.IncludeXmlComments(xmlPath);</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>WebApi</p>\n<p><img src=\"/2019/07/02/net-core-swagger/3.png\" alt=\"XML\"></p>\n<p>Values<br><img src=\"/2019/07/02/net-core-swagger/4.png\" alt=\"Values\"><br>Apirl.xml/Swagger<br><img src=\"/2019/07/02/net-core-swagger/5.png\" alt=\"Swagger\"><br>/api/Values/{id}<br><img src=\"/2019/07/02/net-core-swagger/6.png\" alt=\"Swagger\"></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>WebApiSwaggerPostman</p>\n<p><strong>Log</strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>JsonApi</p>\n<h3 id=\"Swagger\"><a href=\"#Swagger\" class=\"headerlink\" title=\"Swagger\"></a>Swagger</h3><p>SwaggerJsonSwaggerJava.net<strong></strong></p>\n<h3 id=\"NuGet\"><a href=\"#NuGet\" class=\"headerlink\" title=\"NuGet\"></a>NuGet</h3><p>-&gt;NuGet-&gt;NuGet<br><strong></strong>Swashbuckle.AspNetCore<br><img src=\"/2019/07/02/net-core-swagger/1.png\" alt=\"\"><br>Startup.csConfigureServices</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);</span><br><span class=\"line\">    </span><br><span class=\"line\">   <span class=\"meta\">#<span class=\"meta-keyword\">region</span> Swagger</span></span><br><span class=\"line\">    services.AddSwaggerGen(options =&gt;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        options.SwaggerDoc(<span class=\"string\">\"v1\"</span>, <span class=\"keyword\">new</span> Info</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Version = <span class=\"string\">\"v1.1.0\"</span>,</span><br><span class=\"line\">            Title = <span class=\"string\">\"April WebAPI\"</span>,</span><br><span class=\"line\">            Description = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">            TermsOfService = <span class=\"string\">\"None\"</span>,</span><br><span class=\"line\">            Contact = <span class=\"keyword\">new</span> Contact &#123; Name = <span class=\"string\">\"Blank\"</span>, Email = <span class=\"string\">\"1829027193@qq.com\"</span>, Url = <span class=\"string\">\"http://www.aprilblank.com\"</span> &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endregion</span> </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Startup.csConfigure</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IHostingEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">   </span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">region</span> Swagger</span></span><br><span class=\"line\">    app.UseSwagger();</span><br><span class=\"line\">    app.UseSwaggerUI(options =&gt;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        options.SwaggerEndpoint(<span class=\"string\">\"/net-core-swagger/v1/swagger.json\"</span>, <span class=\"string\">\"ApiHelp V1\"</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">    app.UseHttpsRedirection();</span><br><span class=\"line\">    app.UseMvc();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>/swagger<br><img src=\"/2019/07/02/net-core-swagger/2.png\" alt=\"Swagger\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Startup.csConfigureServices</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">region</span> Swagger</span></span><br><span class=\"line\">    services.AddSwaggerGen(options =&gt;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        options.SwaggerDoc(<span class=\"string\">\"v1\"</span>, <span class=\"keyword\">new</span> Info</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Version = <span class=\"string\">\"v1.1.0\"</span>,</span><br><span class=\"line\">            Title = <span class=\"string\">\"April WebAPI\"</span>,</span><br><span class=\"line\">            Description = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">            TermsOfService = <span class=\"string\">\"None\"</span>,</span><br><span class=\"line\">            Contact = <span class=\"keyword\">new</span> Contact &#123; Name = <span class=\"string\">\"Blank\"</span>, Email = <span class=\"string\">\"790048789@qq.com\"</span>, Url = <span class=\"string\">\"http://www.aprilblank.com\"</span> &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">//  Swagger JSON and UIxml</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> basePath = Path.GetDirectoryName(AppContext.BaseDirectory);<span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> xmlPath = Path.Combine(basePath, <span class=\"string\">\"April.xml\"</span>);</span><br><span class=\"line\">        options.IncludeXmlComments(xmlPath);</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>WebApi</p>\n<p><img src=\"/2019/07/02/net-core-swagger/3.png\" alt=\"XML\"></p>\n<p>Values<br><img src=\"/2019/07/02/net-core-swagger/4.png\" alt=\"Values\"><br>Apirl.xml/Swagger<br><img src=\"/2019/07/02/net-core-swagger/5.png\" alt=\"Swagger\"><br>/api/Values/{id}<br><img src=\"/2019/07/02/net-core-swagger/6.png\" alt=\"Swagger\"></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>WebApiSwaggerPostman</p>\n<p><strong>Log</strong></p>\n"},{"title":"net core Webapilog4net","date":"2019-07-04T07:56:02.000Z","_content":"\n### \nStream\n\n.netNLoglog4log4Log4\n\n### log4net\nlog4netframeworkconfigNLog\n\n### NuGet\n->NuGet->NuGet\n\"log4\"\n![log4](net-core-log4net/1.png)\nStartup.cs\n```csharp\n        public Startup(IConfiguration configuration)\n        {\n            Configuration = configuration;\n\n            repository = LogManager.CreateRepository(\"AprilLog\");\n\n            XmlConfigurator.Configure(repository, new FileInfo(\"Config/log4net.config\"));//\n            BasicConfigurator.Configure(repository);\n        }\n\n        //log4net\n        public static ILoggerRepository repository { get; set; }\n```\n\nconfig\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\n<configuration>\n  <!-- This section contains the log4net configuration settings -->\n  <log4net debug=\"false\">\n    <appender name=\"RollingLogFileAppender\" type=\"log4net.Appender.RollingFileAppender\">\n      <lockingModel type=\"log4net.Appender.FileAppender+MinimalLock\" /><!---->\n      <file value=\"logs/\" /> <!--  -->\n      <appendToFile value=\"true\" /> \n      <rollingStyle value=\"Composite\" />\n      <staticLogFileName value=\"false\" />\n      <datePattern value=\"yyyyMMdd'.log'\" /> <!--  -->\n      <maxSizeRollBackups value=\"10\" />\n      <maximumFileSize value=\"10MB\" /> <!--  -->\n      <layout type=\"log4net.Layout.PatternLayout\">\n        <conversionPattern value=\"%date [%thread] %-5level %logger - %message%newline\" /> <!--  -->\n      </layout>\n    </appender>\n\n    <!-- Setup the root category, add the appenders and set the default level -->\n    <root>\n      <level value=\"ALL\" />  <!--  -->\n      <appender-ref ref=\"RollingLogFileAppender\" /> \n    </root>\n\n  </log4net>\n</configuration>\n```\n\n![log4](net-core-log4net/2.png)\nOKLog\n```csharp\n\tprivate ILog log = LogManager.GetLogger(Startup.repository.Name, \"Name\");\n\t\n\tlog.Info(\"\");\n```\n\nValues\n![](net-core-log4net/3.png)\n\nlogs\n![log](net-core-log4net/4.png)\n\n\n### LogUtil\n\n\nApirl.Util-,-||\n![](net-core-log4net/5.png)\nClass.cs\n\nlog4netNuGetUtil\n\nWebApiUtil\n![](net-core-log4net/6.png)\nUtil\n![](net-core-log4net/7.png)\n\n> NuGetUtillog4WebApi\n\nLogUtil\n```csharp\n\tpublic class LogUtil\n    {\n        private static readonly ILog log = LogManager.GetLogger(\"AprilLog\", typeof(LogUtil));\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"msg\"></param>\n        /// <param name=\"obj\"></param>\n        public static void Debug(string msg, object obj = null)\n        {\n            if (log.IsDebugEnabled && !string.IsNullOrEmpty(msg))\n            {\n                if (obj == null)\n                {\n                    log.Debug(msg);\n                }\n                else\n                {\n                    log.DebugFormat(msg, obj);\n                }\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"msg\"></param>\n        /// <param name=\"obj\"></param>\n        public static void Info(string msg, object obj = null)\n        {\n            if (log.IsInfoEnabled && !string.IsNullOrEmpty(msg))\n            {\n                if (obj == null)\n                {\n                    log.Info(msg);\n                }\n                else\n                {\n                    log.InfoFormat(msg, obj);\n                }\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"msg\"></param>\n        /// <param name=\"obj\"></param>\n        public static void Error(string msg, object obj = null)\n        {\n            if (log.IsErrorEnabled && !string.IsNullOrEmpty(msg))\n            {\n                if (obj == null)\n                {\n                    log.Error(msg);\n                }\n                else\n                {\n                    log.ErrorFormat(msg, obj);\n                }\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"msg\"></param>\n        /// <param name=\"obj\"></param>\n        public static void Fatal(string msg, object obj = null)\n        {\n            if (log.IsFatalEnabled && !string.IsNullOrEmpty(msg))\n            {\n                if (obj == null)\n                {\n                    log.Fatal(msg);\n                }\n                else\n                {\n                    log.FatalFormat(msg, obj);\n                }\n            }\n        }\n\n    }\n```\n\nValuesControllerWhy\n![Values](net-core-log4net/8.png)\n\n![log](net-core-log4net/9.png)\n### \n\n\n****","source":"_posts/net-core-log4net.md","raw":"---\ntitle: net core Webapilog4net\ndate: 2019-07-04 15:56:02\ntags: net core\ncategories: AprilBlank\n---\n\n### \nStream\n\n.netNLoglog4log4Log4\n\n### log4net\nlog4netframeworkconfigNLog\n\n### NuGet\n->NuGet->NuGet\n\"log4\"\n![log4](net-core-log4net/1.png)\nStartup.cs\n```csharp\n        public Startup(IConfiguration configuration)\n        {\n            Configuration = configuration;\n\n            repository = LogManager.CreateRepository(\"AprilLog\");\n\n            XmlConfigurator.Configure(repository, new FileInfo(\"Config/log4net.config\"));//\n            BasicConfigurator.Configure(repository);\n        }\n\n        //log4net\n        public static ILoggerRepository repository { get; set; }\n```\n\nconfig\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\n<configuration>\n  <!-- This section contains the log4net configuration settings -->\n  <log4net debug=\"false\">\n    <appender name=\"RollingLogFileAppender\" type=\"log4net.Appender.RollingFileAppender\">\n      <lockingModel type=\"log4net.Appender.FileAppender+MinimalLock\" /><!---->\n      <file value=\"logs/\" /> <!--  -->\n      <appendToFile value=\"true\" /> \n      <rollingStyle value=\"Composite\" />\n      <staticLogFileName value=\"false\" />\n      <datePattern value=\"yyyyMMdd'.log'\" /> <!--  -->\n      <maxSizeRollBackups value=\"10\" />\n      <maximumFileSize value=\"10MB\" /> <!--  -->\n      <layout type=\"log4net.Layout.PatternLayout\">\n        <conversionPattern value=\"%date [%thread] %-5level %logger - %message%newline\" /> <!--  -->\n      </layout>\n    </appender>\n\n    <!-- Setup the root category, add the appenders and set the default level -->\n    <root>\n      <level value=\"ALL\" />  <!--  -->\n      <appender-ref ref=\"RollingLogFileAppender\" /> \n    </root>\n\n  </log4net>\n</configuration>\n```\n\n![log4](net-core-log4net/2.png)\nOKLog\n```csharp\n\tprivate ILog log = LogManager.GetLogger(Startup.repository.Name, \"Name\");\n\t\n\tlog.Info(\"\");\n```\n\nValues\n![](net-core-log4net/3.png)\n\nlogs\n![log](net-core-log4net/4.png)\n\n\n### LogUtil\n\n\nApirl.Util-,-||\n![](net-core-log4net/5.png)\nClass.cs\n\nlog4netNuGetUtil\n\nWebApiUtil\n![](net-core-log4net/6.png)\nUtil\n![](net-core-log4net/7.png)\n\n> NuGetUtillog4WebApi\n\nLogUtil\n```csharp\n\tpublic class LogUtil\n    {\n        private static readonly ILog log = LogManager.GetLogger(\"AprilLog\", typeof(LogUtil));\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"msg\"></param>\n        /// <param name=\"obj\"></param>\n        public static void Debug(string msg, object obj = null)\n        {\n            if (log.IsDebugEnabled && !string.IsNullOrEmpty(msg))\n            {\n                if (obj == null)\n                {\n                    log.Debug(msg);\n                }\n                else\n                {\n                    log.DebugFormat(msg, obj);\n                }\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"msg\"></param>\n        /// <param name=\"obj\"></param>\n        public static void Info(string msg, object obj = null)\n        {\n            if (log.IsInfoEnabled && !string.IsNullOrEmpty(msg))\n            {\n                if (obj == null)\n                {\n                    log.Info(msg);\n                }\n                else\n                {\n                    log.InfoFormat(msg, obj);\n                }\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"msg\"></param>\n        /// <param name=\"obj\"></param>\n        public static void Error(string msg, object obj = null)\n        {\n            if (log.IsErrorEnabled && !string.IsNullOrEmpty(msg))\n            {\n                if (obj == null)\n                {\n                    log.Error(msg);\n                }\n                else\n                {\n                    log.ErrorFormat(msg, obj);\n                }\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"msg\"></param>\n        /// <param name=\"obj\"></param>\n        public static void Fatal(string msg, object obj = null)\n        {\n            if (log.IsFatalEnabled && !string.IsNullOrEmpty(msg))\n            {\n                if (obj == null)\n                {\n                    log.Fatal(msg);\n                }\n                else\n                {\n                    log.FatalFormat(msg, obj);\n                }\n            }\n        }\n\n    }\n```\n\nValuesControllerWhy\n![Values](net-core-log4net/8.png)\n\n![log](net-core-log4net/9.png)\n### \n\n\n****","slug":"net-core-log4net","published":1,"updated":"2019-09-30T05:46:21.165Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2m001b9sv7ee53sshk","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Stream</p>\n<p>.netNLoglog4log4Log4</p>\n<h3 id=\"log4net\"><a href=\"#log4net\" class=\"headerlink\" title=\"log4net\"></a>log4net</h3><p>log4netframeworkconfigNLog</p>\n<h3 id=\"NuGet\"><a href=\"#NuGet\" class=\"headerlink\" title=\"NuGet\"></a>NuGet</h3><p>-&gt;NuGet-&gt;NuGet<br>log4<br><img src=\"/2019/07/04/net-core-log4net/1.png\" alt=\"log4\"><br>Startup.cs</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Startup</span>(<span class=\"params\">IConfiguration configuration</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    Configuration = configuration;</span><br><span class=\"line\"></span><br><span class=\"line\">    repository = LogManager.CreateRepository(<span class=\"string\">\"AprilLog\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    XmlConfigurator.Configure(repository, <span class=\"keyword\">new</span> FileInfo(<span class=\"string\">\"Config/log4net.config\"</span>));<span class=\"comment\">//</span></span><br><span class=\"line\">    BasicConfigurator.Configure(repository);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//log4net</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> ILoggerRepository repository &#123; <span class=\"keyword\">get</span>; <span class=\"keyword\">set</span>; &#125;</span><br></pre></td></tr></table></figure>\n\n<p>config</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- This section contains the log4net configuration settings --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">log4net</span> <span class=\"attr\">debug</span>=<span class=\"string\">\"false\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">appender</span> <span class=\"attr\">name</span>=<span class=\"string\">\"RollingLogFileAppender\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"log4net.Appender.RollingFileAppender\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">lockingModel</span> <span class=\"attr\">type</span>=<span class=\"string\">\"log4net.Appender.FileAppender+MinimalLock\"</span> /&gt;</span><span class=\"comment\">&lt;!----&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">file</span> <span class=\"attr\">value</span>=<span class=\"string\">\"logs/\"</span> /&gt;</span> <span class=\"comment\">&lt;!--  --&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">appendToFile</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span> /&gt;</span> </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">rollingStyle</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Composite\"</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">staticLogFileName</span> <span class=\"attr\">value</span>=<span class=\"string\">\"false\"</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">datePattern</span> <span class=\"attr\">value</span>=<span class=\"string\">\"yyyyMMdd'.log'\"</span> /&gt;</span> <span class=\"comment\">&lt;!--  --&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">maxSizeRollBackups</span> <span class=\"attr\">value</span>=<span class=\"string\">\"10\"</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">maximumFileSize</span> <span class=\"attr\">value</span>=<span class=\"string\">\"10MB\"</span> /&gt;</span> <span class=\"comment\">&lt;!--  --&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">layout</span> <span class=\"attr\">type</span>=<span class=\"string\">\"log4net.Layout.PatternLayout\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">conversionPattern</span> <span class=\"attr\">value</span>=<span class=\"string\">\"%date [%thread] %-5level %logger - %message%newline\"</span> /&gt;</span> <span class=\"comment\">&lt;!--  --&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">layout</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">appender</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- Setup the root category, add the appenders and set the default level --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">root</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">level</span> <span class=\"attr\">value</span>=<span class=\"string\">\"ALL\"</span> /&gt;</span>  <span class=\"comment\">&lt;!--  --&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">appender-ref</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"RollingLogFileAppender\"</span> /&gt;</span> </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">root</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">log4net</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/2019/07/04/net-core-log4net/2.png\" alt=\"log4\"><br>OKLog</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> ILog log = LogManager.GetLogger(Startup.repository.Name, <span class=\"string\">\"Name\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">log.Info(<span class=\"string\">\"\"</span>);</span><br></pre></td></tr></table></figure>\n\n<p>Values<br><img src=\"/2019/07/04/net-core-log4net/3.png\" alt=\"\"></p>\n<p>logs<br><img src=\"/2019/07/04/net-core-log4net/4.png\" alt=\"log\"><br></p>\n<h3 id=\"LogUtil\"><a href=\"#LogUtil\" class=\"headerlink\" title=\"LogUtil\"></a>LogUtil</h3><p></p>\n<p>Apirl.Util-,-||<br><img src=\"/2019/07/04/net-core-log4net/5.png\" alt=\"\"><br>Class.cs</p>\n<p>log4netNuGetUtil</p>\n<p>WebApiUtil<br><img src=\"/2019/07/04/net-core-log4net/6.png\" alt=\"\"><br>Util<br><img src=\"/2019/07/04/net-core-log4net/7.png\" alt=\"\"></p>\n<blockquote>\n<p>NuGetUtillog4WebApi</p>\n</blockquote>\n<p>LogUtil</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">LogUtil</span></span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">       <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">readonly</span> ILog log = LogManager.GetLogger(<span class=\"string\">\"AprilLog\"</span>, <span class=\"keyword\">typeof</span>(LogUtil));</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"msg\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"obj\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Debug</span>(<span class=\"params\"><span class=\"keyword\">string</span> msg, <span class=\"keyword\">object</span> obj = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (log.IsDebugEnabled &amp;&amp; !<span class=\"keyword\">string</span>.IsNullOrEmpty(msg))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"keyword\">if</span> (obj == <span class=\"literal\">null</span>)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.Debug(msg);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               <span class=\"keyword\">else</span></span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.DebugFormat(msg, obj);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"msg\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"obj\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Info</span>(<span class=\"params\"><span class=\"keyword\">string</span> msg, <span class=\"keyword\">object</span> obj = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (log.IsInfoEnabled &amp;&amp; !<span class=\"keyword\">string</span>.IsNullOrEmpty(msg))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"keyword\">if</span> (obj == <span class=\"literal\">null</span>)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.Info(msg);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               <span class=\"keyword\">else</span></span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.InfoFormat(msg, obj);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"msg\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"obj\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Error</span>(<span class=\"params\"><span class=\"keyword\">string</span> msg, <span class=\"keyword\">object</span> obj = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (log.IsErrorEnabled &amp;&amp; !<span class=\"keyword\">string</span>.IsNullOrEmpty(msg))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"keyword\">if</span> (obj == <span class=\"literal\">null</span>)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.Error(msg);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               <span class=\"keyword\">else</span></span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.ErrorFormat(msg, obj);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"msg\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"obj\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Fatal</span>(<span class=\"params\"><span class=\"keyword\">string</span> msg, <span class=\"keyword\">object</span> obj = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (log.IsFatalEnabled &amp;&amp; !<span class=\"keyword\">string</span>.IsNullOrEmpty(msg))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"keyword\">if</span> (obj == <span class=\"literal\">null</span>)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.Fatal(msg);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               <span class=\"keyword\">else</span></span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.FatalFormat(msg, obj);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p>ValuesControllerWhy<br><img src=\"/2019/07/04/net-core-log4net/8.png\" alt=\"Values\"><br><br><img src=\"/2019/07/04/net-core-log4net/9.png\" alt=\"log\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><strong></strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Stream</p>\n<p>.netNLoglog4log4Log4</p>\n<h3 id=\"log4net\"><a href=\"#log4net\" class=\"headerlink\" title=\"log4net\"></a>log4net</h3><p>log4netframeworkconfigNLog</p>\n<h3 id=\"NuGet\"><a href=\"#NuGet\" class=\"headerlink\" title=\"NuGet\"></a>NuGet</h3><p>-&gt;NuGet-&gt;NuGet<br>log4<br><img src=\"/2019/07/04/net-core-log4net/1.png\" alt=\"log4\"><br>Startup.cs</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Startup</span>(<span class=\"params\">IConfiguration configuration</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    Configuration = configuration;</span><br><span class=\"line\"></span><br><span class=\"line\">    repository = LogManager.CreateRepository(<span class=\"string\">\"AprilLog\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    XmlConfigurator.Configure(repository, <span class=\"keyword\">new</span> FileInfo(<span class=\"string\">\"Config/log4net.config\"</span>));<span class=\"comment\">//</span></span><br><span class=\"line\">    BasicConfigurator.Configure(repository);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//log4net</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> ILoggerRepository repository &#123; <span class=\"keyword\">get</span>; <span class=\"keyword\">set</span>; &#125;</span><br></pre></td></tr></table></figure>\n\n<p>config</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- This section contains the log4net configuration settings --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">log4net</span> <span class=\"attr\">debug</span>=<span class=\"string\">\"false\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">appender</span> <span class=\"attr\">name</span>=<span class=\"string\">\"RollingLogFileAppender\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"log4net.Appender.RollingFileAppender\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">lockingModel</span> <span class=\"attr\">type</span>=<span class=\"string\">\"log4net.Appender.FileAppender+MinimalLock\"</span> /&gt;</span><span class=\"comment\">&lt;!----&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">file</span> <span class=\"attr\">value</span>=<span class=\"string\">\"logs/\"</span> /&gt;</span> <span class=\"comment\">&lt;!--  --&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">appendToFile</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span> /&gt;</span> </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">rollingStyle</span> <span class=\"attr\">value</span>=<span class=\"string\">\"Composite\"</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">staticLogFileName</span> <span class=\"attr\">value</span>=<span class=\"string\">\"false\"</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">datePattern</span> <span class=\"attr\">value</span>=<span class=\"string\">\"yyyyMMdd'.log'\"</span> /&gt;</span> <span class=\"comment\">&lt;!--  --&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">maxSizeRollBackups</span> <span class=\"attr\">value</span>=<span class=\"string\">\"10\"</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">maximumFileSize</span> <span class=\"attr\">value</span>=<span class=\"string\">\"10MB\"</span> /&gt;</span> <span class=\"comment\">&lt;!--  --&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">layout</span> <span class=\"attr\">type</span>=<span class=\"string\">\"log4net.Layout.PatternLayout\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">conversionPattern</span> <span class=\"attr\">value</span>=<span class=\"string\">\"%date [%thread] %-5level %logger - %message%newline\"</span> /&gt;</span> <span class=\"comment\">&lt;!--  --&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">layout</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">appender</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- Setup the root category, add the appenders and set the default level --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">root</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">level</span> <span class=\"attr\">value</span>=<span class=\"string\">\"ALL\"</span> /&gt;</span>  <span class=\"comment\">&lt;!--  --&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">appender-ref</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"RollingLogFileAppender\"</span> /&gt;</span> </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">root</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">log4net</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/2019/07/04/net-core-log4net/2.png\" alt=\"log4\"><br>OKLog</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> ILog log = LogManager.GetLogger(Startup.repository.Name, <span class=\"string\">\"Name\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">log.Info(<span class=\"string\">\"\"</span>);</span><br></pre></td></tr></table></figure>\n\n<p>Values<br><img src=\"/2019/07/04/net-core-log4net/3.png\" alt=\"\"></p>\n<p>logs<br><img src=\"/2019/07/04/net-core-log4net/4.png\" alt=\"log\"><br></p>\n<h3 id=\"LogUtil\"><a href=\"#LogUtil\" class=\"headerlink\" title=\"LogUtil\"></a>LogUtil</h3><p></p>\n<p>Apirl.Util-,-||<br><img src=\"/2019/07/04/net-core-log4net/5.png\" alt=\"\"><br>Class.cs</p>\n<p>log4netNuGetUtil</p>\n<p>WebApiUtil<br><img src=\"/2019/07/04/net-core-log4net/6.png\" alt=\"\"><br>Util<br><img src=\"/2019/07/04/net-core-log4net/7.png\" alt=\"\"></p>\n<blockquote>\n<p>NuGetUtillog4WebApi</p>\n</blockquote>\n<p>LogUtil</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">LogUtil</span></span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">       <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">readonly</span> ILog log = LogManager.GetLogger(<span class=\"string\">\"AprilLog\"</span>, <span class=\"keyword\">typeof</span>(LogUtil));</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"msg\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"obj\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Debug</span>(<span class=\"params\"><span class=\"keyword\">string</span> msg, <span class=\"keyword\">object</span> obj = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (log.IsDebugEnabled &amp;&amp; !<span class=\"keyword\">string</span>.IsNullOrEmpty(msg))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"keyword\">if</span> (obj == <span class=\"literal\">null</span>)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.Debug(msg);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               <span class=\"keyword\">else</span></span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.DebugFormat(msg, obj);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"msg\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"obj\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Info</span>(<span class=\"params\"><span class=\"keyword\">string</span> msg, <span class=\"keyword\">object</span> obj = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (log.IsInfoEnabled &amp;&amp; !<span class=\"keyword\">string</span>.IsNullOrEmpty(msg))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"keyword\">if</span> (obj == <span class=\"literal\">null</span>)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.Info(msg);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               <span class=\"keyword\">else</span></span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.InfoFormat(msg, obj);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"msg\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"obj\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Error</span>(<span class=\"params\"><span class=\"keyword\">string</span> msg, <span class=\"keyword\">object</span> obj = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (log.IsErrorEnabled &amp;&amp; !<span class=\"keyword\">string</span>.IsNullOrEmpty(msg))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"keyword\">if</span> (obj == <span class=\"literal\">null</span>)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.Error(msg);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               <span class=\"keyword\">else</span></span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.ErrorFormat(msg, obj);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"msg\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"obj\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Fatal</span>(<span class=\"params\"><span class=\"keyword\">string</span> msg, <span class=\"keyword\">object</span> obj = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (log.IsFatalEnabled &amp;&amp; !<span class=\"keyword\">string</span>.IsNullOrEmpty(msg))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"keyword\">if</span> (obj == <span class=\"literal\">null</span>)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.Fatal(msg);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               <span class=\"keyword\">else</span></span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   log.FatalFormat(msg, obj);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p>ValuesControllerWhy<br><img src=\"/2019/07/04/net-core-log4net/8.png\" alt=\"Values\"><br><br><img src=\"/2019/07/04/net-core-log4net/9.png\" alt=\"log\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><strong></strong></p>\n"},{"title":"net core WebApixUnits","date":"2019-11-05T09:19:26.000Z","_content":"\n### \nmoney\n\n### \n\n\n1. \n2. \n3. \n\n\n\n**MSTest****NUnit****xUint****xUnit**MSTest\n\n### xUnit\n**April.Test**\n![](net-core-unittest/1.png)\n#### Fact\n\n **[Fact]**\n\n\n\n```csharp\n        [Fact]\n        public void TestEqual()\n        {\n            int a = 10, b = 20;\n            Assert.Equal(30, Add(a, b));\n        }\n\n        private int Add(int a, int b)\n        {\n            return a + b;\n        }\n```\n\nAssert\n\n#### Theory\n **[Theory]**  **[InlineData]** \n\n```csharp\n        [Theory]\n        [InlineData(new object[] { 1, 2, 3, 4 },1)]\n        [InlineData(new object[] { \"t\", \"e\", \"s\", \"t\" }, \"t\")]\n        public void TestContains(object[] objs,object obj)\n        {\n            Assert.Contains(obj, objs);\n        }\n```\n\nMemberDataobject[]\n```csharp\n        [Theory]\n        [MemberData(nameof(tempDatas))]\n        public void TestData(int a, int b)\n        {\n            int result = a + b;\n            Assert.True(result == Add(a, b));\n        }\n        \n        public static IEnumerable<object[]> tempDatas\n        {\n            get\n            {\n                yield return new object[] { 1, 2 };\n                yield return new object[] { 5, 7 };\n                yield return new object[] { 12, 12 };\n            }\n        }\n```\n\n#### \n> \n\n\n- Arrange\n- Act\n- Assert\n\n**Moq**vuemockMoqorm\n\n![](net-core-unittest/2.png)\nApril.WebApiValues**ValuesControllerTest**\n```csharp\n        [Fact]\n        public void TestGet()\n        {\n            // Arrange\n            var mockRepo = new Mock<IStudentService>();\n            var controller = new ValuesController(mockRepo.Object);\n            // Act\n            var result = controller.Get();\n            // Assert\n            Assert.Equal(new string[] { \"value1\", \"\" }, result.Value);\n        }\n```\n\nMoqMock\n\n```csharp\n\t\t[Theory]\n        [InlineData(1)]\n        public void TestGetByID(int id)\n        {\n            var mockRepo = new Mock<IStudentService>();\n            mockRepo.Setup(repo => repo.GetList(s => s.ID == 38).ToList())\n                .Returns(GetList());\n\n            var controller = new ValuesController(mockRepo.Object);\n\n            var result = controller.Get(id);\n\n            Assert.NotNull(result);\n            Assert.Contains(\"\", result.Value);\n        }\n\n        private List<StudentEntity> GetList()\n        {\n            List<StudentEntity> entities = new List<StudentEntity>();\n\n            entities.Add(new StudentEntity()\n            {\n                ID = 1,\n                Name = \"\",\n                Number = \"123456\",\n                Age = 19,\n                Sex = 1,\n                Address = \"\"\n            });\n            entities.Add(new StudentEntity()\n            {\n                ID = 2,\n                Name = \"\",\n                Number = \"456789\",\n                Age = 18,\n                Sex = 0,\n                Address = \"\"\n            });\n\n            return entities;\n        }\n```\n\n> WebApi\n\n### \ndemo****\n\n### \n[April.WebApi](https://github.com/AprilBlank/April.WebApi/tree/3.0)","source":"_posts/net-core-unittest.md","raw":"---\ntitle: net core WebApixUnits\ndate: 2019-11-05 17:19:26\ntags: net core\ncategories: AprilBlank\n---\n\n### \nmoney\n\n### \n\n\n1. \n2. \n3. \n\n\n\n**MSTest****NUnit****xUint****xUnit**MSTest\n\n### xUnit\n**April.Test**\n![](net-core-unittest/1.png)\n#### Fact\n\n **[Fact]**\n\n\n\n```csharp\n        [Fact]\n        public void TestEqual()\n        {\n            int a = 10, b = 20;\n            Assert.Equal(30, Add(a, b));\n        }\n\n        private int Add(int a, int b)\n        {\n            return a + b;\n        }\n```\n\nAssert\n\n#### Theory\n **[Theory]**  **[InlineData]** \n\n```csharp\n        [Theory]\n        [InlineData(new object[] { 1, 2, 3, 4 },1)]\n        [InlineData(new object[] { \"t\", \"e\", \"s\", \"t\" }, \"t\")]\n        public void TestContains(object[] objs,object obj)\n        {\n            Assert.Contains(obj, objs);\n        }\n```\n\nMemberDataobject[]\n```csharp\n        [Theory]\n        [MemberData(nameof(tempDatas))]\n        public void TestData(int a, int b)\n        {\n            int result = a + b;\n            Assert.True(result == Add(a, b));\n        }\n        \n        public static IEnumerable<object[]> tempDatas\n        {\n            get\n            {\n                yield return new object[] { 1, 2 };\n                yield return new object[] { 5, 7 };\n                yield return new object[] { 12, 12 };\n            }\n        }\n```\n\n#### \n> \n\n\n- Arrange\n- Act\n- Assert\n\n**Moq**vuemockMoqorm\n\n![](net-core-unittest/2.png)\nApril.WebApiValues**ValuesControllerTest**\n```csharp\n        [Fact]\n        public void TestGet()\n        {\n            // Arrange\n            var mockRepo = new Mock<IStudentService>();\n            var controller = new ValuesController(mockRepo.Object);\n            // Act\n            var result = controller.Get();\n            // Assert\n            Assert.Equal(new string[] { \"value1\", \"\" }, result.Value);\n        }\n```\n\nMoqMock\n\n```csharp\n\t\t[Theory]\n        [InlineData(1)]\n        public void TestGetByID(int id)\n        {\n            var mockRepo = new Mock<IStudentService>();\n            mockRepo.Setup(repo => repo.GetList(s => s.ID == 38).ToList())\n                .Returns(GetList());\n\n            var controller = new ValuesController(mockRepo.Object);\n\n            var result = controller.Get(id);\n\n            Assert.NotNull(result);\n            Assert.Contains(\"\", result.Value);\n        }\n\n        private List<StudentEntity> GetList()\n        {\n            List<StudentEntity> entities = new List<StudentEntity>();\n\n            entities.Add(new StudentEntity()\n            {\n                ID = 1,\n                Name = \"\",\n                Number = \"123456\",\n                Age = 19,\n                Sex = 1,\n                Address = \"\"\n            });\n            entities.Add(new StudentEntity()\n            {\n                ID = 2,\n                Name = \"\",\n                Number = \"456789\",\n                Age = 18,\n                Sex = 0,\n                Address = \"\"\n            });\n\n            return entities;\n        }\n```\n\n> WebApi\n\n### \ndemo****\n\n### \n[April.WebApi](https://github.com/AprilBlank/April.WebApi/tree/3.0)","slug":"net-core-unittest","published":1,"updated":"2019-11-22T02:56:09.685Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2n001e9sv7sbbbydqs","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>money</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p></p>\n<p><strong>MSTest</strong><strong>NUnit</strong><strong>xUint</strong><strong>xUnit</strong>MSTest</p>\n<h3 id=\"xUnit\"><a href=\"#xUnit\" class=\"headerlink\" title=\"xUnit\"></a>xUnit</h3><p><strong>April.Test</strong><br><img src=\"/2019/11/05/net-core-unittest/1.png\" alt=\"\"></p>\n<h4 id=\"Fact\"><a href=\"#Fact\" class=\"headerlink\" title=\"Fact\"></a>Fact</h4><p> <strong>[Fact]</strong></p>\n<p></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Fact</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">TestEqual</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> a = <span class=\"number\">10</span>, b = <span class=\"number\">20</span>;</span><br><span class=\"line\">    Assert.Equal(<span class=\"number\">30</span>, Add(a, b));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">Add</span>(<span class=\"params\"><span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> b</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a + b;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Assert</p>\n<h4 id=\"Theory\"><a href=\"#Theory\" class=\"headerlink\" title=\"Theory\"></a>Theory</h4><p> <strong>[Theory]</strong>  <strong>[InlineData]</strong> </p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Theory</span>]</span><br><span class=\"line\">[<span class=\"meta\">InlineData(new object[</span>] &#123; <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span> &#125;,<span class=\"number\">1</span>)]</span><br><span class=\"line\">[<span class=\"meta\">InlineData(new object[</span>] &#123; <span class=\"string\">\"t\"</span>, <span class=\"string\">\"e\"</span>, <span class=\"string\">\"s\"</span>, <span class=\"string\">\"t\"</span> &#125;, <span class=\"string\">\"t\"</span>)]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">TestContains</span>(<span class=\"params\"><span class=\"keyword\">object</span>[] objs,<span class=\"keyword\">object</span> obj</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    Assert.Contains(obj, objs);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>MemberDataobject[]</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Theory</span>]</span><br><span class=\"line\">[<span class=\"meta\">MemberData(nameof(tempDatas))</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">TestData</span>(<span class=\"params\"><span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> b</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> result = a + b;</span><br><span class=\"line\">    Assert.True(result == Add(a, b));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IEnumerable&lt;<span class=\"keyword\">object</span>[]&gt; tempDatas</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">get</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">yield</span> <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">object</span>[] &#123; <span class=\"number\">1</span>, <span class=\"number\">2</span> &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">yield</span> <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">object</span>[] &#123; <span class=\"number\">5</span>, <span class=\"number\">7</span> &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">yield</span> <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">object</span>[] &#123; <span class=\"number\">12</span>, <span class=\"number\">12</span> &#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><blockquote>\n<p></p>\n</blockquote>\n<p></p>\n<ul>\n<li>Arrange</li>\n<li>Act</li>\n<li>Assert</li>\n</ul>\n<p><strong>Moq</strong>vuemockMoqorm</p>\n<p><img src=\"/2019/11/05/net-core-unittest/2.png\" alt=\"\"><br>April.WebApiValues<strong>ValuesControllerTest</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Fact</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">TestGet</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Arrange</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> mockRepo = <span class=\"keyword\">new</span> Mock&lt;IStudentService&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> controller = <span class=\"keyword\">new</span> ValuesController(mockRepo.Object);</span><br><span class=\"line\">    <span class=\"comment\">// Act</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> result = controller.Get();</span><br><span class=\"line\">    <span class=\"comment\">// Assert</span></span><br><span class=\"line\">    Assert.Equal(<span class=\"keyword\">new</span> <span class=\"keyword\">string</span>[] &#123; <span class=\"string\">\"value1\"</span>, <span class=\"string\">\"\"</span> &#125;, result.Value);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>MoqMock</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Theory</span>]</span><br><span class=\"line\">      [<span class=\"meta\">InlineData(1)</span>]</span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">TestGetByID</span>(<span class=\"params\"><span class=\"keyword\">int</span> id</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> mockRepo = <span class=\"keyword\">new</span> Mock&lt;IStudentService&gt;();</span><br><span class=\"line\">          mockRepo.Setup(repo =&gt; repo.GetList(s =&gt; s.ID == <span class=\"number\">38</span>).ToList())</span><br><span class=\"line\">              .Returns(GetList());</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"keyword\">var</span> controller = <span class=\"keyword\">new</span> ValuesController(mockRepo.Object);</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"keyword\">var</span> result = controller.Get(id);</span><br><span class=\"line\"></span><br><span class=\"line\">          Assert.NotNull(result);</span><br><span class=\"line\">          Assert.Contains(<span class=\"string\">\"\"</span>, result.Value);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">private</span> List&lt;StudentEntity&gt; <span class=\"title\">GetList</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          List&lt;StudentEntity&gt; entities = <span class=\"keyword\">new</span> List&lt;StudentEntity&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">          entities.Add(<span class=\"keyword\">new</span> StudentEntity()</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              ID = <span class=\"number\">1</span>,</span><br><span class=\"line\">              Name = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">              Number = <span class=\"string\">\"123456\"</span>,</span><br><span class=\"line\">              Age = <span class=\"number\">19</span>,</span><br><span class=\"line\">              Sex = <span class=\"number\">1</span>,</span><br><span class=\"line\">              Address = <span class=\"string\">\"\"</span></span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">          entities.Add(<span class=\"keyword\">new</span> StudentEntity()</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              ID = <span class=\"number\">2</span>,</span><br><span class=\"line\">              Name = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">              Number = <span class=\"string\">\"456789\"</span>,</span><br><span class=\"line\">              Age = <span class=\"number\">18</span>,</span><br><span class=\"line\">              Sex = <span class=\"number\">0</span>,</span><br><span class=\"line\">              Address = <span class=\"string\">\"\"</span></span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"keyword\">return</span> entities;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>WebApi</p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>demo<strong></strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://github.com/AprilBlank/April.WebApi/tree/3.0\" target=\"_blank\" rel=\"noopener\">April.WebApi</a></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>money</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p></p>\n<p><strong>MSTest</strong><strong>NUnit</strong><strong>xUint</strong><strong>xUnit</strong>MSTest</p>\n<h3 id=\"xUnit\"><a href=\"#xUnit\" class=\"headerlink\" title=\"xUnit\"></a>xUnit</h3><p><strong>April.Test</strong><br><img src=\"/2019/11/05/net-core-unittest/1.png\" alt=\"\"></p>\n<h4 id=\"Fact\"><a href=\"#Fact\" class=\"headerlink\" title=\"Fact\"></a>Fact</h4><p> <strong>[Fact]</strong></p>\n<p></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Fact</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">TestEqual</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> a = <span class=\"number\">10</span>, b = <span class=\"number\">20</span>;</span><br><span class=\"line\">    Assert.Equal(<span class=\"number\">30</span>, Add(a, b));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">Add</span>(<span class=\"params\"><span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> b</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a + b;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Assert</p>\n<h4 id=\"Theory\"><a href=\"#Theory\" class=\"headerlink\" title=\"Theory\"></a>Theory</h4><p> <strong>[Theory]</strong>  <strong>[InlineData]</strong> </p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Theory</span>]</span><br><span class=\"line\">[<span class=\"meta\">InlineData(new object[</span>] &#123; <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span> &#125;,<span class=\"number\">1</span>)]</span><br><span class=\"line\">[<span class=\"meta\">InlineData(new object[</span>] &#123; <span class=\"string\">\"t\"</span>, <span class=\"string\">\"e\"</span>, <span class=\"string\">\"s\"</span>, <span class=\"string\">\"t\"</span> &#125;, <span class=\"string\">\"t\"</span>)]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">TestContains</span>(<span class=\"params\"><span class=\"keyword\">object</span>[] objs,<span class=\"keyword\">object</span> obj</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    Assert.Contains(obj, objs);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>MemberDataobject[]</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Theory</span>]</span><br><span class=\"line\">[<span class=\"meta\">MemberData(nameof(tempDatas))</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">TestData</span>(<span class=\"params\"><span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> b</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> result = a + b;</span><br><span class=\"line\">    Assert.True(result == Add(a, b));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IEnumerable&lt;<span class=\"keyword\">object</span>[]&gt; tempDatas</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">get</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">yield</span> <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">object</span>[] &#123; <span class=\"number\">1</span>, <span class=\"number\">2</span> &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">yield</span> <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">object</span>[] &#123; <span class=\"number\">5</span>, <span class=\"number\">7</span> &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">yield</span> <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">object</span>[] &#123; <span class=\"number\">12</span>, <span class=\"number\">12</span> &#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><blockquote>\n<p></p>\n</blockquote>\n<p></p>\n<ul>\n<li>Arrange</li>\n<li>Act</li>\n<li>Assert</li>\n</ul>\n<p><strong>Moq</strong>vuemockMoqorm</p>\n<p><img src=\"/2019/11/05/net-core-unittest/2.png\" alt=\"\"><br>April.WebApiValues<strong>ValuesControllerTest</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Fact</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">TestGet</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Arrange</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> mockRepo = <span class=\"keyword\">new</span> Mock&lt;IStudentService&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> controller = <span class=\"keyword\">new</span> ValuesController(mockRepo.Object);</span><br><span class=\"line\">    <span class=\"comment\">// Act</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> result = controller.Get();</span><br><span class=\"line\">    <span class=\"comment\">// Assert</span></span><br><span class=\"line\">    Assert.Equal(<span class=\"keyword\">new</span> <span class=\"keyword\">string</span>[] &#123; <span class=\"string\">\"value1\"</span>, <span class=\"string\">\"\"</span> &#125;, result.Value);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>MoqMock</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Theory</span>]</span><br><span class=\"line\">      [<span class=\"meta\">InlineData(1)</span>]</span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">TestGetByID</span>(<span class=\"params\"><span class=\"keyword\">int</span> id</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> mockRepo = <span class=\"keyword\">new</span> Mock&lt;IStudentService&gt;();</span><br><span class=\"line\">          mockRepo.Setup(repo =&gt; repo.GetList(s =&gt; s.ID == <span class=\"number\">38</span>).ToList())</span><br><span class=\"line\">              .Returns(GetList());</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"keyword\">var</span> controller = <span class=\"keyword\">new</span> ValuesController(mockRepo.Object);</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"keyword\">var</span> result = controller.Get(id);</span><br><span class=\"line\"></span><br><span class=\"line\">          Assert.NotNull(result);</span><br><span class=\"line\">          Assert.Contains(<span class=\"string\">\"\"</span>, result.Value);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">private</span> List&lt;StudentEntity&gt; <span class=\"title\">GetList</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          List&lt;StudentEntity&gt; entities = <span class=\"keyword\">new</span> List&lt;StudentEntity&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">          entities.Add(<span class=\"keyword\">new</span> StudentEntity()</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              ID = <span class=\"number\">1</span>,</span><br><span class=\"line\">              Name = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">              Number = <span class=\"string\">\"123456\"</span>,</span><br><span class=\"line\">              Age = <span class=\"number\">19</span>,</span><br><span class=\"line\">              Sex = <span class=\"number\">1</span>,</span><br><span class=\"line\">              Address = <span class=\"string\">\"\"</span></span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">          entities.Add(<span class=\"keyword\">new</span> StudentEntity()</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              ID = <span class=\"number\">2</span>,</span><br><span class=\"line\">              Name = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">              Number = <span class=\"string\">\"456789\"</span>,</span><br><span class=\"line\">              Age = <span class=\"number\">18</span>,</span><br><span class=\"line\">              Sex = <span class=\"number\">0</span>,</span><br><span class=\"line\">              Address = <span class=\"string\">\"\"</span></span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"keyword\">return</span> entities;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>WebApi</p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>demo<strong></strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://github.com/AprilBlank/April.WebApi/tree/3.0\" target=\"_blank\" rel=\"noopener\">April.WebApi</a></p>\n"},{"title":"net core Webapi","date":"2019-07-02T09:29:33.000Z","_content":"\n### \n**Visual Studio 2019**2017\nhttps://visualstudio.microsoft.com/zh-hans/downloads/\n\n### \n**net core 2.2**.netframeworknet core 2.1net core 3.02.2\nhttps://dotnet.microsoft.com/download\n\n### \n\n- **April.WebApi ** \n\n- **April.Service **\n\n-  **April.Entity **\n\n-  **April.Util **\n\n","source":"_posts/net-core-tools-and-environment.md","raw":"---\ntitle: net core Webapi\ndate: 2019-07-02 17:29:33\ntags: net core\ncategories: AprilBlank\n---\n\n### \n**Visual Studio 2019**2017\nhttps://visualstudio.microsoft.com/zh-hans/downloads/\n\n### \n**net core 2.2**.netframeworknet core 2.1net core 3.02.2\nhttps://dotnet.microsoft.com/download\n\n### \n\n- **April.WebApi ** \n\n- **April.Service **\n\n-  **April.Entity **\n\n-  **April.Util **\n\n","slug":"net-core-tools-and-environment","published":1,"updated":"2019-09-30T05:47:24.237Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2p001i9sv7058nq4z7","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>Visual Studio 2019</strong>2017<br><a href=\"https://visualstudio.microsoft.com/zh-hans/downloads/\" target=\"_blank\" rel=\"noopener\">https://visualstudio.microsoft.com/zh-hans/downloads/</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>net core 2.2</strong>.netframeworknet core 2.1net core 3.02.2<br><a href=\"https://dotnet.microsoft.com/download\" target=\"_blank\" rel=\"noopener\">https://dotnet.microsoft.com/download</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p><strong>April.WebApi </strong> </p>\n</li>\n<li><p><strong>April.Service </strong></p>\n</li>\n<li><p><strong>April.Entity </strong></p>\n</li>\n<li><p><strong>April.Util </strong></p>\n</li>\n</ul>\n<p></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>Visual Studio 2019</strong>2017<br><a href=\"https://visualstudio.microsoft.com/zh-hans/downloads/\" target=\"_blank\" rel=\"noopener\">https://visualstudio.microsoft.com/zh-hans/downloads/</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>net core 2.2</strong>.netframeworknet core 2.1net core 3.02.2<br><a href=\"https://dotnet.microsoft.com/download\" target=\"_blank\" rel=\"noopener\">https://dotnet.microsoft.com/download</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p><strong>April.WebApi </strong> </p>\n</li>\n<li><p><strong>April.Service </strong></p>\n</li>\n<li><p><strong>April.Entity </strong></p>\n</li>\n<li><p><strong>April.Util </strong></p>\n</li>\n</ul>\n<p></p>\n"},{"title":"net core 3.0April.WebApi2.23.0","date":"2019-10-09T08:21:33.000Z","_content":"\n### \nSwaggerdemo\n\n### \nApril.WebApi->net core 2.23.0->net standard 2.02.1\n\n\n\n3.0Startup\n\n#### 1\n![](net-core-v3-april-webapi/1.png)\n![](net-core-v3-april-webapi/2.png)\n![](net-core-v3-april-webapi/3.png)\nnet core3.0ApiMvcMvc\n\n- ****\n\n3.0**Microsoft.Extensions.Hosting**\n![](net-core-v3-april-webapi/4.png)\n![](net-core-v3-april-webapi/5.png)\n![](net-core-v3-april-webapi/6.png)\n\n\n\n#### 2\n![](net-core-v3-april-webapi/7.png)\nAllowAllCookie\n\n- ****\n![](net-core-v3-april-webapi/8.png)\n\n\n#### 3\n![](net-core-v3-april-webapi/9.png)\nSessionWebHostSession****\n\n- ****\n![](net-core-v3-april-webapi/10.png)\n> **Microsoft.VisualStudio.Web.CodeGeneration.Design**\n\nProgram\n```csharp\n    public class Program\n    {\n        public static void Main(string[] args)\n        {\n            CreateHostBuilder(args).Build().Run();\n        }\n\n        public static IHostBuilder CreateHostBuilder(string[] args) =>\n            Host.CreateDefaultBuilder(args)\n                .ConfigureWebHostDefaults(webBuilder =>\n                {\n                    webBuilder.UseStartup<Startup>();\n                });\n    }\n```\n- ****\n\nSession3.0sessionUseSessionRedirection\n```csharp\n        public void ConfigureServices(IServiceCollection services)\n        {\n        \t\n            #region Session\n            services.AddDistributedMemoryCache();\n            services.AddSession(options =>\n            {\n                options.Cookie.Name = \"April.Session\";\n                options.IdleTimeout = TimeSpan.FromSeconds(2000);//session\n                options.Cookie.HttpOnly = true;//jscookie,\n                options.Cookie.IsEssential = true;\n            });\n            #endregion\n            \n        }\n        public void Configure(IApplicationBuilder app, IWebHostEnvironment env)\n        {\n        \t\n            app.UseHttpsRedirection();\n\n            app.UseSession();\n\n            app.UseRouting();\n            \n        }\n```\n\n\n\n\n#### 4\n![](net-core-v3-april-webapi/11.png)\n- ****\n\nemm\n3.0DIvoid\n\n\n\n#### 5\n![](net-core-v3-april-webapi/12.png)\nswagger\n\n- ****\n[net core 3.0Swagger](/2019/10/07/net-core-v3-swagger/)\n\nSwagger\n#### 6\n![](net-core-v3-april-webapi/13.png)\nDIAspectCore\n\n- ****\n![](net-core-v3-april-webapi/14.png)\n\nSwagger\n\n![Swagger](net-core-v3-april-webapi/15.png)\n### \n> \n\n- log4\n- swagger\n- cache\n- session\n- cookie\n- sqlsugar\n- aop\n- redis\n- \n\n> \n### \nnet core3.0","source":"_posts/net-core-v3-april-webapi.md","raw":"---\ntitle: net core 3.0April.WebApi2.23.0\ndate: 2019-10-09 16:21:33\ntags: net core\ncategories: AprilBlank\n---\n\n### \nSwaggerdemo\n\n### \nApril.WebApi->net core 2.23.0->net standard 2.02.1\n\n\n\n3.0Startup\n\n#### 1\n![](net-core-v3-april-webapi/1.png)\n![](net-core-v3-april-webapi/2.png)\n![](net-core-v3-april-webapi/3.png)\nnet core3.0ApiMvcMvc\n\n- ****\n\n3.0**Microsoft.Extensions.Hosting**\n![](net-core-v3-april-webapi/4.png)\n![](net-core-v3-april-webapi/5.png)\n![](net-core-v3-april-webapi/6.png)\n\n\n\n#### 2\n![](net-core-v3-april-webapi/7.png)\nAllowAllCookie\n\n- ****\n![](net-core-v3-april-webapi/8.png)\n\n\n#### 3\n![](net-core-v3-april-webapi/9.png)\nSessionWebHostSession****\n\n- ****\n![](net-core-v3-april-webapi/10.png)\n> **Microsoft.VisualStudio.Web.CodeGeneration.Design**\n\nProgram\n```csharp\n    public class Program\n    {\n        public static void Main(string[] args)\n        {\n            CreateHostBuilder(args).Build().Run();\n        }\n\n        public static IHostBuilder CreateHostBuilder(string[] args) =>\n            Host.CreateDefaultBuilder(args)\n                .ConfigureWebHostDefaults(webBuilder =>\n                {\n                    webBuilder.UseStartup<Startup>();\n                });\n    }\n```\n- ****\n\nSession3.0sessionUseSessionRedirection\n```csharp\n        public void ConfigureServices(IServiceCollection services)\n        {\n        \t\n            #region Session\n            services.AddDistributedMemoryCache();\n            services.AddSession(options =>\n            {\n                options.Cookie.Name = \"April.Session\";\n                options.IdleTimeout = TimeSpan.FromSeconds(2000);//session\n                options.Cookie.HttpOnly = true;//jscookie,\n                options.Cookie.IsEssential = true;\n            });\n            #endregion\n            \n        }\n        public void Configure(IApplicationBuilder app, IWebHostEnvironment env)\n        {\n        \t\n            app.UseHttpsRedirection();\n\n            app.UseSession();\n\n            app.UseRouting();\n            \n        }\n```\n\n\n\n\n#### 4\n![](net-core-v3-april-webapi/11.png)\n- ****\n\nemm\n3.0DIvoid\n\n\n\n#### 5\n![](net-core-v3-april-webapi/12.png)\nswagger\n\n- ****\n[net core 3.0Swagger](/2019/10/07/net-core-v3-swagger/)\n\nSwagger\n#### 6\n![](net-core-v3-april-webapi/13.png)\nDIAspectCore\n\n- ****\n![](net-core-v3-april-webapi/14.png)\n\nSwagger\n\n![Swagger](net-core-v3-april-webapi/15.png)\n### \n> \n\n- log4\n- swagger\n- cache\n- session\n- cookie\n- sqlsugar\n- aop\n- redis\n- \n\n> \n### \nnet core3.0","slug":"net-core-v3-april-webapi","published":1,"updated":"2019-10-10T06:33:18.348Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2q001l9sv7zay4q50c","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Swaggerdemo</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>April.WebApi-&gt;net core 2.23.0-&gt;net standard 2.02.1</p>\n<p></p>\n<p>3.0Startup</p>\n<h4 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h4><p><img src=\"/2019/10/09/net-core-v3-april-webapi/1.png\" alt=\"\"><br><img src=\"/2019/10/09/net-core-v3-april-webapi/2.png\" alt=\"\"><br><img src=\"/2019/10/09/net-core-v3-april-webapi/3.png\" alt=\"\"><br>net core3.0ApiMvcMvc</p>\n<ul>\n<li><strong></strong></li>\n</ul>\n<p>3.0<strong>Microsoft.Extensions.Hosting</strong><br><img src=\"/2019/10/09/net-core-v3-april-webapi/4.png\" alt=\"\"><br><img src=\"/2019/10/09/net-core-v3-april-webapi/5.png\" alt=\"\"><br><img src=\"/2019/10/09/net-core-v3-april-webapi/6.png\" alt=\"\"></p>\n<p></p>\n<h4 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h4><p><img src=\"/2019/10/09/net-core-v3-april-webapi/7.png\" alt=\"\"><br>AllowAllCookie</p>\n<ul>\n<li><strong></strong><br><img src=\"/2019/10/09/net-core-v3-april-webapi/8.png\" alt=\"\"><br></li>\n</ul>\n<h4 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h4><p><img src=\"/2019/10/09/net-core-v3-april-webapi/9.png\" alt=\"\"><br>SessionWebHostSession<strong></strong></p>\n<ul>\n<li><strong></strong><br><img src=\"/2019/10/09/net-core-v3-april-webapi/10.png\" alt=\"\"><blockquote>\n<p><strong>Microsoft.VisualStudio.Web.CodeGeneration.Design</strong></p>\n</blockquote>\n</li>\n</ul>\n<p>Program</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Program</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"keyword\">string</span>[] args</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        CreateHostBuilder(args).Build().Run();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IHostBuilder <span class=\"title\">CreateHostBuilder</span>(<span class=\"params\"><span class=\"keyword\">string</span>[] args</span>)</span> =&gt;</span><br><span class=\"line\">        Host.CreateDefaultBuilder(args)</span><br><span class=\"line\">            .ConfigureWebHostDefaults(webBuilder =&gt;</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                webBuilder.UseStartup&lt;Startup&gt;();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong></strong></li>\n</ul>\n<p>Session3.0sessionUseSessionRedirection</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">region</span> Session</span></span><br><span class=\"line\">    services.AddDistributedMemoryCache();</span><br><span class=\"line\">    services.AddSession(options =&gt;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        options.Cookie.Name = <span class=\"string\">\"April.Session\"</span>;</span><br><span class=\"line\">        options.IdleTimeout = TimeSpan.FromSeconds(<span class=\"number\">2000</span>);<span class=\"comment\">//session</span></span><br><span class=\"line\">        options.Cookie.HttpOnly = <span class=\"literal\">true</span>;<span class=\"comment\">//jscookie,</span></span><br><span class=\"line\">        options.Cookie.IsEssential = <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IWebHostEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    app.UseHttpsRedirection();</span><br><span class=\"line\"></span><br><span class=\"line\">    app.UseSession();</span><br><span class=\"line\"></span><br><span class=\"line\">    app.UseRouting();</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h4 id=\"4\"><a href=\"#4\" class=\"headerlink\" title=\"4\"></a>4</h4><p><img src=\"/2019/10/09/net-core-v3-april-webapi/11.png\" alt=\"\"></p>\n<ul>\n<li><strong></strong></li>\n</ul>\n<p>emm<br>3.0DIvoid</p>\n<p></p>\n<h4 id=\"5\"><a href=\"#5\" class=\"headerlink\" title=\"5\"></a>5</h4><p><img src=\"/2019/10/09/net-core-v3-april-webapi/12.png\" alt=\"\"><br>swagger</p>\n<ul>\n<li><strong></strong><br><a href=\"/2019/10/07/net-core-v3-swagger/\">net core 3.0Swagger</a></li>\n</ul>\n<p>Swagger</p>\n<h4 id=\"6\"><a href=\"#6\" class=\"headerlink\" title=\"6\"></a>6</h4><p><img src=\"/2019/10/09/net-core-v3-april-webapi/13.png\" alt=\"\"><br>DIAspectCore</p>\n<ul>\n<li><strong></strong><br><img src=\"/2019/10/09/net-core-v3-april-webapi/14.png\" alt=\"\"></li>\n</ul>\n<p>Swagger</p>\n<p><img src=\"/2019/10/09/net-core-v3-april-webapi/15.png\" alt=\"Swagger\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li>log4</li>\n<li>swagger</li>\n<li>cache</li>\n<li>session</li>\n<li>cookie</li>\n<li>sqlsugar</li>\n<li>aop</li>\n<li>redis</li>\n<li></li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net core3.0</p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Swaggerdemo</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>April.WebApi-&gt;net core 2.23.0-&gt;net standard 2.02.1</p>\n<p></p>\n<p>3.0Startup</p>\n<h4 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h4><p><img src=\"/2019/10/09/net-core-v3-april-webapi/1.png\" alt=\"\"><br><img src=\"/2019/10/09/net-core-v3-april-webapi/2.png\" alt=\"\"><br><img src=\"/2019/10/09/net-core-v3-april-webapi/3.png\" alt=\"\"><br>net core3.0ApiMvcMvc</p>\n<ul>\n<li><strong></strong></li>\n</ul>\n<p>3.0<strong>Microsoft.Extensions.Hosting</strong><br><img src=\"/2019/10/09/net-core-v3-april-webapi/4.png\" alt=\"\"><br><img src=\"/2019/10/09/net-core-v3-april-webapi/5.png\" alt=\"\"><br><img src=\"/2019/10/09/net-core-v3-april-webapi/6.png\" alt=\"\"></p>\n<p></p>\n<h4 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h4><p><img src=\"/2019/10/09/net-core-v3-april-webapi/7.png\" alt=\"\"><br>AllowAllCookie</p>\n<ul>\n<li><strong></strong><br><img src=\"/2019/10/09/net-core-v3-april-webapi/8.png\" alt=\"\"><br></li>\n</ul>\n<h4 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h4><p><img src=\"/2019/10/09/net-core-v3-april-webapi/9.png\" alt=\"\"><br>SessionWebHostSession<strong></strong></p>\n<ul>\n<li><strong></strong><br><img src=\"/2019/10/09/net-core-v3-april-webapi/10.png\" alt=\"\"><blockquote>\n<p><strong>Microsoft.VisualStudio.Web.CodeGeneration.Design</strong></p>\n</blockquote>\n</li>\n</ul>\n<p>Program</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Program</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"keyword\">string</span>[] args</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        CreateHostBuilder(args).Build().Run();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IHostBuilder <span class=\"title\">CreateHostBuilder</span>(<span class=\"params\"><span class=\"keyword\">string</span>[] args</span>)</span> =&gt;</span><br><span class=\"line\">        Host.CreateDefaultBuilder(args)</span><br><span class=\"line\">            .ConfigureWebHostDefaults(webBuilder =&gt;</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                webBuilder.UseStartup&lt;Startup&gt;();</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong></strong></li>\n</ul>\n<p>Session3.0sessionUseSessionRedirection</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">region</span> Session</span></span><br><span class=\"line\">    services.AddDistributedMemoryCache();</span><br><span class=\"line\">    services.AddSession(options =&gt;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        options.Cookie.Name = <span class=\"string\">\"April.Session\"</span>;</span><br><span class=\"line\">        options.IdleTimeout = TimeSpan.FromSeconds(<span class=\"number\">2000</span>);<span class=\"comment\">//session</span></span><br><span class=\"line\">        options.Cookie.HttpOnly = <span class=\"literal\">true</span>;<span class=\"comment\">//jscookie,</span></span><br><span class=\"line\">        options.Cookie.IsEssential = <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IWebHostEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    app.UseHttpsRedirection();</span><br><span class=\"line\"></span><br><span class=\"line\">    app.UseSession();</span><br><span class=\"line\"></span><br><span class=\"line\">    app.UseRouting();</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h4 id=\"4\"><a href=\"#4\" class=\"headerlink\" title=\"4\"></a>4</h4><p><img src=\"/2019/10/09/net-core-v3-april-webapi/11.png\" alt=\"\"></p>\n<ul>\n<li><strong></strong></li>\n</ul>\n<p>emm<br>3.0DIvoid</p>\n<p></p>\n<h4 id=\"5\"><a href=\"#5\" class=\"headerlink\" title=\"5\"></a>5</h4><p><img src=\"/2019/10/09/net-core-v3-april-webapi/12.png\" alt=\"\"><br>swagger</p>\n<ul>\n<li><strong></strong><br><a href=\"/2019/10/07/net-core-v3-swagger/\">net core 3.0Swagger</a></li>\n</ul>\n<p>Swagger</p>\n<h4 id=\"6\"><a href=\"#6\" class=\"headerlink\" title=\"6\"></a>6</h4><p><img src=\"/2019/10/09/net-core-v3-april-webapi/13.png\" alt=\"\"><br>DIAspectCore</p>\n<ul>\n<li><strong></strong><br><img src=\"/2019/10/09/net-core-v3-april-webapi/14.png\" alt=\"\"></li>\n</ul>\n<p>Swagger</p>\n<p><img src=\"/2019/10/09/net-core-v3-april-webapi/15.png\" alt=\"Swagger\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li>log4</li>\n<li>swagger</li>\n<li>cache</li>\n<li>session</li>\n<li>cookie</li>\n<li>sqlsugar</li>\n<li>aop</li>\n<li>redis</li>\n<li></li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net core3.0</p>\n"},{"title":"net core 3.0Swagger","date":"2019-10-07T14:34:42.000Z","_content":"\n### \nnet core 3.0Swagger3.020193.0\n\n### \n3.0\n![](net-core-v3-swagger/1.png)\n> 3.0StartupMvcControllers**Values**apiWeatherForecast\n\nswagger\n![](net-core-v3-swagger/2.png)\n```csharp\n            #region Swagger\n            services.AddSwaggerGen(options =>\n            {\n                options.SwaggerDoc(\"v1\", new OpenApiInfo\n                {\n                    Version = \"v1.1.0\",\n                    Title = \"ERP WebAPI\",\n                    Description = \"\",\n                    Contact = new OpenApiContact() { Name = \"Blank\", Email = \"1829027193@qq.com\", Url = new Uri(\"https://www.cnblogs.com/AprilBlank/\") }\n                });\n            });\n            #endregion \n```\n\n\n![](net-core-v3-swagger/3.png)\n```csharp\n            #region Swagger\n            app.UseSwagger();\n            app.UseSwaggerUI(options =>\n            {\n                options.SwaggerEndpoint(\"/swagger/v1/swagger.json\", \"ApiHelp V1\");\n                //swagger,\n                options.RoutePrefix = string.Empty;\n            });\n            #endregion\n```\n\n\nxml\n![](net-core-v3-swagger/4.png)\n\n![](net-core-v3-swagger/5.png)\n```csharp\n            #region Swagger\n            services.AddSwaggerGen(options =>\n            {\n                options.SwaggerDoc(\"v1\", new OpenApiInfo\n                {\n                    Version = \"v1.1.0\",\n                    Title = \"ERP WebAPI\",\n                    Description = \"\",\n                    Contact = new OpenApiContact() { Name = \"Blank\", Email = \"1829027193@qq.com\", Url = new Uri(\"https://www.cnblogs.com/AprilBlank/\") }\n                });\n                //  Swagger JSON and UIxml\n                var basePath = Path.GetDirectoryName(AppContext.BaseDirectory);//\n                var xmlPath = Path.Combine(basePath, \"ERP.Api.xml\");\n                options.IncludeXmlComments(xmlPath);\n            });\n            #endregion \n```\n\n\n![](net-core-v3-swagger/6.png)\n\n### \n> Values\n\nok\n![](net-core-v3-swagger/7.png)\nswagger\n![](net-core-v3-swagger/8.png)\n\n### \nnet core 3.0****","source":"_posts/net-core-v3-swagger.md","raw":"---\ntitle: net core 3.0Swagger\ndate: 2019-10-07 22:34:42\ntags: net core\ncategories: AprilBlank\n---\n\n### \nnet core 3.0Swagger3.020193.0\n\n### \n3.0\n![](net-core-v3-swagger/1.png)\n> 3.0StartupMvcControllers**Values**apiWeatherForecast\n\nswagger\n![](net-core-v3-swagger/2.png)\n```csharp\n            #region Swagger\n            services.AddSwaggerGen(options =>\n            {\n                options.SwaggerDoc(\"v1\", new OpenApiInfo\n                {\n                    Version = \"v1.1.0\",\n                    Title = \"ERP WebAPI\",\n                    Description = \"\",\n                    Contact = new OpenApiContact() { Name = \"Blank\", Email = \"1829027193@qq.com\", Url = new Uri(\"https://www.cnblogs.com/AprilBlank/\") }\n                });\n            });\n            #endregion \n```\n\n\n![](net-core-v3-swagger/3.png)\n```csharp\n            #region Swagger\n            app.UseSwagger();\n            app.UseSwaggerUI(options =>\n            {\n                options.SwaggerEndpoint(\"/swagger/v1/swagger.json\", \"ApiHelp V1\");\n                //swagger,\n                options.RoutePrefix = string.Empty;\n            });\n            #endregion\n```\n\n\nxml\n![](net-core-v3-swagger/4.png)\n\n![](net-core-v3-swagger/5.png)\n```csharp\n            #region Swagger\n            services.AddSwaggerGen(options =>\n            {\n                options.SwaggerDoc(\"v1\", new OpenApiInfo\n                {\n                    Version = \"v1.1.0\",\n                    Title = \"ERP WebAPI\",\n                    Description = \"\",\n                    Contact = new OpenApiContact() { Name = \"Blank\", Email = \"1829027193@qq.com\", Url = new Uri(\"https://www.cnblogs.com/AprilBlank/\") }\n                });\n                //  Swagger JSON and UIxml\n                var basePath = Path.GetDirectoryName(AppContext.BaseDirectory);//\n                var xmlPath = Path.Combine(basePath, \"ERP.Api.xml\");\n                options.IncludeXmlComments(xmlPath);\n            });\n            #endregion \n```\n\n\n![](net-core-v3-swagger/6.png)\n\n### \n> Values\n\nok\n![](net-core-v3-swagger/7.png)\nswagger\n![](net-core-v3-swagger/8.png)\n\n### \nnet core 3.0****","slug":"net-core-v3-swagger","published":1,"updated":"2019-10-10T06:16:41.489Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2r001o9sv71jn8c2ec","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net core 3.0Swagger3.020193.0</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>3.0<br><img src=\"/2019/10/07/net-core-v3-swagger/1.png\" alt=\"\"></p>\n<blockquote>\n<p>3.0StartupMvcControllers<strong>Values</strong>apiWeatherForecast</p>\n</blockquote>\n<p>swagger<br><img src=\"/2019/10/07/net-core-v3-swagger/2.png\" alt=\"\"></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">region</span> Swagger</span></span><br><span class=\"line\">services.AddSwaggerGen(options =&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    options.SwaggerDoc(<span class=\"string\">\"v1\"</span>, <span class=\"keyword\">new</span> OpenApiInfo</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Version = <span class=\"string\">\"v1.1.0\"</span>,</span><br><span class=\"line\">        Title = <span class=\"string\">\"ERP WebAPI\"</span>,</span><br><span class=\"line\">        Description = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">        Contact = <span class=\"keyword\">new</span> OpenApiContact() &#123; Name = <span class=\"string\">\"Blank\"</span>, Email = <span class=\"string\">\"1829027193@qq.com\"</span>, Url = <span class=\"keyword\">new</span> Uri(<span class=\"string\">\"https://www.cnblogs.com/AprilBlank/\"</span>) &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/2019/10/07/net-core-v3-swagger/3.png\" alt=\"\"></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">region</span> Swagger</span></span><br><span class=\"line\">app.UseSwagger();</span><br><span class=\"line\">app.UseSwaggerUI(options =&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    options.SwaggerEndpoint(<span class=\"string\">\"/swagger/v1/swagger.json\"</span>, <span class=\"string\">\"ApiHelp V1\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">//swagger,</span></span><br><span class=\"line\">    options.RoutePrefix = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br></pre></td></tr></table></figure>\n\n<p><br>xml<br><img src=\"/2019/10/07/net-core-v3-swagger/4.png\" alt=\"\"><br><br><img src=\"/2019/10/07/net-core-v3-swagger/5.png\" alt=\"\"></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">region</span> Swagger</span></span><br><span class=\"line\">services.AddSwaggerGen(options =&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    options.SwaggerDoc(<span class=\"string\">\"v1\"</span>, <span class=\"keyword\">new</span> OpenApiInfo</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Version = <span class=\"string\">\"v1.1.0\"</span>,</span><br><span class=\"line\">        Title = <span class=\"string\">\"ERP WebAPI\"</span>,</span><br><span class=\"line\">        Description = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">        Contact = <span class=\"keyword\">new</span> OpenApiContact() &#123; Name = <span class=\"string\">\"Blank\"</span>, Email = <span class=\"string\">\"1829027193@qq.com\"</span>, Url = <span class=\"keyword\">new</span> Uri(<span class=\"string\">\"https://www.cnblogs.com/AprilBlank/\"</span>) &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"comment\">//  Swagger JSON and UIxml</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> basePath = Path.GetDirectoryName(AppContext.BaseDirectory);<span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> xmlPath = Path.Combine(basePath, <span class=\"string\">\"ERP.Api.xml\"</span>);</span><br><span class=\"line\">    options.IncludeXmlComments(xmlPath);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/2019/10/07/net-core-v3-swagger/6.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>Values</p>\n</blockquote>\n<p>ok<br><img src=\"/2019/10/07/net-core-v3-swagger/7.png\" alt=\"\"><br>swagger<br><img src=\"/2019/10/07/net-core-v3-swagger/8.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net core 3.0<strong></strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net core 3.0Swagger3.020193.0</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>3.0<br><img src=\"/2019/10/07/net-core-v3-swagger/1.png\" alt=\"\"></p>\n<blockquote>\n<p>3.0StartupMvcControllers<strong>Values</strong>apiWeatherForecast</p>\n</blockquote>\n<p>swagger<br><img src=\"/2019/10/07/net-core-v3-swagger/2.png\" alt=\"\"></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">region</span> Swagger</span></span><br><span class=\"line\">services.AddSwaggerGen(options =&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    options.SwaggerDoc(<span class=\"string\">\"v1\"</span>, <span class=\"keyword\">new</span> OpenApiInfo</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Version = <span class=\"string\">\"v1.1.0\"</span>,</span><br><span class=\"line\">        Title = <span class=\"string\">\"ERP WebAPI\"</span>,</span><br><span class=\"line\">        Description = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">        Contact = <span class=\"keyword\">new</span> OpenApiContact() &#123; Name = <span class=\"string\">\"Blank\"</span>, Email = <span class=\"string\">\"1829027193@qq.com\"</span>, Url = <span class=\"keyword\">new</span> Uri(<span class=\"string\">\"https://www.cnblogs.com/AprilBlank/\"</span>) &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/2019/10/07/net-core-v3-swagger/3.png\" alt=\"\"></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">region</span> Swagger</span></span><br><span class=\"line\">app.UseSwagger();</span><br><span class=\"line\">app.UseSwaggerUI(options =&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    options.SwaggerEndpoint(<span class=\"string\">\"/swagger/v1/swagger.json\"</span>, <span class=\"string\">\"ApiHelp V1\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">//swagger,</span></span><br><span class=\"line\">    options.RoutePrefix = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br></pre></td></tr></table></figure>\n\n<p><br>xml<br><img src=\"/2019/10/07/net-core-v3-swagger/4.png\" alt=\"\"><br><br><img src=\"/2019/10/07/net-core-v3-swagger/5.png\" alt=\"\"></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">region</span> Swagger</span></span><br><span class=\"line\">services.AddSwaggerGen(options =&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    options.SwaggerDoc(<span class=\"string\">\"v1\"</span>, <span class=\"keyword\">new</span> OpenApiInfo</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Version = <span class=\"string\">\"v1.1.0\"</span>,</span><br><span class=\"line\">        Title = <span class=\"string\">\"ERP WebAPI\"</span>,</span><br><span class=\"line\">        Description = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">        Contact = <span class=\"keyword\">new</span> OpenApiContact() &#123; Name = <span class=\"string\">\"Blank\"</span>, Email = <span class=\"string\">\"1829027193@qq.com\"</span>, Url = <span class=\"keyword\">new</span> Uri(<span class=\"string\">\"https://www.cnblogs.com/AprilBlank/\"</span>) &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"comment\">//  Swagger JSON and UIxml</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> basePath = Path.GetDirectoryName(AppContext.BaseDirectory);<span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> xmlPath = Path.Combine(basePath, <span class=\"string\">\"ERP.Api.xml\"</span>);</span><br><span class=\"line\">    options.IncludeXmlComments(xmlPath);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/2019/10/07/net-core-v3-swagger/6.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>Values</p>\n</blockquote>\n<p>ok<br><img src=\"/2019/10/07/net-core-v3-swagger/7.png\" alt=\"\"><br>swagger<br><img src=\"/2019/10/07/net-core-v3-swagger/8.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net core 3.0<strong></strong></p>\n"},{"title":"net core Webapi ","date":"2019-07-19T03:19:58.000Z","_content":"\n### \n\n- [net core Webapi](/2019/07/02/net-core-tools-and-environment/)\n- [net core Webapi](/2019/07/02/net-core-createprogram/)\n- [net core WebapiSwagger](/2019/07/02/net-core-swagger/)\n- [net core Webapilog4net](/2019/07/04/net-core-log4net/)\n- [net core Webapi](/2019/07/10/net-core-cache/)\n- [net core Webapi_Part 1](/2019/07/18/net-core-sqlsugar-1/)\n- [net core Webapi_Part 2](/2019/07/19/net-core-sqlsugar-2/)\n- [net core WebapiAOP_Part 1](/2019/07/30/net-core-aop-1/)\n- [net core WebapiAOP_Part 2](/2019/08/01/net-core-aop-2/)\n\n### \n\n\n\n- [gitee](https://gitee.com/AprilBlank/April.WebApi)\n- [github](https://github.com/AprilBlank/April.WebApi)\n\n","source":"_posts/net-core-webapi-main.md","raw":"---\ntitle: net core Webapi \ndate: 2019-07-19 11:19:58\ntags: net core\ncategories: AprilBlank\n---\n\n### \n\n- [net core Webapi](/2019/07/02/net-core-tools-and-environment/)\n- [net core Webapi](/2019/07/02/net-core-createprogram/)\n- [net core WebapiSwagger](/2019/07/02/net-core-swagger/)\n- [net core Webapilog4net](/2019/07/04/net-core-log4net/)\n- [net core Webapi](/2019/07/10/net-core-cache/)\n- [net core Webapi_Part 1](/2019/07/18/net-core-sqlsugar-1/)\n- [net core Webapi_Part 2](/2019/07/19/net-core-sqlsugar-2/)\n- [net core WebapiAOP_Part 1](/2019/07/30/net-core-aop-1/)\n- [net core WebapiAOP_Part 2](/2019/08/01/net-core-aop-2/)\n\n### \n\n\n\n- [gitee](https://gitee.com/AprilBlank/April.WebApi)\n- [github](https://github.com/AprilBlank/April.WebApi)\n\n","slug":"net-core-webapi-main","published":1,"updated":"2019-09-30T05:47:27.733Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2s001r9sv7y9kxn9pu","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><a href=\"/2019/07/02/net-core-tools-and-environment/\">net core Webapi</a></li>\n<li><a href=\"/2019/07/02/net-core-createprogram/\">net core Webapi</a></li>\n<li><a href=\"/2019/07/02/net-core-swagger/\">net core WebapiSwagger</a></li>\n<li><a href=\"/2019/07/04/net-core-log4net/\">net core Webapilog4net</a></li>\n<li><a href=\"/2019/07/10/net-core-cache/\">net core Webapi</a></li>\n<li><a href=\"/2019/07/18/net-core-sqlsugar-1/\">net core Webapi_Part 1</a></li>\n<li><a href=\"/2019/07/19/net-core-sqlsugar-2/\">net core Webapi_Part 2</a></li>\n<li><a href=\"/2019/07/30/net-core-aop-1/\">net core WebapiAOP_Part 1</a></li>\n<li><a href=\"/2019/08/01/net-core-aop-2/\">net core WebapiAOP_Part 2</a></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li><a href=\"https://gitee.com/AprilBlank/April.WebApi\" target=\"_blank\" rel=\"noopener\">gitee</a></li>\n<li><a href=\"https://github.com/AprilBlank/April.WebApi\" target=\"_blank\" rel=\"noopener\">github</a></li>\n</ul>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><a href=\"/2019/07/02/net-core-tools-and-environment/\">net core Webapi</a></li>\n<li><a href=\"/2019/07/02/net-core-createprogram/\">net core Webapi</a></li>\n<li><a href=\"/2019/07/02/net-core-swagger/\">net core WebapiSwagger</a></li>\n<li><a href=\"/2019/07/04/net-core-log4net/\">net core Webapilog4net</a></li>\n<li><a href=\"/2019/07/10/net-core-cache/\">net core Webapi</a></li>\n<li><a href=\"/2019/07/18/net-core-sqlsugar-1/\">net core Webapi_Part 1</a></li>\n<li><a href=\"/2019/07/19/net-core-sqlsugar-2/\">net core Webapi_Part 2</a></li>\n<li><a href=\"/2019/07/30/net-core-aop-1/\">net core WebapiAOP_Part 1</a></li>\n<li><a href=\"/2019/08/01/net-core-aop-2/\">net core WebapiAOP_Part 2</a></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li><a href=\"https://gitee.com/AprilBlank/April.WebApi\" target=\"_blank\" rel=\"noopener\">gitee</a></li>\n<li><a href=\"https://github.com/AprilBlank/April.WebApi\" target=\"_blank\" rel=\"noopener\">github</a></li>\n</ul>\n"},{"title":"Linux_Docker","date":"2019-10-28T07:03:33.000Z","_content":"\n### \nLinuxnet core\n\n### Docker\nDockerdocker\"\"dockermysqlredisnginxdockerdockerdocker\n\n### \nroot\n1. yum\n\n```bash\n$ sudo yum update\n```\n\n2. docker\n\n```bash\n$ yum install -y docker\n```\n3. Docker\n\n```bash\n$ sudo systemctl start docker\n```\n\n4. Docker\n\n```bash\n$ sudo systemctl enable docker\n```\n\n5. Docker\n\n```bash\n$ sudo docker run hello-world\n$ docker ps -a\n```\n\n### \n\n**Docker**\n```\ndocker version\n```\n\n**Docker**\n```\ndocker info\n```\n\n****\n```\ndocker pull image_name //:version\n```\n\n****\n```\ndocker images\n```\n\n****\n```\ndocker rmi image_name\n```\n\n**<none>**\n```\ndocker rmi $(docker images | grep \"<none>\" | awk '{print $3}') \n```\n\n****\n```\ndocker rmi `docker images -q`\n```\n\n****\n```\ndocker rmi --force `docker images | grep keyname | awk '{print $3}}'` //keyname\n```\n\n****\n```\ndocker run image_name -d -p port:port\n```\n\n****\n```\ndocker start -i ID\ndocker stop -i ID\ndocker restart -i ID\n```\n\n****\n```\ndocker ps\n```\n\n****\n```\ndocker ps -a\n```\n\n****\n```\ndocker kill -s KILL ID\n```\n\n****\n```\ndocker save -o filename.tar image_name:version\n```\n\n****\n```\ndocker load -i filename.tar\n```\n\n****\n```\ndocker export -o filename.tar ID\n```\n\n****\n```\ncat ./filepath/filename.tar | sudo docker import - image_name:version\n```\n\n****\n```\ndocker pause\n```\n\n****\n```\ndocker unpause\n```\n\n****\n```\ndocker logs -f --tail 10 ID //10\n```\n\n### \nnet coredocker\n","source":"_posts/vmare-docker.md","raw":"---\ntitle: Linux_Docker\ndate: 2019-10-28 15:03:33\ntags: [vmware,]\ncategories: AprilBlank\n---\n\n### \nLinuxnet core\n\n### Docker\nDockerdocker\"\"dockermysqlredisnginxdockerdockerdocker\n\n### \nroot\n1. yum\n\n```bash\n$ sudo yum update\n```\n\n2. docker\n\n```bash\n$ yum install -y docker\n```\n3. Docker\n\n```bash\n$ sudo systemctl start docker\n```\n\n4. Docker\n\n```bash\n$ sudo systemctl enable docker\n```\n\n5. Docker\n\n```bash\n$ sudo docker run hello-world\n$ docker ps -a\n```\n\n### \n\n**Docker**\n```\ndocker version\n```\n\n**Docker**\n```\ndocker info\n```\n\n****\n```\ndocker pull image_name //:version\n```\n\n****\n```\ndocker images\n```\n\n****\n```\ndocker rmi image_name\n```\n\n**<none>**\n```\ndocker rmi $(docker images | grep \"<none>\" | awk '{print $3}') \n```\n\n****\n```\ndocker rmi `docker images -q`\n```\n\n****\n```\ndocker rmi --force `docker images | grep keyname | awk '{print $3}}'` //keyname\n```\n\n****\n```\ndocker run image_name -d -p port:port\n```\n\n****\n```\ndocker start -i ID\ndocker stop -i ID\ndocker restart -i ID\n```\n\n****\n```\ndocker ps\n```\n\n****\n```\ndocker ps -a\n```\n\n****\n```\ndocker kill -s KILL ID\n```\n\n****\n```\ndocker save -o filename.tar image_name:version\n```\n\n****\n```\ndocker load -i filename.tar\n```\n\n****\n```\ndocker export -o filename.tar ID\n```\n\n****\n```\ncat ./filepath/filename.tar | sudo docker import - image_name:version\n```\n\n****\n```\ndocker pause\n```\n\n****\n```\ndocker unpause\n```\n\n****\n```\ndocker logs -f --tail 10 ID //10\n```\n\n### \nnet coredocker\n","slug":"vmare-docker","published":1,"updated":"2019-10-29T02:40:41.957Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2t001v9sv7th7em5nn","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Linuxnet core</p>\n<h3 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h3><p>Dockerdockerdockermysqlredisnginxdockerdockerdocker</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>root</p>\n<ol>\n<li>yum</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo yum update</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>docker</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ yum install -y docker</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>Docker</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo systemctl start docker</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>Docker</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo systemctl <span class=\"built_in\">enable</span> docker</span><br></pre></td></tr></table></figure>\n\n<ol start=\"5\">\n<li>Docker</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo docker run hello-world</span><br><span class=\"line\">$ docker ps -a</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>Docker</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker version</span><br></pre></td></tr></table></figure>\n\n<p><strong>Docker</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker info</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull image_name //:version</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi image_name</span><br></pre></td></tr></table></figure>\n\n<p><strong><none></none></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi $(docker images | grep &quot;&lt;none&gt;&quot; | awk &apos;&#123;print $3&#125;&apos;)</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi `docker images -q`</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi --force `docker images | grep keyname | awk &apos;&#123;print $3&#125;&#125;&apos;` //keyname</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run image_name -d -p port:port</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker start -i ID</span><br><span class=\"line\">docker stop -i ID</span><br><span class=\"line\">docker restart -i ID</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker ps</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker ps -a</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker kill -s KILL ID</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker save -o filename.tar image_name:version</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker load -i filename.tar</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker export -o filename.tar ID</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat ./filepath/filename.tar | sudo docker import - image_name:version</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pause</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker unpause</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker logs -f --tail 10 ID //10</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net coredocker</p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Linuxnet core</p>\n<h3 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h3><p>Dockerdockerdockermysqlredisnginxdockerdockerdocker</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>root</p>\n<ol>\n<li>yum</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo yum update</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>docker</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ yum install -y docker</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>Docker</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo systemctl start docker</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>Docker</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo systemctl <span class=\"built_in\">enable</span> docker</span><br></pre></td></tr></table></figure>\n\n<ol start=\"5\">\n<li>Docker</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo docker run hello-world</span><br><span class=\"line\">$ docker ps -a</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>Docker</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker version</span><br></pre></td></tr></table></figure>\n\n<p><strong>Docker</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker info</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull image_name //:version</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi image_name</span><br></pre></td></tr></table></figure>\n\n<p><strong><none></none></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi $(docker images | grep &quot;&lt;none&gt;&quot; | awk &apos;&#123;print $3&#125;&apos;)</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi `docker images -q`</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi --force `docker images | grep keyname | awk &apos;&#123;print $3&#125;&#125;&apos;` //keyname</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run image_name -d -p port:port</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker start -i ID</span><br><span class=\"line\">docker stop -i ID</span><br><span class=\"line\">docker restart -i ID</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker ps</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker ps -a</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker kill -s KILL ID</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker save -o filename.tar image_name:version</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker load -i filename.tar</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker export -o filename.tar ID</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat ./filepath/filename.tar | sudo docker import - image_name:version</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pause</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker unpause</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker logs -f --tail 10 ID //10</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net coredocker</p>\n"},{"title":"vuelaravel-permission@can","date":"2019-08-02T02:24:00.000Z","_content":"\n#### 1.  model \n```php\npublic function getAllPermissionsAttribute() {\n\t$permissions = $this->getAllPermissions();\n  $permission_names = [];\n\n  collect($permissions)->map(function ($permission) use (&$permission_names) {\n      $permission_names[] = $permission->name;\n  });\n\n  return $permission_names;\n}\n```\n\n#### 2.  app.blade \n```html\n<script>\n    @auth\n        window.Permissions = @json(Auth::user()->allPermissions);\n    @else\n        window.Permissions = [];\n    @endauth\n</script>\n```\n#### 3.  vue component\n```vue\n<script>\n    export default {\n        methods: {\n            $can(permissionName) {\n                return Permissions.indexOf(permissionName) !== -1;\n            }\n        }\n    };\n</script>\n```\n\n#### 4.   app.js  vue \n```\nimport auth from './components/AuthComponent';\\\nVue.mixin(auth);\n```\n\n#### 5. vue\n```\n <a v-if=\"$can('admin.admins.delete')\" class=\"text-danger\" @click=\"dataDelete(admin)\">\n ```\n","source":"_posts/use-laravel-permission-can-tag-in-vue.md","raw":"---\ntitle: vuelaravel-permission@can\ndate: 2019-08-02 10:24:00\ntags: [vue, laravel]\ncategories: \n---\n\n#### 1.  model \n```php\npublic function getAllPermissionsAttribute() {\n\t$permissions = $this->getAllPermissions();\n  $permission_names = [];\n\n  collect($permissions)->map(function ($permission) use (&$permission_names) {\n      $permission_names[] = $permission->name;\n  });\n\n  return $permission_names;\n}\n```\n\n#### 2.  app.blade \n```html\n<script>\n    @auth\n        window.Permissions = @json(Auth::user()->allPermissions);\n    @else\n        window.Permissions = [];\n    @endauth\n</script>\n```\n#### 3.  vue component\n```vue\n<script>\n    export default {\n        methods: {\n            $can(permissionName) {\n                return Permissions.indexOf(permissionName) !== -1;\n            }\n        }\n    };\n</script>\n```\n\n#### 4.   app.js  vue \n```\nimport auth from './components/AuthComponent';\\\nVue.mixin(auth);\n```\n\n#### 5. vue\n```\n <a v-if=\"$can('admin.admins.delete')\" class=\"text-danger\" @click=\"dataDelete(admin)\">\n ```\n","slug":"use-laravel-permission-can-tag-in-vue","published":1,"updated":"2019-09-30T05:50:56.797Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2u001y9sv77vdj2oc2","content":"<h4 id=\"1--model-\"><a href=\"#1--model-\" class=\"headerlink\" title=\"1.  model \"></a>1.  model </h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getAllPermissionsAttribute</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t$permissions = <span class=\"keyword\">$this</span>-&gt;getAllPermissions();</span><br><span class=\"line\">  $permission_names = [];</span><br><span class=\"line\"></span><br><span class=\"line\">  collect($permissions)-&gt;map(<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($permission)</span> <span class=\"title\">use</span> <span class=\"params\">(&amp;$permission_names)</span> </span>&#123;</span><br><span class=\"line\">      $permission_names[] = $permission-&gt;name;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> $permission_names;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2--app-blade-\"><a href=\"#2--app-blade-\" class=\"headerlink\" title=\"2.  app.blade \"></a>2.  app.blade </h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    @auth</span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.Permissions = @json(Auth::user()-&gt;allPermissions);</span></span><br><span class=\"line\"><span class=\"javascript\">    @<span class=\"keyword\">else</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.Permissions = [];</span></span><br><span class=\"line\">    @endauth</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3--vue-component\"><a href=\"#3--vue-component\" class=\"headerlink\" title=\"3.  vue component\"></a>3.  vue component</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">    export default &#123;</span><br><span class=\"line\">        methods: &#123;</span><br><span class=\"line\">            $can(permissionName) &#123;</span><br><span class=\"line\">                return Permissions.indexOf(permissionName) !== -1;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"4--app-js--vue-\"><a href=\"#4--app-js--vue-\" class=\"headerlink\" title=\"4.   app.js  vue \"></a>4.   app.js  vue </h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import auth from &apos;./components/AuthComponent&apos;;\\</span><br><span class=\"line\">Vue.mixin(auth);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"5-vue\"><a href=\"#5-vue\" class=\"headerlink\" title=\"5. vue\"></a>5. vue</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;a v-if=&quot;$can(&apos;admin.admins.delete&apos;)&quot; class=&quot;text-danger&quot; @click=&quot;dataDelete(admin)&quot;&gt;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h4 id=\"1--model-\"><a href=\"#1--model-\" class=\"headerlink\" title=\"1.  model \"></a>1.  model </h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getAllPermissionsAttribute</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t$permissions = <span class=\"keyword\">$this</span>-&gt;getAllPermissions();</span><br><span class=\"line\">  $permission_names = [];</span><br><span class=\"line\"></span><br><span class=\"line\">  collect($permissions)-&gt;map(<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($permission)</span> <span class=\"title\">use</span> <span class=\"params\">(&amp;$permission_names)</span> </span>&#123;</span><br><span class=\"line\">      $permission_names[] = $permission-&gt;name;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> $permission_names;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2--app-blade-\"><a href=\"#2--app-blade-\" class=\"headerlink\" title=\"2.  app.blade \"></a>2.  app.blade </h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    @auth</span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.Permissions = @json(Auth::user()-&gt;allPermissions);</span></span><br><span class=\"line\"><span class=\"javascript\">    @<span class=\"keyword\">else</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.Permissions = [];</span></span><br><span class=\"line\">    @endauth</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3--vue-component\"><a href=\"#3--vue-component\" class=\"headerlink\" title=\"3.  vue component\"></a>3.  vue component</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">    export default &#123;</span><br><span class=\"line\">        methods: &#123;</span><br><span class=\"line\">            $can(permissionName) &#123;</span><br><span class=\"line\">                return Permissions.indexOf(permissionName) !== -1;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"4--app-js--vue-\"><a href=\"#4--app-js--vue-\" class=\"headerlink\" title=\"4.   app.js  vue \"></a>4.   app.js  vue </h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import auth from &apos;./components/AuthComponent&apos;;\\</span><br><span class=\"line\">Vue.mixin(auth);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"5-vue\"><a href=\"#5-vue\" class=\"headerlink\" title=\"5. vue\"></a>5. vue</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;a v-if=&quot;$can(&apos;admin.admins.delete&apos;)&quot; class=&quot;text-danger&quot; @click=&quot;dataDelete(admin)&quot;&gt;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"tp5$_FILESrequestfile","date":"2019-07-11T06:43:56.000Z","_content":"\n### \nphpphpform\n\n### \nlayuiController\n\nhtml\n```html\n               <div class=\"col-md-6 column\">\n                    <div class=\"form-group\">\n                        <label for=\"describe\"></label>\n                        <div class=\"input-group\">\n                            <input id='location' class=\"form-control\" readonly=\"\">\n                            <label class=\"input-group-btn\">\n                                <input type=\"button\" id=\"i-check\" value=\"\" class=\"btn btn-primary\" > <!-- onclick=\"$('#i-file').click();\" -->\n                            </label>\n                       </div>\n                    </div>\n                </div>\n```\n\n```js\n\tvar img_index;\n    layui.use('upload', function(){\n        var $ = layui.jquery\n            ,upload = layui.upload;\n        upload.render({\n            elem: '#i-check'\n            ,url: '/Instorage/upload'\n            ,accept: 'images'\n            ,ext: 'jpg|png|jpeg'\n            ,acceptMime: 'image/*'\n            ,number: 1\n            ,method: 'post'\n            //,auto: false\n            ,before: function(obj) {\n                img_index = layer.msg(\"...\",{\n                    time: 3000,\n                });\n                // obj.preview(function(index, file, result){\n                //     console.log(file);\n                //     $(\"#location\").val(file.name);\n                // });\n            }\n            ,done: function(res){\n              //console.log(res);\n              layer.close(img_index);\n              if(res.code==1){\n                $(\"#location\").val(decodeURIComponent(res.message));\n              }else{\n                layer.msg(\",\");\n              }\n            }\n          });\n    });\n```\n\n\n\n```php\n\tpublic function upload(){\n        //   \n        $file = request()->file('file'); \n        //var_dump($file);\n        //var_dump($_FILES);\n        if(empty($file)) {  \n            return AjaxReturn(0,'');\n        }  \n        // /public/uploads/   \n        $info = $file->move('./public/static/uploads/img/'); \n        //$info  \n        //$info->getFilename()  ***********\n        ///$info->getSaveName()  **********\n        $filename = $info->getSaveName();  // \n        if($filename){              \n            return AjaxReturn(1,'/public/static/uploads/img/' . $filename);\n        }else{  \n            //   \n            return AjaxReturn(0);\n        }  \n    }\n```\n\n### \n#### \n- \n- js\n- \n#### \n- request()->file() array(0)\n- $_FILESarray(1)\n\nphplayuiformData\n\nphp$_FILES\n![](tp5-fileupload-requestfile-is-null/1.png)\nerrorerror\n\n\n\n|ErrorCode|  |\n|--|--|\n| 0 |  |\n| 1 |  php.ini  upload_max_filesize |\n| 2 |  HTML  MAX_FILE_SIZE  |\n| 3 |  |\n| 4 |  |\n| 6 |  |\n| 7 |  |\n\n### \n\n\n","source":"_posts/tp5-fileupload-requestfile-is-null.md","raw":"---\ntitle: tp5$_FILESrequestfile\ndate: 2019-07-11 14:43:56\ntags: [php,]\ncategories: AprilBlank\n---\n\n### \nphpphpform\n\n### \nlayuiController\n\nhtml\n```html\n               <div class=\"col-md-6 column\">\n                    <div class=\"form-group\">\n                        <label for=\"describe\"></label>\n                        <div class=\"input-group\">\n                            <input id='location' class=\"form-control\" readonly=\"\">\n                            <label class=\"input-group-btn\">\n                                <input type=\"button\" id=\"i-check\" value=\"\" class=\"btn btn-primary\" > <!-- onclick=\"$('#i-file').click();\" -->\n                            </label>\n                       </div>\n                    </div>\n                </div>\n```\n\n```js\n\tvar img_index;\n    layui.use('upload', function(){\n        var $ = layui.jquery\n            ,upload = layui.upload;\n        upload.render({\n            elem: '#i-check'\n            ,url: '/Instorage/upload'\n            ,accept: 'images'\n            ,ext: 'jpg|png|jpeg'\n            ,acceptMime: 'image/*'\n            ,number: 1\n            ,method: 'post'\n            //,auto: false\n            ,before: function(obj) {\n                img_index = layer.msg(\"...\",{\n                    time: 3000,\n                });\n                // obj.preview(function(index, file, result){\n                //     console.log(file);\n                //     $(\"#location\").val(file.name);\n                // });\n            }\n            ,done: function(res){\n              //console.log(res);\n              layer.close(img_index);\n              if(res.code==1){\n                $(\"#location\").val(decodeURIComponent(res.message));\n              }else{\n                layer.msg(\",\");\n              }\n            }\n          });\n    });\n```\n\n\n\n```php\n\tpublic function upload(){\n        //   \n        $file = request()->file('file'); \n        //var_dump($file);\n        //var_dump($_FILES);\n        if(empty($file)) {  \n            return AjaxReturn(0,'');\n        }  \n        // /public/uploads/   \n        $info = $file->move('./public/static/uploads/img/'); \n        //$info  \n        //$info->getFilename()  ***********\n        ///$info->getSaveName()  **********\n        $filename = $info->getSaveName();  // \n        if($filename){              \n            return AjaxReturn(1,'/public/static/uploads/img/' . $filename);\n        }else{  \n            //   \n            return AjaxReturn(0);\n        }  \n    }\n```\n\n### \n#### \n- \n- js\n- \n#### \n- request()->file() array(0)\n- $_FILESarray(1)\n\nphplayuiformData\n\nphp$_FILES\n![](tp5-fileupload-requestfile-is-null/1.png)\nerrorerror\n\n\n\n|ErrorCode|  |\n|--|--|\n| 0 |  |\n| 1 |  php.ini  upload_max_filesize |\n| 2 |  HTML  MAX_FILE_SIZE  |\n| 3 |  |\n| 4 |  |\n| 6 |  |\n| 7 |  |\n\n### \n\n\n","slug":"tp5-fileupload-requestfile-is-null","published":1,"updated":"2019-09-30T05:45:34.549Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2w00229sv7y31462vg","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>phpphpform</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>layuiController</p>\n<p>html</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"col-md-6 column\"</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"form-group\"</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"describe\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"input-group\"</span>&gt;</span></span><br><span class=\"line\">             <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">id</span>=<span class=\"string\">'location'</span> <span class=\"attr\">class</span>=<span class=\"string\">\"form-control\"</span> <span class=\"attr\">readonly</span>=<span class=\"string\">\"\"</span>&gt;</span></span><br><span class=\"line\">             <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">class</span>=<span class=\"string\">\"input-group-btn\"</span>&gt;</span></span><br><span class=\"line\">                 <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"i-check\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"btn btn-primary\"</span> &gt;</span> <span class=\"comment\">&lt;!-- onclick=\"$('#i-file').click();\" --&gt;</span></span><br><span class=\"line\">             <span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> img_index;</span><br><span class=\"line\">   layui.use(<span class=\"string\">'upload'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">       <span class=\"keyword\">var</span> $ = layui.jquery</span><br><span class=\"line\">           ,upload = layui.upload;</span><br><span class=\"line\">       upload.render(&#123;</span><br><span class=\"line\">           elem: <span class=\"string\">'#i-check'</span></span><br><span class=\"line\">           ,<span class=\"attr\">url</span>: <span class=\"string\">'/Instorage/upload'</span></span><br><span class=\"line\">           ,<span class=\"attr\">accept</span>: <span class=\"string\">'images'</span></span><br><span class=\"line\">           ,<span class=\"attr\">ext</span>: <span class=\"string\">'jpg|png|jpeg'</span></span><br><span class=\"line\">           ,<span class=\"attr\">acceptMime</span>: <span class=\"string\">'image/*'</span></span><br><span class=\"line\">           ,<span class=\"attr\">number</span>: <span class=\"number\">1</span></span><br><span class=\"line\">           ,<span class=\"attr\">method</span>: <span class=\"string\">'post'</span></span><br><span class=\"line\">           <span class=\"comment\">//,auto: false</span></span><br><span class=\"line\">           ,<span class=\"attr\">before</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">obj</span>) </span>&#123;</span><br><span class=\"line\">               img_index = layer.msg(<span class=\"string\">\"...\"</span>,&#123;</span><br><span class=\"line\">                   time: <span class=\"number\">3000</span>,</span><br><span class=\"line\">               &#125;);</span><br><span class=\"line\">               <span class=\"comment\">// obj.preview(function(index, file, result)&#123;</span></span><br><span class=\"line\">               <span class=\"comment\">//     console.log(file);</span></span><br><span class=\"line\">               <span class=\"comment\">//     $(\"#location\").val(file.name);</span></span><br><span class=\"line\">               <span class=\"comment\">// &#125;);</span></span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           ,<span class=\"attr\">done</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">res</span>)</span>&#123;</span><br><span class=\"line\">             <span class=\"comment\">//console.log(res);</span></span><br><span class=\"line\">             layer.close(img_index);</span><br><span class=\"line\">             <span class=\"keyword\">if</span>(res.code==<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">               $(<span class=\"string\">\"#location\"</span>).val(<span class=\"built_in\">decodeURIComponent</span>(res.message));</span><br><span class=\"line\">             &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">               layer.msg(<span class=\"string\">\",\"</span>);</span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">         &#125;);</span><br><span class=\"line\">   &#125;);</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">       <span class=\"comment\">//   </span></span><br><span class=\"line\">       $file = request()-&gt;file(<span class=\"string\">'file'</span>); </span><br><span class=\"line\">       <span class=\"comment\">//var_dump($file);</span></span><br><span class=\"line\">       <span class=\"comment\">//var_dump($_FILES);</span></span><br><span class=\"line\">       <span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>($file)) &#123;  </span><br><span class=\"line\">           <span class=\"keyword\">return</span> AjaxReturn(<span class=\"number\">0</span>,<span class=\"string\">''</span>);</span><br><span class=\"line\">       &#125;  </span><br><span class=\"line\">       <span class=\"comment\">// /public/uploads/   </span></span><br><span class=\"line\">       $info = $file-&gt;move(<span class=\"string\">'./public/static/uploads/img/'</span>); </span><br><span class=\"line\">       <span class=\"comment\">//$info  </span></span><br><span class=\"line\">       <span class=\"comment\">//$info-&gt;getFilename()  ***********</span></span><br><span class=\"line\">       <span class=\"comment\">///$info-&gt;getSaveName()  **********</span></span><br><span class=\"line\">       $filename = $info-&gt;getSaveName();  <span class=\"comment\">// </span></span><br><span class=\"line\">       <span class=\"keyword\">if</span>($filename)&#123;              </span><br><span class=\"line\">           <span class=\"keyword\">return</span> AjaxReturn(<span class=\"number\">1</span>,<span class=\"string\">'/public/static/uploads/img/'</span> . $filename);</span><br><span class=\"line\">       &#125;<span class=\"keyword\">else</span>&#123;  </span><br><span class=\"line\">           <span class=\"comment\">//   </span></span><br><span class=\"line\">           <span class=\"keyword\">return</span> AjaxReturn(<span class=\"number\">0</span>);</span><br><span class=\"line\">       &#125;  </span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li></li>\n<li>js</li>\n<li><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4></li>\n<li>request()-&gt;file() array(0)</li>\n<li>$_FILESarray(1)</li>\n</ul>\n<p>phplayuiformData</p>\n<p>php$_FILES<br><img src=\"/2019/07/11/tp5-fileupload-requestfile-is-null/1.png\" alt=\"\"><br>errorerror</p>\n<p></p>\n<table>\n<thead>\n<tr>\n<th>ErrorCode</th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>0</td>\n<td></td>\n</tr>\n<tr>\n<td>1</td>\n<td> php.ini  upload_max_filesize</td>\n</tr>\n<tr>\n<td>2</td>\n<td> HTML  MAX_FILE_SIZE </td>\n</tr>\n<tr>\n<td>3</td>\n<td></td>\n</tr>\n<tr>\n<td>4</td>\n<td></td>\n</tr>\n<tr>\n<td>6</td>\n<td></td>\n</tr>\n<tr>\n<td>7</td>\n<td></td>\n</tr>\n</tbody></table>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>phpphpform</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>layuiController</p>\n<p>html</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"col-md-6 column\"</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"form-group\"</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"describe\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"input-group\"</span>&gt;</span></span><br><span class=\"line\">             <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">id</span>=<span class=\"string\">'location'</span> <span class=\"attr\">class</span>=<span class=\"string\">\"form-control\"</span> <span class=\"attr\">readonly</span>=<span class=\"string\">\"\"</span>&gt;</span></span><br><span class=\"line\">             <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">class</span>=<span class=\"string\">\"input-group-btn\"</span>&gt;</span></span><br><span class=\"line\">                 <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"i-check\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"btn btn-primary\"</span> &gt;</span> <span class=\"comment\">&lt;!-- onclick=\"$('#i-file').click();\" --&gt;</span></span><br><span class=\"line\">             <span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> img_index;</span><br><span class=\"line\">   layui.use(<span class=\"string\">'upload'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">       <span class=\"keyword\">var</span> $ = layui.jquery</span><br><span class=\"line\">           ,upload = layui.upload;</span><br><span class=\"line\">       upload.render(&#123;</span><br><span class=\"line\">           elem: <span class=\"string\">'#i-check'</span></span><br><span class=\"line\">           ,<span class=\"attr\">url</span>: <span class=\"string\">'/Instorage/upload'</span></span><br><span class=\"line\">           ,<span class=\"attr\">accept</span>: <span class=\"string\">'images'</span></span><br><span class=\"line\">           ,<span class=\"attr\">ext</span>: <span class=\"string\">'jpg|png|jpeg'</span></span><br><span class=\"line\">           ,<span class=\"attr\">acceptMime</span>: <span class=\"string\">'image/*'</span></span><br><span class=\"line\">           ,<span class=\"attr\">number</span>: <span class=\"number\">1</span></span><br><span class=\"line\">           ,<span class=\"attr\">method</span>: <span class=\"string\">'post'</span></span><br><span class=\"line\">           <span class=\"comment\">//,auto: false</span></span><br><span class=\"line\">           ,<span class=\"attr\">before</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">obj</span>) </span>&#123;</span><br><span class=\"line\">               img_index = layer.msg(<span class=\"string\">\"...\"</span>,&#123;</span><br><span class=\"line\">                   time: <span class=\"number\">3000</span>,</span><br><span class=\"line\">               &#125;);</span><br><span class=\"line\">               <span class=\"comment\">// obj.preview(function(index, file, result)&#123;</span></span><br><span class=\"line\">               <span class=\"comment\">//     console.log(file);</span></span><br><span class=\"line\">               <span class=\"comment\">//     $(\"#location\").val(file.name);</span></span><br><span class=\"line\">               <span class=\"comment\">// &#125;);</span></span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           ,<span class=\"attr\">done</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">res</span>)</span>&#123;</span><br><span class=\"line\">             <span class=\"comment\">//console.log(res);</span></span><br><span class=\"line\">             layer.close(img_index);</span><br><span class=\"line\">             <span class=\"keyword\">if</span>(res.code==<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">               $(<span class=\"string\">\"#location\"</span>).val(<span class=\"built_in\">decodeURIComponent</span>(res.message));</span><br><span class=\"line\">             &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">               layer.msg(<span class=\"string\">\",\"</span>);</span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">         &#125;);</span><br><span class=\"line\">   &#125;);</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">       <span class=\"comment\">//   </span></span><br><span class=\"line\">       $file = request()-&gt;file(<span class=\"string\">'file'</span>); </span><br><span class=\"line\">       <span class=\"comment\">//var_dump($file);</span></span><br><span class=\"line\">       <span class=\"comment\">//var_dump($_FILES);</span></span><br><span class=\"line\">       <span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>($file)) &#123;  </span><br><span class=\"line\">           <span class=\"keyword\">return</span> AjaxReturn(<span class=\"number\">0</span>,<span class=\"string\">''</span>);</span><br><span class=\"line\">       &#125;  </span><br><span class=\"line\">       <span class=\"comment\">// /public/uploads/   </span></span><br><span class=\"line\">       $info = $file-&gt;move(<span class=\"string\">'./public/static/uploads/img/'</span>); </span><br><span class=\"line\">       <span class=\"comment\">//$info  </span></span><br><span class=\"line\">       <span class=\"comment\">//$info-&gt;getFilename()  ***********</span></span><br><span class=\"line\">       <span class=\"comment\">///$info-&gt;getSaveName()  **********</span></span><br><span class=\"line\">       $filename = $info-&gt;getSaveName();  <span class=\"comment\">// </span></span><br><span class=\"line\">       <span class=\"keyword\">if</span>($filename)&#123;              </span><br><span class=\"line\">           <span class=\"keyword\">return</span> AjaxReturn(<span class=\"number\">1</span>,<span class=\"string\">'/public/static/uploads/img/'</span> . $filename);</span><br><span class=\"line\">       &#125;<span class=\"keyword\">else</span>&#123;  </span><br><span class=\"line\">           <span class=\"comment\">//   </span></span><br><span class=\"line\">           <span class=\"keyword\">return</span> AjaxReturn(<span class=\"number\">0</span>);</span><br><span class=\"line\">       &#125;  </span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li></li>\n<li>js</li>\n<li><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4></li>\n<li>request()-&gt;file() array(0)</li>\n<li>$_FILESarray(1)</li>\n</ul>\n<p>phplayuiformData</p>\n<p>php$_FILES<br><img src=\"/2019/07/11/tp5-fileupload-requestfile-is-null/1.png\" alt=\"\"><br>errorerror</p>\n<p></p>\n<table>\n<thead>\n<tr>\n<th>ErrorCode</th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>0</td>\n<td></td>\n</tr>\n<tr>\n<td>1</td>\n<td> php.ini  upload_max_filesize</td>\n</tr>\n<tr>\n<td>2</td>\n<td> HTML  MAX_FILE_SIZE </td>\n</tr>\n<tr>\n<td>3</td>\n<td></td>\n</tr>\n<tr>\n<td>4</td>\n<td></td>\n</tr>\n<tr>\n<td>6</td>\n<td></td>\n</tr>\n<tr>\n<td>7</td>\n<td></td>\n</tr>\n</tbody></table>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n"},{"title":"Linux_Redis","date":"2019-09-12T09:40:48.000Z","_content":"### \nmysqlredis\n\n### \n[Redis](http://download.redis.io/releases/)\n\n> wget\n\n```bash\n[root@april tmp]# wget http://download.redis.io/releases/redis-5.0.5.tar.gz\n\n[root@april tmp]# tar -zxvf redis-5.0.5.tar.gz -C /usr/local/\n\n```\n\ngccmake\n```bash\n[root@april tmp]# gcc -v\nbash: gcc: command not found...\n[root@april tmp]# sudo yum install -y gcc\n```\n\n```bash\n[root@april tmp]# cd /usr/local/redis-5.0.5/\n[root@april redis-5.0.5]# make MALLOC=libc \n[root@april redis-5.0.5]# cd src && make install\n```\n\n\n```bash\n[root@april src]# ./redis-server \n```\n![](vmware-redis/1.png)\nOK\n\n```bash\n #yes\ndaemonize yes  \n\n# \n# bind 127.0.0.1\n \n# \nprotected-mode no\n\n# RedisRedispid/var/run/redis.pidpidfile\npidfile /var/run/redis_6379.pid\n\n# Redis6379\n# 0RedisTCP\nport 6379\n\n# \ndir /var/redis/6379\n```\n\nredis\n\n```bash\n[root@april redis-5.0.5]# mkdir /etc/redis\n[root@april redis-5.0.5]# cp /usr/local/redis-5.0.5/redis.conf /etc/redis/6379.conf\n[root@april redis-5.0.5]# cp /usr/local/redis-5.0.5/utils/redis_init_script /etc/init.d/redisd\n# \n[root@april redis-5.0.5]# cd /etc/init.d/\n[root@april init.d]# chkconfig redisd on\n# \n[root@april init.d]# service redisd start\n```\n\n\n```bash\n[root@april init.d]# firewall-cmd --permanent --add-port=6379/tcp\nsuccess\n[root@april init.d]# firewall-cmd --reload\n```\n\n### \n![](vmware-redis/2.png)\n\n\n![](vmware-redis/3.png)\n\n### \nRedisredis","source":"_posts/vmware-redis.md","raw":"---\ntitle: Linux_Redis\ndate: 2019-09-12 17:40:48\ntags: [vmware,]\ncategories: AprilBlank\n---\n### \nmysqlredis\n\n### \n[Redis](http://download.redis.io/releases/)\n\n> wget\n\n```bash\n[root@april tmp]# wget http://download.redis.io/releases/redis-5.0.5.tar.gz\n\n[root@april tmp]# tar -zxvf redis-5.0.5.tar.gz -C /usr/local/\n\n```\n\ngccmake\n```bash\n[root@april tmp]# gcc -v\nbash: gcc: command not found...\n[root@april tmp]# sudo yum install -y gcc\n```\n\n```bash\n[root@april tmp]# cd /usr/local/redis-5.0.5/\n[root@april redis-5.0.5]# make MALLOC=libc \n[root@april redis-5.0.5]# cd src && make install\n```\n\n\n```bash\n[root@april src]# ./redis-server \n```\n![](vmware-redis/1.png)\nOK\n\n```bash\n #yes\ndaemonize yes  \n\n# \n# bind 127.0.0.1\n \n# \nprotected-mode no\n\n# RedisRedispid/var/run/redis.pidpidfile\npidfile /var/run/redis_6379.pid\n\n# Redis6379\n# 0RedisTCP\nport 6379\n\n# \ndir /var/redis/6379\n```\n\nredis\n\n```bash\n[root@april redis-5.0.5]# mkdir /etc/redis\n[root@april redis-5.0.5]# cp /usr/local/redis-5.0.5/redis.conf /etc/redis/6379.conf\n[root@april redis-5.0.5]# cp /usr/local/redis-5.0.5/utils/redis_init_script /etc/init.d/redisd\n# \n[root@april redis-5.0.5]# cd /etc/init.d/\n[root@april init.d]# chkconfig redisd on\n# \n[root@april init.d]# service redisd start\n```\n\n\n```bash\n[root@april init.d]# firewall-cmd --permanent --add-port=6379/tcp\nsuccess\n[root@april init.d]# firewall-cmd --reload\n```\n\n### \n![](vmware-redis/2.png)\n\n\n![](vmware-redis/3.png)\n\n### \nRedisredis","slug":"vmware-redis","published":1,"updated":"2019-09-30T05:47:52.646Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2x00259sv7wlxfvh6c","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>mysqlredis</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://download.redis.io/releases/\" target=\"_blank\" rel=\"noopener\">Redis</a></p>\n<blockquote>\n<p>wget</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april tmp]<span class=\"comment\"># wget http://download.redis.io/releases/redis-5.0.5.tar.gz</span></span><br><span class=\"line\"></span><br><span class=\"line\">[root@april tmp]<span class=\"comment\"># tar -zxvf redis-5.0.5.tar.gz -C /usr/local/</span></span><br></pre></td></tr></table></figure>\n\n<p>gccmake</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april tmp]<span class=\"comment\"># gcc -v</span></span><br><span class=\"line\">bash: gcc: <span class=\"built_in\">command</span> not found...</span><br><span class=\"line\">[root@april tmp]<span class=\"comment\"># sudo yum install -y gcc</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april tmp]<span class=\"comment\"># cd /usr/local/redis-5.0.5/</span></span><br><span class=\"line\">[root@april redis-5.0.5]<span class=\"comment\"># make MALLOC=libc </span></span><br><span class=\"line\">[root@april redis-5.0.5]<span class=\"comment\"># cd src &amp;&amp; make install</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april src]<span class=\"comment\"># ./redis-server</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/09/12/vmware-redis/1.png\" alt=\"\"><br>OK</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">#yes</span></span><br><span class=\"line\">daemonize yes  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"comment\"># bind 127.0.0.1</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">protected-mode no</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># RedisRedispid/var/run/redis.pidpidfile</span></span><br><span class=\"line\">pidfile /var/run/redis_6379.pid</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Redis6379</span></span><br><span class=\"line\"><span class=\"comment\"># 0RedisTCP</span></span><br><span class=\"line\">port 6379</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">dir /var/redis/6379</span><br></pre></td></tr></table></figure>\n\n<p>redis</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april redis-5.0.5]<span class=\"comment\"># mkdir /etc/redis</span></span><br><span class=\"line\">[root@april redis-5.0.5]<span class=\"comment\"># cp /usr/local/redis-5.0.5/redis.conf /etc/redis/6379.conf</span></span><br><span class=\"line\">[root@april redis-5.0.5]<span class=\"comment\"># cp /usr/local/redis-5.0.5/utils/redis_init_script /etc/init.d/redisd</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">[root@april redis-5.0.5]<span class=\"comment\"># cd /etc/init.d/</span></span><br><span class=\"line\">[root@april init.d]<span class=\"comment\"># chkconfig redisd on</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">[root@april init.d]<span class=\"comment\"># service redisd start</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april init.d]<span class=\"comment\"># firewall-cmd --permanent --add-port=6379/tcp</span></span><br><span class=\"line\">success</span><br><span class=\"line\">[root@april init.d]<span class=\"comment\"># firewall-cmd --reload</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/09/12/vmware-redis/2.png\" alt=\"\"></p>\n<p><br><img src=\"/2019/09/12/vmware-redis/3.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Redisredis</p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>mysqlredis</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://download.redis.io/releases/\" target=\"_blank\" rel=\"noopener\">Redis</a></p>\n<blockquote>\n<p>wget</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april tmp]<span class=\"comment\"># wget http://download.redis.io/releases/redis-5.0.5.tar.gz</span></span><br><span class=\"line\"></span><br><span class=\"line\">[root@april tmp]<span class=\"comment\"># tar -zxvf redis-5.0.5.tar.gz -C /usr/local/</span></span><br></pre></td></tr></table></figure>\n\n<p>gccmake</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april tmp]<span class=\"comment\"># gcc -v</span></span><br><span class=\"line\">bash: gcc: <span class=\"built_in\">command</span> not found...</span><br><span class=\"line\">[root@april tmp]<span class=\"comment\"># sudo yum install -y gcc</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april tmp]<span class=\"comment\"># cd /usr/local/redis-5.0.5/</span></span><br><span class=\"line\">[root@april redis-5.0.5]<span class=\"comment\"># make MALLOC=libc </span></span><br><span class=\"line\">[root@april redis-5.0.5]<span class=\"comment\"># cd src &amp;&amp; make install</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april src]<span class=\"comment\"># ./redis-server</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/09/12/vmware-redis/1.png\" alt=\"\"><br>OK</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">#yes</span></span><br><span class=\"line\">daemonize yes  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"comment\"># bind 127.0.0.1</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">protected-mode no</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># RedisRedispid/var/run/redis.pidpidfile</span></span><br><span class=\"line\">pidfile /var/run/redis_6379.pid</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Redis6379</span></span><br><span class=\"line\"><span class=\"comment\"># 0RedisTCP</span></span><br><span class=\"line\">port 6379</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">dir /var/redis/6379</span><br></pre></td></tr></table></figure>\n\n<p>redis</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april redis-5.0.5]<span class=\"comment\"># mkdir /etc/redis</span></span><br><span class=\"line\">[root@april redis-5.0.5]<span class=\"comment\"># cp /usr/local/redis-5.0.5/redis.conf /etc/redis/6379.conf</span></span><br><span class=\"line\">[root@april redis-5.0.5]<span class=\"comment\"># cp /usr/local/redis-5.0.5/utils/redis_init_script /etc/init.d/redisd</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">[root@april redis-5.0.5]<span class=\"comment\"># cd /etc/init.d/</span></span><br><span class=\"line\">[root@april init.d]<span class=\"comment\"># chkconfig redisd on</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">[root@april init.d]<span class=\"comment\"># service redisd start</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april init.d]<span class=\"comment\"># firewall-cmd --permanent --add-port=6379/tcp</span></span><br><span class=\"line\">success</span><br><span class=\"line\">[root@april init.d]<span class=\"comment\"># firewall-cmd --reload</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/09/12/vmware-redis/2.png\" alt=\"\"></p>\n<p><br><img src=\"/2019/09/12/vmware-redis/3.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Redisredis</p>\n"},{"title":"Linux_CentOS","date":"2019-08-21T05:48:19.000Z","_content":"\n### \nnet corenet coreLinuxWindowsLinux\n\n### VMware\nWindowsLinuxVMware-_-|||CentOS 7net core7\n\n### \n\n- \n![](vmware-use-centos/1.png)\n- \n![](vmware-use-centos/2.png)\n- \n![](vmware-use-centos/3.png)\n- \n![](vmware-use-centos/4.png)\n- \n![](vmware-use-centos/5.png)\n- \n![](vmware-use-centos/6.png)\n- \n![](vmware-use-centos/7.png)\n- \n![](vmware-use-centos/8.png)\n- \n![](vmware-use-centos/9.png)\n- \n![](vmware-use-centos/10.png)\n- \n![](vmware-use-centos/11.png)\n- \n![](vmware-use-centos/12.png)\n- \n![](vmware-use-centos/13.png)\n- \n![](vmware-use-centos/14.png)\n- \n![](vmware-use-centos/15.png)\n********\n![](vmware-use-centos/16.png)\n- \n![](vmware-use-centos/17.png)\n![](vmware-use-centos/18.png)\n\n![](vmware-use-centos/19.png)\n### \nOK\n\n\n\n![](vmware-use-centos/20.png)\n- \n![](vmware-use-centos/21.png)\n- \n![](vmware-use-centos/22.png)\n- \n![](vmware-use-centos/23.png)\n- MiniLinuxMini\n![](vmware-use-centos/24.png)\n![](vmware-use-centos/25.png)\n- \n![](vmware-use-centos/26.png)\n![](vmware-use-centos/27.png)\n- \n![](vmware-use-centos/28.png)\n![](vmware-use-centos/29.png)\n![](vmware-use-centos/30.png)\nroot\n![](vmware-use-centos/31.png)\n![](vmware-use-centos/32.png)\n![](vmware-use-centos/33.png)\nOK\n![](vmware-use-centos/34.png)\nWindowsNext\n![](vmware-use-centos/35.png)\nLinux\n![](vmware-use-centos/36.png)\n\n### \nVMwareVMwareLinuxNginxMySqlRedisDockernet coreLinux","source":"_posts/vmware-use-centos.md","raw":"---\ntitle: Linux_CentOS\ndate: 2019-08-21 13:48:19\ntags: [vmware,]\ncategories: AprilBlank\n---\n\n### \nnet corenet coreLinuxWindowsLinux\n\n### VMware\nWindowsLinuxVMware-_-|||CentOS 7net core7\n\n### \n\n- \n![](vmware-use-centos/1.png)\n- \n![](vmware-use-centos/2.png)\n- \n![](vmware-use-centos/3.png)\n- \n![](vmware-use-centos/4.png)\n- \n![](vmware-use-centos/5.png)\n- \n![](vmware-use-centos/6.png)\n- \n![](vmware-use-centos/7.png)\n- \n![](vmware-use-centos/8.png)\n- \n![](vmware-use-centos/9.png)\n- \n![](vmware-use-centos/10.png)\n- \n![](vmware-use-centos/11.png)\n- \n![](vmware-use-centos/12.png)\n- \n![](vmware-use-centos/13.png)\n- \n![](vmware-use-centos/14.png)\n- \n![](vmware-use-centos/15.png)\n********\n![](vmware-use-centos/16.png)\n- \n![](vmware-use-centos/17.png)\n![](vmware-use-centos/18.png)\n\n![](vmware-use-centos/19.png)\n### \nOK\n\n\n\n![](vmware-use-centos/20.png)\n- \n![](vmware-use-centos/21.png)\n- \n![](vmware-use-centos/22.png)\n- \n![](vmware-use-centos/23.png)\n- MiniLinuxMini\n![](vmware-use-centos/24.png)\n![](vmware-use-centos/25.png)\n- \n![](vmware-use-centos/26.png)\n![](vmware-use-centos/27.png)\n- \n![](vmware-use-centos/28.png)\n![](vmware-use-centos/29.png)\n![](vmware-use-centos/30.png)\nroot\n![](vmware-use-centos/31.png)\n![](vmware-use-centos/32.png)\n![](vmware-use-centos/33.png)\nOK\n![](vmware-use-centos/34.png)\nWindowsNext\n![](vmware-use-centos/35.png)\nLinux\n![](vmware-use-centos/36.png)\n\n### \nVMwareVMwareLinuxNginxMySqlRedisDockernet coreLinux","slug":"vmware-use-centos","published":1,"updated":"2019-09-30T05:47:57.694Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m2y00299sv7tnxl5jj6","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net corenet coreLinuxWindowsLinux</p>\n<h3 id=\"VMware\"><a href=\"#VMware\" class=\"headerlink\" title=\"VMware\"></a>VMware</h3><p>WindowsLinuxVMware-_-|||CentOS 7net core7</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/1.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/2.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/3.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/4.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/5.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/6.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/7.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/8.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/9.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/10.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/11.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/12.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/13.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/14.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/15.png\" alt=\"\"><br><strong></strong><strong></strong><br><img src=\"/2019/08/21/vmware-use-centos/16.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/17.png\" alt=\"\"><br><img src=\"/2019/08/21/vmware-use-centos/18.png\" alt=\"\"><br><br><img src=\"/2019/08/21/vmware-use-centos/19.png\" alt=\"\"><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3>OK</li>\n</ul>\n<p></p>\n<p><img src=\"/2019/08/21/vmware-use-centos/20.png\" alt=\"\"></p>\n<ul>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/21.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/22.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/23.png\" alt=\"\"></li>\n<li>MiniLinuxMini<br><img src=\"/2019/08/21/vmware-use-centos/24.png\" alt=\"\"><br><img src=\"/2019/08/21/vmware-use-centos/25.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/26.png\" alt=\"\"><br><img src=\"/2019/08/21/vmware-use-centos/27.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/28.png\" alt=\"\"><br><img src=\"/2019/08/21/vmware-use-centos/29.png\" alt=\"\"><br><img src=\"/2019/08/21/vmware-use-centos/30.png\" alt=\"\"><br>root<br><img src=\"/2019/08/21/vmware-use-centos/31.png\" alt=\"\"><br><img src=\"/2019/08/21/vmware-use-centos/32.png\" alt=\"\"><br><img src=\"/2019/08/21/vmware-use-centos/33.png\" alt=\"\"><br>OK<br><img src=\"/2019/08/21/vmware-use-centos/34.png\" alt=\"\"><br>WindowsNext<br><img src=\"/2019/08/21/vmware-use-centos/35.png\" alt=\"\"><br>Linux<br><img src=\"/2019/08/21/vmware-use-centos/36.png\" alt=\"\"></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>VMwareVMwareLinuxNginxMySqlRedisDockernet coreLinux</p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net corenet coreLinuxWindowsLinux</p>\n<h3 id=\"VMware\"><a href=\"#VMware\" class=\"headerlink\" title=\"VMware\"></a>VMware</h3><p>WindowsLinuxVMware-_-|||CentOS 7net core7</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/1.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/2.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/3.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/4.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/5.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/6.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/7.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/8.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/9.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/10.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/11.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/12.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/13.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/14.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/15.png\" alt=\"\"><br><strong></strong><strong></strong><br><img src=\"/2019/08/21/vmware-use-centos/16.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/17.png\" alt=\"\"><br><img src=\"/2019/08/21/vmware-use-centos/18.png\" alt=\"\"><br><br><img src=\"/2019/08/21/vmware-use-centos/19.png\" alt=\"\"><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3>OK</li>\n</ul>\n<p></p>\n<p><img src=\"/2019/08/21/vmware-use-centos/20.png\" alt=\"\"></p>\n<ul>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/21.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/22.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/23.png\" alt=\"\"></li>\n<li>MiniLinuxMini<br><img src=\"/2019/08/21/vmware-use-centos/24.png\" alt=\"\"><br><img src=\"/2019/08/21/vmware-use-centos/25.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/26.png\" alt=\"\"><br><img src=\"/2019/08/21/vmware-use-centos/27.png\" alt=\"\"></li>\n<li><br><img src=\"/2019/08/21/vmware-use-centos/28.png\" alt=\"\"><br><img src=\"/2019/08/21/vmware-use-centos/29.png\" alt=\"\"><br><img src=\"/2019/08/21/vmware-use-centos/30.png\" alt=\"\"><br>root<br><img src=\"/2019/08/21/vmware-use-centos/31.png\" alt=\"\"><br><img src=\"/2019/08/21/vmware-use-centos/32.png\" alt=\"\"><br><img src=\"/2019/08/21/vmware-use-centos/33.png\" alt=\"\"><br>OK<br><img src=\"/2019/08/21/vmware-use-centos/34.png\" alt=\"\"><br>WindowsNext<br><img src=\"/2019/08/21/vmware-use-centos/35.png\" alt=\"\"><br>Linux<br><img src=\"/2019/08/21/vmware-use-centos/36.png\" alt=\"\"></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>VMwareVMwareLinuxNginxMySqlRedisDockernet coreLinux</p>\n"},{"title":"Linux_Nginx","date":"2019-08-21T07:08:18.000Z","_content":"\n### \nLinux**Nginx**\n\n### Nginx\n- \nNginxwebNginx\n- \nyummake\n\n|  |  |\n|--|--|\n| yum |  |\n|  |  |\n\n##### 1. yum\nyumnginx **/etc/nginx**\n```bash\n$ sudo yum update  \t\t\t\t\t#yum\n$ sudo yum -y install nginx \t\t#nginx\n$ sudo yum remove nginx \t\t\t#nginx\n```\n\n\n![](vmware-nginx/1.png)\n\n```bash\n$ sudo rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm\n```\n\nnginx\n```bash\n$ sudo systemctl enable nginx \t\t\t#  \n$ sudo service nginx start \t\t\t\t# nginx\n$ sudo service nginx stop \t\t\t\t# nginx\n$ sudo service nginx restart \t\t\t# nginx\n$ sudo service nginx reload \t\t\t# nginx\n```\n\n##### 2. \n\n\n**1. gcc**\n```bash\n$ sudo yum -y install gcc gcc-c++ # nginxgcc\n```\n**2. pcre**\n```bash\n$ sudo yum -y install pcre pcre-devel # nginx\n```\n**3. zlib**\n```bash\n$ sudo yum -y install zlib zlib-devel # nginxzlibhttpgzip\n```\n**4. openssl**\n```bash\n$ sudo yum -y install openssl openssl-devel # https\n```\n[Nginx](https://nginx.org/en/download.html) **/usr/local/**\n```bash\n$ cd /usr/local/ #\n$ sudo tar -zxvf  nginx-x.xx.x.tar.gz # x.xx.x\n$ cd nginx-x.xx.x\t# \n$ ./configure --user=nobody --group=nobody --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_gzip_static_module --with-http_realip_module --with-http_sub_module --with-http_ssl_module\n```\nconfigcc++openssl\n\n```\n$ make && make install\n```\nyum\n```bash\n$ /usr/local/nginx/sbin/nginx # \n$ /usr/local/nginx/sbin/nginx -s reload # \n$ /usr/local/nginx/sbin/nginx -s stop # \n```\n\nnginx\n```bash\n$ ps -ef | grep nginx # \n```\n\nnginx\n![](vmware-nginx/2.png)\n### \n### \nnginxweb","source":"_posts/vmware-nginx.md","raw":"---\ntitle: Linux_Nginx\ndate: 2019-08-21 15:08:18\ntags: [vmware,]\ncategories: AprilBlank\n---\n\n### \nLinux**Nginx**\n\n### Nginx\n- \nNginxwebNginx\n- \nyummake\n\n|  |  |\n|--|--|\n| yum |  |\n|  |  |\n\n##### 1. yum\nyumnginx **/etc/nginx**\n```bash\n$ sudo yum update  \t\t\t\t\t#yum\n$ sudo yum -y install nginx \t\t#nginx\n$ sudo yum remove nginx \t\t\t#nginx\n```\n\n\n![](vmware-nginx/1.png)\n\n```bash\n$ sudo rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm\n```\n\nnginx\n```bash\n$ sudo systemctl enable nginx \t\t\t#  \n$ sudo service nginx start \t\t\t\t# nginx\n$ sudo service nginx stop \t\t\t\t# nginx\n$ sudo service nginx restart \t\t\t# nginx\n$ sudo service nginx reload \t\t\t# nginx\n```\n\n##### 2. \n\n\n**1. gcc**\n```bash\n$ sudo yum -y install gcc gcc-c++ # nginxgcc\n```\n**2. pcre**\n```bash\n$ sudo yum -y install pcre pcre-devel # nginx\n```\n**3. zlib**\n```bash\n$ sudo yum -y install zlib zlib-devel # nginxzlibhttpgzip\n```\n**4. openssl**\n```bash\n$ sudo yum -y install openssl openssl-devel # https\n```\n[Nginx](https://nginx.org/en/download.html) **/usr/local/**\n```bash\n$ cd /usr/local/ #\n$ sudo tar -zxvf  nginx-x.xx.x.tar.gz # x.xx.x\n$ cd nginx-x.xx.x\t# \n$ ./configure --user=nobody --group=nobody --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_gzip_static_module --with-http_realip_module --with-http_sub_module --with-http_ssl_module\n```\nconfigcc++openssl\n\n```\n$ make && make install\n```\nyum\n```bash\n$ /usr/local/nginx/sbin/nginx # \n$ /usr/local/nginx/sbin/nginx -s reload # \n$ /usr/local/nginx/sbin/nginx -s stop # \n```\n\nnginx\n```bash\n$ ps -ef | grep nginx # \n```\n\nnginx\n![](vmware-nginx/2.png)\n### \n### \nnginxweb","slug":"vmware-nginx","published":1,"updated":"2019-09-30T05:47:49.277Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m30002c9sv70dphy82o","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Linux<strong>Nginx</strong></p>\n<h3 id=\"Nginx\"><a href=\"#Nginx\" class=\"headerlink\" title=\"Nginx\"></a>Nginx</h3><ul>\n<li><br>NginxwebNginx</li>\n<li><br>yummake</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>yum</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<h5 id=\"1-yum\"><a href=\"#1-yum\" class=\"headerlink\" title=\"1. yum\"></a>1. yum</h5><p>yumnginx <strong>/etc/nginx</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo yum update  \t\t\t\t\t<span class=\"comment\">#yum</span></span><br><span class=\"line\">$ sudo yum -y install nginx \t\t<span class=\"comment\">#nginx</span></span><br><span class=\"line\">$ sudo yum remove nginx \t\t\t<span class=\"comment\">#nginx</span></span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/2019/08/21/vmware-nginx/1.png\" alt=\"\"><br></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</span><br></pre></td></tr></table></figure>\n\n<p>nginx</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo systemctl <span class=\"built_in\">enable</span> nginx \t\t\t<span class=\"comment\">#  </span></span><br><span class=\"line\">$ sudo service nginx start \t\t\t\t<span class=\"comment\"># nginx</span></span><br><span class=\"line\">$ sudo service nginx stop \t\t\t\t<span class=\"comment\"># nginx</span></span><br><span class=\"line\">$ sudo service nginx restart \t\t\t<span class=\"comment\"># nginx</span></span><br><span class=\"line\">$ sudo service nginx reload \t\t\t<span class=\"comment\"># nginx</span></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h5><p><br><br><strong>1. gcc</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo yum -y install gcc gcc-c++ <span class=\"comment\"># nginxgcc</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>2. pcre</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo yum -y install pcre pcre-devel <span class=\"comment\"># nginx</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>3. zlib</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo yum -y install zlib zlib-devel <span class=\"comment\"># nginxzlibhttpgzip</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>4. openssl</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo yum -y install openssl openssl-devel <span class=\"comment\"># https</span></span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://nginx.org/en/download.html\" target=\"_blank\" rel=\"noopener\">Nginx</a> <strong>/usr/local/</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> /usr/<span class=\"built_in\">local</span>/ <span class=\"comment\">#</span></span><br><span class=\"line\">$ sudo tar -zxvf  nginx-x.xx.x.tar.gz <span class=\"comment\"># x.xx.x</span></span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> nginx-x.xx.x\t<span class=\"comment\"># </span></span><br><span class=\"line\">$ ./configure --user=nobody --group=nobody --prefix=/usr/<span class=\"built_in\">local</span>/nginx --with-http_stub_status_module --with-http_gzip_static_module --with-http_realip_module --with-http_sub_module --with-http_ssl_module</span><br></pre></td></tr></table></figure>\n\n<p>configcc++openssl<br></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n\n<p>yum</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ /usr/<span class=\"built_in\">local</span>/nginx/sbin/nginx <span class=\"comment\"># </span></span><br><span class=\"line\">$ /usr/<span class=\"built_in\">local</span>/nginx/sbin/nginx -s reload <span class=\"comment\"># </span></span><br><span class=\"line\">$ /usr/<span class=\"built_in\">local</span>/nginx/sbin/nginx -s stop <span class=\"comment\"># </span></span><br></pre></td></tr></table></figure>\n\n<p>nginx</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ps -ef | grep nginx <span class=\"comment\"># </span></span><br></pre></td></tr></table></figure>\n\n<p>nginx<br><img src=\"/2019/08/21/vmware-nginx/2.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>nginxweb</p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Linux<strong>Nginx</strong></p>\n<h3 id=\"Nginx\"><a href=\"#Nginx\" class=\"headerlink\" title=\"Nginx\"></a>Nginx</h3><ul>\n<li><br>NginxwebNginx</li>\n<li><br>yummake</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>yum</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<h5 id=\"1-yum\"><a href=\"#1-yum\" class=\"headerlink\" title=\"1. yum\"></a>1. yum</h5><p>yumnginx <strong>/etc/nginx</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo yum update  \t\t\t\t\t<span class=\"comment\">#yum</span></span><br><span class=\"line\">$ sudo yum -y install nginx \t\t<span class=\"comment\">#nginx</span></span><br><span class=\"line\">$ sudo yum remove nginx \t\t\t<span class=\"comment\">#nginx</span></span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/2019/08/21/vmware-nginx/1.png\" alt=\"\"><br></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</span><br></pre></td></tr></table></figure>\n\n<p>nginx</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo systemctl <span class=\"built_in\">enable</span> nginx \t\t\t<span class=\"comment\">#  </span></span><br><span class=\"line\">$ sudo service nginx start \t\t\t\t<span class=\"comment\"># nginx</span></span><br><span class=\"line\">$ sudo service nginx stop \t\t\t\t<span class=\"comment\"># nginx</span></span><br><span class=\"line\">$ sudo service nginx restart \t\t\t<span class=\"comment\"># nginx</span></span><br><span class=\"line\">$ sudo service nginx reload \t\t\t<span class=\"comment\"># nginx</span></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h5><p><br><br><strong>1. gcc</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo yum -y install gcc gcc-c++ <span class=\"comment\"># nginxgcc</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>2. pcre</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo yum -y install pcre pcre-devel <span class=\"comment\"># nginx</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>3. zlib</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo yum -y install zlib zlib-devel <span class=\"comment\"># nginxzlibhttpgzip</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>4. openssl</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo yum -y install openssl openssl-devel <span class=\"comment\"># https</span></span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://nginx.org/en/download.html\" target=\"_blank\" rel=\"noopener\">Nginx</a> <strong>/usr/local/</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> /usr/<span class=\"built_in\">local</span>/ <span class=\"comment\">#</span></span><br><span class=\"line\">$ sudo tar -zxvf  nginx-x.xx.x.tar.gz <span class=\"comment\"># x.xx.x</span></span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> nginx-x.xx.x\t<span class=\"comment\"># </span></span><br><span class=\"line\">$ ./configure --user=nobody --group=nobody --prefix=/usr/<span class=\"built_in\">local</span>/nginx --with-http_stub_status_module --with-http_gzip_static_module --with-http_realip_module --with-http_sub_module --with-http_ssl_module</span><br></pre></td></tr></table></figure>\n\n<p>configcc++openssl<br></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n\n<p>yum</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ /usr/<span class=\"built_in\">local</span>/nginx/sbin/nginx <span class=\"comment\"># </span></span><br><span class=\"line\">$ /usr/<span class=\"built_in\">local</span>/nginx/sbin/nginx -s reload <span class=\"comment\"># </span></span><br><span class=\"line\">$ /usr/<span class=\"built_in\">local</span>/nginx/sbin/nginx -s stop <span class=\"comment\"># </span></span><br></pre></td></tr></table></figure>\n\n<p>nginx</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ps -ef | grep nginx <span class=\"comment\"># </span></span><br></pre></td></tr></table></figure>\n\n<p>nginx<br><img src=\"/2019/08/21/vmware-nginx/2.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>nginxweb</p>\n"},{"title":"Linux_MySql","date":"2019-09-12T07:38:58.000Z","_content":"\n### \nopengl\n\n### \n\n```bash\n# \n[root@april /]# wget http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm\n\n[root@april /]# sudo rpm -ivh mysql-community-release-el7-5.noarch.rpm\n\n# y\n[root@april /]# yum install mysql-server\n\n# mysql\n[root@april /]# systemctl start mysqld \n\n# mysql\n[root@april /]# mysql_secure_installation \n```\n\n\n```bash\n# root\nEnter current password for root (enter for none): \n# root\nSet root password? [Y/n] y\nNew password: \nRe-enter new password: \nPassword updated successfully!\n# \nRemove anonymous users? [Y/n] y\n# root\nDisallow root login remotely? [Y/n] n\n# \nRemove test database and access to it? [Y/n] y\n# \nReload privilege tables now? [Y/n] y\n\n```\n\nmysql\n```bash\n[root@april /]# mysql -u root -p\nEnter password: \n\n# mysql\nmysql>show variables like '%character%'; \n```\ndatabaseserverutf8/usr/share**my-default.cnf**mysql**/etc/my.cnf**\n\n```bash\n[root@april mysql]# cp /usr/share/mysql/my-default.cnf /etc/my.cnf\ncp: overwrite /etc/my.cnf? \n[root@april mysql]# cd /etc/\n[root@april etc]# vi my.cnf\n```\n\n\n```bash\n[client]\ndefault-character-set = utf8\n[mysqld]\ncharacter_set_server =  utf8\n```\n\nlinuxlinuxiinsert\n\n|  |  |\n|--|--|\n| :w | vi |\n| :w file | filevi |\n| :w! | vi |\n| :wq | vi |\n| :wq! | vi |\n| q: | vi |\n| :q! | vi |\n| :e! |  |\n\n```bash\n# \n[root@april etc]# systemctl restart mysql.service\n```\n\nmysqlcharacter\n![](vmware-mysql/1.png)\n\n```bash\nmysql> GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'root';\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> FLUSH PRIVILEGES;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\nip\n\n\n### \n\n\n```bash\n# \n$ systemctl status firewalld\n\n# \n$ systemctl start firewalld \n\n$ systemctl restart firewalld\n\n$ systemctl stop firewalld\n\n# \n$ firewall-cmd --list-all \n\n# \n$ firewall-cmd --query-port=80/tcp //80\n\n$ firewall-cmd --permanent --add-port=80/tcp //80\n\n$ firewall-cmd --permanent --remove-port=80/tcp //80\n\n$ firewall-cmd --reload //\n```\n\n\n\n### \nlinuxnet corelinux","source":"_posts/vmware-mysql.md","raw":"---\ntitle: Linux_MySql\ndate: 2019-09-12 15:38:58\ntags: [vmware,]\ncategories: AprilBlank\n---\n\n### \nopengl\n\n### \n\n```bash\n# \n[root@april /]# wget http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm\n\n[root@april /]# sudo rpm -ivh mysql-community-release-el7-5.noarch.rpm\n\n# y\n[root@april /]# yum install mysql-server\n\n# mysql\n[root@april /]# systemctl start mysqld \n\n# mysql\n[root@april /]# mysql_secure_installation \n```\n\n\n```bash\n# root\nEnter current password for root (enter for none): \n# root\nSet root password? [Y/n] y\nNew password: \nRe-enter new password: \nPassword updated successfully!\n# \nRemove anonymous users? [Y/n] y\n# root\nDisallow root login remotely? [Y/n] n\n# \nRemove test database and access to it? [Y/n] y\n# \nReload privilege tables now? [Y/n] y\n\n```\n\nmysql\n```bash\n[root@april /]# mysql -u root -p\nEnter password: \n\n# mysql\nmysql>show variables like '%character%'; \n```\ndatabaseserverutf8/usr/share**my-default.cnf**mysql**/etc/my.cnf**\n\n```bash\n[root@april mysql]# cp /usr/share/mysql/my-default.cnf /etc/my.cnf\ncp: overwrite /etc/my.cnf? \n[root@april mysql]# cd /etc/\n[root@april etc]# vi my.cnf\n```\n\n\n```bash\n[client]\ndefault-character-set = utf8\n[mysqld]\ncharacter_set_server =  utf8\n```\n\nlinuxlinuxiinsert\n\n|  |  |\n|--|--|\n| :w | vi |\n| :w file | filevi |\n| :w! | vi |\n| :wq | vi |\n| :wq! | vi |\n| q: | vi |\n| :q! | vi |\n| :e! |  |\n\n```bash\n# \n[root@april etc]# systemctl restart mysql.service\n```\n\nmysqlcharacter\n![](vmware-mysql/1.png)\n\n```bash\nmysql> GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'root';\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> FLUSH PRIVILEGES;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\nip\n\n\n### \n\n\n```bash\n# \n$ systemctl status firewalld\n\n# \n$ systemctl start firewalld \n\n$ systemctl restart firewalld\n\n$ systemctl stop firewalld\n\n# \n$ firewall-cmd --list-all \n\n# \n$ firewall-cmd --query-port=80/tcp //80\n\n$ firewall-cmd --permanent --add-port=80/tcp //80\n\n$ firewall-cmd --permanent --remove-port=80/tcp //80\n\n$ firewall-cmd --reload //\n```\n\n\n\n### \nlinuxnet corelinux","slug":"vmware-mysql","published":1,"updated":"2019-09-30T05:47:45.453Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m3d003i9sv7d5oz970h","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>opengl</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">[root@april /]<span class=\"comment\"># wget http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm</span></span><br><span class=\"line\"></span><br><span class=\"line\">[root@april /]<span class=\"comment\"># sudo rpm -ivh mysql-community-release-el7-5.noarch.rpm</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># y</span></span><br><span class=\"line\">[root@april /]<span class=\"comment\"># yum install mysql-server</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># mysql</span></span><br><span class=\"line\">[root@april /]<span class=\"comment\"># systemctl start mysqld </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># mysql</span></span><br><span class=\"line\">[root@april /]<span class=\"comment\"># mysql_secure_installation</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># root</span></span><br><span class=\"line\">Enter current password <span class=\"keyword\">for</span> root (enter <span class=\"keyword\">for</span> none): </span><br><span class=\"line\"><span class=\"comment\"># root</span></span><br><span class=\"line\">Set root password? [Y/n] y</span><br><span class=\"line\">New password: </span><br><span class=\"line\">Re-enter new password: </span><br><span class=\"line\">Password updated successfully!</span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">Remove anonymous users? [Y/n] y</span><br><span class=\"line\"><span class=\"comment\"># root</span></span><br><span class=\"line\">Disallow root login remotely? [Y/n] n</span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">Remove <span class=\"built_in\">test</span> database and access to it? [Y/n] y</span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">Reload privilege tables now? [Y/n] y</span><br></pre></td></tr></table></figure>\n\n<p>mysql</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april /]<span class=\"comment\"># mysql -u root -p</span></span><br><span class=\"line\">Enter password: </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># mysql</span></span><br><span class=\"line\">mysql&gt;show variables like <span class=\"string\">'%character%'</span>;</span><br></pre></td></tr></table></figure>\n\n<p>databaseserverutf8/usr/share<strong>my-default.cnf</strong>mysql<strong>/etc/my.cnf</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april mysql]<span class=\"comment\"># cp /usr/share/mysql/my-default.cnf /etc/my.cnf</span></span><br><span class=\"line\">cp: overwrite /etc/my.cnf? </span><br><span class=\"line\">[root@april mysql]<span class=\"comment\"># cd /etc/</span></span><br><span class=\"line\">[root@april etc]<span class=\"comment\"># vi my.cnf</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[client]</span><br><span class=\"line\">default-character-set = utf8</span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\">character_set_server =  utf8</span><br></pre></td></tr></table></figure>\n\n<p>linuxlinuxiinsert</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>:w</td>\n<td>vi</td>\n</tr>\n<tr>\n<td>:w file</td>\n<td>filevi</td>\n</tr>\n<tr>\n<td>:w!</td>\n<td>vi</td>\n</tr>\n<tr>\n<td>:wq</td>\n<td>vi</td>\n</tr>\n<tr>\n<td>:wq!</td>\n<td>vi</td>\n</tr>\n<tr>\n<td>q:</td>\n<td>vi</td>\n</tr>\n<tr>\n<td>:q!</td>\n<td>vi</td>\n</tr>\n<tr>\n<td>:e!</td>\n<td></td>\n</tr>\n</tbody></table>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">[root@april etc]<span class=\"comment\"># systemctl restart mysql.service</span></span><br></pre></td></tr></table></figure>\n\n<p>mysqlcharacter<br><img src=\"/2019/09/12/vmware-mysql/1.png\" alt=\"\"></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO <span class=\"string\">'root'</span>@<span class=\"string\">'%'</span> IDENTIFIED BY <span class=\"string\">'root'</span>;</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; FLUSH PRIVILEGES;</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>\n\n<p>ip</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">$ systemctl status firewalld</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">$ systemctl start firewalld </span><br><span class=\"line\"></span><br><span class=\"line\">$ systemctl restart firewalld</span><br><span class=\"line\"></span><br><span class=\"line\">$ systemctl stop firewalld</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">$ firewall-cmd --list-all </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">$ firewall-cmd --query-port=80/tcp //80</span><br><span class=\"line\"></span><br><span class=\"line\">$ firewall-cmd --permanent --add-port=80/tcp //80</span><br><span class=\"line\"></span><br><span class=\"line\">$ firewall-cmd --permanent --remove-port=80/tcp //80</span><br><span class=\"line\"></span><br><span class=\"line\">$ firewall-cmd --reload //</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>linuxnet corelinux</p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>opengl</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">[root@april /]<span class=\"comment\"># wget http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm</span></span><br><span class=\"line\"></span><br><span class=\"line\">[root@april /]<span class=\"comment\"># sudo rpm -ivh mysql-community-release-el7-5.noarch.rpm</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># y</span></span><br><span class=\"line\">[root@april /]<span class=\"comment\"># yum install mysql-server</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># mysql</span></span><br><span class=\"line\">[root@april /]<span class=\"comment\"># systemctl start mysqld </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># mysql</span></span><br><span class=\"line\">[root@april /]<span class=\"comment\"># mysql_secure_installation</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># root</span></span><br><span class=\"line\">Enter current password <span class=\"keyword\">for</span> root (enter <span class=\"keyword\">for</span> none): </span><br><span class=\"line\"><span class=\"comment\"># root</span></span><br><span class=\"line\">Set root password? [Y/n] y</span><br><span class=\"line\">New password: </span><br><span class=\"line\">Re-enter new password: </span><br><span class=\"line\">Password updated successfully!</span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">Remove anonymous users? [Y/n] y</span><br><span class=\"line\"><span class=\"comment\"># root</span></span><br><span class=\"line\">Disallow root login remotely? [Y/n] n</span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">Remove <span class=\"built_in\">test</span> database and access to it? [Y/n] y</span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">Reload privilege tables now? [Y/n] y</span><br></pre></td></tr></table></figure>\n\n<p>mysql</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april /]<span class=\"comment\"># mysql -u root -p</span></span><br><span class=\"line\">Enter password: </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># mysql</span></span><br><span class=\"line\">mysql&gt;show variables like <span class=\"string\">'%character%'</span>;</span><br></pre></td></tr></table></figure>\n\n<p>databaseserverutf8/usr/share<strong>my-default.cnf</strong>mysql<strong>/etc/my.cnf</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@april mysql]<span class=\"comment\"># cp /usr/share/mysql/my-default.cnf /etc/my.cnf</span></span><br><span class=\"line\">cp: overwrite /etc/my.cnf? </span><br><span class=\"line\">[root@april mysql]<span class=\"comment\"># cd /etc/</span></span><br><span class=\"line\">[root@april etc]<span class=\"comment\"># vi my.cnf</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[client]</span><br><span class=\"line\">default-character-set = utf8</span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\">character_set_server =  utf8</span><br></pre></td></tr></table></figure>\n\n<p>linuxlinuxiinsert</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>:w</td>\n<td>vi</td>\n</tr>\n<tr>\n<td>:w file</td>\n<td>filevi</td>\n</tr>\n<tr>\n<td>:w!</td>\n<td>vi</td>\n</tr>\n<tr>\n<td>:wq</td>\n<td>vi</td>\n</tr>\n<tr>\n<td>:wq!</td>\n<td>vi</td>\n</tr>\n<tr>\n<td>q:</td>\n<td>vi</td>\n</tr>\n<tr>\n<td>:q!</td>\n<td>vi</td>\n</tr>\n<tr>\n<td>:e!</td>\n<td></td>\n</tr>\n</tbody></table>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">[root@april etc]<span class=\"comment\"># systemctl restart mysql.service</span></span><br></pre></td></tr></table></figure>\n\n<p>mysqlcharacter<br><img src=\"/2019/09/12/vmware-mysql/1.png\" alt=\"\"></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO <span class=\"string\">'root'</span>@<span class=\"string\">'%'</span> IDENTIFIED BY <span class=\"string\">'root'</span>;</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; FLUSH PRIVILEGES;</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>\n\n<p>ip</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">$ systemctl status firewalld</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">$ systemctl start firewalld </span><br><span class=\"line\"></span><br><span class=\"line\">$ systemctl restart firewalld</span><br><span class=\"line\"></span><br><span class=\"line\">$ systemctl stop firewalld</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">$ firewall-cmd --list-all </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">$ firewall-cmd --query-port=80/tcp //80</span><br><span class=\"line\"></span><br><span class=\"line\">$ firewall-cmd --permanent --add-port=80/tcp //80</span><br><span class=\"line\"></span><br><span class=\"line\">$ firewall-cmd --permanent --remove-port=80/tcp //80</span><br><span class=\"line\"></span><br><span class=\"line\">$ firewall-cmd --reload //</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>linuxnet corelinux</p>\n"},{"title":"net core WebApi","date":"2019-08-27T08:11:43.000Z","_content":"\n### \n[net core WebApi](/2019/08/23/net-core-fileuploader-and-cors/)\n### \n[net core Webapi ](/2019/07/19/net-core-webapi-main/)\n\n****\n1. \n2. \n\n****\n\n1. \n2. \n\n**a**\n\n**FileController****RequestDownloadFile****FileDownload**\n\n```csharp\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"fileInfo\">[name]</param>\n        /// <returns></returns>\n        [HttpPost, Route(\"RequestDownload\")]\n        public MessageEntity RequestDownloadFile([FromBody]Dictionary<string, object> fileInfo)\n        {\n\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"fileInfo\">[index,name]</param>\n        /// <returns></returns>\n        [HttpPost, Route(\"Download\")]\n        public async Task<IActionResult> FileDownload([FromBody]Dictionary<string, object> fileInfo)\n        {\n\n        }\n```\n\n**RequestDownloadFile**\n>\n\n```csharp\n        public MessageEntity RequestDownloadFile([FromBody]Dictionary<string, object> fileInfo)\n        {\n            MessageEntity message = new MessageEntity();\n            string fileName = string.Empty;\n            string fileExt = string.Empty;\n            if (fileInfo.ContainsKey(\"name\"))\n            {\n                fileName = fileInfo[\"name\"].ToString();\n            }\n            if (fileInfo.ContainsKey(\"ext\"))\n            {\n                fileExt = fileInfo[\"ext\"].ToString();\n            }\n            if (string.IsNullOrEmpty(fileName))\n            {\n                message.Code = -1;\n                message.Msg = \"\";\n                return message;\n            }\n            //\n            string filePath = $\".{AprilConfig.FilePath}{DateTime.Now.ToString(\"yyyy-MM-dd\")}/{fileName}\";\n            filePath = $\"{filePath}{fileExt}\";\n            FileStream fs = null;\n            try\n            {\n                if (!System.IO.File.Exists(filePath))\n                {\n                    //\n                    message.Code = -1;\n                    message.Msg = \"\";\n                    return message;\n                }\n                fs = new FileStream(filePath, FileMode.Open);\n                if (fs.Length <= 0)\n                {\n                    //\n                    message.Code = -1;\n                    message.Msg = \"\";\n                    return message;\n                }\n                int shardSize = 1 * 1024 * 1024;//1M\n                RequestFileUploadEntity request = new RequestFileUploadEntity();\n                request.fileext = fileExt;\n                request.size = fs.Length;\n                request.count = (int)(fs.Length / shardSize);\n                if ((fs.Length % shardSize) > 0)\n                {\n                    request.count += 1;\n                }\n                request.filedata = GetCryptoString(fs);\n\n                message.Data = request;\n            }\n            catch (Exception ex)\n            {\n                LogUtil.Debug($\"{filePath}{ex.Message}\");\n            }\n            finally\n            {\n                if (fs != null)\n                {\n                    fs.Close();\n                }\n            }\n\n            return message;\n        }\n```\n\n**FileDownload**\n```csharp\n        public async Task<IActionResult> FileDownload([FromBody]Dictionary<string, object> fileInfo)\n        {\n            //\n            int index = 0;\n            if (fileInfo.ContainsKey(\"index\"))\n            {\n                int.TryParse(fileInfo[\"index\"].ToString(), out index);\n            }\n            else\n            {\n                return Ok(new { code = -1, msg = \"\" });\n            }\n            string fileName = string.Empty;\n            string fileExt = string.Empty;\n            if (fileInfo.ContainsKey(\"name\"))\n            {\n                fileName = fileInfo[\"name\"].ToString();\n            }\n            if (fileInfo.ContainsKey(\"ext\"))\n            {\n                fileExt = fileInfo[\"ext\"].ToString();\n            }\n            if (string.IsNullOrEmpty(fileName))\n            {\n                return Ok(new { code = -1, msg = \"\" });\n            }\n            //\n            string filePath = $\".{AprilConfig.FilePath}{DateTime.Now.ToString(\"yyyy-MM-dd\")}/{fileName}\";\n            filePath = $\"{filePath}{fileExt}\";\n            if (!System.IO.File.Exists(filePath))\n            {\n                return Ok(new { code = -1, msg = \"\" });\n            }\n            using (var fs = new FileStream(filePath, FileMode.Open))\n            {\n                if (fs.Length <= 0)\n                {\n                    return Ok(new { code = -1, msg = \"\" });\n                }\n                int shardSize = 1 * 1024 * 1024;//1M\n                int count = (int)(fs.Length / shardSize);\n                if ((fs.Length % shardSize) > 0)\n                {\n                    count += 1;\n                }\n                if (index > count - 1)\n                {\n                    return Ok(new { code = -1, msg = \"\" });\n                }\n                fs.Seek(index * shardSize, SeekOrigin.Begin);\n                if (index == count - 1)\n                {\n                    // =  - ( * )\n                    shardSize = (int)(fs.Length - (shardSize * index));\n                }\n                byte[] datas = new byte[shardSize];\n                await fs.ReadAsync(datas, 0, datas.Length);\n                //fs.Close();\n                return File(datas, \"application/x-gzip\");\n            }\n        }\n```\n\n****=>****=>****\n\n### \n\n![](net-core-filedownload/1.png)\nerror\n\n### \nlinux****","source":"_posts/net-core-filedownload.md","raw":"---\ntitle: net core WebApi\ndate: 2019-08-27 16:11:43\ntags: net core\ncategories: AprilBlank\n---\n\n### \n[net core WebApi](/2019/08/23/net-core-fileuploader-and-cors/)\n### \n[net core Webapi ](/2019/07/19/net-core-webapi-main/)\n\n****\n1. \n2. \n\n****\n\n1. \n2. \n\n**a**\n\n**FileController****RequestDownloadFile****FileDownload**\n\n```csharp\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"fileInfo\">[name]</param>\n        /// <returns></returns>\n        [HttpPost, Route(\"RequestDownload\")]\n        public MessageEntity RequestDownloadFile([FromBody]Dictionary<string, object> fileInfo)\n        {\n\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"fileInfo\">[index,name]</param>\n        /// <returns></returns>\n        [HttpPost, Route(\"Download\")]\n        public async Task<IActionResult> FileDownload([FromBody]Dictionary<string, object> fileInfo)\n        {\n\n        }\n```\n\n**RequestDownloadFile**\n>\n\n```csharp\n        public MessageEntity RequestDownloadFile([FromBody]Dictionary<string, object> fileInfo)\n        {\n            MessageEntity message = new MessageEntity();\n            string fileName = string.Empty;\n            string fileExt = string.Empty;\n            if (fileInfo.ContainsKey(\"name\"))\n            {\n                fileName = fileInfo[\"name\"].ToString();\n            }\n            if (fileInfo.ContainsKey(\"ext\"))\n            {\n                fileExt = fileInfo[\"ext\"].ToString();\n            }\n            if (string.IsNullOrEmpty(fileName))\n            {\n                message.Code = -1;\n                message.Msg = \"\";\n                return message;\n            }\n            //\n            string filePath = $\".{AprilConfig.FilePath}{DateTime.Now.ToString(\"yyyy-MM-dd\")}/{fileName}\";\n            filePath = $\"{filePath}{fileExt}\";\n            FileStream fs = null;\n            try\n            {\n                if (!System.IO.File.Exists(filePath))\n                {\n                    //\n                    message.Code = -1;\n                    message.Msg = \"\";\n                    return message;\n                }\n                fs = new FileStream(filePath, FileMode.Open);\n                if (fs.Length <= 0)\n                {\n                    //\n                    message.Code = -1;\n                    message.Msg = \"\";\n                    return message;\n                }\n                int shardSize = 1 * 1024 * 1024;//1M\n                RequestFileUploadEntity request = new RequestFileUploadEntity();\n                request.fileext = fileExt;\n                request.size = fs.Length;\n                request.count = (int)(fs.Length / shardSize);\n                if ((fs.Length % shardSize) > 0)\n                {\n                    request.count += 1;\n                }\n                request.filedata = GetCryptoString(fs);\n\n                message.Data = request;\n            }\n            catch (Exception ex)\n            {\n                LogUtil.Debug($\"{filePath}{ex.Message}\");\n            }\n            finally\n            {\n                if (fs != null)\n                {\n                    fs.Close();\n                }\n            }\n\n            return message;\n        }\n```\n\n**FileDownload**\n```csharp\n        public async Task<IActionResult> FileDownload([FromBody]Dictionary<string, object> fileInfo)\n        {\n            //\n            int index = 0;\n            if (fileInfo.ContainsKey(\"index\"))\n            {\n                int.TryParse(fileInfo[\"index\"].ToString(), out index);\n            }\n            else\n            {\n                return Ok(new { code = -1, msg = \"\" });\n            }\n            string fileName = string.Empty;\n            string fileExt = string.Empty;\n            if (fileInfo.ContainsKey(\"name\"))\n            {\n                fileName = fileInfo[\"name\"].ToString();\n            }\n            if (fileInfo.ContainsKey(\"ext\"))\n            {\n                fileExt = fileInfo[\"ext\"].ToString();\n            }\n            if (string.IsNullOrEmpty(fileName))\n            {\n                return Ok(new { code = -1, msg = \"\" });\n            }\n            //\n            string filePath = $\".{AprilConfig.FilePath}{DateTime.Now.ToString(\"yyyy-MM-dd\")}/{fileName}\";\n            filePath = $\"{filePath}{fileExt}\";\n            if (!System.IO.File.Exists(filePath))\n            {\n                return Ok(new { code = -1, msg = \"\" });\n            }\n            using (var fs = new FileStream(filePath, FileMode.Open))\n            {\n                if (fs.Length <= 0)\n                {\n                    return Ok(new { code = -1, msg = \"\" });\n                }\n                int shardSize = 1 * 1024 * 1024;//1M\n                int count = (int)(fs.Length / shardSize);\n                if ((fs.Length % shardSize) > 0)\n                {\n                    count += 1;\n                }\n                if (index > count - 1)\n                {\n                    return Ok(new { code = -1, msg = \"\" });\n                }\n                fs.Seek(index * shardSize, SeekOrigin.Begin);\n                if (index == count - 1)\n                {\n                    // =  - ( * )\n                    shardSize = (int)(fs.Length - (shardSize * index));\n                }\n                byte[] datas = new byte[shardSize];\n                await fs.ReadAsync(datas, 0, datas.Length);\n                //fs.Close();\n                return File(datas, \"application/x-gzip\");\n            }\n        }\n```\n\n****=>****=>****\n\n### \n\n![](net-core-filedownload/1.png)\nerror\n\n### \nlinux****","slug":"net-core-filedownload","published":1,"updated":"2019-09-30T05:46:11.076Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m3e003j9sv7y27n8gpx","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"/2019/08/23/net-core-fileuploader-and-cors/\">net core WebApi</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"/2019/07/19/net-core-webapi-main/\">net core Webapi </a><br><br><strong></strong></p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<p><strong></strong></p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<p><strong>a</strong></p>\n<p><strong>FileController</strong><strong>RequestDownloadFile</strong><strong>FileDownload</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"fileInfo\"&gt;</span>[name]<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">[<span class=\"meta\">HttpPost, Route(<span class=\"meta-string\">\"RequestDownload\"</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> MessageEntity <span class=\"title\">RequestDownloadFile</span>(<span class=\"params\">[FromBody]Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; fileInfo</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"fileInfo\"&gt;</span>[index,name]<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">[<span class=\"meta\">HttpPost, Route(<span class=\"meta-string\">\"Download\"</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;IActionResult&gt; <span class=\"title\">FileDownload</span>(<span class=\"params\">[FromBody]Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; fileInfo</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>RequestDownloadFile</strong></p>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> MessageEntity <span class=\"title\">RequestDownloadFile</span>(<span class=\"params\">[FromBody]Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; fileInfo</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    MessageEntity message = <span class=\"keyword\">new</span> MessageEntity();</span><br><span class=\"line\">    <span class=\"keyword\">string</span> fileName = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> fileExt = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fileInfo.ContainsKey(<span class=\"string\">\"name\"</span>))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        fileName = fileInfo[<span class=\"string\">\"name\"</span>].ToString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fileInfo.ContainsKey(<span class=\"string\">\"ext\"</span>))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        fileExt = fileInfo[<span class=\"string\">\"ext\"</span>].ToString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(fileName))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">        message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"keyword\">string</span> filePath = <span class=\"string\">$\".<span class=\"subst\">&#123;AprilConfig.FilePath&#125;</span><span class=\"subst\">&#123;DateTime.Now.ToString(<span class=\"string\">\"yyyy-MM-dd\"</span>)&#125;</span>/<span class=\"subst\">&#123;fileName&#125;</span>\"</span>;</span><br><span class=\"line\">    filePath = <span class=\"string\">$\"<span class=\"subst\">&#123;filePath&#125;</span><span class=\"subst\">&#123;fileExt&#125;</span>\"</span>;</span><br><span class=\"line\">    FileStream fs = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!System.IO.File.Exists(filePath))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">            message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fs = <span class=\"keyword\">new</span> FileStream(filePath, FileMode.Open);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (fs.Length &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">            message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> shardSize = <span class=\"number\">1</span> * <span class=\"number\">1024</span> * <span class=\"number\">1024</span>;<span class=\"comment\">//1M</span></span><br><span class=\"line\">        RequestFileUploadEntity request = <span class=\"keyword\">new</span> RequestFileUploadEntity();</span><br><span class=\"line\">        request.fileext = fileExt;</span><br><span class=\"line\">        request.size = fs.Length;</span><br><span class=\"line\">        request.count = (<span class=\"keyword\">int</span>)(fs.Length / shardSize);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((fs.Length % shardSize) &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            request.count += <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        request.filedata = GetCryptoString(fs);</span><br><span class=\"line\"></span><br><span class=\"line\">        message.Data = request;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;filePath&#125;</span><span class=\"subst\">&#123;ex.Message&#125;</span>\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">finally</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (fs != <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            fs.Close();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>FileDownload</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;IActionResult&gt; <span class=\"title\">FileDownload</span>(<span class=\"params\">[FromBody]Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; fileInfo</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> index = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fileInfo.ContainsKey(<span class=\"string\">\"index\"</span>))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>.TryParse(fileInfo[<span class=\"string\">\"index\"</span>].ToString(), <span class=\"keyword\">out</span> index);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Ok(<span class=\"keyword\">new</span> &#123; code = <span class=\"number\">-1</span>, msg = <span class=\"string\">\"\"</span> &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> fileName = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> fileExt = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fileInfo.ContainsKey(<span class=\"string\">\"name\"</span>))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        fileName = fileInfo[<span class=\"string\">\"name\"</span>].ToString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fileInfo.ContainsKey(<span class=\"string\">\"ext\"</span>))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        fileExt = fileInfo[<span class=\"string\">\"ext\"</span>].ToString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(fileName))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Ok(<span class=\"keyword\">new</span> &#123; code = <span class=\"number\">-1</span>, msg = <span class=\"string\">\"\"</span> &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"keyword\">string</span> filePath = <span class=\"string\">$\".<span class=\"subst\">&#123;AprilConfig.FilePath&#125;</span><span class=\"subst\">&#123;DateTime.Now.ToString(<span class=\"string\">\"yyyy-MM-dd\"</span>)&#125;</span>/<span class=\"subst\">&#123;fileName&#125;</span>\"</span>;</span><br><span class=\"line\">    filePath = <span class=\"string\">$\"<span class=\"subst\">&#123;filePath&#125;</span><span class=\"subst\">&#123;fileExt&#125;</span>\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!System.IO.File.Exists(filePath))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Ok(<span class=\"keyword\">new</span> &#123; code = <span class=\"number\">-1</span>, msg = <span class=\"string\">\"\"</span> &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> fs = <span class=\"keyword\">new</span> FileStream(filePath, FileMode.Open))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (fs.Length &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> Ok(<span class=\"keyword\">new</span> &#123; code = <span class=\"number\">-1</span>, msg = <span class=\"string\">\"\"</span> &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> shardSize = <span class=\"number\">1</span> * <span class=\"number\">1024</span> * <span class=\"number\">1024</span>;<span class=\"comment\">//1M</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> count = (<span class=\"keyword\">int</span>)(fs.Length / shardSize);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((fs.Length % shardSize) &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            count += <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &gt; count - <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> Ok(<span class=\"keyword\">new</span> &#123; code = <span class=\"number\">-1</span>, msg = <span class=\"string\">\"\"</span> &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fs.Seek(index * shardSize, SeekOrigin.Begin);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index == count - <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// =  - ( * )</span></span><br><span class=\"line\">            shardSize = (<span class=\"keyword\">int</span>)(fs.Length - (shardSize * index));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">byte</span>[] datas = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[shardSize];</span><br><span class=\"line\">        <span class=\"keyword\">await</span> fs.ReadAsync(datas, <span class=\"number\">0</span>, datas.Length);</span><br><span class=\"line\">        <span class=\"comment\">//fs.Close();</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> File(datas, <span class=\"string\">\"application/x-gzip\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong>=&gt;<strong></strong>=&gt;<strong></strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br><img src=\"/2019/08/27/net-core-filedownload/1.png\" alt=\"\"><br>error</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>linux<strong></strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"/2019/08/23/net-core-fileuploader-and-cors/\">net core WebApi</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"/2019/07/19/net-core-webapi-main/\">net core Webapi </a><br><br><strong></strong></p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<p><strong></strong></p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<p><strong>a</strong></p>\n<p><strong>FileController</strong><strong>RequestDownloadFile</strong><strong>FileDownload</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"fileInfo\"&gt;</span>[name]<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">[<span class=\"meta\">HttpPost, Route(<span class=\"meta-string\">\"RequestDownload\"</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> MessageEntity <span class=\"title\">RequestDownloadFile</span>(<span class=\"params\">[FromBody]Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; fileInfo</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"fileInfo\"&gt;</span>[index,name]<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">[<span class=\"meta\">HttpPost, Route(<span class=\"meta-string\">\"Download\"</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;IActionResult&gt; <span class=\"title\">FileDownload</span>(<span class=\"params\">[FromBody]Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; fileInfo</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>RequestDownloadFile</strong></p>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> MessageEntity <span class=\"title\">RequestDownloadFile</span>(<span class=\"params\">[FromBody]Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; fileInfo</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    MessageEntity message = <span class=\"keyword\">new</span> MessageEntity();</span><br><span class=\"line\">    <span class=\"keyword\">string</span> fileName = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> fileExt = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fileInfo.ContainsKey(<span class=\"string\">\"name\"</span>))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        fileName = fileInfo[<span class=\"string\">\"name\"</span>].ToString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fileInfo.ContainsKey(<span class=\"string\">\"ext\"</span>))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        fileExt = fileInfo[<span class=\"string\">\"ext\"</span>].ToString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(fileName))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">        message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"keyword\">string</span> filePath = <span class=\"string\">$\".<span class=\"subst\">&#123;AprilConfig.FilePath&#125;</span><span class=\"subst\">&#123;DateTime.Now.ToString(<span class=\"string\">\"yyyy-MM-dd\"</span>)&#125;</span>/<span class=\"subst\">&#123;fileName&#125;</span>\"</span>;</span><br><span class=\"line\">    filePath = <span class=\"string\">$\"<span class=\"subst\">&#123;filePath&#125;</span><span class=\"subst\">&#123;fileExt&#125;</span>\"</span>;</span><br><span class=\"line\">    FileStream fs = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!System.IO.File.Exists(filePath))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">            message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fs = <span class=\"keyword\">new</span> FileStream(filePath, FileMode.Open);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (fs.Length &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">            message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> shardSize = <span class=\"number\">1</span> * <span class=\"number\">1024</span> * <span class=\"number\">1024</span>;<span class=\"comment\">//1M</span></span><br><span class=\"line\">        RequestFileUploadEntity request = <span class=\"keyword\">new</span> RequestFileUploadEntity();</span><br><span class=\"line\">        request.fileext = fileExt;</span><br><span class=\"line\">        request.size = fs.Length;</span><br><span class=\"line\">        request.count = (<span class=\"keyword\">int</span>)(fs.Length / shardSize);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((fs.Length % shardSize) &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            request.count += <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        request.filedata = GetCryptoString(fs);</span><br><span class=\"line\"></span><br><span class=\"line\">        message.Data = request;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;filePath&#125;</span><span class=\"subst\">&#123;ex.Message&#125;</span>\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">finally</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (fs != <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            fs.Close();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>FileDownload</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;IActionResult&gt; <span class=\"title\">FileDownload</span>(<span class=\"params\">[FromBody]Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; fileInfo</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> index = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fileInfo.ContainsKey(<span class=\"string\">\"index\"</span>))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>.TryParse(fileInfo[<span class=\"string\">\"index\"</span>].ToString(), <span class=\"keyword\">out</span> index);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Ok(<span class=\"keyword\">new</span> &#123; code = <span class=\"number\">-1</span>, msg = <span class=\"string\">\"\"</span> &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> fileName = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> fileExt = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fileInfo.ContainsKey(<span class=\"string\">\"name\"</span>))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        fileName = fileInfo[<span class=\"string\">\"name\"</span>].ToString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fileInfo.ContainsKey(<span class=\"string\">\"ext\"</span>))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        fileExt = fileInfo[<span class=\"string\">\"ext\"</span>].ToString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(fileName))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Ok(<span class=\"keyword\">new</span> &#123; code = <span class=\"number\">-1</span>, msg = <span class=\"string\">\"\"</span> &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"keyword\">string</span> filePath = <span class=\"string\">$\".<span class=\"subst\">&#123;AprilConfig.FilePath&#125;</span><span class=\"subst\">&#123;DateTime.Now.ToString(<span class=\"string\">\"yyyy-MM-dd\"</span>)&#125;</span>/<span class=\"subst\">&#123;fileName&#125;</span>\"</span>;</span><br><span class=\"line\">    filePath = <span class=\"string\">$\"<span class=\"subst\">&#123;filePath&#125;</span><span class=\"subst\">&#123;fileExt&#125;</span>\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!System.IO.File.Exists(filePath))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Ok(<span class=\"keyword\">new</span> &#123; code = <span class=\"number\">-1</span>, msg = <span class=\"string\">\"\"</span> &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> fs = <span class=\"keyword\">new</span> FileStream(filePath, FileMode.Open))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (fs.Length &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> Ok(<span class=\"keyword\">new</span> &#123; code = <span class=\"number\">-1</span>, msg = <span class=\"string\">\"\"</span> &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> shardSize = <span class=\"number\">1</span> * <span class=\"number\">1024</span> * <span class=\"number\">1024</span>;<span class=\"comment\">//1M</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> count = (<span class=\"keyword\">int</span>)(fs.Length / shardSize);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((fs.Length % shardSize) &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            count += <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &gt; count - <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> Ok(<span class=\"keyword\">new</span> &#123; code = <span class=\"number\">-1</span>, msg = <span class=\"string\">\"\"</span> &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fs.Seek(index * shardSize, SeekOrigin.Begin);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index == count - <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// =  - ( * )</span></span><br><span class=\"line\">            shardSize = (<span class=\"keyword\">int</span>)(fs.Length - (shardSize * index));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">byte</span>[] datas = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[shardSize];</span><br><span class=\"line\">        <span class=\"keyword\">await</span> fs.ReadAsync(datas, <span class=\"number\">0</span>, datas.Length);</span><br><span class=\"line\">        <span class=\"comment\">//fs.Close();</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> File(datas, <span class=\"string\">\"application/x-gzip\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong>=&gt;<strong></strong>=&gt;<strong></strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br><img src=\"/2019/08/27/net-core-filedownload/1.png\" alt=\"\"><br>error</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>linux<strong></strong></p>\n"},{"title":"net core Webapi","date":"2019-07-10T05:46:17.000Z","_content":"\n### \nWebApifor**Cache,Session,Cookie**Redis\n\n### Cache\nnet coreCacheMemoryCacheCache\n\nCache\n- \n- \n- \n\n**Microsoft.Extensions.Caching.Memory**\n![Cache](net-core-cache/1.png)\nUtil\nMemoryCache\n```csharp\n\t//\n\tprivate static readonly MemoryCache Cache = new MemoryCache(new MemoryCacheOptions());\n\t/// <summary>\n    /// \n    /// </summary>\n    /// <param name=\"key\">Key</param>\n    /// <param name=\"value\">Value</param>\n    /// <param name=\"expiresSliding\"></param>\n    /// <param name=\"expiressAbsoulte\"></param>\n    /// <returns></returns>\n    public static bool Set(string key, object value, TimeSpan expiresSliding, TimeSpan expiressAbsoulte)\n    {\n        if (key == null)\n            throw new ArgumentNullException(nameof(key));\n        if (value == null)\n            throw new ArgumentNullException(nameof(value));\n\n        Cache.Set(key, value,\n            new MemoryCacheEntryOptions().SetSlidingExpiration(expiresSliding)\n                .SetAbsoluteExpiration(expiressAbsoulte));\n        return Exists(key);\n    }\n\n    /// <summary>\n    /// \n    /// </summary>\n    /// <param name=\"key\">Key</param>\n    /// <param name=\"value\">Value</param>\n    /// <param name=\"expiresIn\"></param>\n    /// <param name=\"isSliding\"></param>\n    /// <returns></returns>\n    public static bool Set(string key, object value, TimeSpan expiresIn, bool isSliding = false)\n    {\n        if (key == null)\n            throw new ArgumentNullException(nameof(key));\n        if (value == null)\n            throw new ArgumentNullException(nameof(value));\n\n        Cache.Set(key, value,\n            isSliding\n                ? new MemoryCacheEntryOptions().SetSlidingExpiration(expiresIn)\n                : new MemoryCacheEntryOptions().SetAbsoluteExpiration(expiresIn));\n\n        return Exists(key);\n    }\n```\n\nSqlSugar\n\nSession-,-||\n\n![Values](net-core-cache/2.png)\n\n![Cache](net-core-cache/3.png)\nCache\n![Cache](net-core-cache/4.png)\n\n### Session\nnet coreSessionSessionSessionCookieSessionIDCookie\n\nSessionwebCookie[JWT](https://jwt.io/)tokentokenSessionRedis\n**Microsoft.AspNetCore.Session**\n![Session](net-core-cache/5.png)\nStartup.csSession\n```csharp\n        public void ConfigureServices(IServiceCollection services)\n        {\n            //\n            \n            #region Session\n            services.AddSession(options =>\n            {\n                options.Cookie.Name = \"April.Session\";\n                options.IdleTimeout = TimeSpan.FromSeconds(2000);//session\n                options.Cookie.HttpOnly = true;//jscookie,\n            });\n            #endregion\n        }\n```\nConfigConfigureUseUserMvc\n```csharp\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n            //\n\n            app.UseSession();//\n\n            app.UseHttpsRedirection();\n            app.UseMvc();\n        }\n```\n\nUtilSessionUtilSession\n```csharp\n    public class SessionUtil\n    {\n        /// <summary>\n        /// Session\n        /// </summary>\n        /// <param name=\"key\"></param>\n        /// <param name=\"value\"></param>\n        public void SetSession(HttpContext content,string key, string value)\n        {\n            content.Session.SetString(key, value);\n        }\n        /// <summary>\n        /// Session\n        /// </summary>\n        /// <param name=\"key\"></param>\n        /// <returns></returns>\n        public string GetSession(HttpContext context, string key, string defaultValue = \"\")\n        {\n            string value = context.Session.GetString(key);\n            if (string.IsNullOrEmpty(value))\n            {\n                value = defaultValue;\n            }\n            return value;\n        }\n    }\n```\nValuesController\n\n![Values](net-core-cache/6.png)\nValues/{id}Session\n![](net-core-cache/7.png)\n\nHttpContextIServiceProvider\nAprilConfig\n```csharp\n    public class AprilConfig\n    {\n        public static IServiceProvider _provider;\n\n        public static HttpContext HttpCurrent\n        {\n            get\n            {\n                object factory = _provider.GetService(typeof(IHttpContextAccessor));\n                HttpContext context = ((IHttpContextAccessor)factory).HttpContext;\n                return context;\n            }\n        }\n    }\n```\n\nStartup.csIserviceProvider\n![Startup](net-core-cache/8.png)\nSessionUtilHttpContext\n![SessionUtil](net-core-cache/9.png)\nHttpContext**AprilConfig.HttpCurrent**\n\n### Cookie\nCookiewebps\n\nCookienet coreNuGet\n\nCookieUtil\n```csharp\npublic class CookieUtil\n    {\n        /// <summary>\n        /// cookie\n        /// </summary>\n        /// <param name=\"key\"></param>\n        /// <param name=\"value\"></param>  \n        /// <param name=\"minutes\"></param>      \n        public static void SetCookies(string key, string value, int minutes = 10)\n        {\n            AprilConfig.HttpCurrent.Response.Cookies.Append(key, value, new CookieOptions\n            {\n                Expires = DateTime.Now.AddMinutes(minutes)\n            });\n        }\n        /// <summary>\n        /// cookie\n        /// </summary>\n        /// <param name=\"key\"></param>\n        public static void DeleteCookies(string key)\n        {\n            //\n            AprilConfig.HttpCurrent.Response.Cookies.Delete(key);\n        }\n\n        /// <summary>\n        /// cookies\n        /// </summary>\n        /// <param name=\"key\"></param>\n        /// <returns></returns>\n        public static string GetCookies(string key,string defaultValue=\"\")\n        {\n            string value = string.Empty;\n            AprilConfig.HttpCurrent.Request.Cookies.TryGetValue(key, out value);\n            if (string.IsNullOrEmpty(value))\n            {\n                value = defaultValue;\n            }\n            return value;\n        }\n    }\n```\n\nValuesController\n![Values](net-core-cache/10.png)\n\n![](net-core-cache/11.png)\n\n### \nYY****\n\n### \nSession.SetStringNuGet**Microsoft.AspNetCore.Http.Abstractions**","source":"_posts/net-core-cache.md","raw":"---\ntitle: net core Webapi\ndate: 2019-07-10 13:46:17\ntags: net core\ncategories: AprilBlank\n---\n\n### \nWebApifor**Cache,Session,Cookie**Redis\n\n### Cache\nnet coreCacheMemoryCacheCache\n\nCache\n- \n- \n- \n\n**Microsoft.Extensions.Caching.Memory**\n![Cache](net-core-cache/1.png)\nUtil\nMemoryCache\n```csharp\n\t//\n\tprivate static readonly MemoryCache Cache = new MemoryCache(new MemoryCacheOptions());\n\t/// <summary>\n    /// \n    /// </summary>\n    /// <param name=\"key\">Key</param>\n    /// <param name=\"value\">Value</param>\n    /// <param name=\"expiresSliding\"></param>\n    /// <param name=\"expiressAbsoulte\"></param>\n    /// <returns></returns>\n    public static bool Set(string key, object value, TimeSpan expiresSliding, TimeSpan expiressAbsoulte)\n    {\n        if (key == null)\n            throw new ArgumentNullException(nameof(key));\n        if (value == null)\n            throw new ArgumentNullException(nameof(value));\n\n        Cache.Set(key, value,\n            new MemoryCacheEntryOptions().SetSlidingExpiration(expiresSliding)\n                .SetAbsoluteExpiration(expiressAbsoulte));\n        return Exists(key);\n    }\n\n    /// <summary>\n    /// \n    /// </summary>\n    /// <param name=\"key\">Key</param>\n    /// <param name=\"value\">Value</param>\n    /// <param name=\"expiresIn\"></param>\n    /// <param name=\"isSliding\"></param>\n    /// <returns></returns>\n    public static bool Set(string key, object value, TimeSpan expiresIn, bool isSliding = false)\n    {\n        if (key == null)\n            throw new ArgumentNullException(nameof(key));\n        if (value == null)\n            throw new ArgumentNullException(nameof(value));\n\n        Cache.Set(key, value,\n            isSliding\n                ? new MemoryCacheEntryOptions().SetSlidingExpiration(expiresIn)\n                : new MemoryCacheEntryOptions().SetAbsoluteExpiration(expiresIn));\n\n        return Exists(key);\n    }\n```\n\nSqlSugar\n\nSession-,-||\n\n![Values](net-core-cache/2.png)\n\n![Cache](net-core-cache/3.png)\nCache\n![Cache](net-core-cache/4.png)\n\n### Session\nnet coreSessionSessionSessionCookieSessionIDCookie\n\nSessionwebCookie[JWT](https://jwt.io/)tokentokenSessionRedis\n**Microsoft.AspNetCore.Session**\n![Session](net-core-cache/5.png)\nStartup.csSession\n```csharp\n        public void ConfigureServices(IServiceCollection services)\n        {\n            //\n            \n            #region Session\n            services.AddSession(options =>\n            {\n                options.Cookie.Name = \"April.Session\";\n                options.IdleTimeout = TimeSpan.FromSeconds(2000);//session\n                options.Cookie.HttpOnly = true;//jscookie,\n            });\n            #endregion\n        }\n```\nConfigConfigureUseUserMvc\n```csharp\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n            //\n\n            app.UseSession();//\n\n            app.UseHttpsRedirection();\n            app.UseMvc();\n        }\n```\n\nUtilSessionUtilSession\n```csharp\n    public class SessionUtil\n    {\n        /// <summary>\n        /// Session\n        /// </summary>\n        /// <param name=\"key\"></param>\n        /// <param name=\"value\"></param>\n        public void SetSession(HttpContext content,string key, string value)\n        {\n            content.Session.SetString(key, value);\n        }\n        /// <summary>\n        /// Session\n        /// </summary>\n        /// <param name=\"key\"></param>\n        /// <returns></returns>\n        public string GetSession(HttpContext context, string key, string defaultValue = \"\")\n        {\n            string value = context.Session.GetString(key);\n            if (string.IsNullOrEmpty(value))\n            {\n                value = defaultValue;\n            }\n            return value;\n        }\n    }\n```\nValuesController\n\n![Values](net-core-cache/6.png)\nValues/{id}Session\n![](net-core-cache/7.png)\n\nHttpContextIServiceProvider\nAprilConfig\n```csharp\n    public class AprilConfig\n    {\n        public static IServiceProvider _provider;\n\n        public static HttpContext HttpCurrent\n        {\n            get\n            {\n                object factory = _provider.GetService(typeof(IHttpContextAccessor));\n                HttpContext context = ((IHttpContextAccessor)factory).HttpContext;\n                return context;\n            }\n        }\n    }\n```\n\nStartup.csIserviceProvider\n![Startup](net-core-cache/8.png)\nSessionUtilHttpContext\n![SessionUtil](net-core-cache/9.png)\nHttpContext**AprilConfig.HttpCurrent**\n\n### Cookie\nCookiewebps\n\nCookienet coreNuGet\n\nCookieUtil\n```csharp\npublic class CookieUtil\n    {\n        /// <summary>\n        /// cookie\n        /// </summary>\n        /// <param name=\"key\"></param>\n        /// <param name=\"value\"></param>  \n        /// <param name=\"minutes\"></param>      \n        public static void SetCookies(string key, string value, int minutes = 10)\n        {\n            AprilConfig.HttpCurrent.Response.Cookies.Append(key, value, new CookieOptions\n            {\n                Expires = DateTime.Now.AddMinutes(minutes)\n            });\n        }\n        /// <summary>\n        /// cookie\n        /// </summary>\n        /// <param name=\"key\"></param>\n        public static void DeleteCookies(string key)\n        {\n            //\n            AprilConfig.HttpCurrent.Response.Cookies.Delete(key);\n        }\n\n        /// <summary>\n        /// cookies\n        /// </summary>\n        /// <param name=\"key\"></param>\n        /// <returns></returns>\n        public static string GetCookies(string key,string defaultValue=\"\")\n        {\n            string value = string.Empty;\n            AprilConfig.HttpCurrent.Request.Cookies.TryGetValue(key, out value);\n            if (string.IsNullOrEmpty(value))\n            {\n                value = defaultValue;\n            }\n            return value;\n        }\n    }\n```\n\nValuesController\n![Values](net-core-cache/10.png)\n\n![](net-core-cache/11.png)\n\n### \nYY****\n\n### \nSession.SetStringNuGet**Microsoft.AspNetCore.Http.Abstractions**","slug":"net-core-cache","published":1,"updated":"2019-09-30T05:46:03.903Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m3g003l9sv7x7kea258","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>WebApifor<strong>Cache,Session,Cookie</strong>Redis</p>\n<h3 id=\"Cache\"><a href=\"#Cache\" class=\"headerlink\" title=\"Cache\"></a>Cache</h3><p>net coreCacheMemoryCacheCache</p>\n<p>Cache</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><strong>Microsoft.Extensions.Caching.Memory</strong><br><img src=\"/2019/07/10/net-core-cache/1.png\" alt=\"Cache\"><br>Util<br>MemoryCache</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">readonly</span> MemoryCache Cache = <span class=\"keyword\">new</span> MemoryCache(<span class=\"keyword\">new</span> MemoryCacheOptions());</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span>Key<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"value\"&gt;</span>Value<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"expiresSliding\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"expiressAbsoulte\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">bool</span> <span class=\"title\">Set</span>(<span class=\"params\"><span class=\"keyword\">string</span> key, <span class=\"keyword\">object</span> <span class=\"keyword\">value</span>, TimeSpan expiresSliding, TimeSpan expiressAbsoulte</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>   &#123;</span><br><span class=\"line\">       <span class=\"keyword\">if</span> (key == <span class=\"literal\">null</span>)</span><br><span class=\"line\">           <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ArgumentNullException(<span class=\"keyword\">nameof</span>(key));</span><br><span class=\"line\">       <span class=\"keyword\">if</span> (<span class=\"keyword\">value</span> == <span class=\"literal\">null</span>)</span><br><span class=\"line\">           <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ArgumentNullException(<span class=\"keyword\">nameof</span>(<span class=\"keyword\">value</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">       Cache.Set(key, <span class=\"keyword\">value</span>,</span><br><span class=\"line\">           <span class=\"keyword\">new</span> MemoryCacheEntryOptions().SetSlidingExpiration(expiresSliding)</span><br><span class=\"line\">               .SetAbsoluteExpiration(expiressAbsoulte));</span><br><span class=\"line\">       <span class=\"keyword\">return</span> Exists(key);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span>Key<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"value\"&gt;</span>Value<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"expiresIn\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"isSliding\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">bool</span> <span class=\"title\">Set</span>(<span class=\"params\"><span class=\"keyword\">string</span> key, <span class=\"keyword\">object</span> <span class=\"keyword\">value</span>, TimeSpan expiresIn, <span class=\"keyword\">bool</span> isSliding = <span class=\"literal\">false</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>   &#123;</span><br><span class=\"line\">       <span class=\"keyword\">if</span> (key == <span class=\"literal\">null</span>)</span><br><span class=\"line\">           <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ArgumentNullException(<span class=\"keyword\">nameof</span>(key));</span><br><span class=\"line\">       <span class=\"keyword\">if</span> (<span class=\"keyword\">value</span> == <span class=\"literal\">null</span>)</span><br><span class=\"line\">           <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ArgumentNullException(<span class=\"keyword\">nameof</span>(<span class=\"keyword\">value</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">       Cache.Set(key, <span class=\"keyword\">value</span>,</span><br><span class=\"line\">           isSliding</span><br><span class=\"line\">               ? <span class=\"keyword\">new</span> MemoryCacheEntryOptions().SetSlidingExpiration(expiresIn)</span><br><span class=\"line\">               : <span class=\"keyword\">new</span> MemoryCacheEntryOptions().SetAbsoluteExpiration(expiresIn));</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"keyword\">return</span> Exists(key);</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p>SqlSugar</p>\n<p>Session-,-||</p>\n<p><img src=\"/2019/07/10/net-core-cache/2.png\" alt=\"Values\"></p>\n<p><img src=\"/2019/07/10/net-core-cache/3.png\" alt=\"Cache\"><br>Cache<br><img src=\"/2019/07/10/net-core-cache/4.png\" alt=\"Cache\"></p>\n<h3 id=\"Session\"><a href=\"#Session\" class=\"headerlink\" title=\"Session\"></a>Session</h3><p>net coreSessionSessionSessionCookieSessionIDCookie</p>\n<p>SessionwebCookie<a href=\"https://jwt.io/\" target=\"_blank\" rel=\"noopener\">JWT</a>tokentokenSessionRedis<br><strong>Microsoft.AspNetCore.Session</strong><br><img src=\"/2019/07/10/net-core-cache/5.png\" alt=\"Session\"><br>Startup.csSession</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">region</span> Session</span></span><br><span class=\"line\">    services.AddSession(options =&gt;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        options.Cookie.Name = <span class=\"string\">\"April.Session\"</span>;</span><br><span class=\"line\">        options.IdleTimeout = TimeSpan.FromSeconds(<span class=\"number\">2000</span>);<span class=\"comment\">//session</span></span><br><span class=\"line\">        options.Cookie.HttpOnly = <span class=\"literal\">true</span>;<span class=\"comment\">//jscookie,</span></span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ConfigConfigureUseUserMvc</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IHostingEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\">    app.UseSession();<span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\">    app.UseHttpsRedirection();</span><br><span class=\"line\">    app.UseMvc();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>UtilSessionUtilSession</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">SessionUtil</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> Session</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"value\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">SetSession</span>(<span class=\"params\">HttpContext content,<span class=\"keyword\">string</span> key, <span class=\"keyword\">string</span> <span class=\"keyword\">value</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        content.Session.SetString(key, <span class=\"keyword\">value</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> Session</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">string</span> <span class=\"title\">GetSession</span>(<span class=\"params\">HttpContext context, <span class=\"keyword\">string</span> key, <span class=\"keyword\">string</span> defaultValue = <span class=\"string\">\"\"</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">string</span> <span class=\"keyword\">value</span> = context.Session.GetString(key);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(<span class=\"keyword\">value</span>))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">value</span> = defaultValue;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">value</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ValuesController</p>\n<p><img src=\"/2019/07/10/net-core-cache/6.png\" alt=\"Values\"><br>Values/{id}Session<br><img src=\"/2019/07/10/net-core-cache/7.png\" alt=\"\"></p>\n<p>HttpContextIServiceProvider<br>AprilConfig</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AprilConfig</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IServiceProvider _provider;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> HttpContext HttpCurrent</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">get</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">object</span> factory = _provider.GetService(<span class=\"keyword\">typeof</span>(IHttpContextAccessor));</span><br><span class=\"line\">            HttpContext context = ((IHttpContextAccessor)factory).HttpContext;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> context;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Startup.csIserviceProvider<br><img src=\"/2019/07/10/net-core-cache/8.png\" alt=\"Startup\"><br>SessionUtilHttpContext<br><img src=\"/2019/07/10/net-core-cache/9.png\" alt=\"SessionUtil\"><br>HttpContext<strong>AprilConfig.HttpCurrent</strong></p>\n<h3 id=\"Cookie\"><a href=\"#Cookie\" class=\"headerlink\" title=\"Cookie\"></a>Cookie</h3><p>Cookiewebps</p>\n<p>Cookienet coreNuGet</p>\n<p>CookieUtil</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">CookieUtil</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> cookie</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"value\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span>  </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"minutes\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span>      </span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">SetCookies</span>(<span class=\"params\"><span class=\"keyword\">string</span> key, <span class=\"keyword\">string</span> <span class=\"keyword\">value</span>, <span class=\"keyword\">int</span> minutes = <span class=\"number\">10</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>        &#123;</span><br><span class=\"line\">            AprilConfig.HttpCurrent.Response.Cookies.Append(key, <span class=\"keyword\">value</span>, <span class=\"keyword\">new</span> CookieOptions</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                Expires = DateTime.Now.AddMinutes(minutes)</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> cookie</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">DeleteCookies</span>(<span class=\"params\"><span class=\"keyword\">string</span> key</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>        &#123;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            AprilConfig.HttpCurrent.Response.Cookies.Delete(key);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> cookies</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> <span class=\"title\">GetCookies</span>(<span class=\"params\"><span class=\"keyword\">string</span> key,<span class=\"keyword\">string</span> defaultValue=<span class=\"string\">\"\"</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">string</span> <span class=\"keyword\">value</span> = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">            AprilConfig.HttpCurrent.Request.Cookies.TryGetValue(key, <span class=\"keyword\">out</span> <span class=\"keyword\">value</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(<span class=\"keyword\">value</span>))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">value</span> = defaultValue;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">value</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>ValuesController<br><img src=\"/2019/07/10/net-core-cache/10.png\" alt=\"Values\"><br><br><img src=\"/2019/07/10/net-core-cache/11.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>YY<strong></strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Session.SetStringNuGet<strong>Microsoft.AspNetCore.Http.Abstractions</strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>WebApifor<strong>Cache,Session,Cookie</strong>Redis</p>\n<h3 id=\"Cache\"><a href=\"#Cache\" class=\"headerlink\" title=\"Cache\"></a>Cache</h3><p>net coreCacheMemoryCacheCache</p>\n<p>Cache</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><strong>Microsoft.Extensions.Caching.Memory</strong><br><img src=\"/2019/07/10/net-core-cache/1.png\" alt=\"Cache\"><br>Util<br>MemoryCache</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">readonly</span> MemoryCache Cache = <span class=\"keyword\">new</span> MemoryCache(<span class=\"keyword\">new</span> MemoryCacheOptions());</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span>Key<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"value\"&gt;</span>Value<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"expiresSliding\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"expiressAbsoulte\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">bool</span> <span class=\"title\">Set</span>(<span class=\"params\"><span class=\"keyword\">string</span> key, <span class=\"keyword\">object</span> <span class=\"keyword\">value</span>, TimeSpan expiresSliding, TimeSpan expiressAbsoulte</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>   &#123;</span><br><span class=\"line\">       <span class=\"keyword\">if</span> (key == <span class=\"literal\">null</span>)</span><br><span class=\"line\">           <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ArgumentNullException(<span class=\"keyword\">nameof</span>(key));</span><br><span class=\"line\">       <span class=\"keyword\">if</span> (<span class=\"keyword\">value</span> == <span class=\"literal\">null</span>)</span><br><span class=\"line\">           <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ArgumentNullException(<span class=\"keyword\">nameof</span>(<span class=\"keyword\">value</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">       Cache.Set(key, <span class=\"keyword\">value</span>,</span><br><span class=\"line\">           <span class=\"keyword\">new</span> MemoryCacheEntryOptions().SetSlidingExpiration(expiresSliding)</span><br><span class=\"line\">               .SetAbsoluteExpiration(expiressAbsoulte));</span><br><span class=\"line\">       <span class=\"keyword\">return</span> Exists(key);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span>Key<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"value\"&gt;</span>Value<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"expiresIn\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"isSliding\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">   <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">bool</span> <span class=\"title\">Set</span>(<span class=\"params\"><span class=\"keyword\">string</span> key, <span class=\"keyword\">object</span> <span class=\"keyword\">value</span>, TimeSpan expiresIn, <span class=\"keyword\">bool</span> isSliding = <span class=\"literal\">false</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>   &#123;</span><br><span class=\"line\">       <span class=\"keyword\">if</span> (key == <span class=\"literal\">null</span>)</span><br><span class=\"line\">           <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ArgumentNullException(<span class=\"keyword\">nameof</span>(key));</span><br><span class=\"line\">       <span class=\"keyword\">if</span> (<span class=\"keyword\">value</span> == <span class=\"literal\">null</span>)</span><br><span class=\"line\">           <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ArgumentNullException(<span class=\"keyword\">nameof</span>(<span class=\"keyword\">value</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">       Cache.Set(key, <span class=\"keyword\">value</span>,</span><br><span class=\"line\">           isSliding</span><br><span class=\"line\">               ? <span class=\"keyword\">new</span> MemoryCacheEntryOptions().SetSlidingExpiration(expiresIn)</span><br><span class=\"line\">               : <span class=\"keyword\">new</span> MemoryCacheEntryOptions().SetAbsoluteExpiration(expiresIn));</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"keyword\">return</span> Exists(key);</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p>SqlSugar</p>\n<p>Session-,-||</p>\n<p><img src=\"/2019/07/10/net-core-cache/2.png\" alt=\"Values\"></p>\n<p><img src=\"/2019/07/10/net-core-cache/3.png\" alt=\"Cache\"><br>Cache<br><img src=\"/2019/07/10/net-core-cache/4.png\" alt=\"Cache\"></p>\n<h3 id=\"Session\"><a href=\"#Session\" class=\"headerlink\" title=\"Session\"></a>Session</h3><p>net coreSessionSessionSessionCookieSessionIDCookie</p>\n<p>SessionwebCookie<a href=\"https://jwt.io/\" target=\"_blank\" rel=\"noopener\">JWT</a>tokentokenSessionRedis<br><strong>Microsoft.AspNetCore.Session</strong><br><img src=\"/2019/07/10/net-core-cache/5.png\" alt=\"Session\"><br>Startup.csSession</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">region</span> Session</span></span><br><span class=\"line\">    services.AddSession(options =&gt;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        options.Cookie.Name = <span class=\"string\">\"April.Session\"</span>;</span><br><span class=\"line\">        options.IdleTimeout = TimeSpan.FromSeconds(<span class=\"number\">2000</span>);<span class=\"comment\">//session</span></span><br><span class=\"line\">        options.Cookie.HttpOnly = <span class=\"literal\">true</span>;<span class=\"comment\">//jscookie,</span></span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ConfigConfigureUseUserMvc</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IHostingEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\">    app.UseSession();<span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\">    app.UseHttpsRedirection();</span><br><span class=\"line\">    app.UseMvc();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>UtilSessionUtilSession</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">SessionUtil</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> Session</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"value\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">SetSession</span>(<span class=\"params\">HttpContext content,<span class=\"keyword\">string</span> key, <span class=\"keyword\">string</span> <span class=\"keyword\">value</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        content.Session.SetString(key, <span class=\"keyword\">value</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> Session</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">string</span> <span class=\"title\">GetSession</span>(<span class=\"params\">HttpContext context, <span class=\"keyword\">string</span> key, <span class=\"keyword\">string</span> defaultValue = <span class=\"string\">\"\"</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">string</span> <span class=\"keyword\">value</span> = context.Session.GetString(key);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(<span class=\"keyword\">value</span>))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">value</span> = defaultValue;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">value</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ValuesController</p>\n<p><img src=\"/2019/07/10/net-core-cache/6.png\" alt=\"Values\"><br>Values/{id}Session<br><img src=\"/2019/07/10/net-core-cache/7.png\" alt=\"\"></p>\n<p>HttpContextIServiceProvider<br>AprilConfig</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AprilConfig</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IServiceProvider _provider;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> HttpContext HttpCurrent</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">get</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">object</span> factory = _provider.GetService(<span class=\"keyword\">typeof</span>(IHttpContextAccessor));</span><br><span class=\"line\">            HttpContext context = ((IHttpContextAccessor)factory).HttpContext;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> context;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Startup.csIserviceProvider<br><img src=\"/2019/07/10/net-core-cache/8.png\" alt=\"Startup\"><br>SessionUtilHttpContext<br><img src=\"/2019/07/10/net-core-cache/9.png\" alt=\"SessionUtil\"><br>HttpContext<strong>AprilConfig.HttpCurrent</strong></p>\n<h3 id=\"Cookie\"><a href=\"#Cookie\" class=\"headerlink\" title=\"Cookie\"></a>Cookie</h3><p>Cookiewebps</p>\n<p>Cookienet coreNuGet</p>\n<p>CookieUtil</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">CookieUtil</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> cookie</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"value\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span>  </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"minutes\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span>      </span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">SetCookies</span>(<span class=\"params\"><span class=\"keyword\">string</span> key, <span class=\"keyword\">string</span> <span class=\"keyword\">value</span>, <span class=\"keyword\">int</span> minutes = <span class=\"number\">10</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>        &#123;</span><br><span class=\"line\">            AprilConfig.HttpCurrent.Response.Cookies.Append(key, <span class=\"keyword\">value</span>, <span class=\"keyword\">new</span> CookieOptions</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                Expires = DateTime.Now.AddMinutes(minutes)</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> cookie</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">DeleteCookies</span>(<span class=\"params\"><span class=\"keyword\">string</span> key</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>        &#123;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            AprilConfig.HttpCurrent.Response.Cookies.Delete(key);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> cookies</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> <span class=\"title\">GetCookies</span>(<span class=\"params\"><span class=\"keyword\">string</span> key,<span class=\"keyword\">string</span> defaultValue=<span class=\"string\">\"\"</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">string</span> <span class=\"keyword\">value</span> = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">            AprilConfig.HttpCurrent.Request.Cookies.TryGetValue(key, <span class=\"keyword\">out</span> <span class=\"keyword\">value</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(<span class=\"keyword\">value</span>))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">value</span> = defaultValue;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">value</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>ValuesController<br><img src=\"/2019/07/10/net-core-cache/10.png\" alt=\"Values\"><br><br><img src=\"/2019/07/10/net-core-cache/11.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>YY<strong></strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Session.SetStringNuGet<strong>Microsoft.AspNetCore.Http.Abstractions</strong></p>\n"},{"title":"net core WebApiQuartz","date":"2019-09-26T02:08:53.000Z","_content":"\n\n### \npy\n\n\"\"****\n\n### Quartz\n**Hangfire****Quartz**\n\nUtil\n\nStartup\n```csharp\n        public IServiceProvider ConfigureServices(IServiceCollection services)\n        {\n            ServiceInjection.ConfigureRepository(services);\n\n            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);\n\t\t\t//\n            services.TryAddSingleton<ISchedulerFactory, StdSchedulerFactory>();\n\t\t}\n```\n\n**SchedulerFactory****Trigger****Job**appappappjob\n\n\n\n> \n\nok**MyJob**\n\n```csharp\n    public class MyJob : IJob\n    {\n        public Task Execute(IJobExecutionContext context)\n        {\n            return Task.Run(() =>\n            {\n                LogUtil.Debug(\"MyJob\");\n            });\n        }\n    }\n```\n\n**QuartzUtil**\n\n```csharp\n    public class QuartzUtil\n    {\n        private static ISchedulerFactory _schedulerFactory;\n        private static IScheduler _scheduler;\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"type\"></param>\n        /// <param name=\"jobKey\"></param>\n        /// <param name=\"trigger\"></param>\n        public static async Task Add(Type type, JobKey jobKey, ITrigger trigger = null)\n        {\n            Init();\n            _scheduler = await _schedulerFactory.GetScheduler();\n\n            await _scheduler.Start();\n\n            if (trigger == null)\n            {\n                trigger = TriggerBuilder.Create()\n                    .WithIdentity(\"april.trigger\")\n                    .WithDescription(\"default\")\n                    .WithSimpleSchedule(x=>x.WithMisfireHandlingInstructionFireNow().WithRepeatCount(-1))\n                    .Build();\n            }\n            var job = JobBuilder.Create(type)\n                .WithIdentity(jobKey)\n                .Build();\n\n            await _scheduler.ScheduleJob(job, trigger);          \n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"jobKey\"></param>\n        public static async Task Resume(JobKey jobKey)\n        {\n            Init();\n            _scheduler = await _schedulerFactory.GetScheduler();\n            LogUtil.Debug($\"{jobKey.Group},{jobKey.Name}\");\n            await _scheduler.ResumeJob(jobKey);\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"jobKey\"></param>\n        public static async Task Stop(JobKey jobKey)\n        {\n            Init();\n            _scheduler = await _schedulerFactory.GetScheduler();\n            LogUtil.Debug($\"{jobKey.Group},{jobKey.Name}\");\n            await _scheduler.PauseJob(jobKey);\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        private static void Init()\n        {\n            if (_schedulerFactory == null)\n            {\n                _schedulerFactory = AprilConfig.ServiceProvider.GetService<ISchedulerFactory>();\n            }\n        }\n    }\n```\n//\n\n**Cron**\n\n**corn      ** 0 0 0 1 * ?[Cron](http://www.bejson.com/othertools/cronvalidate/)\n\n### \n>\n\n\n\n**Values**5s\n\n```csharp\n        [HttpGet]\n        [Route(\"QuartzTest\")]\n        public void QuartzTest(int type)\n        {\n            JobKey jobKey = new JobKey(\"demo\",\"group1\");\n            switch (type)\n            {\n                //\n                case 1:\n                    var trigger = TriggerBuilder.Create()\n                            .WithDescription(\"\")\n                            .WithIdentity(\"test\")\n                            //.WithSchedule(CronScheduleBuilder.CronSchedule(\"0 0/30 * * * ? *\").WithMisfireHandlingInstructionDoNothing())\n                            .WithSimpleSchedule(x=>x.WithIntervalInSeconds(5).RepeatForever().WithMisfireHandlingInstructionIgnoreMisfires())\n                            .Build();\n                    QuartzUtil.Add(typeof(MyJob), jobKey, trigger);\n                    break;\n                //\n                case 2:\n                    QuartzUtil.Stop(jobKey);\n                    break;\n                //\n                case 3:\n                    QuartzUtil.Resume(jobKey);\n                    break;\n            }\n        }\n```\n\nappsettings\n\n![](net-core-quartz/1.png)\n123\n![](net-core-quartz/2.png)\n\n- --- ok\n- --- ok\n- --- ok\n\n### \n\nQuartz**WithMisfireHandlingInstructionIgnoreMisfires**\n\n\n\n![](net-core-quartz/3.png)\n**CronTrigger**\n\n||  |\n|--|--|\n| withMisfireHandlingInstructionDoNothing | ; CronCron |\n| withMisfireHandlingInstructionIgnoreMisfires|  ; ; Cron  |\n| withMisfireHandlingInstructionFireAndProceed| ; Cron |\n\n**SimpleTrigger**\n\n||  |\n|--|--|\n| withMisfireHandlingInstructionFireNow| ; FinalTIme;FinalTime; FinalTimestarttimeFinalTime |\n| withMisfireHandlingInstructionIgnoreMisfires| ; ;Interval; RepeatCount+1  |\n| withMisfireHandlingInstructionNextWithExistingCount| ; FinalTime; startTimeFinalTime; pauseresumeFinalTime |\n| withMisfireHandlingInstructionNowWithExistingCount| ; FinalTIme; FinalTime; FinalTimestarttimeFinalTime |\n| withMisfireHandlingInstructionNextWithRemainingCount| ; FinalTime; startTimeFinalTime; pauseresumeFinalTime |\n| withMisfireHandlingInstructionNowWithRemainingCount| ; FinalTIme; FinalTime; FinalTimestarttimeFinalTime |\n\n\n[https://blog.csdn.net/yangshangwei/article/details/78539433](https://blog.csdn.net/yangshangwei/article/details/78539433)\n\nnet frameworkIIS20windows\n\nnet core\n\n### \nsqlsql/**net core 3.0**\n\n","source":"_posts/net-core-quartz.md","raw":"---\ntitle: net core WebApiQuartz\ndate: 2019-09-26 10:08:53\ntags: net core\ncategories: AprilBlank\n---\n\n\n### \npy\n\n\"\"****\n\n### Quartz\n**Hangfire****Quartz**\n\nUtil\n\nStartup\n```csharp\n        public IServiceProvider ConfigureServices(IServiceCollection services)\n        {\n            ServiceInjection.ConfigureRepository(services);\n\n            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);\n\t\t\t//\n            services.TryAddSingleton<ISchedulerFactory, StdSchedulerFactory>();\n\t\t}\n```\n\n**SchedulerFactory****Trigger****Job**appappappjob\n\n\n\n> \n\nok**MyJob**\n\n```csharp\n    public class MyJob : IJob\n    {\n        public Task Execute(IJobExecutionContext context)\n        {\n            return Task.Run(() =>\n            {\n                LogUtil.Debug(\"MyJob\");\n            });\n        }\n    }\n```\n\n**QuartzUtil**\n\n```csharp\n    public class QuartzUtil\n    {\n        private static ISchedulerFactory _schedulerFactory;\n        private static IScheduler _scheduler;\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"type\"></param>\n        /// <param name=\"jobKey\"></param>\n        /// <param name=\"trigger\"></param>\n        public static async Task Add(Type type, JobKey jobKey, ITrigger trigger = null)\n        {\n            Init();\n            _scheduler = await _schedulerFactory.GetScheduler();\n\n            await _scheduler.Start();\n\n            if (trigger == null)\n            {\n                trigger = TriggerBuilder.Create()\n                    .WithIdentity(\"april.trigger\")\n                    .WithDescription(\"default\")\n                    .WithSimpleSchedule(x=>x.WithMisfireHandlingInstructionFireNow().WithRepeatCount(-1))\n                    .Build();\n            }\n            var job = JobBuilder.Create(type)\n                .WithIdentity(jobKey)\n                .Build();\n\n            await _scheduler.ScheduleJob(job, trigger);          \n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"jobKey\"></param>\n        public static async Task Resume(JobKey jobKey)\n        {\n            Init();\n            _scheduler = await _schedulerFactory.GetScheduler();\n            LogUtil.Debug($\"{jobKey.Group},{jobKey.Name}\");\n            await _scheduler.ResumeJob(jobKey);\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"jobKey\"></param>\n        public static async Task Stop(JobKey jobKey)\n        {\n            Init();\n            _scheduler = await _schedulerFactory.GetScheduler();\n            LogUtil.Debug($\"{jobKey.Group},{jobKey.Name}\");\n            await _scheduler.PauseJob(jobKey);\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        private static void Init()\n        {\n            if (_schedulerFactory == null)\n            {\n                _schedulerFactory = AprilConfig.ServiceProvider.GetService<ISchedulerFactory>();\n            }\n        }\n    }\n```\n//\n\n**Cron**\n\n**corn      ** 0 0 0 1 * ?[Cron](http://www.bejson.com/othertools/cronvalidate/)\n\n### \n>\n\n\n\n**Values**5s\n\n```csharp\n        [HttpGet]\n        [Route(\"QuartzTest\")]\n        public void QuartzTest(int type)\n        {\n            JobKey jobKey = new JobKey(\"demo\",\"group1\");\n            switch (type)\n            {\n                //\n                case 1:\n                    var trigger = TriggerBuilder.Create()\n                            .WithDescription(\"\")\n                            .WithIdentity(\"test\")\n                            //.WithSchedule(CronScheduleBuilder.CronSchedule(\"0 0/30 * * * ? *\").WithMisfireHandlingInstructionDoNothing())\n                            .WithSimpleSchedule(x=>x.WithIntervalInSeconds(5).RepeatForever().WithMisfireHandlingInstructionIgnoreMisfires())\n                            .Build();\n                    QuartzUtil.Add(typeof(MyJob), jobKey, trigger);\n                    break;\n                //\n                case 2:\n                    QuartzUtil.Stop(jobKey);\n                    break;\n                //\n                case 3:\n                    QuartzUtil.Resume(jobKey);\n                    break;\n            }\n        }\n```\n\nappsettings\n\n![](net-core-quartz/1.png)\n123\n![](net-core-quartz/2.png)\n\n- --- ok\n- --- ok\n- --- ok\n\n### \n\nQuartz**WithMisfireHandlingInstructionIgnoreMisfires**\n\n\n\n![](net-core-quartz/3.png)\n**CronTrigger**\n\n||  |\n|--|--|\n| withMisfireHandlingInstructionDoNothing | ; CronCron |\n| withMisfireHandlingInstructionIgnoreMisfires|  ; ; Cron  |\n| withMisfireHandlingInstructionFireAndProceed| ; Cron |\n\n**SimpleTrigger**\n\n||  |\n|--|--|\n| withMisfireHandlingInstructionFireNow| ; FinalTIme;FinalTime; FinalTimestarttimeFinalTime |\n| withMisfireHandlingInstructionIgnoreMisfires| ; ;Interval; RepeatCount+1  |\n| withMisfireHandlingInstructionNextWithExistingCount| ; FinalTime; startTimeFinalTime; pauseresumeFinalTime |\n| withMisfireHandlingInstructionNowWithExistingCount| ; FinalTIme; FinalTime; FinalTimestarttimeFinalTime |\n| withMisfireHandlingInstructionNextWithRemainingCount| ; FinalTime; startTimeFinalTime; pauseresumeFinalTime |\n| withMisfireHandlingInstructionNowWithRemainingCount| ; FinalTIme; FinalTime; FinalTimestarttimeFinalTime |\n\n\n[https://blog.csdn.net/yangshangwei/article/details/78539433](https://blog.csdn.net/yangshangwei/article/details/78539433)\n\nnet frameworkIIS20windows\n\nnet core\n\n### \nsqlsql/**net core 3.0**\n\n","slug":"net-core-quartz","published":1,"updated":"2019-09-30T05:46:23.853Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m3l003n9sv7ljahxjfa","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>py</p>\n<p><strong></strong></p>\n<h3 id=\"Quartz\"><a href=\"#Quartz\" class=\"headerlink\" title=\"Quartz\"></a>Quartz</h3><p><strong>Hangfire</strong><strong>Quartz</strong></p>\n<p>Util</p>\n<p>Startup</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> IServiceProvider <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          ServiceInjection.ConfigureRepository(services);</span><br><span class=\"line\"></span><br><span class=\"line\">          services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">          services.TryAddSingleton&lt;ISchedulerFactory, StdSchedulerFactory&gt;();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>SchedulerFactory</strong><strong>Trigger</strong><strong>Job</strong>appappappjob</p>\n<p></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>ok<strong>MyJob</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">MyJob</span> : <span class=\"title\">IJob</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Task <span class=\"title\">Execute</span>(<span class=\"params\">IJobExecutionContext context</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Task.Run(() =&gt;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            LogUtil.Debug(<span class=\"string\">\"MyJob\"</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>QuartzUtil</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">QuartzUtil</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> ISchedulerFactory _schedulerFactory;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> IScheduler _scheduler;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"type\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"jobKey\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"trigger\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">async</span> Task <span class=\"title\">Add</span>(<span class=\"params\">Type type, JobKey jobKey, ITrigger trigger = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        Init();</span><br><span class=\"line\">        _scheduler = <span class=\"keyword\">await</span> _schedulerFactory.GetScheduler();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">await</span> _scheduler.Start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (trigger == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            trigger = TriggerBuilder.Create()</span><br><span class=\"line\">                .WithIdentity(<span class=\"string\">\"april.trigger\"</span>)</span><br><span class=\"line\">                .WithDescription(<span class=\"string\">\"default\"</span>)</span><br><span class=\"line\">                .WithSimpleSchedule(x=&gt;x.WithMisfireHandlingInstructionFireNow().WithRepeatCount(<span class=\"number\">-1</span>))</span><br><span class=\"line\">                .Build();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> job = JobBuilder.Create(type)</span><br><span class=\"line\">            .WithIdentity(jobKey)</span><br><span class=\"line\">            .Build();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">await</span> _scheduler.ScheduleJob(job, trigger);          </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"jobKey\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">async</span> Task <span class=\"title\">Resume</span>(<span class=\"params\">JobKey jobKey</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        Init();</span><br><span class=\"line\">        _scheduler = <span class=\"keyword\">await</span> _schedulerFactory.GetScheduler();</span><br><span class=\"line\">        LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;jobKey.Group&#125;</span>,<span class=\"subst\">&#123;jobKey.Name&#125;</span>\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">await</span> _scheduler.ResumeJob(jobKey);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"jobKey\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">async</span> Task <span class=\"title\">Stop</span>(<span class=\"params\">JobKey jobKey</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        Init();</span><br><span class=\"line\">        _scheduler = <span class=\"keyword\">await</span> _schedulerFactory.GetScheduler();</span><br><span class=\"line\">        LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;jobKey.Group&#125;</span>,<span class=\"subst\">&#123;jobKey.Name&#125;</span>\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">await</span> _scheduler.PauseJob(jobKey);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Init</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (_schedulerFactory == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            _schedulerFactory = AprilConfig.ServiceProvider.GetService&lt;ISchedulerFactory&gt;();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>//</p>\n<p><strong>Cron</strong></p>\n<p><strong>corn      </strong> 0 0 0 1 * ?<a href=\"http://www.bejson.com/othertools/cronvalidate/\" target=\"_blank\" rel=\"noopener\">Cron</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p></p>\n</blockquote>\n<p></p>\n<p><strong>Values</strong>5s</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\">[<span class=\"meta\">Route(<span class=\"meta-string\">\"QuartzTest\"</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">QuartzTest</span>(<span class=\"params\"><span class=\"keyword\">int</span> type</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    JobKey jobKey = <span class=\"keyword\">new</span> JobKey(<span class=\"string\">\"demo\"</span>,<span class=\"string\">\"group1\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">switch</span> (type)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">            <span class=\"keyword\">var</span> trigger = TriggerBuilder.Create()</span><br><span class=\"line\">                    .WithDescription(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">                    .WithIdentity(<span class=\"string\">\"test\"</span>)</span><br><span class=\"line\">                    <span class=\"comment\">//.WithSchedule(CronScheduleBuilder.CronSchedule(\"0 0/30 * * * ? *\").WithMisfireHandlingInstructionDoNothing())</span></span><br><span class=\"line\">                    .WithSimpleSchedule(x=&gt;x.WithIntervalInSeconds(<span class=\"number\">5</span>).RepeatForever().WithMisfireHandlingInstructionIgnoreMisfires())</span><br><span class=\"line\">                    .Build();</span><br><span class=\"line\">            QuartzUtil.Add(<span class=\"keyword\">typeof</span>(MyJob), jobKey, trigger);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">            QuartzUtil.Stop(jobKey);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">3</span>:</span><br><span class=\"line\">            QuartzUtil.Resume(jobKey);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>appsettings</p>\n<p><img src=\"/2019/09/26/net-core-quartz/1.png\" alt=\"\"><br>123<br><img src=\"/2019/09/26/net-core-quartz/2.png\" alt=\"\"></p>\n<ul>\n<li> ok</li>\n<li> ok</li>\n<li> ok</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Quartz<strong>WithMisfireHandlingInstructionIgnoreMisfires</strong></p>\n<p></p>\n<p><img src=\"/2019/09/26/net-core-quartz/3.png\" alt=\"\"><br><strong>CronTrigger</strong></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>withMisfireHandlingInstructionDoNothing</td>\n<td>; CronCron</td>\n</tr>\n<tr>\n<td>withMisfireHandlingInstructionIgnoreMisfires</td>\n<td> ; ; Cron</td>\n</tr>\n<tr>\n<td>withMisfireHandlingInstructionFireAndProceed</td>\n<td>; Cron</td>\n</tr>\n</tbody></table>\n<p><strong>SimpleTrigger</strong></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>withMisfireHandlingInstructionFireNow</td>\n<td>; FinalTIme;FinalTime; FinalTimestarttimeFinalTime</td>\n</tr>\n<tr>\n<td>withMisfireHandlingInstructionIgnoreMisfires</td>\n<td>; ;Interval; RepeatCount+1</td>\n</tr>\n<tr>\n<td>withMisfireHandlingInstructionNextWithExistingCount</td>\n<td>; FinalTime; startTimeFinalTime; pauseresumeFinalTime</td>\n</tr>\n<tr>\n<td>withMisfireHandlingInstructionNowWithExistingCount</td>\n<td>; FinalTIme; FinalTime; FinalTimestarttimeFinalTime</td>\n</tr>\n<tr>\n<td>withMisfireHandlingInstructionNextWithRemainingCount</td>\n<td>; FinalTime; startTimeFinalTime; pauseresumeFinalTime</td>\n</tr>\n<tr>\n<td>withMisfireHandlingInstructionNowWithRemainingCount</td>\n<td>; FinalTIme; FinalTime; FinalTimestarttimeFinalTime</td>\n</tr>\n</tbody></table>\n<p><a href=\"https://blog.csdn.net/yangshangwei/article/details/78539433\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/yangshangwei/article/details/78539433</a></p>\n<p>net frameworkIIS20windows</p>\n<p>net core</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>sqlsql/<strong>net core 3.0</strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>py</p>\n<p><strong></strong></p>\n<h3 id=\"Quartz\"><a href=\"#Quartz\" class=\"headerlink\" title=\"Quartz\"></a>Quartz</h3><p><strong>Hangfire</strong><strong>Quartz</strong></p>\n<p>Util</p>\n<p>Startup</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> IServiceProvider <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          ServiceInjection.ConfigureRepository(services);</span><br><span class=\"line\"></span><br><span class=\"line\">          services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">          services.TryAddSingleton&lt;ISchedulerFactory, StdSchedulerFactory&gt;();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>SchedulerFactory</strong><strong>Trigger</strong><strong>Job</strong>appappappjob</p>\n<p></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>ok<strong>MyJob</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">MyJob</span> : <span class=\"title\">IJob</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Task <span class=\"title\">Execute</span>(<span class=\"params\">IJobExecutionContext context</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Task.Run(() =&gt;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            LogUtil.Debug(<span class=\"string\">\"MyJob\"</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>QuartzUtil</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">QuartzUtil</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> ISchedulerFactory _schedulerFactory;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> IScheduler _scheduler;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"type\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"jobKey\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"trigger\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">async</span> Task <span class=\"title\">Add</span>(<span class=\"params\">Type type, JobKey jobKey, ITrigger trigger = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        Init();</span><br><span class=\"line\">        _scheduler = <span class=\"keyword\">await</span> _schedulerFactory.GetScheduler();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">await</span> _scheduler.Start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (trigger == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            trigger = TriggerBuilder.Create()</span><br><span class=\"line\">                .WithIdentity(<span class=\"string\">\"april.trigger\"</span>)</span><br><span class=\"line\">                .WithDescription(<span class=\"string\">\"default\"</span>)</span><br><span class=\"line\">                .WithSimpleSchedule(x=&gt;x.WithMisfireHandlingInstructionFireNow().WithRepeatCount(<span class=\"number\">-1</span>))</span><br><span class=\"line\">                .Build();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> job = JobBuilder.Create(type)</span><br><span class=\"line\">            .WithIdentity(jobKey)</span><br><span class=\"line\">            .Build();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">await</span> _scheduler.ScheduleJob(job, trigger);          </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"jobKey\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">async</span> Task <span class=\"title\">Resume</span>(<span class=\"params\">JobKey jobKey</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        Init();</span><br><span class=\"line\">        _scheduler = <span class=\"keyword\">await</span> _schedulerFactory.GetScheduler();</span><br><span class=\"line\">        LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;jobKey.Group&#125;</span>,<span class=\"subst\">&#123;jobKey.Name&#125;</span>\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">await</span> _scheduler.ResumeJob(jobKey);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"jobKey\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">async</span> Task <span class=\"title\">Stop</span>(<span class=\"params\">JobKey jobKey</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        Init();</span><br><span class=\"line\">        _scheduler = <span class=\"keyword\">await</span> _schedulerFactory.GetScheduler();</span><br><span class=\"line\">        LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;jobKey.Group&#125;</span>,<span class=\"subst\">&#123;jobKey.Name&#125;</span>\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">await</span> _scheduler.PauseJob(jobKey);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Init</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (_schedulerFactory == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            _schedulerFactory = AprilConfig.ServiceProvider.GetService&lt;ISchedulerFactory&gt;();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>//</p>\n<p><strong>Cron</strong></p>\n<p><strong>corn      </strong> 0 0 0 1 * ?<a href=\"http://www.bejson.com/othertools/cronvalidate/\" target=\"_blank\" rel=\"noopener\">Cron</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p></p>\n</blockquote>\n<p></p>\n<p><strong>Values</strong>5s</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\">[<span class=\"meta\">Route(<span class=\"meta-string\">\"QuartzTest\"</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">QuartzTest</span>(<span class=\"params\"><span class=\"keyword\">int</span> type</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    JobKey jobKey = <span class=\"keyword\">new</span> JobKey(<span class=\"string\">\"demo\"</span>,<span class=\"string\">\"group1\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">switch</span> (type)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">            <span class=\"keyword\">var</span> trigger = TriggerBuilder.Create()</span><br><span class=\"line\">                    .WithDescription(<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">                    .WithIdentity(<span class=\"string\">\"test\"</span>)</span><br><span class=\"line\">                    <span class=\"comment\">//.WithSchedule(CronScheduleBuilder.CronSchedule(\"0 0/30 * * * ? *\").WithMisfireHandlingInstructionDoNothing())</span></span><br><span class=\"line\">                    .WithSimpleSchedule(x=&gt;x.WithIntervalInSeconds(<span class=\"number\">5</span>).RepeatForever().WithMisfireHandlingInstructionIgnoreMisfires())</span><br><span class=\"line\">                    .Build();</span><br><span class=\"line\">            QuartzUtil.Add(<span class=\"keyword\">typeof</span>(MyJob), jobKey, trigger);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">            QuartzUtil.Stop(jobKey);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">3</span>:</span><br><span class=\"line\">            QuartzUtil.Resume(jobKey);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>appsettings</p>\n<p><img src=\"/2019/09/26/net-core-quartz/1.png\" alt=\"\"><br>123<br><img src=\"/2019/09/26/net-core-quartz/2.png\" alt=\"\"></p>\n<ul>\n<li> ok</li>\n<li> ok</li>\n<li> ok</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Quartz<strong>WithMisfireHandlingInstructionIgnoreMisfires</strong></p>\n<p></p>\n<p><img src=\"/2019/09/26/net-core-quartz/3.png\" alt=\"\"><br><strong>CronTrigger</strong></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>withMisfireHandlingInstructionDoNothing</td>\n<td>; CronCron</td>\n</tr>\n<tr>\n<td>withMisfireHandlingInstructionIgnoreMisfires</td>\n<td> ; ; Cron</td>\n</tr>\n<tr>\n<td>withMisfireHandlingInstructionFireAndProceed</td>\n<td>; Cron</td>\n</tr>\n</tbody></table>\n<p><strong>SimpleTrigger</strong></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>withMisfireHandlingInstructionFireNow</td>\n<td>; FinalTIme;FinalTime; FinalTimestarttimeFinalTime</td>\n</tr>\n<tr>\n<td>withMisfireHandlingInstructionIgnoreMisfires</td>\n<td>; ;Interval; RepeatCount+1</td>\n</tr>\n<tr>\n<td>withMisfireHandlingInstructionNextWithExistingCount</td>\n<td>; FinalTime; startTimeFinalTime; pauseresumeFinalTime</td>\n</tr>\n<tr>\n<td>withMisfireHandlingInstructionNowWithExistingCount</td>\n<td>; FinalTIme; FinalTime; FinalTimestarttimeFinalTime</td>\n</tr>\n<tr>\n<td>withMisfireHandlingInstructionNextWithRemainingCount</td>\n<td>; FinalTime; startTimeFinalTime; pauseresumeFinalTime</td>\n</tr>\n<tr>\n<td>withMisfireHandlingInstructionNowWithRemainingCount</td>\n<td>; FinalTIme; FinalTime; FinalTimestarttimeFinalTime</td>\n</tr>\n</tbody></table>\n<p><a href=\"https://blog.csdn.net/yangshangwei/article/details/78539433\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/yangshangwei/article/details/78539433</a></p>\n<p>net frameworkIIS20windows</p>\n<p>net core</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>sqlsql/<strong>net core 3.0</strong></p>\n"},{"title":"net core WebApi","date":"2019-09-02T08:37:06.000Z","_content":"\n\n### \n\n\n### \nOA16\n### \n\n![](net-core-qywx-application/1.png)\n****\n![](net-core-qywx-application/2.png)\n\n![](net-core-qywx-application/3.png)\nOK[API](https://work.weixin.qq.com/api/doc#90000/90003/90487)\n\n1. \n2. \n3. \n4. AppIDSecretaccesstoken\n5. accesstoken\n6. \n7. \n\n> \n\n**Util****QyThirdUtil**10\n```csharp\n\t\tprivate static string _CorpID = string.Empty;\n        private static string _Secret = string.Empty;\n        private static string _AgentID = string.Empty;\n        /// <summary>\n        /// id\n        /// </summary>\n        public static string CorpID\n        {\n            get\n            {\n                if (string.IsNullOrEmpty(_CorpID))\n                {\n                    _CorpID = AprilConfig.Configuration[\"QyThird:CorpID\"];\n                }\n                return _CorpID;\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        public static string Secret\n        {\n            get\n            {\n                if (string.IsNullOrEmpty(_Secret))\n                {\n                    _Secret = AprilConfig.Configuration[\"QyThird:Secret\"];\n                }\n                return _Secret;\n            }\n        }\n        /// <summary>\n        /// id\n        /// </summary>\n        public static string AgentID\n        {\n            get\n            {\n                if (string.IsNullOrEmpty(_Secret))\n                {\n                    _AgentID = AprilConfig.Configuration[\"QyThird:AgentID\"];\n                }\n                return _AgentID;\n            }\n        }\n```\naccesstoken\n```csharp\n\t\t/// <summary>\n        /// AccessToken\n        /// </summary>\n        /// <returns></returns>\n        public static string GetAccessToken()\n        {\n            QyAccessToken accessToken = null;\n            bool isGet = false;\n            if (CacheUtil.Exists(\"QyAccessToken\"))\n            {\n                accessToken = CacheUtil.Get<QyAccessToken>(\"QyAccessToken\");\n                if (accessToken.Expire_Time >= DateTime.Now.AddMinutes(1))\n                {\n                    isGet = true;\n                }\n            }\n            if (!isGet)\n            {\n                string url = $\"https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid={CorpID}&corpsecret={Secret}\";\n                //\n                string res = RequestUtil.HttpGet(url);\n                accessToken = JsonConvert.DeserializeObject<QyAccessToken>(res);\n                if (accessToken != null && accessToken.ErrCode == 0)\n                {\n                    accessToken.Expire_Time = DateTime.Now.AddSeconds(accessToken.Expires_In);\n                    CacheUtil.Set(\"QyAccessToken\", accessToken, new TimeSpan(2, 0, 0));\n                }\n                else\n                {\n                    LogUtil.Error($\"accesstoken{accessToken.ErrCode},{accessToken.ErrMsg}\");\n                }\n            }\n\n            return accessToken.Access_Token;\n        }\n```\n**QyAccessToken**cv\n\nHttpClient**RequestUtil**HttpClient\n```csharp\n\tpublic class RequestUtil\n    {\n\n        /// <summary>\n        /// POST\n        /// </summary>\n        /// <param name=\"url\"></param>\n        /// <param name=\"postData\"></param>\n        /// <param name=\"contentType\"></param>  \n        /// <param name=\"timeOut\"></param>  \n        /// <returns></returns>\n        public static string HttpPost(string url, string postData = null, string contentType = null, int timeOut = 30)\n        {\n            if (string.IsNullOrEmpty(postData))\n            {\n                postData = \"\";\n            }\n            using (HttpClient client = new HttpClient())\n            {\n                client.Timeout = new TimeSpan(0, 0, timeOut);\n                using (HttpContent httpContent = new StringContent(postData, Encoding.UTF8))\n                {\n                    if (contentType != null)\n                        httpContent.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue(contentType);\n\n                    HttpResponseMessage response = client.PostAsync(url, httpContent).Result;\n                    return response.Content.ReadAsStringAsync().Result;\n                }\n            }\n        }\n\n\n        /// <summary>\n        /// POST\n        /// </summary>\n        /// <param name=\"url\"></param>\n        /// <param name=\"postData\"></param>\n        /// <param name=\"contentType\"></param>\n        /// <param name=\"timeOut\"></param>      \n        /// <returns></returns>\n        public static async Task<string> HttpPostAsync(string url, string postData = null, string contentType = null, int timeOut = 30)\n        {\n            if (string.IsNullOrEmpty(postData))\n            {\n                postData = \"\";\n            }\n            using (HttpClient client = new HttpClient())\n            {\n                client.Timeout = new TimeSpan(0, 0, timeOut);\n                using (HttpContent httpContent = new StringContent(postData, Encoding.UTF8))\n                {\n                    if (contentType != null)\n                        httpContent.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue(contentType);\n\n                    HttpResponseMessage response = await client.PostAsync(url, httpContent);\n                    return await response.Content.ReadAsStringAsync();\n                }\n            }\n        }\n\n        /// <summary>\n        /// GET\n        /// </summary>\n        /// <param name=\"url\"></param>\n        /// <returns></returns>\n        public static string HttpGet(string url)\n        {\n            using (HttpClient client = new HttpClient())\n            {\n                return client.GetStringAsync(url).Result;\n            }\n        }\n\n        /// <summary>\n        /// GET\n        /// </summary>\n        /// <param name=\"url\"></param>\n        /// <returns></returns>\n        public static async Task<string> HttpGetAsync(string url)\n        {\n            using (HttpClient client = new HttpClient())\n            {\n                HttpResponseMessage response = await client.GetAsync(url);\n                return await response.Content.ReadAsStringAsync();\n            }\n        }\n    }\n```\n\n**SendMessage**\n```csharp\n\t\t/// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"content\"></param>\n        /// <param name=\"range\"></param>\n        /// <param name=\"messageType\"></param>\n        /// <returns></returns>\n        public static bool SendMessage(string content, MessageRange range, AprilEnums.MessageType messageType)\n        {\n            bool isSend = false;\n            if (string.IsNullOrEmpty(content) || content.Length > 2048 || range==null)\n            {\n                return false;\n            }\n            string accessToken = GetAccessToken();\n            if (string.IsNullOrEmpty(accessToken))\n            {\n                return false;\n            }\n            string url = $\"https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token={accessToken}\";\n            StringBuilder data = new StringBuilder();\n            bool isVaildRange = false;\n            if (range.IsAll)\n            {\n                data.Append($\"\\\"touser\\\":\\\"@all\\\"\");\n                isVaildRange = true;\n            }\n            else\n            {\n                if (range.Users != null && range.Users.Count > 0)\n                {\n                    data.AppendFormat(\"\\\"touser\\\" : {0}\", GetRangeValue(range.Users));\n                    isVaildRange = true;\n                }\n\n                if (range.Tags != null && range.Tags.Count > 0)\n                {\n                    if (data.Length > 0)\n                    {\n                        data.Append(\",\");\n                    }\n                    data.AppendFormat(\"\\\"totag\\\" : {0}\", GetRangeValue(range.Tags));\n                    isVaildRange = true;\n                }\n\n                if (range.Departments != null && range.Departments.Count > 0)\n                {\n                    if (data.Length > 0)\n                    {\n                        data.Append(\",\");\n                    }\n                    data.AppendFormat(\"\\\"totag\\\" : {0}\", GetRangeValue(range.Departments));\n                    isVaildRange = true;\n                }\n            }\n            if (!isVaildRange)\n            {\n                //\n                return false;\n            }\n            data.AppendFormat(\",\\\"msgtype\\\":\\\"{0}\\\"\", GetMessageType(messageType));\n            data.AppendFormat(\",\\\"agentid\\\":\\\"{0}\\\"\", AgentID);\n            data.Append(\",\\\"text\\\": {\");\n            data.AppendFormat(\"\\\"content\\\":\\\"{0}\\\"\", content);\n            data.Insert(0, \"{\");\n            data.Append(\"}}\");\n            LogUtil.Debug($\"{data.ToString()}\");\n            string res = RequestUtil.HttpPost(url, data.ToString(), \"application/json\");\n            LogUtil.Debug($\"{res}\");\n\n            return false;\n        }\n```\nAPI\n\n### \n**Values**\n```csharp\n        [HttpGet]\n        public ActionResult<IEnumerable<string>> Get()\n        {\n        \t//\n            MessageRange range = new MessageRange();\n            range.Users = new List<string>();\n            range.Users.Add(\"10001\");\n            QyThridUtil.SendMessage(\"\", range, AprilEnums.MessageType.Text);\n            //\n        }\n```\n\n![](net-core-qywx-application/4.png)\n\n![](net-core-qywx-application/5.png)\n### \n","source":"_posts/net-core-qywx-application.md","raw":"---\ntitle: net core WebApi\ndate: 2019-09-02 16:37:06\ntags: net core\ncategories: AprilBlank\n---\n\n\n### \n\n\n### \nOA16\n### \n\n![](net-core-qywx-application/1.png)\n****\n![](net-core-qywx-application/2.png)\n\n![](net-core-qywx-application/3.png)\nOK[API](https://work.weixin.qq.com/api/doc#90000/90003/90487)\n\n1. \n2. \n3. \n4. AppIDSecretaccesstoken\n5. accesstoken\n6. \n7. \n\n> \n\n**Util****QyThirdUtil**10\n```csharp\n\t\tprivate static string _CorpID = string.Empty;\n        private static string _Secret = string.Empty;\n        private static string _AgentID = string.Empty;\n        /// <summary>\n        /// id\n        /// </summary>\n        public static string CorpID\n        {\n            get\n            {\n                if (string.IsNullOrEmpty(_CorpID))\n                {\n                    _CorpID = AprilConfig.Configuration[\"QyThird:CorpID\"];\n                }\n                return _CorpID;\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        public static string Secret\n        {\n            get\n            {\n                if (string.IsNullOrEmpty(_Secret))\n                {\n                    _Secret = AprilConfig.Configuration[\"QyThird:Secret\"];\n                }\n                return _Secret;\n            }\n        }\n        /// <summary>\n        /// id\n        /// </summary>\n        public static string AgentID\n        {\n            get\n            {\n                if (string.IsNullOrEmpty(_Secret))\n                {\n                    _AgentID = AprilConfig.Configuration[\"QyThird:AgentID\"];\n                }\n                return _AgentID;\n            }\n        }\n```\naccesstoken\n```csharp\n\t\t/// <summary>\n        /// AccessToken\n        /// </summary>\n        /// <returns></returns>\n        public static string GetAccessToken()\n        {\n            QyAccessToken accessToken = null;\n            bool isGet = false;\n            if (CacheUtil.Exists(\"QyAccessToken\"))\n            {\n                accessToken = CacheUtil.Get<QyAccessToken>(\"QyAccessToken\");\n                if (accessToken.Expire_Time >= DateTime.Now.AddMinutes(1))\n                {\n                    isGet = true;\n                }\n            }\n            if (!isGet)\n            {\n                string url = $\"https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid={CorpID}&corpsecret={Secret}\";\n                //\n                string res = RequestUtil.HttpGet(url);\n                accessToken = JsonConvert.DeserializeObject<QyAccessToken>(res);\n                if (accessToken != null && accessToken.ErrCode == 0)\n                {\n                    accessToken.Expire_Time = DateTime.Now.AddSeconds(accessToken.Expires_In);\n                    CacheUtil.Set(\"QyAccessToken\", accessToken, new TimeSpan(2, 0, 0));\n                }\n                else\n                {\n                    LogUtil.Error($\"accesstoken{accessToken.ErrCode},{accessToken.ErrMsg}\");\n                }\n            }\n\n            return accessToken.Access_Token;\n        }\n```\n**QyAccessToken**cv\n\nHttpClient**RequestUtil**HttpClient\n```csharp\n\tpublic class RequestUtil\n    {\n\n        /// <summary>\n        /// POST\n        /// </summary>\n        /// <param name=\"url\"></param>\n        /// <param name=\"postData\"></param>\n        /// <param name=\"contentType\"></param>  \n        /// <param name=\"timeOut\"></param>  \n        /// <returns></returns>\n        public static string HttpPost(string url, string postData = null, string contentType = null, int timeOut = 30)\n        {\n            if (string.IsNullOrEmpty(postData))\n            {\n                postData = \"\";\n            }\n            using (HttpClient client = new HttpClient())\n            {\n                client.Timeout = new TimeSpan(0, 0, timeOut);\n                using (HttpContent httpContent = new StringContent(postData, Encoding.UTF8))\n                {\n                    if (contentType != null)\n                        httpContent.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue(contentType);\n\n                    HttpResponseMessage response = client.PostAsync(url, httpContent).Result;\n                    return response.Content.ReadAsStringAsync().Result;\n                }\n            }\n        }\n\n\n        /// <summary>\n        /// POST\n        /// </summary>\n        /// <param name=\"url\"></param>\n        /// <param name=\"postData\"></param>\n        /// <param name=\"contentType\"></param>\n        /// <param name=\"timeOut\"></param>      \n        /// <returns></returns>\n        public static async Task<string> HttpPostAsync(string url, string postData = null, string contentType = null, int timeOut = 30)\n        {\n            if (string.IsNullOrEmpty(postData))\n            {\n                postData = \"\";\n            }\n            using (HttpClient client = new HttpClient())\n            {\n                client.Timeout = new TimeSpan(0, 0, timeOut);\n                using (HttpContent httpContent = new StringContent(postData, Encoding.UTF8))\n                {\n                    if (contentType != null)\n                        httpContent.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue(contentType);\n\n                    HttpResponseMessage response = await client.PostAsync(url, httpContent);\n                    return await response.Content.ReadAsStringAsync();\n                }\n            }\n        }\n\n        /// <summary>\n        /// GET\n        /// </summary>\n        /// <param name=\"url\"></param>\n        /// <returns></returns>\n        public static string HttpGet(string url)\n        {\n            using (HttpClient client = new HttpClient())\n            {\n                return client.GetStringAsync(url).Result;\n            }\n        }\n\n        /// <summary>\n        /// GET\n        /// </summary>\n        /// <param name=\"url\"></param>\n        /// <returns></returns>\n        public static async Task<string> HttpGetAsync(string url)\n        {\n            using (HttpClient client = new HttpClient())\n            {\n                HttpResponseMessage response = await client.GetAsync(url);\n                return await response.Content.ReadAsStringAsync();\n            }\n        }\n    }\n```\n\n**SendMessage**\n```csharp\n\t\t/// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"content\"></param>\n        /// <param name=\"range\"></param>\n        /// <param name=\"messageType\"></param>\n        /// <returns></returns>\n        public static bool SendMessage(string content, MessageRange range, AprilEnums.MessageType messageType)\n        {\n            bool isSend = false;\n            if (string.IsNullOrEmpty(content) || content.Length > 2048 || range==null)\n            {\n                return false;\n            }\n            string accessToken = GetAccessToken();\n            if (string.IsNullOrEmpty(accessToken))\n            {\n                return false;\n            }\n            string url = $\"https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token={accessToken}\";\n            StringBuilder data = new StringBuilder();\n            bool isVaildRange = false;\n            if (range.IsAll)\n            {\n                data.Append($\"\\\"touser\\\":\\\"@all\\\"\");\n                isVaildRange = true;\n            }\n            else\n            {\n                if (range.Users != null && range.Users.Count > 0)\n                {\n                    data.AppendFormat(\"\\\"touser\\\" : {0}\", GetRangeValue(range.Users));\n                    isVaildRange = true;\n                }\n\n                if (range.Tags != null && range.Tags.Count > 0)\n                {\n                    if (data.Length > 0)\n                    {\n                        data.Append(\",\");\n                    }\n                    data.AppendFormat(\"\\\"totag\\\" : {0}\", GetRangeValue(range.Tags));\n                    isVaildRange = true;\n                }\n\n                if (range.Departments != null && range.Departments.Count > 0)\n                {\n                    if (data.Length > 0)\n                    {\n                        data.Append(\",\");\n                    }\n                    data.AppendFormat(\"\\\"totag\\\" : {0}\", GetRangeValue(range.Departments));\n                    isVaildRange = true;\n                }\n            }\n            if (!isVaildRange)\n            {\n                //\n                return false;\n            }\n            data.AppendFormat(\",\\\"msgtype\\\":\\\"{0}\\\"\", GetMessageType(messageType));\n            data.AppendFormat(\",\\\"agentid\\\":\\\"{0}\\\"\", AgentID);\n            data.Append(\",\\\"text\\\": {\");\n            data.AppendFormat(\"\\\"content\\\":\\\"{0}\\\"\", content);\n            data.Insert(0, \"{\");\n            data.Append(\"}}\");\n            LogUtil.Debug($\"{data.ToString()}\");\n            string res = RequestUtil.HttpPost(url, data.ToString(), \"application/json\");\n            LogUtil.Debug($\"{res}\");\n\n            return false;\n        }\n```\nAPI\n\n### \n**Values**\n```csharp\n        [HttpGet]\n        public ActionResult<IEnumerable<string>> Get()\n        {\n        \t//\n            MessageRange range = new MessageRange();\n            range.Users = new List<string>();\n            range.Users.Add(\"10001\");\n            QyThridUtil.SendMessage(\"\", range, AprilEnums.MessageType.Text);\n            //\n        }\n```\n\n![](net-core-qywx-application/4.png)\n\n![](net-core-qywx-application/5.png)\n### \n","slug":"net-core-qywx-application","published":1,"updated":"2019-09-30T05:46:26.760Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m3p003q9sv7ojwxduwe","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>OA16</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br><img src=\"/2019/09/02/net-core-qywx-application/1.png\" alt=\"\"><br><strong></strong><br><img src=\"/2019/09/02/net-core-qywx-application/2.png\" alt=\"\"><br><br><img src=\"/2019/09/02/net-core-qywx-application/3.png\" alt=\"\"><br>OK<a href=\"https://work.weixin.qq.com/api/doc#90000/90003/90487\" target=\"_blank\" rel=\"noopener\">API</a><br></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li>AppIDSecretaccesstoken</li>\n<li>accesstoken</li>\n<li></li>\n<li></li>\n</ol>\n<blockquote>\n<p></p>\n</blockquote>\n<p><strong>Util</strong><strong>QyThirdUtil</strong>10</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> _CorpID = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">      <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> _Secret = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">      <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> _AgentID = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> id</span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> CorpID</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">get</span></span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(_CorpID))</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  _CorpID = AprilConfig.Configuration[<span class=\"string\">\"QyThird:CorpID\"</span>];</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> _CorpID;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> Secret</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">get</span></span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(_Secret))</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  _Secret = AprilConfig.Configuration[<span class=\"string\">\"QyThird:Secret\"</span>];</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> _Secret;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> id</span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> AgentID</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">get</span></span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(_Secret))</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  _AgentID = AprilConfig.Configuration[<span class=\"string\">\"QyThird:AgentID\"</span>];</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> _AgentID;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<p>accesstoken</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> AccessToken</span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> <span class=\"title\">GetAccessToken</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          QyAccessToken accessToken = <span class=\"literal\">null</span>;</span><br><span class=\"line\">          <span class=\"keyword\">bool</span> isGet = <span class=\"literal\">false</span>;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (CacheUtil.Exists(<span class=\"string\">\"QyAccessToken\"</span>))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              accessToken = CacheUtil.Get&lt;QyAccessToken&gt;(<span class=\"string\">\"QyAccessToken\"</span>);</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (accessToken.Expire_Time &gt;= DateTime.Now.AddMinutes(<span class=\"number\">1</span>))</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  isGet = <span class=\"literal\">true</span>;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (!isGet)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">string</span> url = <span class=\"string\">$\"https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=<span class=\"subst\">&#123;CorpID&#125;</span>&amp;corpsecret=<span class=\"subst\">&#123;Secret&#125;</span>\"</span>;</span><br><span class=\"line\">              <span class=\"comment\">//</span></span><br><span class=\"line\">              <span class=\"keyword\">string</span> res = RequestUtil.HttpGet(url);</span><br><span class=\"line\">              accessToken = JsonConvert.DeserializeObject&lt;QyAccessToken&gt;(res);</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (accessToken != <span class=\"literal\">null</span> &amp;&amp; accessToken.ErrCode == <span class=\"number\">0</span>)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  accessToken.Expire_Time = DateTime.Now.AddSeconds(accessToken.Expires_In);</span><br><span class=\"line\">                  CacheUtil.Set(<span class=\"string\">\"QyAccessToken\"</span>, accessToken, <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">2</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>));</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">else</span></span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  LogUtil.Error(<span class=\"string\">$\"accesstoken<span class=\"subst\">&#123;accessToken.ErrCode&#125;</span>,<span class=\"subst\">&#123;accessToken.ErrMsg&#125;</span>\"</span>);</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"keyword\">return</span> accessToken.Access_Token;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>QyAccessToken</strong>cv</p>\n<p>HttpClient<strong>RequestUtil</strong>HttpClient</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">RequestUtil</span></span><br><span class=\"line\">   &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> POST</span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"url\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"postData\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"contentType\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span>  </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"timeOut\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span>  </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> <span class=\"title\">HttpPost</span>(<span class=\"params\"><span class=\"keyword\">string</span> url, <span class=\"keyword\">string</span> postData = <span class=\"literal\">null</span>, <span class=\"keyword\">string</span> contentType = <span class=\"literal\">null</span>, <span class=\"keyword\">int</span> timeOut = <span class=\"number\">30</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(postData))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               postData = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"keyword\">using</span> (HttpClient client = <span class=\"keyword\">new</span> HttpClient())</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               client.Timeout = <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">0</span>, <span class=\"number\">0</span>, timeOut);</span><br><span class=\"line\">               <span class=\"keyword\">using</span> (HttpContent httpContent = <span class=\"keyword\">new</span> StringContent(postData, Encoding.UTF8))</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   <span class=\"keyword\">if</span> (contentType != <span class=\"literal\">null</span>)</span><br><span class=\"line\">                       httpContent.Headers.ContentType = <span class=\"keyword\">new</span> System.Net.Http.Headers.MediaTypeHeaderValue(contentType);</span><br><span class=\"line\"></span><br><span class=\"line\">                   HttpResponseMessage response = client.PostAsync(url, httpContent).Result;</span><br><span class=\"line\">                   <span class=\"keyword\">return</span> response.Content.ReadAsStringAsync().Result;</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> POST</span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"url\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"postData\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"contentType\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"timeOut\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span>      </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">async</span> Task&lt;<span class=\"keyword\">string</span>&gt; <span class=\"title\">HttpPostAsync</span>(<span class=\"params\"><span class=\"keyword\">string</span> url, <span class=\"keyword\">string</span> postData = <span class=\"literal\">null</span>, <span class=\"keyword\">string</span> contentType = <span class=\"literal\">null</span>, <span class=\"keyword\">int</span> timeOut = <span class=\"number\">30</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(postData))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               postData = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"keyword\">using</span> (HttpClient client = <span class=\"keyword\">new</span> HttpClient())</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               client.Timeout = <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">0</span>, <span class=\"number\">0</span>, timeOut);</span><br><span class=\"line\">               <span class=\"keyword\">using</span> (HttpContent httpContent = <span class=\"keyword\">new</span> StringContent(postData, Encoding.UTF8))</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   <span class=\"keyword\">if</span> (contentType != <span class=\"literal\">null</span>)</span><br><span class=\"line\">                       httpContent.Headers.ContentType = <span class=\"keyword\">new</span> System.Net.Http.Headers.MediaTypeHeaderValue(contentType);</span><br><span class=\"line\"></span><br><span class=\"line\">                   HttpResponseMessage response = <span class=\"keyword\">await</span> client.PostAsync(url, httpContent);</span><br><span class=\"line\">                   <span class=\"keyword\">return</span> <span class=\"keyword\">await</span> response.Content.ReadAsStringAsync();</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> GET</span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"url\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> <span class=\"title\">HttpGet</span>(<span class=\"params\"><span class=\"keyword\">string</span> url</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">using</span> (HttpClient client = <span class=\"keyword\">new</span> HttpClient())</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"keyword\">return</span> client.GetStringAsync(url).Result;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> GET</span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"url\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">async</span> Task&lt;<span class=\"keyword\">string</span>&gt; <span class=\"title\">HttpGetAsync</span>(<span class=\"params\"><span class=\"keyword\">string</span> url</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">using</span> (HttpClient client = <span class=\"keyword\">new</span> HttpClient())</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               HttpResponseMessage response = <span class=\"keyword\">await</span> client.GetAsync(url);</span><br><span class=\"line\">               <span class=\"keyword\">return</span> <span class=\"keyword\">await</span> response.Content.ReadAsStringAsync();</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>SendMessage</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"content\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"range\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"messageType\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">bool</span> <span class=\"title\">SendMessage</span>(<span class=\"params\"><span class=\"keyword\">string</span> content, MessageRange range, AprilEnums.MessageType messageType</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">bool</span> isSend = <span class=\"literal\">false</span>;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(content) || content.Length &gt; <span class=\"number\">2048</span> || range==<span class=\"literal\">null</span>)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">string</span> accessToken = GetAccessToken();</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(accessToken))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">string</span> url = <span class=\"string\">$\"https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=<span class=\"subst\">&#123;accessToken&#125;</span>\"</span>;</span><br><span class=\"line\">          StringBuilder data = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">          <span class=\"keyword\">bool</span> isVaildRange = <span class=\"literal\">false</span>;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (range.IsAll)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              data.Append(<span class=\"string\">$\"\\\"touser\\\":\\\"@all\\\"\"</span>);</span><br><span class=\"line\">              isVaildRange = <span class=\"literal\">true</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">else</span></span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (range.Users != <span class=\"literal\">null</span> &amp;&amp; range.Users.Count &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  data.AppendFormat(<span class=\"string\">\"\\\"touser\\\" : &#123;0&#125;\"</span>, GetRangeValue(range.Users));</span><br><span class=\"line\">                  isVaildRange = <span class=\"literal\">true</span>;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">              <span class=\"keyword\">if</span> (range.Tags != <span class=\"literal\">null</span> &amp;&amp; range.Tags.Count &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  <span class=\"keyword\">if</span> (data.Length &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">                  &#123;</span><br><span class=\"line\">                      data.Append(<span class=\"string\">\",\"</span>);</span><br><span class=\"line\">                  &#125;</span><br><span class=\"line\">                  data.AppendFormat(<span class=\"string\">\"\\\"totag\\\" : &#123;0&#125;\"</span>, GetRangeValue(range.Tags));</span><br><span class=\"line\">                  isVaildRange = <span class=\"literal\">true</span>;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">              <span class=\"keyword\">if</span> (range.Departments != <span class=\"literal\">null</span> &amp;&amp; range.Departments.Count &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  <span class=\"keyword\">if</span> (data.Length &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">                  &#123;</span><br><span class=\"line\">                      data.Append(<span class=\"string\">\",\"</span>);</span><br><span class=\"line\">                  &#125;</span><br><span class=\"line\">                  data.AppendFormat(<span class=\"string\">\"\\\"totag\\\" : &#123;0&#125;\"</span>, GetRangeValue(range.Departments));</span><br><span class=\"line\">                  isVaildRange = <span class=\"literal\">true</span>;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (!isVaildRange)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"comment\">//</span></span><br><span class=\"line\">              <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          data.AppendFormat(<span class=\"string\">\",\\\"msgtype\\\":\\\"&#123;0&#125;\\\"\"</span>, GetMessageType(messageType));</span><br><span class=\"line\">          data.AppendFormat(<span class=\"string\">\",\\\"agentid\\\":\\\"&#123;0&#125;\\\"\"</span>, AgentID);</span><br><span class=\"line\">          data.Append(<span class=\"string\">\",\\\"text\\\": &#123;\"</span>);</span><br><span class=\"line\">          data.AppendFormat(<span class=\"string\">\"\\\"content\\\":\\\"&#123;0&#125;\\\"\"</span>, content);</span><br><span class=\"line\">          data.Insert(<span class=\"number\">0</span>, <span class=\"string\">\"&#123;\"</span>);</span><br><span class=\"line\">          data.Append(<span class=\"string\">\"&#125;&#125;\"</span>);</span><br><span class=\"line\">          LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;data.ToString()&#125;</span>\"</span>);</span><br><span class=\"line\">          <span class=\"keyword\">string</span> res = RequestUtil.HttpPost(url, data.ToString(), <span class=\"string\">\"application/json\"</span>);</span><br><span class=\"line\">          LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;res&#125;</span>\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<p>API</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>Values</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\"><span class=\"keyword\">public</span> ActionResult&lt;IEnumerable&lt;<span class=\"keyword\">string</span>&gt;&gt; Get()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">    MessageRange range = <span class=\"keyword\">new</span> MessageRange();</span><br><span class=\"line\">    range.Users = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">    range.Users.Add(<span class=\"string\">\"10001\"</span>);</span><br><span class=\"line\">    QyThridUtil.SendMessage(<span class=\"string\">\"\"</span>, range, AprilEnums.MessageType.Text);</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/09/02/net-core-qywx-application/4.png\" alt=\"\"></p>\n<p><img src=\"/2019/09/02/net-core-qywx-application/5.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>OA16</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br><img src=\"/2019/09/02/net-core-qywx-application/1.png\" alt=\"\"><br><strong></strong><br><img src=\"/2019/09/02/net-core-qywx-application/2.png\" alt=\"\"><br><br><img src=\"/2019/09/02/net-core-qywx-application/3.png\" alt=\"\"><br>OK<a href=\"https://work.weixin.qq.com/api/doc#90000/90003/90487\" target=\"_blank\" rel=\"noopener\">API</a><br></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li>AppIDSecretaccesstoken</li>\n<li>accesstoken</li>\n<li></li>\n<li></li>\n</ol>\n<blockquote>\n<p></p>\n</blockquote>\n<p><strong>Util</strong><strong>QyThirdUtil</strong>10</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> _CorpID = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">      <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> _Secret = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">      <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> _AgentID = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> id</span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> CorpID</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">get</span></span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(_CorpID))</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  _CorpID = AprilConfig.Configuration[<span class=\"string\">\"QyThird:CorpID\"</span>];</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> _CorpID;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> Secret</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">get</span></span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(_Secret))</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  _Secret = AprilConfig.Configuration[<span class=\"string\">\"QyThird:Secret\"</span>];</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> _Secret;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> id</span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> AgentID</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">get</span></span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(_Secret))</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  _AgentID = AprilConfig.Configuration[<span class=\"string\">\"QyThird:AgentID\"</span>];</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> _AgentID;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<p>accesstoken</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> AccessToken</span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> <span class=\"title\">GetAccessToken</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          QyAccessToken accessToken = <span class=\"literal\">null</span>;</span><br><span class=\"line\">          <span class=\"keyword\">bool</span> isGet = <span class=\"literal\">false</span>;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (CacheUtil.Exists(<span class=\"string\">\"QyAccessToken\"</span>))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              accessToken = CacheUtil.Get&lt;QyAccessToken&gt;(<span class=\"string\">\"QyAccessToken\"</span>);</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (accessToken.Expire_Time &gt;= DateTime.Now.AddMinutes(<span class=\"number\">1</span>))</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  isGet = <span class=\"literal\">true</span>;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (!isGet)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">string</span> url = <span class=\"string\">$\"https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=<span class=\"subst\">&#123;CorpID&#125;</span>&amp;corpsecret=<span class=\"subst\">&#123;Secret&#125;</span>\"</span>;</span><br><span class=\"line\">              <span class=\"comment\">//</span></span><br><span class=\"line\">              <span class=\"keyword\">string</span> res = RequestUtil.HttpGet(url);</span><br><span class=\"line\">              accessToken = JsonConvert.DeserializeObject&lt;QyAccessToken&gt;(res);</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (accessToken != <span class=\"literal\">null</span> &amp;&amp; accessToken.ErrCode == <span class=\"number\">0</span>)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  accessToken.Expire_Time = DateTime.Now.AddSeconds(accessToken.Expires_In);</span><br><span class=\"line\">                  CacheUtil.Set(<span class=\"string\">\"QyAccessToken\"</span>, accessToken, <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">2</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>));</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">else</span></span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  LogUtil.Error(<span class=\"string\">$\"accesstoken<span class=\"subst\">&#123;accessToken.ErrCode&#125;</span>,<span class=\"subst\">&#123;accessToken.ErrMsg&#125;</span>\"</span>);</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"keyword\">return</span> accessToken.Access_Token;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>QyAccessToken</strong>cv</p>\n<p>HttpClient<strong>RequestUtil</strong>HttpClient</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">RequestUtil</span></span><br><span class=\"line\">   &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> POST</span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"url\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"postData\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"contentType\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span>  </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"timeOut\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span>  </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> <span class=\"title\">HttpPost</span>(<span class=\"params\"><span class=\"keyword\">string</span> url, <span class=\"keyword\">string</span> postData = <span class=\"literal\">null</span>, <span class=\"keyword\">string</span> contentType = <span class=\"literal\">null</span>, <span class=\"keyword\">int</span> timeOut = <span class=\"number\">30</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(postData))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               postData = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"keyword\">using</span> (HttpClient client = <span class=\"keyword\">new</span> HttpClient())</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               client.Timeout = <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">0</span>, <span class=\"number\">0</span>, timeOut);</span><br><span class=\"line\">               <span class=\"keyword\">using</span> (HttpContent httpContent = <span class=\"keyword\">new</span> StringContent(postData, Encoding.UTF8))</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   <span class=\"keyword\">if</span> (contentType != <span class=\"literal\">null</span>)</span><br><span class=\"line\">                       httpContent.Headers.ContentType = <span class=\"keyword\">new</span> System.Net.Http.Headers.MediaTypeHeaderValue(contentType);</span><br><span class=\"line\"></span><br><span class=\"line\">                   HttpResponseMessage response = client.PostAsync(url, httpContent).Result;</span><br><span class=\"line\">                   <span class=\"keyword\">return</span> response.Content.ReadAsStringAsync().Result;</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> POST</span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"url\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"postData\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"contentType\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"timeOut\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span>      </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">async</span> Task&lt;<span class=\"keyword\">string</span>&gt; <span class=\"title\">HttpPostAsync</span>(<span class=\"params\"><span class=\"keyword\">string</span> url, <span class=\"keyword\">string</span> postData = <span class=\"literal\">null</span>, <span class=\"keyword\">string</span> contentType = <span class=\"literal\">null</span>, <span class=\"keyword\">int</span> timeOut = <span class=\"number\">30</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(postData))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               postData = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"keyword\">using</span> (HttpClient client = <span class=\"keyword\">new</span> HttpClient())</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               client.Timeout = <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">0</span>, <span class=\"number\">0</span>, timeOut);</span><br><span class=\"line\">               <span class=\"keyword\">using</span> (HttpContent httpContent = <span class=\"keyword\">new</span> StringContent(postData, Encoding.UTF8))</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   <span class=\"keyword\">if</span> (contentType != <span class=\"literal\">null</span>)</span><br><span class=\"line\">                       httpContent.Headers.ContentType = <span class=\"keyword\">new</span> System.Net.Http.Headers.MediaTypeHeaderValue(contentType);</span><br><span class=\"line\"></span><br><span class=\"line\">                   HttpResponseMessage response = <span class=\"keyword\">await</span> client.PostAsync(url, httpContent);</span><br><span class=\"line\">                   <span class=\"keyword\">return</span> <span class=\"keyword\">await</span> response.Content.ReadAsStringAsync();</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> GET</span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"url\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> <span class=\"title\">HttpGet</span>(<span class=\"params\"><span class=\"keyword\">string</span> url</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">using</span> (HttpClient client = <span class=\"keyword\">new</span> HttpClient())</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"keyword\">return</span> client.GetStringAsync(url).Result;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> GET</span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"url\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">async</span> Task&lt;<span class=\"keyword\">string</span>&gt; <span class=\"title\">HttpGetAsync</span>(<span class=\"params\"><span class=\"keyword\">string</span> url</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">using</span> (HttpClient client = <span class=\"keyword\">new</span> HttpClient())</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               HttpResponseMessage response = <span class=\"keyword\">await</span> client.GetAsync(url);</span><br><span class=\"line\">               <span class=\"keyword\">return</span> <span class=\"keyword\">await</span> response.Content.ReadAsStringAsync();</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>SendMessage</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"content\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"range\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"messageType\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">bool</span> <span class=\"title\">SendMessage</span>(<span class=\"params\"><span class=\"keyword\">string</span> content, MessageRange range, AprilEnums.MessageType messageType</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">bool</span> isSend = <span class=\"literal\">false</span>;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(content) || content.Length &gt; <span class=\"number\">2048</span> || range==<span class=\"literal\">null</span>)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">string</span> accessToken = GetAccessToken();</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(accessToken))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">string</span> url = <span class=\"string\">$\"https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=<span class=\"subst\">&#123;accessToken&#125;</span>\"</span>;</span><br><span class=\"line\">          StringBuilder data = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">          <span class=\"keyword\">bool</span> isVaildRange = <span class=\"literal\">false</span>;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (range.IsAll)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              data.Append(<span class=\"string\">$\"\\\"touser\\\":\\\"@all\\\"\"</span>);</span><br><span class=\"line\">              isVaildRange = <span class=\"literal\">true</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">else</span></span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (range.Users != <span class=\"literal\">null</span> &amp;&amp; range.Users.Count &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  data.AppendFormat(<span class=\"string\">\"\\\"touser\\\" : &#123;0&#125;\"</span>, GetRangeValue(range.Users));</span><br><span class=\"line\">                  isVaildRange = <span class=\"literal\">true</span>;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">              <span class=\"keyword\">if</span> (range.Tags != <span class=\"literal\">null</span> &amp;&amp; range.Tags.Count &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  <span class=\"keyword\">if</span> (data.Length &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">                  &#123;</span><br><span class=\"line\">                      data.Append(<span class=\"string\">\",\"</span>);</span><br><span class=\"line\">                  &#125;</span><br><span class=\"line\">                  data.AppendFormat(<span class=\"string\">\"\\\"totag\\\" : &#123;0&#125;\"</span>, GetRangeValue(range.Tags));</span><br><span class=\"line\">                  isVaildRange = <span class=\"literal\">true</span>;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">              <span class=\"keyword\">if</span> (range.Departments != <span class=\"literal\">null</span> &amp;&amp; range.Departments.Count &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  <span class=\"keyword\">if</span> (data.Length &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">                  &#123;</span><br><span class=\"line\">                      data.Append(<span class=\"string\">\",\"</span>);</span><br><span class=\"line\">                  &#125;</span><br><span class=\"line\">                  data.AppendFormat(<span class=\"string\">\"\\\"totag\\\" : &#123;0&#125;\"</span>, GetRangeValue(range.Departments));</span><br><span class=\"line\">                  isVaildRange = <span class=\"literal\">true</span>;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (!isVaildRange)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"comment\">//</span></span><br><span class=\"line\">              <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          data.AppendFormat(<span class=\"string\">\",\\\"msgtype\\\":\\\"&#123;0&#125;\\\"\"</span>, GetMessageType(messageType));</span><br><span class=\"line\">          data.AppendFormat(<span class=\"string\">\",\\\"agentid\\\":\\\"&#123;0&#125;\\\"\"</span>, AgentID);</span><br><span class=\"line\">          data.Append(<span class=\"string\">\",\\\"text\\\": &#123;\"</span>);</span><br><span class=\"line\">          data.AppendFormat(<span class=\"string\">\"\\\"content\\\":\\\"&#123;0&#125;\\\"\"</span>, content);</span><br><span class=\"line\">          data.Insert(<span class=\"number\">0</span>, <span class=\"string\">\"&#123;\"</span>);</span><br><span class=\"line\">          data.Append(<span class=\"string\">\"&#125;&#125;\"</span>);</span><br><span class=\"line\">          LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;data.ToString()&#125;</span>\"</span>);</span><br><span class=\"line\">          <span class=\"keyword\">string</span> res = RequestUtil.HttpPost(url, data.ToString(), <span class=\"string\">\"application/json\"</span>);</span><br><span class=\"line\">          LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;res&#125;</span>\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<p>API</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>Values</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\"><span class=\"keyword\">public</span> ActionResult&lt;IEnumerable&lt;<span class=\"keyword\">string</span>&gt;&gt; Get()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">    MessageRange range = <span class=\"keyword\">new</span> MessageRange();</span><br><span class=\"line\">    range.Users = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">    range.Users.Add(<span class=\"string\">\"10001\"</span>);</span><br><span class=\"line\">    QyThridUtil.SendMessage(<span class=\"string\">\"\"</span>, range, AprilEnums.MessageType.Text);</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/09/02/net-core-qywx-application/4.png\" alt=\"\"></p>\n<p><img src=\"/2019/09/02/net-core-qywx-application/5.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n"},{"title":"net core WebApiRedis","date":"2019-09-23T01:48:56.000Z","_content":"\n### \nnet core\n\n### Redis\n**Cookie****Session****Cache**CookieSessionCacheCookieCachehttp\n\n**Redis**RedisRedisRedis\n\nRedis[Linux_Redis](/2019/09/12/vmware-redis/)Redis\n\n### \nNuget**April.Util****Microsoft.Extensions.Caching.Redis****StackExchange.Redis****CSRedisCore**[](https://github.com/aspnet/Extensions/tree/9bc79b2f25a3724376d7af19617c33749a30ea3a)\n\nappsettings.json\n![](net-core-redis/1.png)\nRedis\n![Redis](net-core-redis/2.png)\nvaluebyte[]\n![Redis](net-core-redis/3.png)\nUtil\n\n### RedisUtil\nappsettings**AprilConfig**\n```csharp\nprivate static string _IsOpenCache = string.Empty;\n        /// <summary>\n        /// Redis\n        /// </summary>\n        public static bool IsOpenCache\n        {\n            get\n            {\n                if (string.IsNullOrEmpty(_IsOpenCache))\n                {\n                    _IsOpenCache = Configuration[\"Redis:IsOpenRedis\"];\n                }\n                if (_IsOpenCache.ToLower() == \"true\")\n                {\n                    return true;\n                }\n                return false;\n            }\n        }\n\n        private static string _RedisConnectionString = string.Empty;\n        /// <summary>\n        /// Redis\n        /// </summary>\n        public static string RedisConnectionString\n        {\n            get\n            {\n                if (string.IsNullOrEmpty(_RedisConnectionString))\n                {\n                    _RedisConnectionString = Configuration[\"Redis:ConnectionString\"];\n                }\n                return _RedisConnectionString;\n            }\n        }\n```\n\nRedis\n```csharp\n        private static RedisCache _redisCache = null;\n        private static RedisCacheOptions options = null;\n        /// <summary>\n        /// Redis\n        /// </summary>\n        public static void InitRedis()\n        {\n            if (AprilConfig.IsOpenCache)\n            {\n                _redisCache = new RedisCache(GetOptions());\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <returns></returns>\n        protected static RedisCacheOptions GetOptions()\n        {\n            options = new RedisCacheOptions();\n            options.Configuration = AprilConfig.RedisConnectionString;\n            options.InstanceName = \"April.Redis\";\n            return options;\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"key\"></param>\n        /// <param name=\"value\"></param>\n        /// <param name=\"ExprireTime\"></param>\n        public static void Add(string key, object value, int ExprireTime = 10)\n        {\n            if (string.IsNullOrEmpty(key))\n            {\n                return;\n            }\n            string strValue = string.Empty;\n            try\n            {\n                strValue = JsonConvert.SerializeObject(value);\n            }\n            catch (Exception ex)\n            {\n                LogUtil.Error($\"Redis.Add:{ex.Message}\");\n            }\n            if (!string.IsNullOrEmpty(strValue))\n            {\n                _redisCache.SetString(key, strValue, new Microsoft.Extensions.Caching.Distributed.DistributedCacheEntryOptions()\n                {\n                    AbsoluteExpiration = DateTime.Now.AddMinutes(ExprireTime)\n                });\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <typeparam name=\"T\"></typeparam>\n        /// <param name=\"key\"></param>\n        /// <returns></returns>\n        public static T Get<T>(string key)\n        {\n            string value = Get(key);\n            if (string.IsNullOrEmpty(value))\n            {\n                return default(T);\n            }\n            T obj = default(T);\n            try\n            {\n                obj = JsonConvert.DeserializeObject<T>(value);\n            }\n            catch (Exception ex)\n            {\n                LogUtil.Error($\"Redis.Get{ex.Message},{value}\");\n            }\n            return obj;\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"key\"></param>\n        public static void Remove(string key)\n        {\n            if (!string.IsNullOrEmpty(key))\n            {\n                _redisCache.Remove(key);\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"key\"></param>\n        /// <param name=\"value\"></param>\n        /// <param name=\"expireTime\"></param>\n        public static void Replace(string key, object value, int expireTime = 10)\n        {\n            if (!string.IsNullOrEmpty(key))\n            {\n                Remove(key);\n                Add(key, value, expireTime);\n            }\n        }\n```\n\n[net core Webapi ](/2019/07/19/net-core-webapi-main/)\n\n### \n\n****\n![](net-core-redis/4.png)\n![](net-core-redis/5.png)\n****\n![](net-core-redis/6.png)\n![](net-core-redis/7.png)\n****\nps:-,-|||\n![](net-core-redis/8.png)\n![](net-core-redis/9.png)\n****\n![](net-core-redis/10.png)\n![](net-core-redis/11.png)\n\n### \nRedisdatabaseredis****","source":"_posts/net-core-redis.md","raw":"---\ntitle: net core WebApiRedis\ndate: 2019-09-23 09:48:56\ntags: net core\ncategories: AprilBlank\n---\n\n### \nnet core\n\n### Redis\n**Cookie****Session****Cache**CookieSessionCacheCookieCachehttp\n\n**Redis**RedisRedisRedis\n\nRedis[Linux_Redis](/2019/09/12/vmware-redis/)Redis\n\n### \nNuget**April.Util****Microsoft.Extensions.Caching.Redis****StackExchange.Redis****CSRedisCore**[](https://github.com/aspnet/Extensions/tree/9bc79b2f25a3724376d7af19617c33749a30ea3a)\n\nappsettings.json\n![](net-core-redis/1.png)\nRedis\n![Redis](net-core-redis/2.png)\nvaluebyte[]\n![Redis](net-core-redis/3.png)\nUtil\n\n### RedisUtil\nappsettings**AprilConfig**\n```csharp\nprivate static string _IsOpenCache = string.Empty;\n        /// <summary>\n        /// Redis\n        /// </summary>\n        public static bool IsOpenCache\n        {\n            get\n            {\n                if (string.IsNullOrEmpty(_IsOpenCache))\n                {\n                    _IsOpenCache = Configuration[\"Redis:IsOpenRedis\"];\n                }\n                if (_IsOpenCache.ToLower() == \"true\")\n                {\n                    return true;\n                }\n                return false;\n            }\n        }\n\n        private static string _RedisConnectionString = string.Empty;\n        /// <summary>\n        /// Redis\n        /// </summary>\n        public static string RedisConnectionString\n        {\n            get\n            {\n                if (string.IsNullOrEmpty(_RedisConnectionString))\n                {\n                    _RedisConnectionString = Configuration[\"Redis:ConnectionString\"];\n                }\n                return _RedisConnectionString;\n            }\n        }\n```\n\nRedis\n```csharp\n        private static RedisCache _redisCache = null;\n        private static RedisCacheOptions options = null;\n        /// <summary>\n        /// Redis\n        /// </summary>\n        public static void InitRedis()\n        {\n            if (AprilConfig.IsOpenCache)\n            {\n                _redisCache = new RedisCache(GetOptions());\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <returns></returns>\n        protected static RedisCacheOptions GetOptions()\n        {\n            options = new RedisCacheOptions();\n            options.Configuration = AprilConfig.RedisConnectionString;\n            options.InstanceName = \"April.Redis\";\n            return options;\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"key\"></param>\n        /// <param name=\"value\"></param>\n        /// <param name=\"ExprireTime\"></param>\n        public static void Add(string key, object value, int ExprireTime = 10)\n        {\n            if (string.IsNullOrEmpty(key))\n            {\n                return;\n            }\n            string strValue = string.Empty;\n            try\n            {\n                strValue = JsonConvert.SerializeObject(value);\n            }\n            catch (Exception ex)\n            {\n                LogUtil.Error($\"Redis.Add:{ex.Message}\");\n            }\n            if (!string.IsNullOrEmpty(strValue))\n            {\n                _redisCache.SetString(key, strValue, new Microsoft.Extensions.Caching.Distributed.DistributedCacheEntryOptions()\n                {\n                    AbsoluteExpiration = DateTime.Now.AddMinutes(ExprireTime)\n                });\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <typeparam name=\"T\"></typeparam>\n        /// <param name=\"key\"></param>\n        /// <returns></returns>\n        public static T Get<T>(string key)\n        {\n            string value = Get(key);\n            if (string.IsNullOrEmpty(value))\n            {\n                return default(T);\n            }\n            T obj = default(T);\n            try\n            {\n                obj = JsonConvert.DeserializeObject<T>(value);\n            }\n            catch (Exception ex)\n            {\n                LogUtil.Error($\"Redis.Get{ex.Message},{value}\");\n            }\n            return obj;\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"key\"></param>\n        public static void Remove(string key)\n        {\n            if (!string.IsNullOrEmpty(key))\n            {\n                _redisCache.Remove(key);\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"key\"></param>\n        /// <param name=\"value\"></param>\n        /// <param name=\"expireTime\"></param>\n        public static void Replace(string key, object value, int expireTime = 10)\n        {\n            if (!string.IsNullOrEmpty(key))\n            {\n                Remove(key);\n                Add(key, value, expireTime);\n            }\n        }\n```\n\n[net core Webapi ](/2019/07/19/net-core-webapi-main/)\n\n### \n\n****\n![](net-core-redis/4.png)\n![](net-core-redis/5.png)\n****\n![](net-core-redis/6.png)\n![](net-core-redis/7.png)\n****\nps:-,-|||\n![](net-core-redis/8.png)\n![](net-core-redis/9.png)\n****\n![](net-core-redis/10.png)\n![](net-core-redis/11.png)\n\n### \nRedisdatabaseredis****","slug":"net-core-redis","published":1,"updated":"2019-09-30T05:47:07.993Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m3u003t9sv7275oj29e","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net core</p>\n<h3 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h3><p><strong>Cookie</strong><strong>Session</strong><strong>Cache</strong>CookieSessionCacheCookieCachehttp</p>\n<p><strong>Redis</strong>RedisRedisRedis</p>\n<p>Redis<a href=\"/2019/09/12/vmware-redis/\">Linux_Redis</a>Redis</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Nuget<strong>April.Util</strong><strong>Microsoft.Extensions.Caching.Redis</strong><strong>StackExchange.Redis</strong><strong>CSRedisCore</strong><a href=\"https://github.com/aspnet/Extensions/tree/9bc79b2f25a3724376d7af19617c33749a30ea3a\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p>appsettings.json<br><img src=\"/2019/09/23/net-core-redis/1.png\" alt=\"\"><br>Redis<br><img src=\"/2019/09/23/net-core-redis/2.png\" alt=\"Redis\"><br>valuebyte[]<br><img src=\"/2019/09/23/net-core-redis/3.png\" alt=\"Redis\"><br>Util</p>\n<h3 id=\"RedisUtil\"><a href=\"#RedisUtil\" class=\"headerlink\" title=\"RedisUtil\"></a>RedisUtil</h3><p>appsettings<strong>AprilConfig</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> _IsOpenCache = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> Redis</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">bool</span> IsOpenCache</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">get</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(_IsOpenCache))</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    _IsOpenCache = Configuration[<span class=\"string\">\"Redis:IsOpenRedis\"</span>];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (_IsOpenCache.ToLower() == <span class=\"string\">\"true\"</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> _RedisConnectionString = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> Redis</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> RedisConnectionString</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">get</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(_RedisConnectionString))</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    _RedisConnectionString = Configuration[<span class=\"string\">\"Redis:ConnectionString\"</span>];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> _RedisConnectionString;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br></pre></td></tr></table></figure>\n\n<p>Redis</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> RedisCache _redisCache = <span class=\"literal\">null</span>;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> RedisCacheOptions options = <span class=\"literal\">null</span>;</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> Redis</span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">InitRedis</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (AprilConfig.IsOpenCache)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        _redisCache = <span class=\"keyword\">new</span> RedisCache(GetOptions());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">static</span> RedisCacheOptions <span class=\"title\">GetOptions</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    options = <span class=\"keyword\">new</span> RedisCacheOptions();</span><br><span class=\"line\">    options.Configuration = AprilConfig.RedisConnectionString;</span><br><span class=\"line\">    options.InstanceName = <span class=\"string\">\"April.Redis\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> options;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"value\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"ExprireTime\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Add</span>(<span class=\"params\"><span class=\"keyword\">string</span> key, <span class=\"keyword\">object</span> <span class=\"keyword\">value</span>, <span class=\"keyword\">int</span> ExprireTime = <span class=\"number\">10</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(key))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> strValue = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">try</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        strValue = JsonConvert.SerializeObject(<span class=\"keyword\">value</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        LogUtil.Error(<span class=\"string\">$\"Redis.Add:<span class=\"subst\">&#123;ex.Message&#125;</span>\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(strValue))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        _redisCache.SetString(key, strValue, <span class=\"keyword\">new</span> Microsoft.Extensions.Caching.Distributed.DistributedCacheEntryOptions()</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            AbsoluteExpiration = DateTime.Now.AddMinutes(ExprireTime)</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;typeparam name=\"T\"&gt;</span><span class=\"doctag\">&lt;/typeparam&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> T Get&lt;T&gt;(<span class=\"keyword\">string</span> key)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> <span class=\"keyword\">value</span> = Get(key);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(<span class=\"keyword\">value</span>))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">default</span>(T);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    T obj = <span class=\"keyword\">default</span>(T);</span><br><span class=\"line\">    <span class=\"keyword\">try</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        obj = JsonConvert.DeserializeObject&lt;T&gt;(<span class=\"keyword\">value</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        LogUtil.Error(<span class=\"string\">$\"Redis.Get<span class=\"subst\">&#123;ex.Message&#125;</span>,<span class=\"subst\">&#123;<span class=\"keyword\">value</span>&#125;</span>\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> obj;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Remove</span>(<span class=\"params\"><span class=\"keyword\">string</span> key</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(key))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        _redisCache.Remove(key);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"value\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"expireTime\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Replace</span>(<span class=\"params\"><span class=\"keyword\">string</span> key, <span class=\"keyword\">object</span> <span class=\"keyword\">value</span>, <span class=\"keyword\">int</span> expireTime = <span class=\"number\">10</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(key))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Remove(key);</span><br><span class=\"line\">        Add(key, <span class=\"keyword\">value</span>, expireTime);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"/2019/07/19/net-core-webapi-main/\">net core Webapi </a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br><strong></strong><br><img src=\"/2019/09/23/net-core-redis/4.png\" alt=\"\"><br><img src=\"/2019/09/23/net-core-redis/5.png\" alt=\"\"><br><strong></strong><br><img src=\"/2019/09/23/net-core-redis/6.png\" alt=\"\"><br><img src=\"/2019/09/23/net-core-redis/7.png\" alt=\"\"><br><strong></strong><br>ps:-,-|||<br><img src=\"/2019/09/23/net-core-redis/8.png\" alt=\"\"><br><img src=\"/2019/09/23/net-core-redis/9.png\" alt=\"\"><br><strong></strong><br><img src=\"/2019/09/23/net-core-redis/10.png\" alt=\"\"><br><img src=\"/2019/09/23/net-core-redis/11.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Redisdatabaseredis<strong></strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net core</p>\n<h3 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h3><p><strong>Cookie</strong><strong>Session</strong><strong>Cache</strong>CookieSessionCacheCookieCachehttp</p>\n<p><strong>Redis</strong>RedisRedisRedis</p>\n<p>Redis<a href=\"/2019/09/12/vmware-redis/\">Linux_Redis</a>Redis</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Nuget<strong>April.Util</strong><strong>Microsoft.Extensions.Caching.Redis</strong><strong>StackExchange.Redis</strong><strong>CSRedisCore</strong><a href=\"https://github.com/aspnet/Extensions/tree/9bc79b2f25a3724376d7af19617c33749a30ea3a\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p>appsettings.json<br><img src=\"/2019/09/23/net-core-redis/1.png\" alt=\"\"><br>Redis<br><img src=\"/2019/09/23/net-core-redis/2.png\" alt=\"Redis\"><br>valuebyte[]<br><img src=\"/2019/09/23/net-core-redis/3.png\" alt=\"Redis\"><br>Util</p>\n<h3 id=\"RedisUtil\"><a href=\"#RedisUtil\" class=\"headerlink\" title=\"RedisUtil\"></a>RedisUtil</h3><p>appsettings<strong>AprilConfig</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> _IsOpenCache = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> Redis</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">bool</span> IsOpenCache</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">get</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(_IsOpenCache))</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    _IsOpenCache = Configuration[<span class=\"string\">\"Redis:IsOpenRedis\"</span>];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (_IsOpenCache.ToLower() == <span class=\"string\">\"true\"</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> _RedisConnectionString = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> Redis</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> RedisConnectionString</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">get</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(_RedisConnectionString))</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    _RedisConnectionString = Configuration[<span class=\"string\">\"Redis:ConnectionString\"</span>];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> _RedisConnectionString;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br></pre></td></tr></table></figure>\n\n<p>Redis</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> RedisCache _redisCache = <span class=\"literal\">null</span>;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> RedisCacheOptions options = <span class=\"literal\">null</span>;</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> Redis</span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">InitRedis</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (AprilConfig.IsOpenCache)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        _redisCache = <span class=\"keyword\">new</span> RedisCache(GetOptions());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">static</span> RedisCacheOptions <span class=\"title\">GetOptions</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    options = <span class=\"keyword\">new</span> RedisCacheOptions();</span><br><span class=\"line\">    options.Configuration = AprilConfig.RedisConnectionString;</span><br><span class=\"line\">    options.InstanceName = <span class=\"string\">\"April.Redis\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> options;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"value\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"ExprireTime\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Add</span>(<span class=\"params\"><span class=\"keyword\">string</span> key, <span class=\"keyword\">object</span> <span class=\"keyword\">value</span>, <span class=\"keyword\">int</span> ExprireTime = <span class=\"number\">10</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(key))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> strValue = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">try</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        strValue = JsonConvert.SerializeObject(<span class=\"keyword\">value</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        LogUtil.Error(<span class=\"string\">$\"Redis.Add:<span class=\"subst\">&#123;ex.Message&#125;</span>\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(strValue))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        _redisCache.SetString(key, strValue, <span class=\"keyword\">new</span> Microsoft.Extensions.Caching.Distributed.DistributedCacheEntryOptions()</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            AbsoluteExpiration = DateTime.Now.AddMinutes(ExprireTime)</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;typeparam name=\"T\"&gt;</span><span class=\"doctag\">&lt;/typeparam&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> T Get&lt;T&gt;(<span class=\"keyword\">string</span> key)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> <span class=\"keyword\">value</span> = Get(key);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(<span class=\"keyword\">value</span>))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">default</span>(T);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    T obj = <span class=\"keyword\">default</span>(T);</span><br><span class=\"line\">    <span class=\"keyword\">try</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        obj = JsonConvert.DeserializeObject&lt;T&gt;(<span class=\"keyword\">value</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        LogUtil.Error(<span class=\"string\">$\"Redis.Get<span class=\"subst\">&#123;ex.Message&#125;</span>,<span class=\"subst\">&#123;<span class=\"keyword\">value</span>&#125;</span>\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> obj;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Remove</span>(<span class=\"params\"><span class=\"keyword\">string</span> key</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(key))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        _redisCache.Remove(key);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"value\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"expireTime\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Replace</span>(<span class=\"params\"><span class=\"keyword\">string</span> key, <span class=\"keyword\">object</span> <span class=\"keyword\">value</span>, <span class=\"keyword\">int</span> expireTime = <span class=\"number\">10</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(key))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Remove(key);</span><br><span class=\"line\">        Add(key, <span class=\"keyword\">value</span>, expireTime);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"/2019/07/19/net-core-webapi-main/\">net core Webapi </a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br><strong></strong><br><img src=\"/2019/09/23/net-core-redis/4.png\" alt=\"\"><br><img src=\"/2019/09/23/net-core-redis/5.png\" alt=\"\"><br><strong></strong><br><img src=\"/2019/09/23/net-core-redis/6.png\" alt=\"\"><br><img src=\"/2019/09/23/net-core-redis/7.png\" alt=\"\"><br><strong></strong><br>ps:-,-|||<br><img src=\"/2019/09/23/net-core-redis/8.png\" alt=\"\"><br><img src=\"/2019/09/23/net-core-redis/9.png\" alt=\"\"><br><strong></strong><br><img src=\"/2019/09/23/net-core-redis/10.png\" alt=\"\"><br><img src=\"/2019/09/23/net-core-redis/11.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Redisdatabaseredis<strong></strong></p>\n"},{"title":"net core Webapi_Part 2","date":"2019-07-19T09:49:58.000Z","_content":"\n### \n\n\n[net core Webapi_Part 1](/2019/07/18/net-core-sqlsugar-1/)\n\n### \nService**Interfaces****Implements****Common**\n\n![Service](net-core-sqlsugar-2/1.png)\nStudentEntity\n**IStudentService**IBaseService\n```csharp\n    public interface IStudentService : IBaseService<StudentEntity>\n    {\n    }\n```\n**StudentService**BaseServiceIStudentService\n```csharp\n    public class StudentService : BaseService<StudentEntity>, IStudentService\n    {\n    }\n```\n\n\n### \n\n\nStartUp\n\n> WebApiServiceEntity\n\nServiceCommonDepends**ServiceInjection**\n\n```csharp\n    public class ServiceInjection\n    {\n        public static void ConfigureRepository(IServiceCollection services)\n        {\n            services.AddSingleton<IStudentService, StudentService>();\n        }\n    }\n```\n\n\n\n|  |   |\n|--|--|\n| Transient |  |\n| Scoped |  |\n| Singleton |   |\n\nStartUpConfigureServicesAprilConfig\n```csharp\n\t\tpublic Startup(IConfiguration configuration)\n        {\n\t\t\t...\n            AprilConfig.InitConfig(configuration);\n        }\n\t\t\n        public void ConfigureServices(IServiceCollection services)\n        {\n            ServiceInjection.ConfigureRepository(services);\n            \n\t\t\t...\n\t\t}\n```\n\n```csharp\n    public class AprilConfig\n    {\n        public static IServiceProvider ServiceProvider;\n        public static IConfiguration Configuration;\n\n        public static void InitConfig(IConfiguration _configuration)\n        {\n            Configuration = _configuration;\n        }\n\t}\n```\n\nValues\n\nSqlServer1MySql0\n\nappsettingsweb.config\n```json\n  //\n  \"DefaultSqlConnectionString\": {\n    \"MySql\": \"server=127.0.0.1;userid=root;password=root;database=test;\"\n  }\n```\nUtil**AprilConfig**\n\n```csharp\n        private static string _MySqlConnectionString = string.Empty;\n        /// <summary>\n        /// MySql\n        /// </summary>\n        public static string MySqlConnectionString\n        {\n            get\n            {\n                if (string.IsNullOrEmpty(_MySqlConnectionString))\n                {\n                    _MySqlConnectionString = Configuration[\"DefaultSqlConnectionString:MySql\"];\n                }\n                return _MySqlConnectionString;\n            }\n        }\n```\n\nBaseService\n![BaseService](net-core-sqlsugar-2/2.png)\nSqlSugarCodeFirstDbFirst\n![](net-core-sqlsugar-2/3.png)\n![mysql](net-core-sqlsugar-2/4.png)\n\nValuesIStudentService\n\n```csharp\n    public class ValuesController : ControllerBase\n    {\n\n        private readonly IStudentService _service;\n\n        public ValuesController(IStudentService service)\n        {\n            _service = service;\n        }\n    }\n```\n\n- ****\n```csharp\n        [HttpGet]\n        public ActionResult<IEnumerable<string>> Get()\n        {\n            StudentEntity entity = new StudentEntity();\n            entity.Name = \"\";\n            entity.Age = 18;\n            entity.Number = \"007\";\n            entity.Sex = 0;\n            entity.Address = \"\";\n            _service.Insert(entity);\n            return new string[] { \"value1\", \"value2\" };\n        }\n```\n![](net-core-sqlsugar-2/5.png)\n- ****\nSqlFilterEntity\n\n*SqlFilterEntity*\n```csharp\n\t\t//...\n\t\t\n\t\t/// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"filter\"></param>\n        /// <param name=\"relation\"></param>\n        public void Append(string filter, string relation = \"and\")\n        {\n            if (string.IsNullOrEmpty(filter))\n            {\n                return;\n            }\n            if (Filter.Length > 0)\n            {\n                Filter += relation;\n            }\n            Filter += filter;\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"key\"></param>\n        /// <param name=\"value\"></param>\n        public void Add(string key, object value)\n        {\n            if (string.IsNullOrEmpty(key) || value == null)\n            {\n                return;\n            }\n            if (Value == null)\n            {\n                Value = new Dictionary<string, object>();\n            }\n            if (Value.ContainsKey(key))\n            {\n                Value[key] = value;\n            }\n            else\n            {\n                Value.Add(key, value);\n            }\n        }\n```\n\n**\n```csharp\n\t\t\tStudentEntity entity = null;\n            SqlFilterEntity filter = new SqlFilterEntity();\n            filter.Append($\"ID=@ID\");\n            filter.Add(\"@ID\", 1);\n            entity = _service.GetEntity(filter);\n            if (entity != null)\n            {\n                entity.Name = \"\";\n                _service.Update(entity);\n            }\n\t\n```\n![](net-core-sqlsugar-2/6.png)\n\n- ****\n\n![](net-core-sqlsugar-2/7.png)\n![](net-core-sqlsugar-2/8.png)\n\n- ****\n\nValues/{id}\n```csharp\n        [HttpGet(\"{id}\")]\n        public ActionResult<string> Get(int id)\n        {\n            string value = string.Empty;\n            //value = CacheUtil.Get<string>(\"cachetest\");\n            //value = SessionUtil.GetSession(\"test\");\n            //value = CookieUtil.GetCookies(\"apirlcookietest\");\n\n            int count = 0;\n            List<StudentEntity> lists = _service.GetPageList(id, 10, \"\", null, \"\", out count);\n\n            value = JsonConvert.SerializeObject(lists);\n\n            return value;\n        }\n```\n![](net-core-sqlsugar-2/9.png)\n\n### \n\nSqlSugar****yy**Aop**","source":"_posts/net-core-sqlsugar-2.md","raw":"---\ntitle: net core Webapi_Part 2\ndate: 2019-07-19 17:49:58\ntags: net core\ncategories: AprilBlank\n---\n\n### \n\n\n[net core Webapi_Part 1](/2019/07/18/net-core-sqlsugar-1/)\n\n### \nService**Interfaces****Implements****Common**\n\n![Service](net-core-sqlsugar-2/1.png)\nStudentEntity\n**IStudentService**IBaseService\n```csharp\n    public interface IStudentService : IBaseService<StudentEntity>\n    {\n    }\n```\n**StudentService**BaseServiceIStudentService\n```csharp\n    public class StudentService : BaseService<StudentEntity>, IStudentService\n    {\n    }\n```\n\n\n### \n\n\nStartUp\n\n> WebApiServiceEntity\n\nServiceCommonDepends**ServiceInjection**\n\n```csharp\n    public class ServiceInjection\n    {\n        public static void ConfigureRepository(IServiceCollection services)\n        {\n            services.AddSingleton<IStudentService, StudentService>();\n        }\n    }\n```\n\n\n\n|  |   |\n|--|--|\n| Transient |  |\n| Scoped |  |\n| Singleton |   |\n\nStartUpConfigureServicesAprilConfig\n```csharp\n\t\tpublic Startup(IConfiguration configuration)\n        {\n\t\t\t...\n            AprilConfig.InitConfig(configuration);\n        }\n\t\t\n        public void ConfigureServices(IServiceCollection services)\n        {\n            ServiceInjection.ConfigureRepository(services);\n            \n\t\t\t...\n\t\t}\n```\n\n```csharp\n    public class AprilConfig\n    {\n        public static IServiceProvider ServiceProvider;\n        public static IConfiguration Configuration;\n\n        public static void InitConfig(IConfiguration _configuration)\n        {\n            Configuration = _configuration;\n        }\n\t}\n```\n\nValues\n\nSqlServer1MySql0\n\nappsettingsweb.config\n```json\n  //\n  \"DefaultSqlConnectionString\": {\n    \"MySql\": \"server=127.0.0.1;userid=root;password=root;database=test;\"\n  }\n```\nUtil**AprilConfig**\n\n```csharp\n        private static string _MySqlConnectionString = string.Empty;\n        /// <summary>\n        /// MySql\n        /// </summary>\n        public static string MySqlConnectionString\n        {\n            get\n            {\n                if (string.IsNullOrEmpty(_MySqlConnectionString))\n                {\n                    _MySqlConnectionString = Configuration[\"DefaultSqlConnectionString:MySql\"];\n                }\n                return _MySqlConnectionString;\n            }\n        }\n```\n\nBaseService\n![BaseService](net-core-sqlsugar-2/2.png)\nSqlSugarCodeFirstDbFirst\n![](net-core-sqlsugar-2/3.png)\n![mysql](net-core-sqlsugar-2/4.png)\n\nValuesIStudentService\n\n```csharp\n    public class ValuesController : ControllerBase\n    {\n\n        private readonly IStudentService _service;\n\n        public ValuesController(IStudentService service)\n        {\n            _service = service;\n        }\n    }\n```\n\n- ****\n```csharp\n        [HttpGet]\n        public ActionResult<IEnumerable<string>> Get()\n        {\n            StudentEntity entity = new StudentEntity();\n            entity.Name = \"\";\n            entity.Age = 18;\n            entity.Number = \"007\";\n            entity.Sex = 0;\n            entity.Address = \"\";\n            _service.Insert(entity);\n            return new string[] { \"value1\", \"value2\" };\n        }\n```\n![](net-core-sqlsugar-2/5.png)\n- ****\nSqlFilterEntity\n\n*SqlFilterEntity*\n```csharp\n\t\t//...\n\t\t\n\t\t/// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"filter\"></param>\n        /// <param name=\"relation\"></param>\n        public void Append(string filter, string relation = \"and\")\n        {\n            if (string.IsNullOrEmpty(filter))\n            {\n                return;\n            }\n            if (Filter.Length > 0)\n            {\n                Filter += relation;\n            }\n            Filter += filter;\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"key\"></param>\n        /// <param name=\"value\"></param>\n        public void Add(string key, object value)\n        {\n            if (string.IsNullOrEmpty(key) || value == null)\n            {\n                return;\n            }\n            if (Value == null)\n            {\n                Value = new Dictionary<string, object>();\n            }\n            if (Value.ContainsKey(key))\n            {\n                Value[key] = value;\n            }\n            else\n            {\n                Value.Add(key, value);\n            }\n        }\n```\n\n**\n```csharp\n\t\t\tStudentEntity entity = null;\n            SqlFilterEntity filter = new SqlFilterEntity();\n            filter.Append($\"ID=@ID\");\n            filter.Add(\"@ID\", 1);\n            entity = _service.GetEntity(filter);\n            if (entity != null)\n            {\n                entity.Name = \"\";\n                _service.Update(entity);\n            }\n\t\n```\n![](net-core-sqlsugar-2/6.png)\n\n- ****\n\n![](net-core-sqlsugar-2/7.png)\n![](net-core-sqlsugar-2/8.png)\n\n- ****\n\nValues/{id}\n```csharp\n        [HttpGet(\"{id}\")]\n        public ActionResult<string> Get(int id)\n        {\n            string value = string.Empty;\n            //value = CacheUtil.Get<string>(\"cachetest\");\n            //value = SessionUtil.GetSession(\"test\");\n            //value = CookieUtil.GetCookies(\"apirlcookietest\");\n\n            int count = 0;\n            List<StudentEntity> lists = _service.GetPageList(id, 10, \"\", null, \"\", out count);\n\n            value = JsonConvert.SerializeObject(lists);\n\n            return value;\n        }\n```\n![](net-core-sqlsugar-2/9.png)\n\n### \n\nSqlSugar****yy**Aop**","slug":"net-core-sqlsugar-2","published":1,"updated":"2019-09-30T05:47:17.978Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m41003w9sv79xftjxlw","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><a href=\"/2019/07/18/net-core-sqlsugar-1/\">net core Webapi_Part 1</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Service<strong>Interfaces</strong><strong>Implements</strong><strong>Common</strong></p>\n<p><img src=\"/2019/07/19/net-core-sqlsugar-2/1.png\" alt=\"Service\"><br>StudentEntity<br><strong>IStudentService</strong>IBaseService</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public interface IStudentService : IBaseService&lt;StudentEntity&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>StudentService</strong>BaseServiceIStudentService</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class StudentService : BaseService&lt;StudentEntity&gt;, IStudentService</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>StartUp</p>\n<blockquote>\n<p>WebApiServiceEntity</p>\n</blockquote>\n<p>ServiceCommonDepends<strong>ServiceInjection</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">ServiceInjection</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureRepository</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        services.AddSingleton&lt;IStudentService, StudentService&gt;();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Transient</td>\n<td></td>\n</tr>\n<tr>\n<td>Scoped</td>\n<td></td>\n</tr>\n<tr>\n<td>Singleton</td>\n<td></td>\n</tr>\n</tbody></table>\n<p>StartUpConfigureServicesAprilConfig</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Startup</span>(<span class=\"params\">IConfiguration configuration</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">\t...</span><br><span class=\"line\">          AprilConfig.InitConfig(configuration);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          ServiceInjection.ConfigureRepository(services);</span><br><span class=\"line\">          </span><br><span class=\"line\">\t...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">   <span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AprilConfig</span></span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IServiceProvider ServiceProvider;</span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IConfiguration Configuration;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">InitConfig</span>(<span class=\"params\">IConfiguration _configuration</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           Configuration = _configuration;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Values</p>\n<p>SqlServer1MySql0</p>\n<p>appsettingsweb.config</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//</span><br><span class=\"line\">\"DefaultSqlConnectionString\": &#123;</span><br><span class=\"line\">  \"MySql\": \"server=127.0.0.1;userid=root;password=root;database=test;\"</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Util<strong>AprilConfig</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> _MySqlConnectionString = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> MySql</span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> MySqlConnectionString</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">get</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(_MySqlConnectionString))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            _MySqlConnectionString = Configuration[<span class=\"string\">\"DefaultSqlConnectionString:MySql\"</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> _MySqlConnectionString;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>BaseService<br><img src=\"/2019/07/19/net-core-sqlsugar-2/2.png\" alt=\"BaseService\"><br>SqlSugarCodeFirstDbFirst<br><img src=\"/2019/07/19/net-core-sqlsugar-2/3.png\" alt=\"\"><br><img src=\"/2019/07/19/net-core-sqlsugar-2/4.png\" alt=\"mysql\"></p>\n<p>ValuesIStudentService</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">ValuesController</span> : <span class=\"title\">ControllerBase</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> IStudentService _service;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ValuesController</span>(<span class=\"params\">IStudentService service</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        _service = service;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong></strong><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\"><span class=\"keyword\">public</span> ActionResult&lt;IEnumerable&lt;<span class=\"keyword\">string</span>&gt;&gt; Get()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    StudentEntity entity = <span class=\"keyword\">new</span> StudentEntity();</span><br><span class=\"line\">    entity.Name = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">    entity.Age = <span class=\"number\">18</span>;</span><br><span class=\"line\">    entity.Number = <span class=\"string\">\"007\"</span>;</span><br><span class=\"line\">    entity.Sex = <span class=\"number\">0</span>;</span><br><span class=\"line\">    entity.Address = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">    _service.Insert(entity);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">string</span>[] &#123; <span class=\"string\">\"value1\"</span>, <span class=\"string\">\"value2\"</span> &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p><img src=\"/2019/07/19/net-core-sqlsugar-2/5.png\" alt=\"\"></p>\n<ul>\n<li><strong></strong><br>SqlFilterEntity</li>\n</ul>\n<p><em>SqlFilterEntity</em></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//...</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"relation\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Append</span>(<span class=\"params\"><span class=\"keyword\">string</span> filter, <span class=\"keyword\">string</span> relation = <span class=\"string\">\"and\"</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(filter))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (Filter.Length &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              Filter += relation;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          Filter += filter;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"value\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Add</span>(<span class=\"params\"><span class=\"keyword\">string</span> key, <span class=\"keyword\">object</span> <span class=\"keyword\">value</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(key) || <span class=\"keyword\">value</span> == <span class=\"literal\">null</span>)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (Value == <span class=\"literal\">null</span>)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              Value = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt;();</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (Value.ContainsKey(key))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              Value[key] = <span class=\"keyword\">value</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">else</span></span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              Value.Add(key, <span class=\"keyword\">value</span>);</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<p><em></em></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">StudentEntity entity = <span class=\"literal\">null</span>;</span><br><span class=\"line\">         SqlFilterEntity filter = <span class=\"keyword\">new</span> SqlFilterEntity();</span><br><span class=\"line\">         filter.Append(<span class=\"string\">$\"ID=@ID\"</span>);</span><br><span class=\"line\">         filter.Add(<span class=\"string\">\"@ID\"</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">         entity = _service.GetEntity(filter);</span><br><span class=\"line\">         <span class=\"keyword\">if</span> (entity != <span class=\"literal\">null</span>)</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">             entity.Name = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">             _service.Update(entity);</span><br><span class=\"line\">         &#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/07/19/net-core-sqlsugar-2/6.png\" alt=\"\"></p>\n<ul>\n<li><p><strong></strong><br><br><img src=\"/2019/07/19/net-core-sqlsugar-2/7.png\" alt=\"\"><br><img src=\"/2019/07/19/net-core-sqlsugar-2/8.png\" alt=\"\"></p>\n</li>\n<li><p><strong></strong></p>\n</li>\n</ul>\n<p>Values/{id}</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet(<span class=\"meta-string\">\"&#123;id&#125;\"</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ActionResult&lt;<span class=\"keyword\">string</span>&gt; <span class=\"title\">Get</span>(<span class=\"params\"><span class=\"keyword\">int</span> id</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> <span class=\"keyword\">value</span> = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"comment\">//value = CacheUtil.Get&lt;string&gt;(\"cachetest\");</span></span><br><span class=\"line\">    <span class=\"comment\">//value = SessionUtil.GetSession(\"test\");</span></span><br><span class=\"line\">    <span class=\"comment\">//value = CookieUtil.GetCookies(\"apirlcookietest\");</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span> count = <span class=\"number\">0</span>;</span><br><span class=\"line\">    List&lt;StudentEntity&gt; lists = _service.GetPageList(id, <span class=\"number\">10</span>, <span class=\"string\">\"\"</span>, <span class=\"literal\">null</span>, <span class=\"string\">\"\"</span>, <span class=\"keyword\">out</span> count);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">value</span> = JsonConvert.SerializeObject(lists);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">value</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/07/19/net-core-sqlsugar-2/9.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>SqlSugar<strong></strong>yy<strong>Aop</strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><a href=\"/2019/07/18/net-core-sqlsugar-1/\">net core Webapi_Part 1</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Service<strong>Interfaces</strong><strong>Implements</strong><strong>Common</strong></p>\n<p><img src=\"/2019/07/19/net-core-sqlsugar-2/1.png\" alt=\"Service\"><br>StudentEntity<br><strong>IStudentService</strong>IBaseService</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public interface IStudentService : IBaseService&lt;StudentEntity&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>StudentService</strong>BaseServiceIStudentService</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class StudentService : BaseService&lt;StudentEntity&gt;, IStudentService</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>StartUp</p>\n<blockquote>\n<p>WebApiServiceEntity</p>\n</blockquote>\n<p>ServiceCommonDepends<strong>ServiceInjection</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">ServiceInjection</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureRepository</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        services.AddSingleton&lt;IStudentService, StudentService&gt;();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Transient</td>\n<td></td>\n</tr>\n<tr>\n<td>Scoped</td>\n<td></td>\n</tr>\n<tr>\n<td>Singleton</td>\n<td></td>\n</tr>\n</tbody></table>\n<p>StartUpConfigureServicesAprilConfig</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Startup</span>(<span class=\"params\">IConfiguration configuration</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">\t...</span><br><span class=\"line\">          AprilConfig.InitConfig(configuration);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          ServiceInjection.ConfigureRepository(services);</span><br><span class=\"line\">          </span><br><span class=\"line\">\t...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">   <span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AprilConfig</span></span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IServiceProvider ServiceProvider;</span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IConfiguration Configuration;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">InitConfig</span>(<span class=\"params\">IConfiguration _configuration</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           Configuration = _configuration;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Values</p>\n<p>SqlServer1MySql0</p>\n<p>appsettingsweb.config</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//</span><br><span class=\"line\">\"DefaultSqlConnectionString\": &#123;</span><br><span class=\"line\">  \"MySql\": \"server=127.0.0.1;userid=root;password=root;database=test;\"</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Util<strong>AprilConfig</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> _MySqlConnectionString = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> MySql</span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> MySqlConnectionString</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">get</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(_MySqlConnectionString))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            _MySqlConnectionString = Configuration[<span class=\"string\">\"DefaultSqlConnectionString:MySql\"</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> _MySqlConnectionString;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>BaseService<br><img src=\"/2019/07/19/net-core-sqlsugar-2/2.png\" alt=\"BaseService\"><br>SqlSugarCodeFirstDbFirst<br><img src=\"/2019/07/19/net-core-sqlsugar-2/3.png\" alt=\"\"><br><img src=\"/2019/07/19/net-core-sqlsugar-2/4.png\" alt=\"mysql\"></p>\n<p>ValuesIStudentService</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">ValuesController</span> : <span class=\"title\">ControllerBase</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> IStudentService _service;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ValuesController</span>(<span class=\"params\">IStudentService service</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        _service = service;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong></strong><figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\"><span class=\"keyword\">public</span> ActionResult&lt;IEnumerable&lt;<span class=\"keyword\">string</span>&gt;&gt; Get()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    StudentEntity entity = <span class=\"keyword\">new</span> StudentEntity();</span><br><span class=\"line\">    entity.Name = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">    entity.Age = <span class=\"number\">18</span>;</span><br><span class=\"line\">    entity.Number = <span class=\"string\">\"007\"</span>;</span><br><span class=\"line\">    entity.Sex = <span class=\"number\">0</span>;</span><br><span class=\"line\">    entity.Address = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">    _service.Insert(entity);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">string</span>[] &#123; <span class=\"string\">\"value1\"</span>, <span class=\"string\">\"value2\"</span> &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p><img src=\"/2019/07/19/net-core-sqlsugar-2/5.png\" alt=\"\"></p>\n<ul>\n<li><strong></strong><br>SqlFilterEntity</li>\n</ul>\n<p><em>SqlFilterEntity</em></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//...</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"relation\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Append</span>(<span class=\"params\"><span class=\"keyword\">string</span> filter, <span class=\"keyword\">string</span> relation = <span class=\"string\">\"and\"</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(filter))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (Filter.Length &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              Filter += relation;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          Filter += filter;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"key\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"value\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Add</span>(<span class=\"params\"><span class=\"keyword\">string</span> key, <span class=\"keyword\">object</span> <span class=\"keyword\">value</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(key) || <span class=\"keyword\">value</span> == <span class=\"literal\">null</span>)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (Value == <span class=\"literal\">null</span>)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              Value = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt;();</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (Value.ContainsKey(key))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              Value[key] = <span class=\"keyword\">value</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">else</span></span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              Value.Add(key, <span class=\"keyword\">value</span>);</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<p><em></em></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">StudentEntity entity = <span class=\"literal\">null</span>;</span><br><span class=\"line\">         SqlFilterEntity filter = <span class=\"keyword\">new</span> SqlFilterEntity();</span><br><span class=\"line\">         filter.Append(<span class=\"string\">$\"ID=@ID\"</span>);</span><br><span class=\"line\">         filter.Add(<span class=\"string\">\"@ID\"</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">         entity = _service.GetEntity(filter);</span><br><span class=\"line\">         <span class=\"keyword\">if</span> (entity != <span class=\"literal\">null</span>)</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">             entity.Name = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">             _service.Update(entity);</span><br><span class=\"line\">         &#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/07/19/net-core-sqlsugar-2/6.png\" alt=\"\"></p>\n<ul>\n<li><p><strong></strong><br><br><img src=\"/2019/07/19/net-core-sqlsugar-2/7.png\" alt=\"\"><br><img src=\"/2019/07/19/net-core-sqlsugar-2/8.png\" alt=\"\"></p>\n</li>\n<li><p><strong></strong></p>\n</li>\n</ul>\n<p>Values/{id}</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet(<span class=\"meta-string\">\"&#123;id&#125;\"</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ActionResult&lt;<span class=\"keyword\">string</span>&gt; <span class=\"title\">Get</span>(<span class=\"params\"><span class=\"keyword\">int</span> id</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> <span class=\"keyword\">value</span> = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"comment\">//value = CacheUtil.Get&lt;string&gt;(\"cachetest\");</span></span><br><span class=\"line\">    <span class=\"comment\">//value = SessionUtil.GetSession(\"test\");</span></span><br><span class=\"line\">    <span class=\"comment\">//value = CookieUtil.GetCookies(\"apirlcookietest\");</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span> count = <span class=\"number\">0</span>;</span><br><span class=\"line\">    List&lt;StudentEntity&gt; lists = _service.GetPageList(id, <span class=\"number\">10</span>, <span class=\"string\">\"\"</span>, <span class=\"literal\">null</span>, <span class=\"string\">\"\"</span>, <span class=\"keyword\">out</span> count);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">value</span> = JsonConvert.SerializeObject(lists);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">value</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/07/19/net-core-sqlsugar-2/9.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>SqlSugar<strong></strong>yy<strong>Aop</strong></p>\n"},{"title":"net core WebApiNPOI","date":"2019-10-18T06:47:36.000Z","_content":"\n### \n3.0SwaggerjsExcel**NPOI**\n\n### NPOI\n.net frameworkExcelNPOI2007net core\n\n**Util****NPOI**![](net-core-v3-npoi/1.png)\n- ****\n\nExcel\n\n1. \n2. sheetsheet\n3. sheet\n4. \n5. \n6. ///\n\nok**ExcelUtil**\n\n```csharp\n\tpublic class ExcelUtil\n    {\n        /// <summary>\n        /// ExcelSheet\n        /// </summary>\n        /// <param name=\"filePath\"></param>\n        /// <param name=\"sheetName\">Sheet</param>\n        /// <returns></returns>\n        public static DataSet ReadExcelToDataSet(string filePath, string sheetName = null)\n        {\n            if (!File.Exists(filePath))\n            {\n                LogUtil.Debug($\"{filePath}\");\n                return null;\n            }\n            //\n            FileStream fs = new FileStream(filePath, FileMode.Open, FileAccess.Read);\n            IWorkbook workbook = WorkbookFactory.Create(fs);\n            //sheet\n            ISheet sheet = null;\n            DataSet ds = new DataSet();\n            if (!string.IsNullOrEmpty(sheetName))\n            {\n                sheet = workbook.GetSheet(sheetName);\n                if (sheet == null)\n                {\n                    LogUtil.Debug($\"{filePath}sheet:{sheetName}\");\n                    return null;\n                }\n                DataTable dt = ReadExcelFunc(workbook, sheet);\n                ds.Tables.Add(dt);\n            }\n            else\n            {\n                //\n                int sheetCount = workbook.NumberOfSheets;\n                for (int i = 0; i < sheetCount; i++) {\n                    sheet = workbook.GetSheetAt(i);\n                    if (sheet != null)\n                    {\n                        DataTable dt = ReadExcelFunc(workbook, sheet);\n                        ds.Tables.Add(dt);\n                    }\n                }\n            }\n            return ds;\n        }\n\n        /// <summary>\n        /// Excel\n        /// </summary>\n        /// <param name=\"workbook\"></param>\n        /// <param name=\"sheet\">sheet</param>\n        /// <returns></returns>\n        private static DataTable ReadExcelFunc(IWorkbook workbook, ISheet sheet)\n        {\n            DataTable dt = new DataTable();\n            //\n            IRow cells = sheet.GetRow(sheet.FirstRowNum);\n            int cellsCount = cells.PhysicalNumberOfCells;\n            int emptyCount = 0;\n            int cellIndex = sheet.FirstRowNum;\n            List<string> listColumns = new List<string>();\n            bool isFindColumn = false;\n            while (!isFindColumn)\n            {\n                emptyCount = 0;\n                listColumns.Clear();\n                for (int i = 0; i < cellsCount; i++)\n                {\n                    if (string.IsNullOrEmpty(cells.GetCell(i).StringCellValue))\n                    {\n                        emptyCount++;\n                    }\n                    listColumns.Add(cells.GetCell(i).StringCellValue);\n                }\n                //\n                if (emptyCount == 0)\n                {\n                    isFindColumn = true;\n                }\n                cellIndex++;\n                cells = sheet.GetRow(cellIndex);\n            }\n\n            foreach (string columnName in listColumns)\n            {\n                if (dt.Columns.Contains(columnName))\n                {\n                    //\n                    continue;\n                }\n                dt.Columns.Add(columnName, typeof(string));\n            }\n            //\n            int rowsCount = sheet.PhysicalNumberOfRows;\n            cellIndex += 1;\n            DataRow dr = null;\n            for (int i = cellIndex; i < rowsCount; i++) {\n                cells = sheet.GetRow(i);\n                dr = dt.NewRow();\n                for (int j = 0; j < dt.Columns.Count; j++)\n                {\n                    //\n                    switch (cells.GetCell(j).CellType)\n                    {\n                        case CellType.String:\n                            dr[j] = cells.GetCell(j).StringCellValue;\n                            break;\n                        case CellType.Numeric:\n                            dr[j] = cells.GetCell(j).NumericCellValue.ToString();\n                            break;\n                        case CellType.Unknown:\n                            dr[j] = cells.GetCell(j).StringCellValue;\n                            break;\n                    }\n                }\n                dt.Rows.Add(dr);\n            }\n            return dt;\n        }\n    }\n```\n\n[net core WebApi](/2019/08/23/net-core-fileuploader-and-cors/)\n\n\n\n- ****\n\n\n\n1. sql\n2. ListDataTable\n3. sheet\n4. \n5. row\n6. \n\n\n\n```csharp\n\t\t/// <summary>\n        /// Excel\n        /// </summary>\n        /// <typeparam name=\"T\"></typeparam>\n        /// <param name=\"entities\"></param>\n        /// <param name=\"dicColumns\">,Name-></param>\n        /// <param name=\"title\"></param>\n        /// <returns></returns>\n        public static byte[] ExportExcel<T>(List<T> entities,Dictionary<string,string> dicColumns, string title = null)\n        {\n            if (entities.Count <= 0)\n            {\n                return null;\n            }\n            //HSSFWorkbook => xls\n            //XSSFWorkbook => xlsx\n            IWorkbook workbook = new XSSFWorkbook();\n            ISheet sheet = workbook.CreateSheet(\"test\");//\n            IRow cellsColumn = null;\n            IRow cellsData = null;\n            //\n            PropertyInfo[] properties = entities[0].GetType().GetProperties();\n            int cellsIndex = 0;\n            //\n            if (!string.IsNullOrEmpty(title))\n            {\n                ICellStyle style = workbook.CreateCellStyle();\n                //  \n                style.BorderBottom = BorderStyle.Dotted;\n                style.BorderLeft = BorderStyle.Hair;\n                style.BorderRight = BorderStyle.Hair;\n                style.BorderTop = BorderStyle.Dotted;\n                //  \n                style.Alignment = HorizontalAlignment.Left;\n\n                //  \n                style.VerticalAlignment = VerticalAlignment.Center;\n\n                //\n                IFont font = workbook.CreateFont();\n                font.FontHeightInPoints = 10;\n                font.FontName = \"\";\n                style.SetFont(font);\n\n                IRow cellsTitle = sheet.CreateRow(0);\n                cellsTitle.CreateCell(0).SetCellValue(title);\n                cellsTitle.RowStyle = style;\n                //\n                sheet.AddMergedRegion(new NPOI.SS.Util.CellRangeAddress(0, 1, 0, dicColumns.Count - 1));\n                cellsIndex = 2;\n            }\n            //\n            cellsColumn = sheet.CreateRow(cellsIndex);\n            int index = 0;\n            Dictionary<string, int> columns = new Dictionary<string, int>();\n            foreach (var item in dicColumns)\n            {\n                cellsColumn.CreateCell(index).SetCellValue(item.Value);\n                columns.Add(item.Value, index);\n                index++;\n            }\n            cellsIndex += 1;\n            //\n            foreach (var item in entities)\n            {\n                cellsData = sheet.CreateRow(cellsIndex);\n                for (int i = 0; i < properties.Length; i++)\n                {\n                    if (!dicColumns.ContainsKey(properties[i].Name)) continue;\n                    //ICellStyle\n                    object[] entityValues = new object[properties.Length];\n                    entityValues[i] = properties[i].GetValue(item);\n                    //\n                    index = columns[dicColumns[properties[i].Name]];\n                    cellsData.CreateCell(index).SetCellValue(entityValues[i].ToString());\n                }\n                cellsIndex++;\n            }\n\n            byte[] buffer = null;\n            using (MemoryStream ms = new MemoryStream())\n            {\n                workbook.Write(ms);\n                buffer = ms.GetBuffer();\n                ms.Close();\n            }\n\n            return buffer;\n        }\n```\n\n### \n\n\nExcel\n![](net-core-v3-npoi/2.png)\n\nSwagger\n![](net-core-v3-npoi/3.png)\n\n![](net-core-v3-npoi/4.png)\n\n![](net-core-v3-npoi/5.png)\n\n\n![](net-core-v3-npoi/6.png)\n\n### \nopenglc++qtopenglthreejsopenglnet core****","source":"_posts/net-core-v3-npoi.md","raw":"---\ntitle: net core WebApiNPOI\ndate: 2019-10-18 14:47:36\ntags: net core\ncategories: AprilBlank\n---\n\n### \n3.0SwaggerjsExcel**NPOI**\n\n### NPOI\n.net frameworkExcelNPOI2007net core\n\n**Util****NPOI**![](net-core-v3-npoi/1.png)\n- ****\n\nExcel\n\n1. \n2. sheetsheet\n3. sheet\n4. \n5. \n6. ///\n\nok**ExcelUtil**\n\n```csharp\n\tpublic class ExcelUtil\n    {\n        /// <summary>\n        /// ExcelSheet\n        /// </summary>\n        /// <param name=\"filePath\"></param>\n        /// <param name=\"sheetName\">Sheet</param>\n        /// <returns></returns>\n        public static DataSet ReadExcelToDataSet(string filePath, string sheetName = null)\n        {\n            if (!File.Exists(filePath))\n            {\n                LogUtil.Debug($\"{filePath}\");\n                return null;\n            }\n            //\n            FileStream fs = new FileStream(filePath, FileMode.Open, FileAccess.Read);\n            IWorkbook workbook = WorkbookFactory.Create(fs);\n            //sheet\n            ISheet sheet = null;\n            DataSet ds = new DataSet();\n            if (!string.IsNullOrEmpty(sheetName))\n            {\n                sheet = workbook.GetSheet(sheetName);\n                if (sheet == null)\n                {\n                    LogUtil.Debug($\"{filePath}sheet:{sheetName}\");\n                    return null;\n                }\n                DataTable dt = ReadExcelFunc(workbook, sheet);\n                ds.Tables.Add(dt);\n            }\n            else\n            {\n                //\n                int sheetCount = workbook.NumberOfSheets;\n                for (int i = 0; i < sheetCount; i++) {\n                    sheet = workbook.GetSheetAt(i);\n                    if (sheet != null)\n                    {\n                        DataTable dt = ReadExcelFunc(workbook, sheet);\n                        ds.Tables.Add(dt);\n                    }\n                }\n            }\n            return ds;\n        }\n\n        /// <summary>\n        /// Excel\n        /// </summary>\n        /// <param name=\"workbook\"></param>\n        /// <param name=\"sheet\">sheet</param>\n        /// <returns></returns>\n        private static DataTable ReadExcelFunc(IWorkbook workbook, ISheet sheet)\n        {\n            DataTable dt = new DataTable();\n            //\n            IRow cells = sheet.GetRow(sheet.FirstRowNum);\n            int cellsCount = cells.PhysicalNumberOfCells;\n            int emptyCount = 0;\n            int cellIndex = sheet.FirstRowNum;\n            List<string> listColumns = new List<string>();\n            bool isFindColumn = false;\n            while (!isFindColumn)\n            {\n                emptyCount = 0;\n                listColumns.Clear();\n                for (int i = 0; i < cellsCount; i++)\n                {\n                    if (string.IsNullOrEmpty(cells.GetCell(i).StringCellValue))\n                    {\n                        emptyCount++;\n                    }\n                    listColumns.Add(cells.GetCell(i).StringCellValue);\n                }\n                //\n                if (emptyCount == 0)\n                {\n                    isFindColumn = true;\n                }\n                cellIndex++;\n                cells = sheet.GetRow(cellIndex);\n            }\n\n            foreach (string columnName in listColumns)\n            {\n                if (dt.Columns.Contains(columnName))\n                {\n                    //\n                    continue;\n                }\n                dt.Columns.Add(columnName, typeof(string));\n            }\n            //\n            int rowsCount = sheet.PhysicalNumberOfRows;\n            cellIndex += 1;\n            DataRow dr = null;\n            for (int i = cellIndex; i < rowsCount; i++) {\n                cells = sheet.GetRow(i);\n                dr = dt.NewRow();\n                for (int j = 0; j < dt.Columns.Count; j++)\n                {\n                    //\n                    switch (cells.GetCell(j).CellType)\n                    {\n                        case CellType.String:\n                            dr[j] = cells.GetCell(j).StringCellValue;\n                            break;\n                        case CellType.Numeric:\n                            dr[j] = cells.GetCell(j).NumericCellValue.ToString();\n                            break;\n                        case CellType.Unknown:\n                            dr[j] = cells.GetCell(j).StringCellValue;\n                            break;\n                    }\n                }\n                dt.Rows.Add(dr);\n            }\n            return dt;\n        }\n    }\n```\n\n[net core WebApi](/2019/08/23/net-core-fileuploader-and-cors/)\n\n\n\n- ****\n\n\n\n1. sql\n2. ListDataTable\n3. sheet\n4. \n5. row\n6. \n\n\n\n```csharp\n\t\t/// <summary>\n        /// Excel\n        /// </summary>\n        /// <typeparam name=\"T\"></typeparam>\n        /// <param name=\"entities\"></param>\n        /// <param name=\"dicColumns\">,Name-></param>\n        /// <param name=\"title\"></param>\n        /// <returns></returns>\n        public static byte[] ExportExcel<T>(List<T> entities,Dictionary<string,string> dicColumns, string title = null)\n        {\n            if (entities.Count <= 0)\n            {\n                return null;\n            }\n            //HSSFWorkbook => xls\n            //XSSFWorkbook => xlsx\n            IWorkbook workbook = new XSSFWorkbook();\n            ISheet sheet = workbook.CreateSheet(\"test\");//\n            IRow cellsColumn = null;\n            IRow cellsData = null;\n            //\n            PropertyInfo[] properties = entities[0].GetType().GetProperties();\n            int cellsIndex = 0;\n            //\n            if (!string.IsNullOrEmpty(title))\n            {\n                ICellStyle style = workbook.CreateCellStyle();\n                //  \n                style.BorderBottom = BorderStyle.Dotted;\n                style.BorderLeft = BorderStyle.Hair;\n                style.BorderRight = BorderStyle.Hair;\n                style.BorderTop = BorderStyle.Dotted;\n                //  \n                style.Alignment = HorizontalAlignment.Left;\n\n                //  \n                style.VerticalAlignment = VerticalAlignment.Center;\n\n                //\n                IFont font = workbook.CreateFont();\n                font.FontHeightInPoints = 10;\n                font.FontName = \"\";\n                style.SetFont(font);\n\n                IRow cellsTitle = sheet.CreateRow(0);\n                cellsTitle.CreateCell(0).SetCellValue(title);\n                cellsTitle.RowStyle = style;\n                //\n                sheet.AddMergedRegion(new NPOI.SS.Util.CellRangeAddress(0, 1, 0, dicColumns.Count - 1));\n                cellsIndex = 2;\n            }\n            //\n            cellsColumn = sheet.CreateRow(cellsIndex);\n            int index = 0;\n            Dictionary<string, int> columns = new Dictionary<string, int>();\n            foreach (var item in dicColumns)\n            {\n                cellsColumn.CreateCell(index).SetCellValue(item.Value);\n                columns.Add(item.Value, index);\n                index++;\n            }\n            cellsIndex += 1;\n            //\n            foreach (var item in entities)\n            {\n                cellsData = sheet.CreateRow(cellsIndex);\n                for (int i = 0; i < properties.Length; i++)\n                {\n                    if (!dicColumns.ContainsKey(properties[i].Name)) continue;\n                    //ICellStyle\n                    object[] entityValues = new object[properties.Length];\n                    entityValues[i] = properties[i].GetValue(item);\n                    //\n                    index = columns[dicColumns[properties[i].Name]];\n                    cellsData.CreateCell(index).SetCellValue(entityValues[i].ToString());\n                }\n                cellsIndex++;\n            }\n\n            byte[] buffer = null;\n            using (MemoryStream ms = new MemoryStream())\n            {\n                workbook.Write(ms);\n                buffer = ms.GetBuffer();\n                ms.Close();\n            }\n\n            return buffer;\n        }\n```\n\n### \n\n\nExcel\n![](net-core-v3-npoi/2.png)\n\nSwagger\n![](net-core-v3-npoi/3.png)\n\n![](net-core-v3-npoi/4.png)\n\n![](net-core-v3-npoi/5.png)\n\n\n![](net-core-v3-npoi/6.png)\n\n### \nopenglc++qtopenglthreejsopenglnet core****","slug":"net-core-v3-npoi","published":1,"updated":"2019-10-29T02:28:12.302Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m45003z9sv705kdpamw","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>3.0SwaggerjsExcel<strong>NPOI</strong></p>\n<h3 id=\"NPOI\"><a href=\"#NPOI\" class=\"headerlink\" title=\"NPOI\"></a>NPOI</h3><p>.net frameworkExcelNPOI2007net core</p>\n<p><strong>Util</strong><strong>NPOI</strong><img src=\"/2019/10/18/net-core-v3-npoi/1.png\" alt=\"\"></p>\n<ul>\n<li><strong></strong></li>\n</ul>\n<p>Excel</p>\n<ol>\n<li></li>\n<li>sheetsheet</li>\n<li>sheet</li>\n<li></li>\n<li></li>\n<li>///</li>\n</ol>\n<p>ok<strong>ExcelUtil</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">ExcelUtil</span></span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> ExcelSheet</span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filePath\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"sheetName\"&gt;</span>Sheet<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> DataSet <span class=\"title\">ReadExcelToDataSet</span>(<span class=\"params\"><span class=\"keyword\">string</span> filePath, <span class=\"keyword\">string</span> sheetName = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (!File.Exists(filePath))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;filePath&#125;</span>\"</span>);</span><br><span class=\"line\">               <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"comment\">//</span></span><br><span class=\"line\">           FileStream fs = <span class=\"keyword\">new</span> FileStream(filePath, FileMode.Open, FileAccess.Read);</span><br><span class=\"line\">           IWorkbook workbook = WorkbookFactory.Create(fs);</span><br><span class=\"line\">           <span class=\"comment\">//sheet</span></span><br><span class=\"line\">           ISheet sheet = <span class=\"literal\">null</span>;</span><br><span class=\"line\">           DataSet ds = <span class=\"keyword\">new</span> DataSet();</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(sheetName))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               sheet = workbook.GetSheet(sheetName);</span><br><span class=\"line\">               <span class=\"keyword\">if</span> (sheet == <span class=\"literal\">null</span>)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;filePath&#125;</span>sheet:<span class=\"subst\">&#123;sheetName&#125;</span>\"</span>);</span><br><span class=\"line\">                   <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               DataTable dt = ReadExcelFunc(workbook, sheet);</span><br><span class=\"line\">               ds.Tables.Add(dt);</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"keyword\">else</span></span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"comment\">//</span></span><br><span class=\"line\">               <span class=\"keyword\">int</span> sheetCount = workbook.NumberOfSheets;</span><br><span class=\"line\">               <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; sheetCount; i++) &#123;</span><br><span class=\"line\">                   sheet = workbook.GetSheetAt(i);</span><br><span class=\"line\">                   <span class=\"keyword\">if</span> (sheet != <span class=\"literal\">null</span>)</span><br><span class=\"line\">                   &#123;</span><br><span class=\"line\">                       DataTable dt = ReadExcelFunc(workbook, sheet);</span><br><span class=\"line\">                       ds.Tables.Add(dt);</span><br><span class=\"line\">                   &#125;</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"keyword\">return</span> ds;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> Excel</span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"workbook\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"sheet\"&gt;</span>sheet<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> DataTable <span class=\"title\">ReadExcelFunc</span>(<span class=\"params\">IWorkbook workbook, ISheet sheet</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           DataTable dt = <span class=\"keyword\">new</span> DataTable();</span><br><span class=\"line\">           <span class=\"comment\">//</span></span><br><span class=\"line\">           IRow cells = sheet.GetRow(sheet.FirstRowNum);</span><br><span class=\"line\">           <span class=\"keyword\">int</span> cellsCount = cells.PhysicalNumberOfCells;</span><br><span class=\"line\">           <span class=\"keyword\">int</span> emptyCount = <span class=\"number\">0</span>;</span><br><span class=\"line\">           <span class=\"keyword\">int</span> cellIndex = sheet.FirstRowNum;</span><br><span class=\"line\">           List&lt;<span class=\"keyword\">string</span>&gt; listColumns = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">           <span class=\"keyword\">bool</span> isFindColumn = <span class=\"literal\">false</span>;</span><br><span class=\"line\">           <span class=\"keyword\">while</span> (!isFindColumn)</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               emptyCount = <span class=\"number\">0</span>;</span><br><span class=\"line\">               listColumns.Clear();</span><br><span class=\"line\">               <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; cellsCount; i++)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(cells.GetCell(i).StringCellValue))</span><br><span class=\"line\">                   &#123;</span><br><span class=\"line\">                       emptyCount++;</span><br><span class=\"line\">                   &#125;</span><br><span class=\"line\">                   listColumns.Add(cells.GetCell(i).StringCellValue);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               <span class=\"comment\">//</span></span><br><span class=\"line\">               <span class=\"keyword\">if</span> (emptyCount == <span class=\"number\">0</span>)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   isFindColumn = <span class=\"literal\">true</span>;</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               cellIndex++;</span><br><span class=\"line\">               cells = sheet.GetRow(cellIndex);</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">           <span class=\"keyword\">foreach</span> (<span class=\"keyword\">string</span> columnName <span class=\"keyword\">in</span> listColumns)</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"keyword\">if</span> (dt.Columns.Contains(columnName))</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   <span class=\"comment\">//</span></span><br><span class=\"line\">                   <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               dt.Columns.Add(columnName, <span class=\"keyword\">typeof</span>(<span class=\"keyword\">string</span>));</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"comment\">//</span></span><br><span class=\"line\">           <span class=\"keyword\">int</span> rowsCount = sheet.PhysicalNumberOfRows;</span><br><span class=\"line\">           cellIndex += <span class=\"number\">1</span>;</span><br><span class=\"line\">           DataRow dr = <span class=\"literal\">null</span>;</span><br><span class=\"line\">           <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = cellIndex; i &lt; rowsCount; i++) &#123;</span><br><span class=\"line\">               cells = sheet.GetRow(i);</span><br><span class=\"line\">               dr = dt.NewRow();</span><br><span class=\"line\">               <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; dt.Columns.Count; j++)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   <span class=\"comment\">//</span></span><br><span class=\"line\">                   <span class=\"keyword\">switch</span> (cells.GetCell(j).CellType)</span><br><span class=\"line\">                   &#123;</span><br><span class=\"line\">                       <span class=\"keyword\">case</span> CellType.String:</span><br><span class=\"line\">                           dr[j] = cells.GetCell(j).StringCellValue;</span><br><span class=\"line\">                           <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                       <span class=\"keyword\">case</span> CellType.Numeric:</span><br><span class=\"line\">                           dr[j] = cells.GetCell(j).NumericCellValue.ToString();</span><br><span class=\"line\">                           <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                       <span class=\"keyword\">case</span> CellType.Unknown:</span><br><span class=\"line\">                           dr[j] = cells.GetCell(j).StringCellValue;</span><br><span class=\"line\">                           <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                   &#125;</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               dt.Rows.Add(dr);</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"keyword\">return</span> dt;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"/2019/08/23/net-core-fileuploader-and-cors/\">net core WebApi</a></p>\n<p></p>\n<ul>\n<li><strong></strong></li>\n</ul>\n<p></p>\n<ol>\n<li>sql</li>\n<li>ListDataTable</li>\n<li>sheet</li>\n<li></li>\n<li>row</li>\n<li></li>\n</ol>\n<p></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> Excel</span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;typeparam name=\"T\"&gt;</span><span class=\"doctag\">&lt;/typeparam&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"entities\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"dicColumns\"&gt;</span>,Name-&gt;<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"title\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">      <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span>[] ExportExcel&lt;T&gt;(List&lt;T&gt; entities,Dictionary&lt;<span class=\"keyword\">string</span>,<span class=\"keyword\">string</span>&gt; dicColumns, <span class=\"keyword\">string</span> title = <span class=\"literal\">null</span>)</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (entities.Count &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"comment\">//HSSFWorkbook =&gt; xls</span></span><br><span class=\"line\">          <span class=\"comment\">//XSSFWorkbook =&gt; xlsx</span></span><br><span class=\"line\">          IWorkbook workbook = <span class=\"keyword\">new</span> XSSFWorkbook();</span><br><span class=\"line\">          ISheet sheet = workbook.CreateSheet(<span class=\"string\">\"test\"</span>);<span class=\"comment\">//</span></span><br><span class=\"line\">          IRow cellsColumn = <span class=\"literal\">null</span>;</span><br><span class=\"line\">          IRow cellsData = <span class=\"literal\">null</span>;</span><br><span class=\"line\">          <span class=\"comment\">//</span></span><br><span class=\"line\">          PropertyInfo[] properties = entities[<span class=\"number\">0</span>].GetType().GetProperties();</span><br><span class=\"line\">          <span class=\"keyword\">int</span> cellsIndex = <span class=\"number\">0</span>;</span><br><span class=\"line\">          <span class=\"comment\">//</span></span><br><span class=\"line\">          <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(title))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              ICellStyle style = workbook.CreateCellStyle();</span><br><span class=\"line\">              <span class=\"comment\">//  </span></span><br><span class=\"line\">              style.BorderBottom = BorderStyle.Dotted;</span><br><span class=\"line\">              style.BorderLeft = BorderStyle.Hair;</span><br><span class=\"line\">              style.BorderRight = BorderStyle.Hair;</span><br><span class=\"line\">              style.BorderTop = BorderStyle.Dotted;</span><br><span class=\"line\">              <span class=\"comment\">//  </span></span><br><span class=\"line\">              style.Alignment = HorizontalAlignment.Left;</span><br><span class=\"line\"></span><br><span class=\"line\">              <span class=\"comment\">//  </span></span><br><span class=\"line\">              style.VerticalAlignment = VerticalAlignment.Center;</span><br><span class=\"line\"></span><br><span class=\"line\">              <span class=\"comment\">//</span></span><br><span class=\"line\">              IFont font = workbook.CreateFont();</span><br><span class=\"line\">              font.FontHeightInPoints = <span class=\"number\">10</span>;</span><br><span class=\"line\">              font.FontName = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">              style.SetFont(font);</span><br><span class=\"line\"></span><br><span class=\"line\">              IRow cellsTitle = sheet.CreateRow(<span class=\"number\">0</span>);</span><br><span class=\"line\">              cellsTitle.CreateCell(<span class=\"number\">0</span>).SetCellValue(title);</span><br><span class=\"line\">              cellsTitle.RowStyle = style;</span><br><span class=\"line\">              <span class=\"comment\">//</span></span><br><span class=\"line\">              sheet.AddMergedRegion(<span class=\"keyword\">new</span> NPOI.SS.Util.CellRangeAddress(<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>, dicColumns.Count - <span class=\"number\">1</span>));</span><br><span class=\"line\">              cellsIndex = <span class=\"number\">2</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"comment\">//</span></span><br><span class=\"line\">          cellsColumn = sheet.CreateRow(cellsIndex);</span><br><span class=\"line\">          <span class=\"keyword\">int</span> index = <span class=\"number\">0</span>;</span><br><span class=\"line\">          Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">int</span>&gt; columns = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">int</span>&gt;();</span><br><span class=\"line\">          <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> item <span class=\"keyword\">in</span> dicColumns)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              cellsColumn.CreateCell(index).SetCellValue(item.Value);</span><br><span class=\"line\">              columns.Add(item.Value, index);</span><br><span class=\"line\">              index++;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          cellsIndex += <span class=\"number\">1</span>;</span><br><span class=\"line\">          <span class=\"comment\">//</span></span><br><span class=\"line\">          <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> item <span class=\"keyword\">in</span> entities)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              cellsData = sheet.CreateRow(cellsIndex);</span><br><span class=\"line\">              <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; properties.Length; i++)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  <span class=\"keyword\">if</span> (!dicColumns.ContainsKey(properties[i].Name)) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                  <span class=\"comment\">//ICellStyle</span></span><br><span class=\"line\">                  <span class=\"keyword\">object</span>[] entityValues = <span class=\"keyword\">new</span> <span class=\"keyword\">object</span>[properties.Length];</span><br><span class=\"line\">                  entityValues[i] = properties[i].GetValue(item);</span><br><span class=\"line\">                  <span class=\"comment\">//</span></span><br><span class=\"line\">                  index = columns[dicColumns[properties[i].Name]];</span><br><span class=\"line\">                  cellsData.CreateCell(index).SetCellValue(entityValues[i].ToString());</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              cellsIndex++;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"keyword\">byte</span>[] buffer = <span class=\"literal\">null</span>;</span><br><span class=\"line\">          <span class=\"keyword\">using</span> (MemoryStream ms = <span class=\"keyword\">new</span> MemoryStream())</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              workbook.Write(ms);</span><br><span class=\"line\">              buffer = ms.GetBuffer();</span><br><span class=\"line\">              ms.Close();</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"keyword\">return</span> buffer;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>Excel<br><img src=\"/2019/10/18/net-core-v3-npoi/2.png\" alt=\"\"></p>\n<p>Swagger<br><img src=\"/2019/10/18/net-core-v3-npoi/3.png\" alt=\"\"><br><br><img src=\"/2019/10/18/net-core-v3-npoi/4.png\" alt=\"\"></p>\n<p><img src=\"/2019/10/18/net-core-v3-npoi/5.png\" alt=\"\"></p>\n<p><br><img src=\"/2019/10/18/net-core-v3-npoi/6.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>openglc++qtopenglthreejsopenglnet core<strong></strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>3.0SwaggerjsExcel<strong>NPOI</strong></p>\n<h3 id=\"NPOI\"><a href=\"#NPOI\" class=\"headerlink\" title=\"NPOI\"></a>NPOI</h3><p>.net frameworkExcelNPOI2007net core</p>\n<p><strong>Util</strong><strong>NPOI</strong><img src=\"/2019/10/18/net-core-v3-npoi/1.png\" alt=\"\"></p>\n<ul>\n<li><strong></strong></li>\n</ul>\n<p>Excel</p>\n<ol>\n<li></li>\n<li>sheetsheet</li>\n<li>sheet</li>\n<li></li>\n<li></li>\n<li>///</li>\n</ol>\n<p>ok<strong>ExcelUtil</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">ExcelUtil</span></span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> ExcelSheet</span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filePath\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"sheetName\"&gt;</span>Sheet<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> DataSet <span class=\"title\">ReadExcelToDataSet</span>(<span class=\"params\"><span class=\"keyword\">string</span> filePath, <span class=\"keyword\">string</span> sheetName = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (!File.Exists(filePath))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;filePath&#125;</span>\"</span>);</span><br><span class=\"line\">               <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"comment\">//</span></span><br><span class=\"line\">           FileStream fs = <span class=\"keyword\">new</span> FileStream(filePath, FileMode.Open, FileAccess.Read);</span><br><span class=\"line\">           IWorkbook workbook = WorkbookFactory.Create(fs);</span><br><span class=\"line\">           <span class=\"comment\">//sheet</span></span><br><span class=\"line\">           ISheet sheet = <span class=\"literal\">null</span>;</span><br><span class=\"line\">           DataSet ds = <span class=\"keyword\">new</span> DataSet();</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(sheetName))</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               sheet = workbook.GetSheet(sheetName);</span><br><span class=\"line\">               <span class=\"keyword\">if</span> (sheet == <span class=\"literal\">null</span>)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;filePath&#125;</span>sheet:<span class=\"subst\">&#123;sheetName&#125;</span>\"</span>);</span><br><span class=\"line\">                   <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               DataTable dt = ReadExcelFunc(workbook, sheet);</span><br><span class=\"line\">               ds.Tables.Add(dt);</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"keyword\">else</span></span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"comment\">//</span></span><br><span class=\"line\">               <span class=\"keyword\">int</span> sheetCount = workbook.NumberOfSheets;</span><br><span class=\"line\">               <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; sheetCount; i++) &#123;</span><br><span class=\"line\">                   sheet = workbook.GetSheetAt(i);</span><br><span class=\"line\">                   <span class=\"keyword\">if</span> (sheet != <span class=\"literal\">null</span>)</span><br><span class=\"line\">                   &#123;</span><br><span class=\"line\">                       DataTable dt = ReadExcelFunc(workbook, sheet);</span><br><span class=\"line\">                       ds.Tables.Add(dt);</span><br><span class=\"line\">                   &#125;</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"keyword\">return</span> ds;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> Excel</span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"workbook\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"sheet\"&gt;</span>sheet<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> DataTable <span class=\"title\">ReadExcelFunc</span>(<span class=\"params\">IWorkbook workbook, ISheet sheet</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           DataTable dt = <span class=\"keyword\">new</span> DataTable();</span><br><span class=\"line\">           <span class=\"comment\">//</span></span><br><span class=\"line\">           IRow cells = sheet.GetRow(sheet.FirstRowNum);</span><br><span class=\"line\">           <span class=\"keyword\">int</span> cellsCount = cells.PhysicalNumberOfCells;</span><br><span class=\"line\">           <span class=\"keyword\">int</span> emptyCount = <span class=\"number\">0</span>;</span><br><span class=\"line\">           <span class=\"keyword\">int</span> cellIndex = sheet.FirstRowNum;</span><br><span class=\"line\">           List&lt;<span class=\"keyword\">string</span>&gt; listColumns = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">           <span class=\"keyword\">bool</span> isFindColumn = <span class=\"literal\">false</span>;</span><br><span class=\"line\">           <span class=\"keyword\">while</span> (!isFindColumn)</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               emptyCount = <span class=\"number\">0</span>;</span><br><span class=\"line\">               listColumns.Clear();</span><br><span class=\"line\">               <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; cellsCount; i++)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(cells.GetCell(i).StringCellValue))</span><br><span class=\"line\">                   &#123;</span><br><span class=\"line\">                       emptyCount++;</span><br><span class=\"line\">                   &#125;</span><br><span class=\"line\">                   listColumns.Add(cells.GetCell(i).StringCellValue);</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               <span class=\"comment\">//</span></span><br><span class=\"line\">               <span class=\"keyword\">if</span> (emptyCount == <span class=\"number\">0</span>)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   isFindColumn = <span class=\"literal\">true</span>;</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               cellIndex++;</span><br><span class=\"line\">               cells = sheet.GetRow(cellIndex);</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">           <span class=\"keyword\">foreach</span> (<span class=\"keyword\">string</span> columnName <span class=\"keyword\">in</span> listColumns)</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"keyword\">if</span> (dt.Columns.Contains(columnName))</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   <span class=\"comment\">//</span></span><br><span class=\"line\">                   <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               dt.Columns.Add(columnName, <span class=\"keyword\">typeof</span>(<span class=\"keyword\">string</span>));</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"comment\">//</span></span><br><span class=\"line\">           <span class=\"keyword\">int</span> rowsCount = sheet.PhysicalNumberOfRows;</span><br><span class=\"line\">           cellIndex += <span class=\"number\">1</span>;</span><br><span class=\"line\">           DataRow dr = <span class=\"literal\">null</span>;</span><br><span class=\"line\">           <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = cellIndex; i &lt; rowsCount; i++) &#123;</span><br><span class=\"line\">               cells = sheet.GetRow(i);</span><br><span class=\"line\">               dr = dt.NewRow();</span><br><span class=\"line\">               <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; dt.Columns.Count; j++)</span><br><span class=\"line\">               &#123;</span><br><span class=\"line\">                   <span class=\"comment\">//</span></span><br><span class=\"line\">                   <span class=\"keyword\">switch</span> (cells.GetCell(j).CellType)</span><br><span class=\"line\">                   &#123;</span><br><span class=\"line\">                       <span class=\"keyword\">case</span> CellType.String:</span><br><span class=\"line\">                           dr[j] = cells.GetCell(j).StringCellValue;</span><br><span class=\"line\">                           <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                       <span class=\"keyword\">case</span> CellType.Numeric:</span><br><span class=\"line\">                           dr[j] = cells.GetCell(j).NumericCellValue.ToString();</span><br><span class=\"line\">                           <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                       <span class=\"keyword\">case</span> CellType.Unknown:</span><br><span class=\"line\">                           dr[j] = cells.GetCell(j).StringCellValue;</span><br><span class=\"line\">                           <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                   &#125;</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">               dt.Rows.Add(dr);</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"keyword\">return</span> dt;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"/2019/08/23/net-core-fileuploader-and-cors/\">net core WebApi</a></p>\n<p></p>\n<ul>\n<li><strong></strong></li>\n</ul>\n<p></p>\n<ol>\n<li>sql</li>\n<li>ListDataTable</li>\n<li>sheet</li>\n<li></li>\n<li>row</li>\n<li></li>\n</ol>\n<p></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> Excel</span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;typeparam name=\"T\"&gt;</span><span class=\"doctag\">&lt;/typeparam&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"entities\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"dicColumns\"&gt;</span>,Name-&gt;<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"title\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">      <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span>[] ExportExcel&lt;T&gt;(List&lt;T&gt; entities,Dictionary&lt;<span class=\"keyword\">string</span>,<span class=\"keyword\">string</span>&gt; dicColumns, <span class=\"keyword\">string</span> title = <span class=\"literal\">null</span>)</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (entities.Count &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"comment\">//HSSFWorkbook =&gt; xls</span></span><br><span class=\"line\">          <span class=\"comment\">//XSSFWorkbook =&gt; xlsx</span></span><br><span class=\"line\">          IWorkbook workbook = <span class=\"keyword\">new</span> XSSFWorkbook();</span><br><span class=\"line\">          ISheet sheet = workbook.CreateSheet(<span class=\"string\">\"test\"</span>);<span class=\"comment\">//</span></span><br><span class=\"line\">          IRow cellsColumn = <span class=\"literal\">null</span>;</span><br><span class=\"line\">          IRow cellsData = <span class=\"literal\">null</span>;</span><br><span class=\"line\">          <span class=\"comment\">//</span></span><br><span class=\"line\">          PropertyInfo[] properties = entities[<span class=\"number\">0</span>].GetType().GetProperties();</span><br><span class=\"line\">          <span class=\"keyword\">int</span> cellsIndex = <span class=\"number\">0</span>;</span><br><span class=\"line\">          <span class=\"comment\">//</span></span><br><span class=\"line\">          <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(title))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              ICellStyle style = workbook.CreateCellStyle();</span><br><span class=\"line\">              <span class=\"comment\">//  </span></span><br><span class=\"line\">              style.BorderBottom = BorderStyle.Dotted;</span><br><span class=\"line\">              style.BorderLeft = BorderStyle.Hair;</span><br><span class=\"line\">              style.BorderRight = BorderStyle.Hair;</span><br><span class=\"line\">              style.BorderTop = BorderStyle.Dotted;</span><br><span class=\"line\">              <span class=\"comment\">//  </span></span><br><span class=\"line\">              style.Alignment = HorizontalAlignment.Left;</span><br><span class=\"line\"></span><br><span class=\"line\">              <span class=\"comment\">//  </span></span><br><span class=\"line\">              style.VerticalAlignment = VerticalAlignment.Center;</span><br><span class=\"line\"></span><br><span class=\"line\">              <span class=\"comment\">//</span></span><br><span class=\"line\">              IFont font = workbook.CreateFont();</span><br><span class=\"line\">              font.FontHeightInPoints = <span class=\"number\">10</span>;</span><br><span class=\"line\">              font.FontName = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">              style.SetFont(font);</span><br><span class=\"line\"></span><br><span class=\"line\">              IRow cellsTitle = sheet.CreateRow(<span class=\"number\">0</span>);</span><br><span class=\"line\">              cellsTitle.CreateCell(<span class=\"number\">0</span>).SetCellValue(title);</span><br><span class=\"line\">              cellsTitle.RowStyle = style;</span><br><span class=\"line\">              <span class=\"comment\">//</span></span><br><span class=\"line\">              sheet.AddMergedRegion(<span class=\"keyword\">new</span> NPOI.SS.Util.CellRangeAddress(<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>, dicColumns.Count - <span class=\"number\">1</span>));</span><br><span class=\"line\">              cellsIndex = <span class=\"number\">2</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"comment\">//</span></span><br><span class=\"line\">          cellsColumn = sheet.CreateRow(cellsIndex);</span><br><span class=\"line\">          <span class=\"keyword\">int</span> index = <span class=\"number\">0</span>;</span><br><span class=\"line\">          Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">int</span>&gt; columns = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">int</span>&gt;();</span><br><span class=\"line\">          <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> item <span class=\"keyword\">in</span> dicColumns)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              cellsColumn.CreateCell(index).SetCellValue(item.Value);</span><br><span class=\"line\">              columns.Add(item.Value, index);</span><br><span class=\"line\">              index++;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          cellsIndex += <span class=\"number\">1</span>;</span><br><span class=\"line\">          <span class=\"comment\">//</span></span><br><span class=\"line\">          <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> item <span class=\"keyword\">in</span> entities)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              cellsData = sheet.CreateRow(cellsIndex);</span><br><span class=\"line\">              <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; properties.Length; i++)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  <span class=\"keyword\">if</span> (!dicColumns.ContainsKey(properties[i].Name)) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                  <span class=\"comment\">//ICellStyle</span></span><br><span class=\"line\">                  <span class=\"keyword\">object</span>[] entityValues = <span class=\"keyword\">new</span> <span class=\"keyword\">object</span>[properties.Length];</span><br><span class=\"line\">                  entityValues[i] = properties[i].GetValue(item);</span><br><span class=\"line\">                  <span class=\"comment\">//</span></span><br><span class=\"line\">                  index = columns[dicColumns[properties[i].Name]];</span><br><span class=\"line\">                  cellsData.CreateCell(index).SetCellValue(entityValues[i].ToString());</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              cellsIndex++;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"keyword\">byte</span>[] buffer = <span class=\"literal\">null</span>;</span><br><span class=\"line\">          <span class=\"keyword\">using</span> (MemoryStream ms = <span class=\"keyword\">new</span> MemoryStream())</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              workbook.Write(ms);</span><br><span class=\"line\">              buffer = ms.GetBuffer();</span><br><span class=\"line\">              ms.Close();</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"keyword\">return</span> buffer;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>Excel<br><img src=\"/2019/10/18/net-core-v3-npoi/2.png\" alt=\"\"></p>\n<p>Swagger<br><img src=\"/2019/10/18/net-core-v3-npoi/3.png\" alt=\"\"><br><br><img src=\"/2019/10/18/net-core-v3-npoi/4.png\" alt=\"\"></p>\n<p><img src=\"/2019/10/18/net-core-v3-npoi/5.png\" alt=\"\"></p>\n<p><br><img src=\"/2019/10/18/net-core-v3-npoi/6.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>openglc++qtopenglthreejsopenglnet core<strong></strong></p>\n"},{"title":"net core 3.0","date":"2019-10-29T01:37:07.000Z","_content":"\n### \nlinuxlinuxCome On\n\n### \ndotnet buildpublish\n\n\n![](net-core-v3-publish/1.png)\n![](net-core-v3-publish/2.png)\n![](net-core-v3-publish/3.png)\n> [](https://docs.microsoft.com/zh-cn/dotnet/core/deploying/#self-contained-deployments-scd)\n\n****\n\n\n- pe\n- \n- net coreruntime\n- net core\n\n\n- net core\n- net core\n\n****\n\n\n- net core\n- net core\n\n\n- \n- \n- net coreemm\n\n\n\n\n![](net-core-v3-publish/4.png)\n> April.xml\n\n### \n#### Windows\n\ndotnet\n![](net-core-v3-publish/5.png)\nhttps://localhost:5001\n![](net-core-v3-publish/6.png)\nWindows\n\n##### IIS\nIIS\n\n\n![](net-core-v3-publish/7.png)\nIISnet core[.NET Core Windows Server Hosting](https://aka.ms/dotnetcore.2.0.0-windowshosting)sdk\n\n\n![](net-core-v3-publish/8.png)\n\n\n#### Linux\nCentos 7Vmware\n\npublishlinux/www/april-webapi/linuxdotnet\n![Linux](net-core-v3-publish/9.png)\ndotnetruntimedocker\n\n```bash\n$ sudo rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm\n$ sudo yum install dotnet-sdk-3.0\n```\n\n```bash\n$ sudo rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm\n$ sudo yum install aspnetcore-runtime-3.0\n```\n\nok\n```bash\n$ cd /www/april-webapi/publish/\n```\n\ndotnet\n\n```bash\n$ dotnet April.WebApi.dll\n```\n\ndemo\n\n![](net-core-v3-publish/10.png)\n\nlib/xxxxxx.dllwindowsnet core/lib/netstandardx.x/xxx.dllwindows\n\ndll**April.WebApi.deps.json**/lib/netcore-libs/xxx.dll\n\n~[ Nate McMaster](https://natemcmaster.com/blog/2017/12/21/netcore-primitives/)**April.WebApi.runtimeconfig.json****additionalProbingPaths****April.WebApi.runtimeconfig.dev.json**\n\nok\n\n![](net-core-v3-publish/11.png)\n##### Docker\ndocker[Linux_Docker](/2019/10/28/vmare-docker/)\n\nDockerfile\n\n```bash\nFROM mcr.microsoft.com/dotnet/core/aspnet:3.0-buster-slim AS base\nWORKDIR /app\nEXPOSE 80\nEXPOSE 443\nCOPY . /app\nENTRYPOINT [\"dotnet\", \"April.WebApi.dll\"]\n```\n\n\n\n```bash\n$ docker build -t april-webapi .\n```\n\n\n\n```bash\n$ docker images\n```\n\n![](net-core-v3-publish/12.png)\n\n\n\n```bash\n$ docker run --name april-webapi-demo -d -p 8080:80 april-webapi\n$ docker ps -a\n```\n808080*april-webapi-demo*\n\n![](net-core-v3-publish/13.png)\n\nEXIT(140)emm\n\n\n```bash\n$ docker logs april-webapi-demo\n```\n\n![](net-core-v3-publish/14.png)\n\nlinuxdockerdockerDockerfile**WorkingDir**/appLet's \n\npublishpackages**April.WebApi.deps.json**/lib/netcore-libs//app/packages//app/xxxDockerfileapp\n\nbuild\n\n![](net-core-v3-publish/15.png)\n![](net-core-v3-publish/16.png)\n\n### \n> \n\nnet corelinuxwindowswindows****\n","source":"_posts/net-core-v3-publish.md","raw":"---\ntitle: net core 3.0\ndate: 2019-10-29 09:37:07\ntags: net core\ncategories: AprilBlank\n---\n\n### \nlinuxlinuxCome On\n\n### \ndotnet buildpublish\n\n\n![](net-core-v3-publish/1.png)\n![](net-core-v3-publish/2.png)\n![](net-core-v3-publish/3.png)\n> [](https://docs.microsoft.com/zh-cn/dotnet/core/deploying/#self-contained-deployments-scd)\n\n****\n\n\n- pe\n- \n- net coreruntime\n- net core\n\n\n- net core\n- net core\n\n****\n\n\n- net core\n- net core\n\n\n- \n- \n- net coreemm\n\n\n\n\n![](net-core-v3-publish/4.png)\n> April.xml\n\n### \n#### Windows\n\ndotnet\n![](net-core-v3-publish/5.png)\nhttps://localhost:5001\n![](net-core-v3-publish/6.png)\nWindows\n\n##### IIS\nIIS\n\n\n![](net-core-v3-publish/7.png)\nIISnet core[.NET Core Windows Server Hosting](https://aka.ms/dotnetcore.2.0.0-windowshosting)sdk\n\n\n![](net-core-v3-publish/8.png)\n\n\n#### Linux\nCentos 7Vmware\n\npublishlinux/www/april-webapi/linuxdotnet\n![Linux](net-core-v3-publish/9.png)\ndotnetruntimedocker\n\n```bash\n$ sudo rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm\n$ sudo yum install dotnet-sdk-3.0\n```\n\n```bash\n$ sudo rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm\n$ sudo yum install aspnetcore-runtime-3.0\n```\n\nok\n```bash\n$ cd /www/april-webapi/publish/\n```\n\ndotnet\n\n```bash\n$ dotnet April.WebApi.dll\n```\n\ndemo\n\n![](net-core-v3-publish/10.png)\n\nlib/xxxxxx.dllwindowsnet core/lib/netstandardx.x/xxx.dllwindows\n\ndll**April.WebApi.deps.json**/lib/netcore-libs/xxx.dll\n\n~[ Nate McMaster](https://natemcmaster.com/blog/2017/12/21/netcore-primitives/)**April.WebApi.runtimeconfig.json****additionalProbingPaths****April.WebApi.runtimeconfig.dev.json**\n\nok\n\n![](net-core-v3-publish/11.png)\n##### Docker\ndocker[Linux_Docker](/2019/10/28/vmare-docker/)\n\nDockerfile\n\n```bash\nFROM mcr.microsoft.com/dotnet/core/aspnet:3.0-buster-slim AS base\nWORKDIR /app\nEXPOSE 80\nEXPOSE 443\nCOPY . /app\nENTRYPOINT [\"dotnet\", \"April.WebApi.dll\"]\n```\n\n\n\n```bash\n$ docker build -t april-webapi .\n```\n\n\n\n```bash\n$ docker images\n```\n\n![](net-core-v3-publish/12.png)\n\n\n\n```bash\n$ docker run --name april-webapi-demo -d -p 8080:80 april-webapi\n$ docker ps -a\n```\n808080*april-webapi-demo*\n\n![](net-core-v3-publish/13.png)\n\nEXIT(140)emm\n\n\n```bash\n$ docker logs april-webapi-demo\n```\n\n![](net-core-v3-publish/14.png)\n\nlinuxdockerdockerDockerfile**WorkingDir**/appLet's \n\npublishpackages**April.WebApi.deps.json**/lib/netcore-libs//app/packages//app/xxxDockerfileapp\n\nbuild\n\n![](net-core-v3-publish/15.png)\n![](net-core-v3-publish/16.png)\n\n### \n> \n\nnet corelinuxwindowswindows****\n","slug":"net-core-v3-publish","published":1,"updated":"2019-10-29T02:41:08.710Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m4a00429sv7sm6pkc9j","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>linuxlinuxCome On</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>dotnet buildpublish</p>\n<p><br><img src=\"/2019/10/29/net-core-v3-publish/1.png\" alt=\"\"><br><img src=\"/2019/10/29/net-core-v3-publish/2.png\" alt=\"\"><br><img src=\"/2019/10/29/net-core-v3-publish/3.png\" alt=\"\"></p>\n<blockquote>\n<p><a href=\"https://docs.microsoft.com/zh-cn/dotnet/core/deploying/#self-contained-deployments-scd\" target=\"_blank\" rel=\"noopener\"></a></p>\n</blockquote>\n<p><strong></strong></p>\n<p></p>\n<ul>\n<li>pe</li>\n<li></li>\n<li>net coreruntime</li>\n<li>net core</li>\n</ul>\n<p></p>\n<ul>\n<li>net core</li>\n<li>net core</li>\n</ul>\n<p><strong></strong></p>\n<p></p>\n<ul>\n<li>net core</li>\n<li>net core</li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li>net coreemm</li>\n</ul>\n<p></p>\n<p><br><img src=\"/2019/10/29/net-core-v3-publish/4.png\" alt=\"\"></p>\n<blockquote>\n<p>April.xml</p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"Windows\"><a href=\"#Windows\" class=\"headerlink\" title=\"Windows\"></a>Windows</h4><p>dotnet<br><img src=\"/2019/10/29/net-core-v3-publish/5.png\" alt=\"\"><br><a href=\"https://localhost:5001\" target=\"_blank\" rel=\"noopener\">https://localhost:5001</a><br><img src=\"/2019/10/29/net-core-v3-publish/6.png\" alt=\"\"><br>Windows</p>\n<h5 id=\"IIS\"><a href=\"#IIS\" class=\"headerlink\" title=\"IIS\"></a>IIS</h5><p>IIS</p>\n<p><br><img src=\"/2019/10/29/net-core-v3-publish/7.png\" alt=\"\"><br>IISnet core<a href=\"https://aka.ms/dotnetcore.2.0.0-windowshosting\" target=\"_blank\" rel=\"noopener\">.NET Core Windows Server Hosting</a>sdk</p>\n<p><br><img src=\"/2019/10/29/net-core-v3-publish/8.png\" alt=\"\"><br></p>\n<h4 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux\"></a>Linux</h4><p>Centos 7Vmware</p>\n<p>publishlinux/www/april-webapi/linuxdotnet<br><img src=\"/2019/10/29/net-core-v3-publish/9.png\" alt=\"Linux\"><br>dotnetruntimedocker</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm</span><br><span class=\"line\">$ sudo yum install dotnet-sdk-3.0</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm</span><br><span class=\"line\">$ sudo yum install aspnetcore-runtime-3.0</span><br></pre></td></tr></table></figure>\n\n<p>ok</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> /www/april-webapi/publish/</span><br></pre></td></tr></table></figure>\n\n<p>dotnet</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ dotnet April.WebApi.dll</span><br></pre></td></tr></table></figure>\n\n<p>demo</p>\n<p><img src=\"/2019/10/29/net-core-v3-publish/10.png\" alt=\"\"></p>\n<p>lib/xxxxxx.dllwindowsnet core/lib/netstandardx.x/xxx.dllwindows</p>\n<p>dll<strong>April.WebApi.deps.json</strong>/lib/netcore-libs/xxx.dll</p>\n<p>~<a href=\"https://natemcmaster.com/blog/2017/12/21/netcore-primitives/\" target=\"_blank\" rel=\"noopener\"> Nate McMaster</a><strong>April.WebApi.runtimeconfig.json</strong><strong>additionalProbingPaths</strong><strong>April.WebApi.runtimeconfig.dev.json</strong></p>\n<p>ok</p>\n<p><img src=\"/2019/10/29/net-core-v3-publish/11.png\" alt=\"\"></p>\n<h5 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h5><p>docker<a href=\"/2019/10/28/vmare-docker/\">Linux_Docker</a></p>\n<p>Dockerfile</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FROM mcr.microsoft.com/dotnet/core/aspnet:3.0-buster-slim AS base</span><br><span class=\"line\">WORKDIR /app</span><br><span class=\"line\">EXPOSE 80</span><br><span class=\"line\">EXPOSE 443</span><br><span class=\"line\">COPY . /app</span><br><span class=\"line\">ENTRYPOINT [<span class=\"string\">\"dotnet\"</span>, <span class=\"string\">\"April.WebApi.dll\"</span>]</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ docker build -t april-webapi .</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ docker images</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/10/29/net-core-v3-publish/12.png\" alt=\"\"></p>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ docker run --name april-webapi-demo -d -p 8080:80 april-webapi</span><br><span class=\"line\">$ docker ps -a</span><br></pre></td></tr></table></figure>\n\n<p>808080<em>april-webapi-demo</em></p>\n<p><img src=\"/2019/10/29/net-core-v3-publish/13.png\" alt=\"\"></p>\n<p>EXIT(140)emm</p>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ docker logs april-webapi-demo</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/10/29/net-core-v3-publish/14.png\" alt=\"\"></p>\n<p>linuxdockerdockerDockerfile<strong>WorkingDir</strong>/appLets </p>\n<p>publishpackages<strong>April.WebApi.deps.json</strong>/lib/netcore-libs//app/packages//app/xxxDockerfileapp</p>\n<p>build</p>\n<p><img src=\"/2019/10/29/net-core-v3-publish/15.png\" alt=\"\"><br><img src=\"/2019/10/29/net-core-v3-publish/16.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p></p>\n</blockquote>\n<p>net corelinuxwindowswindows<strong></strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>linuxlinuxCome On</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>dotnet buildpublish</p>\n<p><br><img src=\"/2019/10/29/net-core-v3-publish/1.png\" alt=\"\"><br><img src=\"/2019/10/29/net-core-v3-publish/2.png\" alt=\"\"><br><img src=\"/2019/10/29/net-core-v3-publish/3.png\" alt=\"\"></p>\n<blockquote>\n<p><a href=\"https://docs.microsoft.com/zh-cn/dotnet/core/deploying/#self-contained-deployments-scd\" target=\"_blank\" rel=\"noopener\"></a></p>\n</blockquote>\n<p><strong></strong></p>\n<p></p>\n<ul>\n<li>pe</li>\n<li></li>\n<li>net coreruntime</li>\n<li>net core</li>\n</ul>\n<p></p>\n<ul>\n<li>net core</li>\n<li>net core</li>\n</ul>\n<p><strong></strong></p>\n<p></p>\n<ul>\n<li>net core</li>\n<li>net core</li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li>net coreemm</li>\n</ul>\n<p></p>\n<p><br><img src=\"/2019/10/29/net-core-v3-publish/4.png\" alt=\"\"></p>\n<blockquote>\n<p>April.xml</p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"Windows\"><a href=\"#Windows\" class=\"headerlink\" title=\"Windows\"></a>Windows</h4><p>dotnet<br><img src=\"/2019/10/29/net-core-v3-publish/5.png\" alt=\"\"><br><a href=\"https://localhost:5001\" target=\"_blank\" rel=\"noopener\">https://localhost:5001</a><br><img src=\"/2019/10/29/net-core-v3-publish/6.png\" alt=\"\"><br>Windows</p>\n<h5 id=\"IIS\"><a href=\"#IIS\" class=\"headerlink\" title=\"IIS\"></a>IIS</h5><p>IIS</p>\n<p><br><img src=\"/2019/10/29/net-core-v3-publish/7.png\" alt=\"\"><br>IISnet core<a href=\"https://aka.ms/dotnetcore.2.0.0-windowshosting\" target=\"_blank\" rel=\"noopener\">.NET Core Windows Server Hosting</a>sdk</p>\n<p><br><img src=\"/2019/10/29/net-core-v3-publish/8.png\" alt=\"\"><br></p>\n<h4 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux\"></a>Linux</h4><p>Centos 7Vmware</p>\n<p>publishlinux/www/april-webapi/linuxdotnet<br><img src=\"/2019/10/29/net-core-v3-publish/9.png\" alt=\"Linux\"><br>dotnetruntimedocker</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm</span><br><span class=\"line\">$ sudo yum install dotnet-sdk-3.0</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm</span><br><span class=\"line\">$ sudo yum install aspnetcore-runtime-3.0</span><br></pre></td></tr></table></figure>\n\n<p>ok</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> /www/april-webapi/publish/</span><br></pre></td></tr></table></figure>\n\n<p>dotnet</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ dotnet April.WebApi.dll</span><br></pre></td></tr></table></figure>\n\n<p>demo</p>\n<p><img src=\"/2019/10/29/net-core-v3-publish/10.png\" alt=\"\"></p>\n<p>lib/xxxxxx.dllwindowsnet core/lib/netstandardx.x/xxx.dllwindows</p>\n<p>dll<strong>April.WebApi.deps.json</strong>/lib/netcore-libs/xxx.dll</p>\n<p>~<a href=\"https://natemcmaster.com/blog/2017/12/21/netcore-primitives/\" target=\"_blank\" rel=\"noopener\"> Nate McMaster</a><strong>April.WebApi.runtimeconfig.json</strong><strong>additionalProbingPaths</strong><strong>April.WebApi.runtimeconfig.dev.json</strong></p>\n<p>ok</p>\n<p><img src=\"/2019/10/29/net-core-v3-publish/11.png\" alt=\"\"></p>\n<h5 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h5><p>docker<a href=\"/2019/10/28/vmare-docker/\">Linux_Docker</a></p>\n<p>Dockerfile</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FROM mcr.microsoft.com/dotnet/core/aspnet:3.0-buster-slim AS base</span><br><span class=\"line\">WORKDIR /app</span><br><span class=\"line\">EXPOSE 80</span><br><span class=\"line\">EXPOSE 443</span><br><span class=\"line\">COPY . /app</span><br><span class=\"line\">ENTRYPOINT [<span class=\"string\">\"dotnet\"</span>, <span class=\"string\">\"April.WebApi.dll\"</span>]</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ docker build -t april-webapi .</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ docker images</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/10/29/net-core-v3-publish/12.png\" alt=\"\"></p>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ docker run --name april-webapi-demo -d -p 8080:80 april-webapi</span><br><span class=\"line\">$ docker ps -a</span><br></pre></td></tr></table></figure>\n\n<p>808080<em>april-webapi-demo</em></p>\n<p><img src=\"/2019/10/29/net-core-v3-publish/13.png\" alt=\"\"></p>\n<p>EXIT(140)emm</p>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ docker logs april-webapi-demo</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/10/29/net-core-v3-publish/14.png\" alt=\"\"></p>\n<p>linuxdockerdockerDockerfile<strong>WorkingDir</strong>/appLets </p>\n<p>publishpackages<strong>April.WebApi.deps.json</strong>/lib/netcore-libs//app/packages//app/xxxDockerfileapp</p>\n<p>build</p>\n<p><img src=\"/2019/10/29/net-core-v3-publish/15.png\" alt=\"\"><br><img src=\"/2019/10/29/net-core-v3-publish/16.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p></p>\n</blockquote>\n<p>net corelinuxwindowswindows<strong></strong></p>\n"},{"title":"net core WebApiApril.Util","date":"2019-11-10T14:57:17.000Z","_content":"\n### \nUtil**** [April.Util_github](https://github.com/AprilBlank/April.Util.Public)[April.Util_gitee](https://gitee.com/AprilBlank/April.Util.Public)mark\n\n### \n[net core WebApiApril.Util](https://blog.csdn.net/weixin_44518486/article/details/102947508)**TokenUtil**\n\nwebapiIdentityJwttoken\n\n1. \n2. \n3. \n4. \n5. tokentokentoken\n6. \n\n> \n\n**AdminEntity**\n\n```csharp\n    /// <summary>\n    /// \n    /// </summary>\n    public class AdminEntity\n    {\n        private int _ID = -1;\n        private string _UserName = string.Empty;\n        private string _Avator = string.Empty;\n        private List<string> _Controllers = new List<string>();\n        private List<string> _Permissions = new List<string>();\n        private int _TokenType = 0;\n        private bool _IsSuperManager = false;\n        private List<int> _Depts = new List<int>();\n        private int _CurrentDept = -1;\n        private DateTime _ExpireTime = DateTime.Now;\n\n        /// <summary>\n        /// \n        /// </summary>\n        public int ID { get => _ID; set => _ID = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public string UserName { get => _UserName; set => _UserName = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public string Avator { get => _Avator; set => _Avator = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public List<string> Controllers { get => _Controllers; set => _Controllers = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public List<string> Permissions { get => _Permissions; set => _Permissions = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public int TokenType { get => _TokenType; set => _TokenType = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public bool IsSuperManager { get => _IsSuperManager; set => _IsSuperManager = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public List<int> Depts { get => _Depts; set => _Depts = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public int CurrentDept { get => _CurrentDept; set => _CurrentDept = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public DateTime ExpireTime { get => _ExpireTime; set => _ExpireTime = value; }\n    }\n```\n\nTokenUtiltoken{id}{ts}\n\n```csharp\n    public class TokenUtil\n    {\n        /// <summary>\n        /// token\n        /// </summary>\n        /// <returns></returns>\n        public static string GetToken(AdminEntity user, out string expiretimstamp)\n        {\n            string id = user.ID.ToString();\n            double exp = 0;\n            switch ((AprilEnums.TokenType)user.TokenType)\n            {\n                case AprilEnums.TokenType.Web:\n                    exp = AprilConfig.WebExpire;\n                    break;\n                case AprilEnums.TokenType.App:\n                    exp = AprilConfig.AppExpire;\n                    break;\n                case AprilEnums.TokenType.MiniProgram:\n                    exp = AprilConfig.MiniProgramExpire;\n                    break;\n                case AprilEnums.TokenType.Other:\n                    exp = AprilConfig.OtherExpire;\n                    break;\n            }\n            DateTime date = DateTime.Now.AddHours(exp);\n            user.ExpireTime = date;\n            double timestamp = DateUtil.ConvertToUnixTimestamp(date);\n            expiretimstamp = timestamp.ToString();\n            string token = AprilConfig.TokenSecretFormat.Replace(\"{id}\", id).Replace(\"{ts}\", expiretimstamp);\n            token = EncryptUtil.EncryptDES(token, EncryptUtil.SecurityKey);\n            //LogUtil.Debug($\"{id}token{token}\");\n            Add(token, user);\n            //\n            SetUserToken(token, user.ID);\n            return token;\n        }\n\n        /// <summary>\n        /// token\n        /// </summary>\n        /// <param name=\"token\"></param>\n        /// <returns></returns>\n        public static AdminEntity GetUserByToken(string token = \"\")\n        {\n            if (string.IsNullOrEmpty(token))\n            {\n                token = GetTokenByContent();\n            }\n            if (!string.IsNullOrEmpty(token))\n            {\n                \n                AdminEntity admin = Get(token);\n                if (admin != null)\n                {\n                    //\n                    if (admin.ExpireTime > DateTime.Now)\n                    {\n                        if (AprilConfig.AllowSliding)\n                        {\n                            //\n                            admin.ExpireTime = DateTime.Now.AddMinutes(30);\n                            //\n                            Add(token, admin);\n                        }\n                        return admin;\n                    }\n                    else\n                    {\n                        //\n                        return null;\n                    }\n                }\n            }\n            return null;\n        }\n        /// <summary>\n        /// Token\n        /// </summary>\n        /// <returns></returns>\n        public static string GetTokenByContent()\n        {\n            string token = \"\";\n            //header\n            var headers = AprilConfig.HttpCurrent.Request.Headers;\n            if (headers.ContainsKey(\"token\"))\n            {\n                token = headers[\"token\"].ToString();\n            }\n            if (string.IsNullOrEmpty(token))\n            {\n                token = CookieUtil.GetString(\"token\");\n            }\n            if (string.IsNullOrEmpty(token))\n            {\n                AprilConfig.HttpCurrent.Request.Query.TryGetValue(\"token\", out StringValues temptoken);\n                if (temptoken != StringValues.Empty)\n                {\n                    token = temptoken.ToString();\n                }\n            }\n            return token;\n        }\n        /// <summary>\n        /// Token\n        /// </summary>\n        /// <param name=\"token\"></param>\n        public static void RemoveToken(string token = \"\")\n        {\n            if (string.IsNullOrEmpty(token))\n            {\n                token = GetTokenByContent();\n            }\n            if (!string.IsNullOrEmpty(token))\n            {\n                Remove(token);\n            }\n        }\n\n        #region \n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"token\"></param>\n        /// <param name=\"userid\"></param>\n        public static void SetUserToken(string token, int userid)\n        {\n            Dictionary<int, List<string>> dicusers = CacheUtil.Get<Dictionary<int, List<string>>>(\"UserToken\");\n            if (dicusers == null)\n            {\n                dicusers = new Dictionary<int, List<string>>();\n            }\n            List<string> listtokens = new List<string>();\n            if (dicusers.ContainsKey(userid))\n            {\n                listtokens = dicusers[userid];\n                if (listtokens.Count <= 0)\n                {\n                    listtokens.Add(token);\n                }\n                else\n                {\n                    if (!AprilConfig.AllowMuiltiLogin)\n                    {\n                        foreach (var item in listtokens)\n                        {\n                            RemoveToken(item);\n                        }\n                        listtokens.Add(token);\n                    }\n                    else\n                    {\n                        bool isAdd = true;\n                        foreach (var item in listtokens)\n                        {\n                            if (item == token)\n                            {\n                                isAdd = false;\n                            }\n                        }\n                        if (isAdd)\n                        {\n                            listtokens.Add(token);\n                        }\n                    }\n                }\n            }\n            else\n            {\n\n                listtokens.Add(token);\n                dicusers.Add(userid, listtokens);\n            }\n            CacheUtil.Add(\"UserToken\", dicusers, new TimeSpan(6, 0, 0), true);\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"userid\"></param>\n        public static void RemoveUserToken(int userid)\n        {\n            Dictionary<int, List<string>> dicusers = CacheUtil.Get<Dictionary<int, List<string>>>(\"UserToken\");\n            if (dicusers != null && dicusers.Count > 0)\n            {\n                if (dicusers.ContainsKey(userid))\n                {\n                    //token\n                    var listtokens = dicusers[userid];\n                    foreach (var token in listtokens)\n                    {\n                        RemoveToken(token);\n                    }\n                    dicusers.Remove(userid);\n                }\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"userid\"></param>\n        /// <returns></returns>\n        public static List<string> GetUserToken(int userid)\n        {\n            Dictionary<int, List<string>> dicusers = CacheUtil.Get<Dictionary<int, List<string>>>(\"UserToken\");\n            List<string> lists = new List<string>();\n            if (dicusers != null && dicusers.Count > 0)\n            {\n                foreach (var item in dicusers)\n                {\n                    if (item.Key == userid)\n                    {\n                        lists = dicusers[userid];\n                        break;\n                    }\n                }\n            }\n            return lists;\n        }\n        #endregion\n\n        #region ()\n\n        private static void Add(string token,AdminEntity admin)\n        {\n            switch (AprilConfig.TokenCacheType)\n            {\n                //Cookie\n                case AprilEnums.TokenCacheType.Cookie:\n                    CookieUtil.Add(token, admin);\n                    break;\n                case AprilEnums.TokenCacheType.Cache:\n                    CacheUtil.Add(token, admin, new TimeSpan(0, 30, 0));\n                    break;\n                case AprilEnums.TokenCacheType.Session:\n                    SessionUtil.Add(token, admin);\n                    break;\n                case AprilEnums.TokenCacheType.Redis:\n                    RedisUtil.Add(token, admin);\n                    break;\n            }\n        }\n\n        private static AdminEntity Get(string token)\n        {\n            AdminEntity admin = null;\n            switch (AprilConfig.TokenCacheType)\n            {\n                case AprilEnums.TokenCacheType.Cookie:\n                    admin = CookieUtil.Get<AdminEntity>(token);\n                    break;\n                case AprilEnums.TokenCacheType.Cache:\n                    admin = CacheUtil.Get<AdminEntity>(token);\n                    break;\n                case AprilEnums.TokenCacheType.Session:\n                    admin = SessionUtil.Get<AdminEntity>(token);\n                    break;\n                case AprilEnums.TokenCacheType.Redis:\n                    admin = RedisUtil.Get<AdminEntity>(token);\n                    break;\n            }\n            return admin;\n        }\n\n        private static void Remove(string token)\n        {\n            switch (AprilConfig.TokenCacheType)\n            {\n                case AprilEnums.TokenCacheType.Cookie:\n                    CookieUtil.Remove(token);\n                    break;\n                case AprilEnums.TokenCacheType.Cache:\n                    CacheUtil.Remove(token);\n                    break;\n                case AprilEnums.TokenCacheType.Session:\n                    SessionUtil.Remove(token);\n                    break;\n                case AprilEnums.TokenCacheType.Redis:\n                    RedisUtil.Remove(token);\n                    break;\n            }\n        }\n        #endregion\n    }\n```\n\n### \n[net core WebapiAOP_Part 1](https://blog.csdn.net/weixin_44518486/article/details/97795992)too young too simple2.2\n\n```csharp\n    public class AprilAuthorizationMiddleware\n    {\n        private readonly RequestDelegate next;\n\n        public AprilAuthorizationMiddleware(RequestDelegate next)\n        {\n            this.next = next;\n        }\n\n        public Task Invoke(HttpContext context)\n        {\n            if (context.Request.Method != \"OPTIONS\")\n            {\n                string path = context.Request.Path.Value;\n                if (!AprilConfig.AllowUrl.Contains(path))\n                {\n                    //\n                    AdminEntity admin = TokenUtil.GetUserByToken();\n                    if (admin == null)\n                    {\n                        //\n                        return ResponseUtil.HandleResponse(-2, \"\");\n                    }\n                    if (!admin.IsSuperManager)\n                    {\n                        ///api/Controller/Action/api/Controller1/ConrolerInnerName/xxx/Action\n                        string[] strValues = System.Text.RegularExpressions.Regex.Split(path, \"/\");\n\n                        string controller = \"\";\n                        bool isStartApi = false;\n                        if (path.StartsWith(\"/api\"))\n                        {\n                            isStartApi = true;\n                        }\n                        for (int i = 0; i < strValues.Length; i++)\n                        {\n                            //api\n                            if (string.IsNullOrEmpty(strValues[i]) || i == strValues.Length - 1)\n                            {\n                                continue;\n                            }\n                            if (isStartApi && strValues[i] == \"api\")\n                            {\n                                continue;\n                            }\n                            if (!string.IsNullOrEmpty(controller))\n                            {\n                                controller += \"/\";\n                            }\n                            controller += strValues[i];\n                        }\n                        if (string.IsNullOrEmpty(controller))\n                        {\n                            controller = strValues[strValues.Length - 1];\n                        }\n                        if (!admin.Controllers.Contains(controller.ToLower()))\n                        {\n                            //\n                            return ResponseUtil.HandleResponse(401, \"\");\n                        }\n\n                    }\n                }\n            }\n            return next.Invoke(context);\n        }\n    }\n```\n\nOkLogin\n\n```csharp\n\t\t[HttpPost]\n        public async Task<ResponseDataEntity> Login(LoginFormEntity formEntity)\n        {\n            if (string.IsNullOrEmpty(formEntity.LoginName) || string.IsNullOrEmpty(formEntity.Password))\n            {\n                return ResponseUtil.Fail(\"\");\n            }\n            if (formEntity.LoginName == \"admin\")\n            {\n                //db\n                string password = EncryptUtil.MD5Encrypt(formEntity.Password, AprilConfig.SecurityKey);\n                if (password == \"B092956160CB0018\")\n                {\n                    //db\n                    AdminEntity admin = new AdminEntity\n                    {\n                        UserName = \"\",\n                        Avator = \"\",\n                        IsSuperManager = true,\n                        TokenType = (int)AprilEnums.TokenType.Web\n                    };\n                    string token = TokenUtil.GetToken(admin, out string expiretimestamp);\n                    int expiretime = 0;\n                    int.TryParse(expiretimestamp, out expiretime);\n                    //\n                    return ResponseUtil.Success(\"\", new { username = admin.UserName, avator = admin.Avator, token = token, expire = expiretime });\n                }\n            }\n            else if (formEntity.LoginName == \"test\")\n            {\n                //\n\t\t\t\tAdminEntity admin = new AdminEntity\n                {\n                    UserName = \"\",\n                    Avator = \"\",\n                    TokenType = (int)AprilEnums.TokenType.Web\n                };\n                admin.Controllers.Add(\"weatherforecast\");\n                admin.Permissions.Add(\"weatherforecast_log\");//_(Add,Update...)\n                string token = TokenUtil.GetToken(admin, out string expiretimestamp);\n                int expiretime = 0;\n                int.TryParse(expiretimestamp, out expiretime);\n                //\n                return ResponseUtil.Success(\"\", new { username = admin.UserName, avator = admin.Avator, token = token, expire = expiretime });\n            }\n            //\n            return ResponseUtil.Fail(\"\");\n        }\n```\n> xxxdb\n\n\n\n![](net-core-april-util-update-1/1.png)\nLoginadmin123456token\n![](net-core-april-util-update-1/2.png)\n\n![](net-core-april-util-update-1/3.png)\ntokenqueryheadertokenquery\n\n![](net-core-april-util-update-1/4.png)\n\n\n**AprilPermission**\n\n```csharp\n    public class AprilPermissionAttribute : Attribute, IActionFilter\n    {\n\n        public string Permission;\n        public string Controller;\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"_controller\"></param>\n        /// <param name=\"_permission\"></param>\n        public AprilPermissionAttribute(string _controller, string _permission)\n        {\n            Permission = _permission;\n            Controller = _controller;\n        }\n\n        public void OnActionExecuted(ActionExecutedContext context)\n        {\n            LogUtil.Debug(\"AprilPermission OnActionExecuted\");\n        }\n        public void OnActionExecuting(ActionExecutingContext context)\n        {\n            AdminEntity admin = TokenUtil.GetUserByToken();\n            if (admin == null || admin.ExpireTime <= DateTime.Now)\n            {\n                context.Result = new ObjectResult(new { msg = \"\", code = -2 });\n            }\n            if (!admin.IsSuperManager)\n            {\n                string controller_permission = $\"{Controller}_{Permission}\";\n                if (!admin.Controllers.Contains(Controller) || !admin.Permissions.Contains(controller_permission))\n                {\n                    context.Result = new ObjectResult(new { msg = \"\", code = 401 });\n                }\n            }\n        }\n    }\n```\n\ntest\n\n![](net-core-april-util-update-1/5.png)\n![](net-core-april-util-update-1/6.png)\n![](net-core-april-util-update-1/7.png)\n\n![](net-core-april-util-update-1/8.png)\n\n\n### \n**TokenUtil**\n\n","source":"_posts/net-core-april-util-update-1.md","raw":"---\ntitle: net core WebApiApril.Util\ndate: 2019-11-10 22:57:17\ntags: net core\ncategories: AprilBlank\n---\n\n### \nUtil**** [April.Util_github](https://github.com/AprilBlank/April.Util.Public)[April.Util_gitee](https://gitee.com/AprilBlank/April.Util.Public)mark\n\n### \n[net core WebApiApril.Util](https://blog.csdn.net/weixin_44518486/article/details/102947508)**TokenUtil**\n\nwebapiIdentityJwttoken\n\n1. \n2. \n3. \n4. \n5. tokentokentoken\n6. \n\n> \n\n**AdminEntity**\n\n```csharp\n    /// <summary>\n    /// \n    /// </summary>\n    public class AdminEntity\n    {\n        private int _ID = -1;\n        private string _UserName = string.Empty;\n        private string _Avator = string.Empty;\n        private List<string> _Controllers = new List<string>();\n        private List<string> _Permissions = new List<string>();\n        private int _TokenType = 0;\n        private bool _IsSuperManager = false;\n        private List<int> _Depts = new List<int>();\n        private int _CurrentDept = -1;\n        private DateTime _ExpireTime = DateTime.Now;\n\n        /// <summary>\n        /// \n        /// </summary>\n        public int ID { get => _ID; set => _ID = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public string UserName { get => _UserName; set => _UserName = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public string Avator { get => _Avator; set => _Avator = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public List<string> Controllers { get => _Controllers; set => _Controllers = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public List<string> Permissions { get => _Permissions; set => _Permissions = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public int TokenType { get => _TokenType; set => _TokenType = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public bool IsSuperManager { get => _IsSuperManager; set => _IsSuperManager = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public List<int> Depts { get => _Depts; set => _Depts = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public int CurrentDept { get => _CurrentDept; set => _CurrentDept = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public DateTime ExpireTime { get => _ExpireTime; set => _ExpireTime = value; }\n    }\n```\n\nTokenUtiltoken{id}{ts}\n\n```csharp\n    public class TokenUtil\n    {\n        /// <summary>\n        /// token\n        /// </summary>\n        /// <returns></returns>\n        public static string GetToken(AdminEntity user, out string expiretimstamp)\n        {\n            string id = user.ID.ToString();\n            double exp = 0;\n            switch ((AprilEnums.TokenType)user.TokenType)\n            {\n                case AprilEnums.TokenType.Web:\n                    exp = AprilConfig.WebExpire;\n                    break;\n                case AprilEnums.TokenType.App:\n                    exp = AprilConfig.AppExpire;\n                    break;\n                case AprilEnums.TokenType.MiniProgram:\n                    exp = AprilConfig.MiniProgramExpire;\n                    break;\n                case AprilEnums.TokenType.Other:\n                    exp = AprilConfig.OtherExpire;\n                    break;\n            }\n            DateTime date = DateTime.Now.AddHours(exp);\n            user.ExpireTime = date;\n            double timestamp = DateUtil.ConvertToUnixTimestamp(date);\n            expiretimstamp = timestamp.ToString();\n            string token = AprilConfig.TokenSecretFormat.Replace(\"{id}\", id).Replace(\"{ts}\", expiretimstamp);\n            token = EncryptUtil.EncryptDES(token, EncryptUtil.SecurityKey);\n            //LogUtil.Debug($\"{id}token{token}\");\n            Add(token, user);\n            //\n            SetUserToken(token, user.ID);\n            return token;\n        }\n\n        /// <summary>\n        /// token\n        /// </summary>\n        /// <param name=\"token\"></param>\n        /// <returns></returns>\n        public static AdminEntity GetUserByToken(string token = \"\")\n        {\n            if (string.IsNullOrEmpty(token))\n            {\n                token = GetTokenByContent();\n            }\n            if (!string.IsNullOrEmpty(token))\n            {\n                \n                AdminEntity admin = Get(token);\n                if (admin != null)\n                {\n                    //\n                    if (admin.ExpireTime > DateTime.Now)\n                    {\n                        if (AprilConfig.AllowSliding)\n                        {\n                            //\n                            admin.ExpireTime = DateTime.Now.AddMinutes(30);\n                            //\n                            Add(token, admin);\n                        }\n                        return admin;\n                    }\n                    else\n                    {\n                        //\n                        return null;\n                    }\n                }\n            }\n            return null;\n        }\n        /// <summary>\n        /// Token\n        /// </summary>\n        /// <returns></returns>\n        public static string GetTokenByContent()\n        {\n            string token = \"\";\n            //header\n            var headers = AprilConfig.HttpCurrent.Request.Headers;\n            if (headers.ContainsKey(\"token\"))\n            {\n                token = headers[\"token\"].ToString();\n            }\n            if (string.IsNullOrEmpty(token))\n            {\n                token = CookieUtil.GetString(\"token\");\n            }\n            if (string.IsNullOrEmpty(token))\n            {\n                AprilConfig.HttpCurrent.Request.Query.TryGetValue(\"token\", out StringValues temptoken);\n                if (temptoken != StringValues.Empty)\n                {\n                    token = temptoken.ToString();\n                }\n            }\n            return token;\n        }\n        /// <summary>\n        /// Token\n        /// </summary>\n        /// <param name=\"token\"></param>\n        public static void RemoveToken(string token = \"\")\n        {\n            if (string.IsNullOrEmpty(token))\n            {\n                token = GetTokenByContent();\n            }\n            if (!string.IsNullOrEmpty(token))\n            {\n                Remove(token);\n            }\n        }\n\n        #region \n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"token\"></param>\n        /// <param name=\"userid\"></param>\n        public static void SetUserToken(string token, int userid)\n        {\n            Dictionary<int, List<string>> dicusers = CacheUtil.Get<Dictionary<int, List<string>>>(\"UserToken\");\n            if (dicusers == null)\n            {\n                dicusers = new Dictionary<int, List<string>>();\n            }\n            List<string> listtokens = new List<string>();\n            if (dicusers.ContainsKey(userid))\n            {\n                listtokens = dicusers[userid];\n                if (listtokens.Count <= 0)\n                {\n                    listtokens.Add(token);\n                }\n                else\n                {\n                    if (!AprilConfig.AllowMuiltiLogin)\n                    {\n                        foreach (var item in listtokens)\n                        {\n                            RemoveToken(item);\n                        }\n                        listtokens.Add(token);\n                    }\n                    else\n                    {\n                        bool isAdd = true;\n                        foreach (var item in listtokens)\n                        {\n                            if (item == token)\n                            {\n                                isAdd = false;\n                            }\n                        }\n                        if (isAdd)\n                        {\n                            listtokens.Add(token);\n                        }\n                    }\n                }\n            }\n            else\n            {\n\n                listtokens.Add(token);\n                dicusers.Add(userid, listtokens);\n            }\n            CacheUtil.Add(\"UserToken\", dicusers, new TimeSpan(6, 0, 0), true);\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"userid\"></param>\n        public static void RemoveUserToken(int userid)\n        {\n            Dictionary<int, List<string>> dicusers = CacheUtil.Get<Dictionary<int, List<string>>>(\"UserToken\");\n            if (dicusers != null && dicusers.Count > 0)\n            {\n                if (dicusers.ContainsKey(userid))\n                {\n                    //token\n                    var listtokens = dicusers[userid];\n                    foreach (var token in listtokens)\n                    {\n                        RemoveToken(token);\n                    }\n                    dicusers.Remove(userid);\n                }\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"userid\"></param>\n        /// <returns></returns>\n        public static List<string> GetUserToken(int userid)\n        {\n            Dictionary<int, List<string>> dicusers = CacheUtil.Get<Dictionary<int, List<string>>>(\"UserToken\");\n            List<string> lists = new List<string>();\n            if (dicusers != null && dicusers.Count > 0)\n            {\n                foreach (var item in dicusers)\n                {\n                    if (item.Key == userid)\n                    {\n                        lists = dicusers[userid];\n                        break;\n                    }\n                }\n            }\n            return lists;\n        }\n        #endregion\n\n        #region ()\n\n        private static void Add(string token,AdminEntity admin)\n        {\n            switch (AprilConfig.TokenCacheType)\n            {\n                //Cookie\n                case AprilEnums.TokenCacheType.Cookie:\n                    CookieUtil.Add(token, admin);\n                    break;\n                case AprilEnums.TokenCacheType.Cache:\n                    CacheUtil.Add(token, admin, new TimeSpan(0, 30, 0));\n                    break;\n                case AprilEnums.TokenCacheType.Session:\n                    SessionUtil.Add(token, admin);\n                    break;\n                case AprilEnums.TokenCacheType.Redis:\n                    RedisUtil.Add(token, admin);\n                    break;\n            }\n        }\n\n        private static AdminEntity Get(string token)\n        {\n            AdminEntity admin = null;\n            switch (AprilConfig.TokenCacheType)\n            {\n                case AprilEnums.TokenCacheType.Cookie:\n                    admin = CookieUtil.Get<AdminEntity>(token);\n                    break;\n                case AprilEnums.TokenCacheType.Cache:\n                    admin = CacheUtil.Get<AdminEntity>(token);\n                    break;\n                case AprilEnums.TokenCacheType.Session:\n                    admin = SessionUtil.Get<AdminEntity>(token);\n                    break;\n                case AprilEnums.TokenCacheType.Redis:\n                    admin = RedisUtil.Get<AdminEntity>(token);\n                    break;\n            }\n            return admin;\n        }\n\n        private static void Remove(string token)\n        {\n            switch (AprilConfig.TokenCacheType)\n            {\n                case AprilEnums.TokenCacheType.Cookie:\n                    CookieUtil.Remove(token);\n                    break;\n                case AprilEnums.TokenCacheType.Cache:\n                    CacheUtil.Remove(token);\n                    break;\n                case AprilEnums.TokenCacheType.Session:\n                    SessionUtil.Remove(token);\n                    break;\n                case AprilEnums.TokenCacheType.Redis:\n                    RedisUtil.Remove(token);\n                    break;\n            }\n        }\n        #endregion\n    }\n```\n\n### \n[net core WebapiAOP_Part 1](https://blog.csdn.net/weixin_44518486/article/details/97795992)too young too simple2.2\n\n```csharp\n    public class AprilAuthorizationMiddleware\n    {\n        private readonly RequestDelegate next;\n\n        public AprilAuthorizationMiddleware(RequestDelegate next)\n        {\n            this.next = next;\n        }\n\n        public Task Invoke(HttpContext context)\n        {\n            if (context.Request.Method != \"OPTIONS\")\n            {\n                string path = context.Request.Path.Value;\n                if (!AprilConfig.AllowUrl.Contains(path))\n                {\n                    //\n                    AdminEntity admin = TokenUtil.GetUserByToken();\n                    if (admin == null)\n                    {\n                        //\n                        return ResponseUtil.HandleResponse(-2, \"\");\n                    }\n                    if (!admin.IsSuperManager)\n                    {\n                        ///api/Controller/Action/api/Controller1/ConrolerInnerName/xxx/Action\n                        string[] strValues = System.Text.RegularExpressions.Regex.Split(path, \"/\");\n\n                        string controller = \"\";\n                        bool isStartApi = false;\n                        if (path.StartsWith(\"/api\"))\n                        {\n                            isStartApi = true;\n                        }\n                        for (int i = 0; i < strValues.Length; i++)\n                        {\n                            //api\n                            if (string.IsNullOrEmpty(strValues[i]) || i == strValues.Length - 1)\n                            {\n                                continue;\n                            }\n                            if (isStartApi && strValues[i] == \"api\")\n                            {\n                                continue;\n                            }\n                            if (!string.IsNullOrEmpty(controller))\n                            {\n                                controller += \"/\";\n                            }\n                            controller += strValues[i];\n                        }\n                        if (string.IsNullOrEmpty(controller))\n                        {\n                            controller = strValues[strValues.Length - 1];\n                        }\n                        if (!admin.Controllers.Contains(controller.ToLower()))\n                        {\n                            //\n                            return ResponseUtil.HandleResponse(401, \"\");\n                        }\n\n                    }\n                }\n            }\n            return next.Invoke(context);\n        }\n    }\n```\n\nOkLogin\n\n```csharp\n\t\t[HttpPost]\n        public async Task<ResponseDataEntity> Login(LoginFormEntity formEntity)\n        {\n            if (string.IsNullOrEmpty(formEntity.LoginName) || string.IsNullOrEmpty(formEntity.Password))\n            {\n                return ResponseUtil.Fail(\"\");\n            }\n            if (formEntity.LoginName == \"admin\")\n            {\n                //db\n                string password = EncryptUtil.MD5Encrypt(formEntity.Password, AprilConfig.SecurityKey);\n                if (password == \"B092956160CB0018\")\n                {\n                    //db\n                    AdminEntity admin = new AdminEntity\n                    {\n                        UserName = \"\",\n                        Avator = \"\",\n                        IsSuperManager = true,\n                        TokenType = (int)AprilEnums.TokenType.Web\n                    };\n                    string token = TokenUtil.GetToken(admin, out string expiretimestamp);\n                    int expiretime = 0;\n                    int.TryParse(expiretimestamp, out expiretime);\n                    //\n                    return ResponseUtil.Success(\"\", new { username = admin.UserName, avator = admin.Avator, token = token, expire = expiretime });\n                }\n            }\n            else if (formEntity.LoginName == \"test\")\n            {\n                //\n\t\t\t\tAdminEntity admin = new AdminEntity\n                {\n                    UserName = \"\",\n                    Avator = \"\",\n                    TokenType = (int)AprilEnums.TokenType.Web\n                };\n                admin.Controllers.Add(\"weatherforecast\");\n                admin.Permissions.Add(\"weatherforecast_log\");//_(Add,Update...)\n                string token = TokenUtil.GetToken(admin, out string expiretimestamp);\n                int expiretime = 0;\n                int.TryParse(expiretimestamp, out expiretime);\n                //\n                return ResponseUtil.Success(\"\", new { username = admin.UserName, avator = admin.Avator, token = token, expire = expiretime });\n            }\n            //\n            return ResponseUtil.Fail(\"\");\n        }\n```\n> xxxdb\n\n\n\n![](net-core-april-util-update-1/1.png)\nLoginadmin123456token\n![](net-core-april-util-update-1/2.png)\n\n![](net-core-april-util-update-1/3.png)\ntokenqueryheadertokenquery\n\n![](net-core-april-util-update-1/4.png)\n\n\n**AprilPermission**\n\n```csharp\n    public class AprilPermissionAttribute : Attribute, IActionFilter\n    {\n\n        public string Permission;\n        public string Controller;\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"_controller\"></param>\n        /// <param name=\"_permission\"></param>\n        public AprilPermissionAttribute(string _controller, string _permission)\n        {\n            Permission = _permission;\n            Controller = _controller;\n        }\n\n        public void OnActionExecuted(ActionExecutedContext context)\n        {\n            LogUtil.Debug(\"AprilPermission OnActionExecuted\");\n        }\n        public void OnActionExecuting(ActionExecutingContext context)\n        {\n            AdminEntity admin = TokenUtil.GetUserByToken();\n            if (admin == null || admin.ExpireTime <= DateTime.Now)\n            {\n                context.Result = new ObjectResult(new { msg = \"\", code = -2 });\n            }\n            if (!admin.IsSuperManager)\n            {\n                string controller_permission = $\"{Controller}_{Permission}\";\n                if (!admin.Controllers.Contains(Controller) || !admin.Permissions.Contains(controller_permission))\n                {\n                    context.Result = new ObjectResult(new { msg = \"\", code = 401 });\n                }\n            }\n        }\n    }\n```\n\ntest\n\n![](net-core-april-util-update-1/5.png)\n![](net-core-april-util-update-1/6.png)\n![](net-core-april-util-update-1/7.png)\n\n![](net-core-april-util-update-1/8.png)\n\n\n### \n**TokenUtil**\n\n","slug":"net-core-april-util-update-1","published":1,"updated":"2019-11-22T02:59:38.663Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m4n004a9sv7afj5tedw","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Util<strong></strong> <a href=\"https://github.com/AprilBlank/April.Util.Public\" target=\"_blank\" rel=\"noopener\">April.Util_github</a><a href=\"https://gitee.com/AprilBlank/April.Util.Public\" target=\"_blank\" rel=\"noopener\">April.Util_gitee</a>mark</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://blog.csdn.net/weixin_44518486/article/details/102947508\" target=\"_blank\" rel=\"noopener\">net core WebApiApril.Util</a><strong>TokenUtil</strong></p>\n<p>webapiIdentityJwttoken</p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li>tokentokentoken</li>\n<li></li>\n</ol>\n<blockquote>\n<p></p>\n</blockquote>\n<p><strong>AdminEntity</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AdminEntity</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _ID = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _UserName = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Avator = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;<span class=\"keyword\">string</span>&gt; _Controllers = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;<span class=\"keyword\">string</span>&gt; _Permissions = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _TokenType = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">bool</span> _IsSuperManager = <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;<span class=\"keyword\">int</span>&gt; _Depts = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">int</span>&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _CurrentDept = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> DateTime _ExpireTime = DateTime.Now;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> ID &#123; <span class=\"keyword\">get</span> =&gt; _ID; <span class=\"keyword\">set</span> =&gt; _ID = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> UserName &#123; <span class=\"keyword\">get</span> =&gt; _UserName; <span class=\"keyword\">set</span> =&gt; _UserName = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Avator &#123; <span class=\"keyword\">get</span> =&gt; _Avator; <span class=\"keyword\">set</span> =&gt; _Avator = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;<span class=\"keyword\">string</span>&gt; Controllers &#123; <span class=\"keyword\">get</span> =&gt; _Controllers; <span class=\"keyword\">set</span> =&gt; _Controllers = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;<span class=\"keyword\">string</span>&gt; Permissions &#123; <span class=\"keyword\">get</span> =&gt; _Permissions; <span class=\"keyword\">set</span> =&gt; _Permissions = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> TokenType &#123; <span class=\"keyword\">get</span> =&gt; _TokenType; <span class=\"keyword\">set</span> =&gt; _TokenType = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">bool</span> IsSuperManager &#123; <span class=\"keyword\">get</span> =&gt; _IsSuperManager; <span class=\"keyword\">set</span> =&gt; _IsSuperManager = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;<span class=\"keyword\">int</span>&gt; Depts &#123; <span class=\"keyword\">get</span> =&gt; _Depts; <span class=\"keyword\">set</span> =&gt; _Depts = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> CurrentDept &#123; <span class=\"keyword\">get</span> =&gt; _CurrentDept; <span class=\"keyword\">set</span> =&gt; _CurrentDept = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> DateTime ExpireTime &#123; <span class=\"keyword\">get</span> =&gt; _ExpireTime; <span class=\"keyword\">set</span> =&gt; _ExpireTime = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>TokenUtiltoken{id}{ts}</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">TokenUtil</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> token</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> <span class=\"title\">GetToken</span>(<span class=\"params\">AdminEntity user, <span class=\"keyword\">out</span> <span class=\"keyword\">string</span> expiretimstamp</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">string</span> id = user.ID.ToString();</span><br><span class=\"line\">        <span class=\"keyword\">double</span> exp = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> ((AprilEnums.TokenType)user.TokenType)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenType.Web:</span><br><span class=\"line\">                exp = AprilConfig.WebExpire;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenType.App:</span><br><span class=\"line\">                exp = AprilConfig.AppExpire;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenType.MiniProgram:</span><br><span class=\"line\">                exp = AprilConfig.MiniProgramExpire;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenType.Other:</span><br><span class=\"line\">                exp = AprilConfig.OtherExpire;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        DateTime date = DateTime.Now.AddHours(exp);</span><br><span class=\"line\">        user.ExpireTime = date;</span><br><span class=\"line\">        <span class=\"keyword\">double</span> timestamp = DateUtil.ConvertToUnixTimestamp(date);</span><br><span class=\"line\">        expiretimstamp = timestamp.ToString();</span><br><span class=\"line\">        <span class=\"keyword\">string</span> token = AprilConfig.TokenSecretFormat.Replace(<span class=\"string\">\"&#123;id&#125;\"</span>, id).Replace(<span class=\"string\">\"&#123;ts&#125;\"</span>, expiretimstamp);</span><br><span class=\"line\">        token = EncryptUtil.EncryptDES(token, EncryptUtil.SecurityKey);</span><br><span class=\"line\">        <span class=\"comment\">//LogUtil.Debug($\"&#123;id&#125;token&#123;token&#125;\");</span></span><br><span class=\"line\">        Add(token, user);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        SetUserToken(token, user.ID);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> token;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> token</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"token\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> AdminEntity <span class=\"title\">GetUserByToken</span>(<span class=\"params\"><span class=\"keyword\">string</span> token = <span class=\"string\">\"\"</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(token))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            token = GetTokenByContent();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(token))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            </span><br><span class=\"line\">            AdminEntity admin = Get(token);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (admin != <span class=\"literal\">null</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">//</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (admin.ExpireTime &gt; DateTime.Now)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (AprilConfig.AllowSliding)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"comment\">//</span></span><br><span class=\"line\">                        admin.ExpireTime = DateTime.Now.AddMinutes(<span class=\"number\">30</span>);</span><br><span class=\"line\">                        <span class=\"comment\">//</span></span><br><span class=\"line\">                        Add(token, admin);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> admin;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"comment\">//</span></span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> Token</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> <span class=\"title\">GetTokenByContent</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">string</span> token = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        <span class=\"comment\">//header</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> headers = AprilConfig.HttpCurrent.Request.Headers;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (headers.ContainsKey(<span class=\"string\">\"token\"</span>))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            token = headers[<span class=\"string\">\"token\"</span>].ToString();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(token))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            token = CookieUtil.GetString(<span class=\"string\">\"token\"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(token))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            AprilConfig.HttpCurrent.Request.Query.TryGetValue(<span class=\"string\">\"token\"</span>, <span class=\"keyword\">out</span> StringValues temptoken);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (temptoken != StringValues.Empty)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                token = temptoken.ToString();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> token;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> Token</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"token\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">RemoveToken</span>(<span class=\"params\"><span class=\"keyword\">string</span> token = <span class=\"string\">\"\"</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(token))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            token = GetTokenByContent();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(token))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Remove(token);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">region</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"token\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"userid\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">SetUserToken</span>(<span class=\"params\"><span class=\"keyword\">string</span> token, <span class=\"keyword\">int</span> userid</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        Dictionary&lt;<span class=\"keyword\">int</span>, List&lt;<span class=\"keyword\">string</span>&gt;&gt; dicusers = CacheUtil.Get&lt;Dictionary&lt;<span class=\"keyword\">int</span>, List&lt;<span class=\"keyword\">string</span>&gt;&gt;&gt;(<span class=\"string\">\"UserToken\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dicusers == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            dicusers = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"keyword\">int</span>, List&lt;<span class=\"keyword\">string</span>&gt;&gt;();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        List&lt;<span class=\"keyword\">string</span>&gt; listtokens = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dicusers.ContainsKey(userid))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            listtokens = dicusers[userid];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (listtokens.Count &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                listtokens.Add(token);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!AprilConfig.AllowMuiltiLogin)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> item <span class=\"keyword\">in</span> listtokens)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        RemoveToken(item);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    listtokens.Add(token);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">bool</span> isAdd = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> item <span class=\"keyword\">in</span> listtokens)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (item == token)</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            isAdd = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (isAdd)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        listtokens.Add(token);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            listtokens.Add(token);</span><br><span class=\"line\">            dicusers.Add(userid, listtokens);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        CacheUtil.Add(<span class=\"string\">\"UserToken\"</span>, dicusers, <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">6</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>), <span class=\"literal\">true</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"userid\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">RemoveUserToken</span>(<span class=\"params\"><span class=\"keyword\">int</span> userid</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        Dictionary&lt;<span class=\"keyword\">int</span>, List&lt;<span class=\"keyword\">string</span>&gt;&gt; dicusers = CacheUtil.Get&lt;Dictionary&lt;<span class=\"keyword\">int</span>, List&lt;<span class=\"keyword\">string</span>&gt;&gt;&gt;(<span class=\"string\">\"UserToken\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dicusers != <span class=\"literal\">null</span> &amp;&amp; dicusers.Count &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dicusers.ContainsKey(userid))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">//token</span></span><br><span class=\"line\">                <span class=\"keyword\">var</span> listtokens = dicusers[userid];</span><br><span class=\"line\">                <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> token <span class=\"keyword\">in</span> listtokens)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    RemoveToken(token);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                dicusers.Remove(userid);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"userid\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> List&lt;<span class=\"keyword\">string</span>&gt; <span class=\"title\">GetUserToken</span>(<span class=\"params\"><span class=\"keyword\">int</span> userid</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        Dictionary&lt;<span class=\"keyword\">int</span>, List&lt;<span class=\"keyword\">string</span>&gt;&gt; dicusers = CacheUtil.Get&lt;Dictionary&lt;<span class=\"keyword\">int</span>, List&lt;<span class=\"keyword\">string</span>&gt;&gt;&gt;(<span class=\"string\">\"UserToken\"</span>);</span><br><span class=\"line\">        List&lt;<span class=\"keyword\">string</span>&gt; lists = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dicusers != <span class=\"literal\">null</span> &amp;&amp; dicusers.Count &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> item <span class=\"keyword\">in</span> dicusers)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (item.Key == userid)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    lists = dicusers[userid];</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lists;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">region</span> ()</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Add</span>(<span class=\"params\"><span class=\"keyword\">string</span> token,AdminEntity admin</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (AprilConfig.TokenCacheType)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">//Cookie</span></span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Cookie:</span><br><span class=\"line\">                CookieUtil.Add(token, admin);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Cache:</span><br><span class=\"line\">                CacheUtil.Add(token, admin, <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">0</span>, <span class=\"number\">30</span>, <span class=\"number\">0</span>));</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Session:</span><br><span class=\"line\">                SessionUtil.Add(token, admin);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Redis:</span><br><span class=\"line\">                RedisUtil.Add(token, admin);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> AdminEntity <span class=\"title\">Get</span>(<span class=\"params\"><span class=\"keyword\">string</span> token</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        AdminEntity admin = <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (AprilConfig.TokenCacheType)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Cookie:</span><br><span class=\"line\">                admin = CookieUtil.Get&lt;AdminEntity&gt;(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Cache:</span><br><span class=\"line\">                admin = CacheUtil.Get&lt;AdminEntity&gt;(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Session:</span><br><span class=\"line\">                admin = SessionUtil.Get&lt;AdminEntity&gt;(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Redis:</span><br><span class=\"line\">                admin = RedisUtil.Get&lt;AdminEntity&gt;(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> admin;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Remove</span>(<span class=\"params\"><span class=\"keyword\">string</span> token</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (AprilConfig.TokenCacheType)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Cookie:</span><br><span class=\"line\">                CookieUtil.Remove(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Cache:</span><br><span class=\"line\">                CacheUtil.Remove(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Session:</span><br><span class=\"line\">                SessionUtil.Remove(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Redis:</span><br><span class=\"line\">                RedisUtil.Remove(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://blog.csdn.net/weixin_44518486/article/details/97795992\" target=\"_blank\" rel=\"noopener\">net core WebapiAOP_Part 1</a>too young too simple2.2</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AprilAuthorizationMiddleware</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> RequestDelegate next;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">AprilAuthorizationMiddleware</span>(<span class=\"params\">RequestDelegate next</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.next = next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Task <span class=\"title\">Invoke</span>(<span class=\"params\">HttpContext context</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (context.Request.Method != <span class=\"string\">\"OPTIONS\"</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">string</span> path = context.Request.Path.Value;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!AprilConfig.AllowUrl.Contains(path))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">//</span></span><br><span class=\"line\">                AdminEntity admin = TokenUtil.GetUserByToken();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (admin == <span class=\"literal\">null</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"comment\">//</span></span><br><span class=\"line\">                    <span class=\"keyword\">return</span> ResponseUtil.HandleResponse(<span class=\"number\">-2</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!admin.IsSuperManager)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"comment\">///api/Controller/Action/api/Controller1/ConrolerInnerName/xxx/Action</span></span><br><span class=\"line\">                    <span class=\"keyword\">string</span>[] strValues = System.Text.RegularExpressions.Regex.Split(path, <span class=\"string\">\"/\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">                    <span class=\"keyword\">string</span> controller = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">bool</span> isStartApi = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (path.StartsWith(<span class=\"string\">\"/api\"</span>))</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        isStartApi = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; strValues.Length; i++)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"comment\">//api</span></span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(strValues[i]) || i == strValues.Length - <span class=\"number\">1</span>)</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (isStartApi &amp;&amp; strValues[i] == <span class=\"string\">\"api\"</span>)</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(controller))</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            controller += <span class=\"string\">\"/\"</span>;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        controller += strValues[i];</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(controller))</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        controller = strValues[strValues.Length - <span class=\"number\">1</span>];</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (!admin.Controllers.Contains(controller.ToLower()))</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"comment\">//</span></span><br><span class=\"line\">                        <span class=\"keyword\">return</span> ResponseUtil.HandleResponse(<span class=\"number\">401</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> next.Invoke(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>OkLogin</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpPost</span>]</span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;ResponseDataEntity&gt; <span class=\"title\">Login</span>(<span class=\"params\">LoginFormEntity formEntity</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(formEntity.LoginName) || <span class=\"keyword\">string</span>.IsNullOrEmpty(formEntity.Password))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> ResponseUtil.Fail(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (formEntity.LoginName == <span class=\"string\">\"admin\"</span>)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"comment\">//db</span></span><br><span class=\"line\">              <span class=\"keyword\">string</span> password = EncryptUtil.MD5Encrypt(formEntity.Password, AprilConfig.SecurityKey);</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (password == <span class=\"string\">\"B092956160CB0018\"</span>)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  <span class=\"comment\">//db</span></span><br><span class=\"line\">                  AdminEntity admin = <span class=\"keyword\">new</span> AdminEntity</span><br><span class=\"line\">                  &#123;</span><br><span class=\"line\">                      UserName = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">                      Avator = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">                      IsSuperManager = <span class=\"literal\">true</span>,</span><br><span class=\"line\">                      TokenType = (<span class=\"keyword\">int</span>)AprilEnums.TokenType.Web</span><br><span class=\"line\">                  &#125;;</span><br><span class=\"line\">                  <span class=\"keyword\">string</span> token = TokenUtil.GetToken(admin, <span class=\"keyword\">out</span> <span class=\"keyword\">string</span> expiretimestamp);</span><br><span class=\"line\">                  <span class=\"keyword\">int</span> expiretime = <span class=\"number\">0</span>;</span><br><span class=\"line\">                  <span class=\"keyword\">int</span>.TryParse(expiretimestamp, <span class=\"keyword\">out</span> expiretime);</span><br><span class=\"line\">                  <span class=\"comment\">//</span></span><br><span class=\"line\">                  <span class=\"keyword\">return</span> ResponseUtil.Success(<span class=\"string\">\"\"</span>, <span class=\"keyword\">new</span> &#123; username = admin.UserName, avator = admin.Avator, token = token, expire = expiretime &#125;);</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (formEntity.LoginName == <span class=\"string\">\"test\"</span>)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"comment\">//</span></span><br><span class=\"line\">\t\tAdminEntity admin = <span class=\"keyword\">new</span> AdminEntity</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  UserName = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">                  Avator = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">                  TokenType = (<span class=\"keyword\">int</span>)AprilEnums.TokenType.Web</span><br><span class=\"line\">              &#125;;</span><br><span class=\"line\">              admin.Controllers.Add(<span class=\"string\">\"weatherforecast\"</span>);</span><br><span class=\"line\">              admin.Permissions.Add(<span class=\"string\">\"weatherforecast_log\"</span>);<span class=\"comment\">//_(Add,Update...)</span></span><br><span class=\"line\">              <span class=\"keyword\">string</span> token = TokenUtil.GetToken(admin, <span class=\"keyword\">out</span> <span class=\"keyword\">string</span> expiretimestamp);</span><br><span class=\"line\">              <span class=\"keyword\">int</span> expiretime = <span class=\"number\">0</span>;</span><br><span class=\"line\">              <span class=\"keyword\">int</span>.TryParse(expiretimestamp, <span class=\"keyword\">out</span> expiretime);</span><br><span class=\"line\">              <span class=\"comment\">//</span></span><br><span class=\"line\">              <span class=\"keyword\">return</span> ResponseUtil.Success(<span class=\"string\">\"\"</span>, <span class=\"keyword\">new</span> &#123; username = admin.UserName, avator = admin.Avator, token = token, expire = expiretime &#125;);</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"comment\">//</span></span><br><span class=\"line\">          <span class=\"keyword\">return</span> ResponseUtil.Fail(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>xxxdb</p>\n</blockquote>\n<p></p>\n<p><img src=\"/2019/11/10/net-core-april-util-update-1/1.png\" alt=\"\"><br>Loginadmin123456token<br><img src=\"/2019/11/10/net-core-april-util-update-1/2.png\" alt=\"\"><br><br><img src=\"/2019/11/10/net-core-april-util-update-1/3.png\" alt=\"\"><br>tokenqueryheadertokenquery</p>\n<p><img src=\"/2019/11/10/net-core-april-util-update-1/4.png\" alt=\"\"><br></p>\n<p><strong>AprilPermission</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AprilPermissionAttribute</span> : <span class=\"title\">Attribute</span>, <span class=\"title\">IActionFilter</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Permission;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Controller;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"_controller\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"_permission\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">AprilPermissionAttribute</span>(<span class=\"params\"><span class=\"keyword\">string</span> _controller, <span class=\"keyword\">string</span> _permission</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        Permission = _permission;</span><br><span class=\"line\">        Controller = _controller;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">OnActionExecuted</span>(<span class=\"params\">ActionExecutedContext context</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        LogUtil.Debug(<span class=\"string\">\"AprilPermission OnActionExecuted\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">OnActionExecuting</span>(<span class=\"params\">ActionExecutingContext context</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        AdminEntity admin = TokenUtil.GetUserByToken();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (admin == <span class=\"literal\">null</span> || admin.ExpireTime &lt;= DateTime.Now)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            context.Result = <span class=\"keyword\">new</span> ObjectResult(<span class=\"keyword\">new</span> &#123; msg = <span class=\"string\">\"\"</span>, code = <span class=\"number\">-2</span> &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!admin.IsSuperManager)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">string</span> controller_permission = <span class=\"string\">$\"<span class=\"subst\">&#123;Controller&#125;</span>_<span class=\"subst\">&#123;Permission&#125;</span>\"</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!admin.Controllers.Contains(Controller) || !admin.Permissions.Contains(controller_permission))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                context.Result = <span class=\"keyword\">new</span> ObjectResult(<span class=\"keyword\">new</span> &#123; msg = <span class=\"string\">\"\"</span>, code = <span class=\"number\">401</span> &#125;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>test</p>\n<p><img src=\"/2019/11/10/net-core-april-util-update-1/5.png\" alt=\"\"><br><img src=\"/2019/11/10/net-core-april-util-update-1/6.png\" alt=\"\"><br><img src=\"/2019/11/10/net-core-april-util-update-1/7.png\" alt=\"\"></p>\n<p><img src=\"/2019/11/10/net-core-april-util-update-1/8.png\" alt=\"\"><br></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>TokenUtil</strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Util<strong></strong> <a href=\"https://github.com/AprilBlank/April.Util.Public\" target=\"_blank\" rel=\"noopener\">April.Util_github</a><a href=\"https://gitee.com/AprilBlank/April.Util.Public\" target=\"_blank\" rel=\"noopener\">April.Util_gitee</a>mark</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://blog.csdn.net/weixin_44518486/article/details/102947508\" target=\"_blank\" rel=\"noopener\">net core WebApiApril.Util</a><strong>TokenUtil</strong></p>\n<p>webapiIdentityJwttoken</p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li>tokentokentoken</li>\n<li></li>\n</ol>\n<blockquote>\n<p></p>\n</blockquote>\n<p><strong>AdminEntity</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AdminEntity</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _ID = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _UserName = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Avator = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;<span class=\"keyword\">string</span>&gt; _Controllers = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;<span class=\"keyword\">string</span>&gt; _Permissions = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _TokenType = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">bool</span> _IsSuperManager = <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;<span class=\"keyword\">int</span>&gt; _Depts = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">int</span>&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _CurrentDept = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> DateTime _ExpireTime = DateTime.Now;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> ID &#123; <span class=\"keyword\">get</span> =&gt; _ID; <span class=\"keyword\">set</span> =&gt; _ID = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> UserName &#123; <span class=\"keyword\">get</span> =&gt; _UserName; <span class=\"keyword\">set</span> =&gt; _UserName = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Avator &#123; <span class=\"keyword\">get</span> =&gt; _Avator; <span class=\"keyword\">set</span> =&gt; _Avator = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;<span class=\"keyword\">string</span>&gt; Controllers &#123; <span class=\"keyword\">get</span> =&gt; _Controllers; <span class=\"keyword\">set</span> =&gt; _Controllers = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;<span class=\"keyword\">string</span>&gt; Permissions &#123; <span class=\"keyword\">get</span> =&gt; _Permissions; <span class=\"keyword\">set</span> =&gt; _Permissions = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> TokenType &#123; <span class=\"keyword\">get</span> =&gt; _TokenType; <span class=\"keyword\">set</span> =&gt; _TokenType = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">bool</span> IsSuperManager &#123; <span class=\"keyword\">get</span> =&gt; _IsSuperManager; <span class=\"keyword\">set</span> =&gt; _IsSuperManager = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;<span class=\"keyword\">int</span>&gt; Depts &#123; <span class=\"keyword\">get</span> =&gt; _Depts; <span class=\"keyword\">set</span> =&gt; _Depts = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> CurrentDept &#123; <span class=\"keyword\">get</span> =&gt; _CurrentDept; <span class=\"keyword\">set</span> =&gt; _CurrentDept = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> DateTime ExpireTime &#123; <span class=\"keyword\">get</span> =&gt; _ExpireTime; <span class=\"keyword\">set</span> =&gt; _ExpireTime = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>TokenUtiltoken{id}{ts}</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">TokenUtil</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> token</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> <span class=\"title\">GetToken</span>(<span class=\"params\">AdminEntity user, <span class=\"keyword\">out</span> <span class=\"keyword\">string</span> expiretimstamp</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">string</span> id = user.ID.ToString();</span><br><span class=\"line\">        <span class=\"keyword\">double</span> exp = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> ((AprilEnums.TokenType)user.TokenType)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenType.Web:</span><br><span class=\"line\">                exp = AprilConfig.WebExpire;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenType.App:</span><br><span class=\"line\">                exp = AprilConfig.AppExpire;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenType.MiniProgram:</span><br><span class=\"line\">                exp = AprilConfig.MiniProgramExpire;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenType.Other:</span><br><span class=\"line\">                exp = AprilConfig.OtherExpire;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        DateTime date = DateTime.Now.AddHours(exp);</span><br><span class=\"line\">        user.ExpireTime = date;</span><br><span class=\"line\">        <span class=\"keyword\">double</span> timestamp = DateUtil.ConvertToUnixTimestamp(date);</span><br><span class=\"line\">        expiretimstamp = timestamp.ToString();</span><br><span class=\"line\">        <span class=\"keyword\">string</span> token = AprilConfig.TokenSecretFormat.Replace(<span class=\"string\">\"&#123;id&#125;\"</span>, id).Replace(<span class=\"string\">\"&#123;ts&#125;\"</span>, expiretimstamp);</span><br><span class=\"line\">        token = EncryptUtil.EncryptDES(token, EncryptUtil.SecurityKey);</span><br><span class=\"line\">        <span class=\"comment\">//LogUtil.Debug($\"&#123;id&#125;token&#123;token&#125;\");</span></span><br><span class=\"line\">        Add(token, user);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        SetUserToken(token, user.ID);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> token;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> token</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"token\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> AdminEntity <span class=\"title\">GetUserByToken</span>(<span class=\"params\"><span class=\"keyword\">string</span> token = <span class=\"string\">\"\"</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(token))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            token = GetTokenByContent();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(token))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            </span><br><span class=\"line\">            AdminEntity admin = Get(token);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (admin != <span class=\"literal\">null</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">//</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (admin.ExpireTime &gt; DateTime.Now)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (AprilConfig.AllowSliding)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"comment\">//</span></span><br><span class=\"line\">                        admin.ExpireTime = DateTime.Now.AddMinutes(<span class=\"number\">30</span>);</span><br><span class=\"line\">                        <span class=\"comment\">//</span></span><br><span class=\"line\">                        Add(token, admin);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> admin;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"comment\">//</span></span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> Token</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">string</span> <span class=\"title\">GetTokenByContent</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">string</span> token = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        <span class=\"comment\">//header</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> headers = AprilConfig.HttpCurrent.Request.Headers;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (headers.ContainsKey(<span class=\"string\">\"token\"</span>))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            token = headers[<span class=\"string\">\"token\"</span>].ToString();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(token))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            token = CookieUtil.GetString(<span class=\"string\">\"token\"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(token))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            AprilConfig.HttpCurrent.Request.Query.TryGetValue(<span class=\"string\">\"token\"</span>, <span class=\"keyword\">out</span> StringValues temptoken);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (temptoken != StringValues.Empty)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                token = temptoken.ToString();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> token;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> Token</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"token\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">RemoveToken</span>(<span class=\"params\"><span class=\"keyword\">string</span> token = <span class=\"string\">\"\"</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(token))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            token = GetTokenByContent();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(token))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Remove(token);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">region</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"token\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"userid\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">SetUserToken</span>(<span class=\"params\"><span class=\"keyword\">string</span> token, <span class=\"keyword\">int</span> userid</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        Dictionary&lt;<span class=\"keyword\">int</span>, List&lt;<span class=\"keyword\">string</span>&gt;&gt; dicusers = CacheUtil.Get&lt;Dictionary&lt;<span class=\"keyword\">int</span>, List&lt;<span class=\"keyword\">string</span>&gt;&gt;&gt;(<span class=\"string\">\"UserToken\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dicusers == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            dicusers = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"keyword\">int</span>, List&lt;<span class=\"keyword\">string</span>&gt;&gt;();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        List&lt;<span class=\"keyword\">string</span>&gt; listtokens = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dicusers.ContainsKey(userid))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            listtokens = dicusers[userid];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (listtokens.Count &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                listtokens.Add(token);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!AprilConfig.AllowMuiltiLogin)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> item <span class=\"keyword\">in</span> listtokens)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        RemoveToken(item);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    listtokens.Add(token);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">bool</span> isAdd = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> item <span class=\"keyword\">in</span> listtokens)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (item == token)</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            isAdd = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (isAdd)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        listtokens.Add(token);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            listtokens.Add(token);</span><br><span class=\"line\">            dicusers.Add(userid, listtokens);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        CacheUtil.Add(<span class=\"string\">\"UserToken\"</span>, dicusers, <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">6</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>), <span class=\"literal\">true</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"userid\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">RemoveUserToken</span>(<span class=\"params\"><span class=\"keyword\">int</span> userid</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        Dictionary&lt;<span class=\"keyword\">int</span>, List&lt;<span class=\"keyword\">string</span>&gt;&gt; dicusers = CacheUtil.Get&lt;Dictionary&lt;<span class=\"keyword\">int</span>, List&lt;<span class=\"keyword\">string</span>&gt;&gt;&gt;(<span class=\"string\">\"UserToken\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dicusers != <span class=\"literal\">null</span> &amp;&amp; dicusers.Count &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dicusers.ContainsKey(userid))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">//token</span></span><br><span class=\"line\">                <span class=\"keyword\">var</span> listtokens = dicusers[userid];</span><br><span class=\"line\">                <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> token <span class=\"keyword\">in</span> listtokens)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    RemoveToken(token);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                dicusers.Remove(userid);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"userid\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> List&lt;<span class=\"keyword\">string</span>&gt; <span class=\"title\">GetUserToken</span>(<span class=\"params\"><span class=\"keyword\">int</span> userid</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        Dictionary&lt;<span class=\"keyword\">int</span>, List&lt;<span class=\"keyword\">string</span>&gt;&gt; dicusers = CacheUtil.Get&lt;Dictionary&lt;<span class=\"keyword\">int</span>, List&lt;<span class=\"keyword\">string</span>&gt;&gt;&gt;(<span class=\"string\">\"UserToken\"</span>);</span><br><span class=\"line\">        List&lt;<span class=\"keyword\">string</span>&gt; lists = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dicusers != <span class=\"literal\">null</span> &amp;&amp; dicusers.Count &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> item <span class=\"keyword\">in</span> dicusers)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (item.Key == userid)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    lists = dicusers[userid];</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lists;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">region</span> ()</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Add</span>(<span class=\"params\"><span class=\"keyword\">string</span> token,AdminEntity admin</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (AprilConfig.TokenCacheType)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">//Cookie</span></span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Cookie:</span><br><span class=\"line\">                CookieUtil.Add(token, admin);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Cache:</span><br><span class=\"line\">                CacheUtil.Add(token, admin, <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">0</span>, <span class=\"number\">30</span>, <span class=\"number\">0</span>));</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Session:</span><br><span class=\"line\">                SessionUtil.Add(token, admin);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Redis:</span><br><span class=\"line\">                RedisUtil.Add(token, admin);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> AdminEntity <span class=\"title\">Get</span>(<span class=\"params\"><span class=\"keyword\">string</span> token</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        AdminEntity admin = <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (AprilConfig.TokenCacheType)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Cookie:</span><br><span class=\"line\">                admin = CookieUtil.Get&lt;AdminEntity&gt;(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Cache:</span><br><span class=\"line\">                admin = CacheUtil.Get&lt;AdminEntity&gt;(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Session:</span><br><span class=\"line\">                admin = SessionUtil.Get&lt;AdminEntity&gt;(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Redis:</span><br><span class=\"line\">                admin = RedisUtil.Get&lt;AdminEntity&gt;(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> admin;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Remove</span>(<span class=\"params\"><span class=\"keyword\">string</span> token</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (AprilConfig.TokenCacheType)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Cookie:</span><br><span class=\"line\">                CookieUtil.Remove(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Cache:</span><br><span class=\"line\">                CacheUtil.Remove(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Session:</span><br><span class=\"line\">                SessionUtil.Remove(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> AprilEnums.TokenCacheType.Redis:</span><br><span class=\"line\">                RedisUtil.Remove(token);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">endregion</span></span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://blog.csdn.net/weixin_44518486/article/details/97795992\" target=\"_blank\" rel=\"noopener\">net core WebapiAOP_Part 1</a>too young too simple2.2</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AprilAuthorizationMiddleware</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> RequestDelegate next;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">AprilAuthorizationMiddleware</span>(<span class=\"params\">RequestDelegate next</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.next = next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Task <span class=\"title\">Invoke</span>(<span class=\"params\">HttpContext context</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (context.Request.Method != <span class=\"string\">\"OPTIONS\"</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">string</span> path = context.Request.Path.Value;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!AprilConfig.AllowUrl.Contains(path))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">//</span></span><br><span class=\"line\">                AdminEntity admin = TokenUtil.GetUserByToken();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (admin == <span class=\"literal\">null</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"comment\">//</span></span><br><span class=\"line\">                    <span class=\"keyword\">return</span> ResponseUtil.HandleResponse(<span class=\"number\">-2</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!admin.IsSuperManager)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"comment\">///api/Controller/Action/api/Controller1/ConrolerInnerName/xxx/Action</span></span><br><span class=\"line\">                    <span class=\"keyword\">string</span>[] strValues = System.Text.RegularExpressions.Regex.Split(path, <span class=\"string\">\"/\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">                    <span class=\"keyword\">string</span> controller = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">bool</span> isStartApi = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (path.StartsWith(<span class=\"string\">\"/api\"</span>))</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        isStartApi = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; strValues.Length; i++)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"comment\">//api</span></span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(strValues[i]) || i == strValues.Length - <span class=\"number\">1</span>)</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (isStartApi &amp;&amp; strValues[i] == <span class=\"string\">\"api\"</span>)</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (!<span class=\"keyword\">string</span>.IsNullOrEmpty(controller))</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            controller += <span class=\"string\">\"/\"</span>;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        controller += strValues[i];</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(controller))</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        controller = strValues[strValues.Length - <span class=\"number\">1</span>];</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (!admin.Controllers.Contains(controller.ToLower()))</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"comment\">//</span></span><br><span class=\"line\">                        <span class=\"keyword\">return</span> ResponseUtil.HandleResponse(<span class=\"number\">401</span>, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> next.Invoke(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>OkLogin</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpPost</span>]</span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;ResponseDataEntity&gt; <span class=\"title\">Login</span>(<span class=\"params\">LoginFormEntity formEntity</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(formEntity.LoginName) || <span class=\"keyword\">string</span>.IsNullOrEmpty(formEntity.Password))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> ResponseUtil.Fail(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (formEntity.LoginName == <span class=\"string\">\"admin\"</span>)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"comment\">//db</span></span><br><span class=\"line\">              <span class=\"keyword\">string</span> password = EncryptUtil.MD5Encrypt(formEntity.Password, AprilConfig.SecurityKey);</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (password == <span class=\"string\">\"B092956160CB0018\"</span>)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  <span class=\"comment\">//db</span></span><br><span class=\"line\">                  AdminEntity admin = <span class=\"keyword\">new</span> AdminEntity</span><br><span class=\"line\">                  &#123;</span><br><span class=\"line\">                      UserName = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">                      Avator = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">                      IsSuperManager = <span class=\"literal\">true</span>,</span><br><span class=\"line\">                      TokenType = (<span class=\"keyword\">int</span>)AprilEnums.TokenType.Web</span><br><span class=\"line\">                  &#125;;</span><br><span class=\"line\">                  <span class=\"keyword\">string</span> token = TokenUtil.GetToken(admin, <span class=\"keyword\">out</span> <span class=\"keyword\">string</span> expiretimestamp);</span><br><span class=\"line\">                  <span class=\"keyword\">int</span> expiretime = <span class=\"number\">0</span>;</span><br><span class=\"line\">                  <span class=\"keyword\">int</span>.TryParse(expiretimestamp, <span class=\"keyword\">out</span> expiretime);</span><br><span class=\"line\">                  <span class=\"comment\">//</span></span><br><span class=\"line\">                  <span class=\"keyword\">return</span> ResponseUtil.Success(<span class=\"string\">\"\"</span>, <span class=\"keyword\">new</span> &#123; username = admin.UserName, avator = admin.Avator, token = token, expire = expiretime &#125;);</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (formEntity.LoginName == <span class=\"string\">\"test\"</span>)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              <span class=\"comment\">//</span></span><br><span class=\"line\">\t\tAdminEntity admin = <span class=\"keyword\">new</span> AdminEntity</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  UserName = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">                  Avator = <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">                  TokenType = (<span class=\"keyword\">int</span>)AprilEnums.TokenType.Web</span><br><span class=\"line\">              &#125;;</span><br><span class=\"line\">              admin.Controllers.Add(<span class=\"string\">\"weatherforecast\"</span>);</span><br><span class=\"line\">              admin.Permissions.Add(<span class=\"string\">\"weatherforecast_log\"</span>);<span class=\"comment\">//_(Add,Update...)</span></span><br><span class=\"line\">              <span class=\"keyword\">string</span> token = TokenUtil.GetToken(admin, <span class=\"keyword\">out</span> <span class=\"keyword\">string</span> expiretimestamp);</span><br><span class=\"line\">              <span class=\"keyword\">int</span> expiretime = <span class=\"number\">0</span>;</span><br><span class=\"line\">              <span class=\"keyword\">int</span>.TryParse(expiretimestamp, <span class=\"keyword\">out</span> expiretime);</span><br><span class=\"line\">              <span class=\"comment\">//</span></span><br><span class=\"line\">              <span class=\"keyword\">return</span> ResponseUtil.Success(<span class=\"string\">\"\"</span>, <span class=\"keyword\">new</span> &#123; username = admin.UserName, avator = admin.Avator, token = token, expire = expiretime &#125;);</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"comment\">//</span></span><br><span class=\"line\">          <span class=\"keyword\">return</span> ResponseUtil.Fail(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>xxxdb</p>\n</blockquote>\n<p></p>\n<p><img src=\"/2019/11/10/net-core-april-util-update-1/1.png\" alt=\"\"><br>Loginadmin123456token<br><img src=\"/2019/11/10/net-core-april-util-update-1/2.png\" alt=\"\"><br><br><img src=\"/2019/11/10/net-core-april-util-update-1/3.png\" alt=\"\"><br>tokenqueryheadertokenquery</p>\n<p><img src=\"/2019/11/10/net-core-april-util-update-1/4.png\" alt=\"\"><br></p>\n<p><strong>AprilPermission</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AprilPermissionAttribute</span> : <span class=\"title\">Attribute</span>, <span class=\"title\">IActionFilter</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Permission;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Controller;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"_controller\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"_permission\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">AprilPermissionAttribute</span>(<span class=\"params\"><span class=\"keyword\">string</span> _controller, <span class=\"keyword\">string</span> _permission</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        Permission = _permission;</span><br><span class=\"line\">        Controller = _controller;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">OnActionExecuted</span>(<span class=\"params\">ActionExecutedContext context</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        LogUtil.Debug(<span class=\"string\">\"AprilPermission OnActionExecuted\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">OnActionExecuting</span>(<span class=\"params\">ActionExecutingContext context</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        AdminEntity admin = TokenUtil.GetUserByToken();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (admin == <span class=\"literal\">null</span> || admin.ExpireTime &lt;= DateTime.Now)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            context.Result = <span class=\"keyword\">new</span> ObjectResult(<span class=\"keyword\">new</span> &#123; msg = <span class=\"string\">\"\"</span>, code = <span class=\"number\">-2</span> &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!admin.IsSuperManager)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">string</span> controller_permission = <span class=\"string\">$\"<span class=\"subst\">&#123;Controller&#125;</span>_<span class=\"subst\">&#123;Permission&#125;</span>\"</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!admin.Controllers.Contains(Controller) || !admin.Permissions.Contains(controller_permission))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                context.Result = <span class=\"keyword\">new</span> ObjectResult(<span class=\"keyword\">new</span> &#123; msg = <span class=\"string\">\"\"</span>, code = <span class=\"number\">401</span> &#125;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>test</p>\n<p><img src=\"/2019/11/10/net-core-april-util-update-1/5.png\" alt=\"\"><br><img src=\"/2019/11/10/net-core-april-util-update-1/6.png\" alt=\"\"><br><img src=\"/2019/11/10/net-core-april-util-update-1/7.png\" alt=\"\"></p>\n<p><img src=\"/2019/11/10/net-core-april-util-update-1/8.png\" alt=\"\"><br></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>TokenUtil</strong></p>\n"},{"title":"net core WebApi","date":"2019-08-23T05:30:12.000Z","_content":"\n### \n\n\n### \n\n- ****\n1. \n2. \n3. \n- ****\n1. \n2. md5md5\n3. \n4. \n5. \n\npstoken\n\n> \n\nOK\n\n**FileController****RequestUploadFile****FileSave****FileMerge**\n\n```csharp\n    [Route(\"api/[controller]\")]\n    [ApiController]\n    public class FileController : ControllerBase\n    {\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"requestFile\"></param>\n        /// <returns></returns>\n        [HttpPost, Route(\"RequestUpload\")]\n        public MessageEntity RequestUploadFile([FromBody]RequestFileUploadEntity requestFile)\n        {\n\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <returns></returns>\n        [HttpPost, Route(\"Upload\")]\n        public async Task<MessageEntity> FileSave()\n        {\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"fileInfo\">[name]</param>\n        /// <returns></returns>\n        [HttpPost, Route(\"Merge\")]\n        public async Task<MessageEntity> FileMerge([FromBody]Dictionary<string, object> fileInfo)\n        {\n\n        }\n    }\n```\n**RequestFileUploadEntity****MessageEntity**UtilEntityUtil\n```csharp\n    /// <summary>\n    /// \n    /// </summary>\n    public class RequestFileUploadEntity\n    {\n        private long _size = 0;\n        private int _count = 0;\n        private string _filedata = string.Empty;\n        private string _fileext = string.Empty;\n        private string _filename = string.Empty;\n\n        /// <summary>\n        /// \n        /// </summary>\n        public long size { get => _size; set => _size = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public int count { get => _count; set => _count = value; }\n        /// <summary>\n        /// md5\n        /// </summary>\n        public string filedata { get => _filedata; set => _filedata = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public string fileext { get => _fileext; set => _fileext = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public string filename { get => _filename; set => _filename = value; }\n    }\n```\n\n```csharp\n    /// <summary>\n    /// \n    /// </summary>\n    public class MessageEntity\n    {\n        private int _Code = 0;\n        private string _Msg = string.Empty;\n        private object _Data = new object();\n\n        /// <summary>\n        /// \n        /// </summary>\n        public int Code { get => _Code; set => _Code = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public string Msg { get => _Msg; set => _Msg = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public object Data { get => _Data; set => _Data = value; }\n    }\n```\n\nAlt+Enterso easy\n\n**RequestUploadFile**\n```csharp\n        public MessageEntity RequestUploadFile([FromBody]RequestFileUploadEntity requestFile)\n        {\n            LogUtil.Debug($\"RequestUploadFile {JsonConvert.SerializeObject(requestFile)}\");\n            MessageEntity message = new MessageEntity();\n            if (requestFile.size <= 0 || requestFile.count <= 0 || string.IsNullOrEmpty(requestFile.filedata))\n            {\n                message.Code = -1;\n                message.Msg = \"\";\n            }\n            else\n            {\n                //guid\n                string guidName = Guid.NewGuid().ToString(\"N\");\n\n                //Cacheredis\n                CacheUtil.Set(guidName, requestFile, new TimeSpan(0, 10, 0), true);\n\n                message.Code = 0;\n                message.Msg = \"\";\n                message.Data = new { filename = guidName };\n            }\n            return message;\n        }\n```\n\n**FileSave**\n```csharp\n        public async Task<MessageEntity> FileSave()\n        {\n            var files = Request.Form.Files;\n            long size = files.Sum(f => f.Length);\n            string fileName = Request.Form[\"filename\"];\n\n            int fileIndex = 0;\n            int.TryParse(Request.Form[\"fileindex\"], out fileIndex);\n            LogUtil.Debug($\"FileSave{fileIndex}_{size}\");\n            MessageEntity message = new MessageEntity();\n            if (size <= 0 || string.IsNullOrEmpty(fileName))\n            {\n                message.Code = -1;\n                message.Msg = \"\";\n                return message;\n            }\n\n            if (!CacheUtil.Exists(fileName))\n            {\n                message.Code = -1;\n                message.Msg = \"\";\n                return message;\n            }\n\n            long fileSize = 0;\n            string filePath = $\".{AprilConfig.FilePath}{DateTime.Now.ToString(\"yyyy-MM-dd\")}/{fileName}\";\n            string saveFileName = $\"{fileName}_{fileIndex}\";\n            string dirPath = Path.Combine(filePath, saveFileName);\n            if (!Directory.Exists(filePath))\n            {\n                Directory.CreateDirectory(filePath);\n            }\n\n            foreach (var file in files)\n            {\n                //\n                if (file.Length > 0)\n                {\n                    fileSize = 0;\n                    fileSize = file.Length;\n\n                    using (var stream = new FileStream(dirPath, FileMode.OpenOrCreate))\n                    {\n                        await file.CopyToAsync(stream);\n                    }\n                }\n            }\n\n            message.Code = 0;\n            message.Msg = \"\";\n            return message;\n        }\n```\n\n**FileMerge**\n```csharp\n\t\tpublic async Task<MessageEntity> FileMerge([FromBody]Dictionary<string, object> fileInfo)\n        {\n            MessageEntity message = new MessageEntity();\n            string fileName = string.Empty;\n            if (fileInfo.ContainsKey(\"name\"))\n            {\n                fileName = fileInfo[\"name\"].ToString();\n            }\n            if (string.IsNullOrEmpty(fileName))\n            {\n                message.Code = -1;\n                message.Msg = \"\";\n                return message;\n            }\n\n            //\n            try\n            {\n                RequestFileUploadEntity requestFile = CacheUtil.Get<RequestFileUploadEntity>(fileName);\n                if (requestFile == null)\n                {\n                    message.Code = -1;\n                    message.Msg = \"\";\n                    return message;\n                }\n                string filePath = $\".{AprilConfig.FilePath}{DateTime.Now.ToString(\"yyyy-MM-dd\")}/{fileName}\";\n                string fileExt = requestFile.fileext;\n                string fileMd5 = requestFile.filedata;\n                int fileCount = requestFile.count;\n                long fileSize = requestFile.size;\n\n                LogUtil.Debug($\"{filePath}\");\n                LogUtil.Debug($\"{fileExt}\");\n\n                string savePath = filePath.Replace(fileName, \"\");\n                string saveFileName = $\"{fileName}{fileExt}\";\n                var files = Directory.GetFiles(filePath);\n                string fileFinalName = Path.Combine(savePath, saveFileName);\n                LogUtil.Debug($\"{fileFinalName}\");\n                FileStream fs = new FileStream(fileFinalName, FileMode.Create);\n                LogUtil.Debug($\"{files.Length}\");\n\n                LogUtil.Debug($\"{string.Join(\",\", files.ToArray())}\");\n                LogUtil.Debug($\"{string.Join(\",\", files.OrderBy(x => x.Length).ThenBy(x => x))}\");\n                byte[] finalBytes = new byte[fileSize];\n                foreach (var part in files.OrderBy(x => x.Length).ThenBy(x => x))\n                {\n                    var bytes = System.IO.File.ReadAllBytes(part);\n\n                    await fs.WriteAsync(bytes, 0, bytes.Length);\n                    bytes = null;\n                    System.IO.File.Delete(part);//\n                }\n                fs.Close();\n                //\n                fs = new FileStream(fileFinalName, FileMode.Open);\n                string strMd5 = GetCryptoString(fs);\n                LogUtil.Debug($\"MD5{strMd5}\");\n                LogUtil.Debug($\"{JsonConvert.SerializeObject(requestFile)}\");\n                fs.Close();\n                Directory.Delete(filePath);\n                //MD5MD5\n                if (strMd5 != requestFile.filedata)\n                {\n                    LogUtil.Debug($\"md5{requestFile.filedata},md5{strMd5}\");\n                    message.Code = -1;\n                    message.Msg = \"MD5\";\n                    return message;\n                }\n\n                CacheUtil.Remove(fileInfo[\"name\"].ToString());\n                message.Code = 0;\n                message.Msg = \"\";\n            }\n            catch (Exception ex)\n            {\n                LogUtil.Error($\"{fileName}{ex.Message}\");\n                message.Code = -1;\n                message.Msg = \",\";\n            }\n            return message;\n        }\n```\n\nMergemd5Util\n```csharp\n\t\t/// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"fileStream\"></param>\n        /// <returns></returns>\n        private string GetCryptoString(Stream fileStream)\n        {\n            MD5 md5 = new MD5CryptoServiceProvider();\n            byte[] cryptBytes = md5.ComputeHash(fileStream);\n            return GetCryptoString(cryptBytes);\n        }\n\n        private string GetCryptoString(byte[] cryptBytes)\n        {\n            //string\n            StringBuilder sb = new StringBuilder();\n            for (int i = 0; i < cryptBytes.Length; i++)\n            {\n                sb.Append(cryptBytes[i].ToString(\"x2\"));\n            }\n            return sb.ToString();\n        }\n```\n\n### \n\n\n> KPI1+1=2OK\n\nOPTIONS\n![](net-core-fileuploader-and-cors/1.png)\n### \nnet coreStartup\n\n\n```csharp\n        public IServiceProvider ConfigureServices(IServiceCollection services)\n        {\n        \t//\n        \t\n            services.AddCors(options =>\n            {\n                options.AddPolicy(\"AllowAll\", p =>\n                {\n                    p.AllowAnyOrigin()\n                    .AllowAnyMethod()\n                    .AllowAnyHeader()\n                    .AllowCredentials();\n                });\n            });\n            \n            services.AddAspectCoreContainer();\n            return services.BuildAspectInjectorProvider();\n\n        }\n```\n\n**AddCors****AddPolicy**\n\n||  |\n|--|--|\n| AllowAnyOrigin |  |\n| AllowAnyMethod | GET/POST/PUT/DELETE |\n| AllowAnyHeader |  |\n| AllowCredentials | Cookie |\n\nHeader\n```csharp\n\t\t\t//\n            services.AddCors(options =>\n            {\n                options.AddPolicy(\"AllowSome\", p =>\n                 {\n                     p.WithOrigins(\"https://www.baidu.com\")\n                     .WithMethods(\"GET\", \"POST\")\n                     .WithHeaders(HeaderNames.ContentType, \"x-custom-header\");\n                 });\n            });\n```\n\n**Configure**\n```csharp\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n        \t//\n            app.UseCors(\"AllowAll\");  \n            \n            app.UseHttpsRedirection();\n            app.UseMvc();      \n        }\n```\n\n\n![](net-core-fileuploader-and-cors/2.png)\n[net core WebapiAOP_Part 1](/2019/07/30/aop-and-test-part-1/)\nappsettings.json\n```json\n  \"AllowUrl\": \"/api/Values,/api/File/RequestUpload,/api/File/Upload,/api/File/Merge\"\n```\njssubstring\n![](net-core-fileuploader-and-cors/3.png)\n\n![](net-core-fileuploader-and-cors/4.png)\nappsettings\n![](net-core-fileuploader-and-cors/5.png)\n\n![](net-core-fileuploader-and-cors/6.png)\n\n![](net-core-fileuploader-and-cors/7.png)\n### \n****\n\n\n","source":"_posts/net-core-fileuploader-and-cors.md","raw":"---\ntitle: net core WebApi\ndate: 2019-08-23 13:30:12\ntags: net core\ncategories: AprilBlank\n---\n\n### \n\n\n### \n\n- ****\n1. \n2. \n3. \n- ****\n1. \n2. md5md5\n3. \n4. \n5. \n\npstoken\n\n> \n\nOK\n\n**FileController****RequestUploadFile****FileSave****FileMerge**\n\n```csharp\n    [Route(\"api/[controller]\")]\n    [ApiController]\n    public class FileController : ControllerBase\n    {\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"requestFile\"></param>\n        /// <returns></returns>\n        [HttpPost, Route(\"RequestUpload\")]\n        public MessageEntity RequestUploadFile([FromBody]RequestFileUploadEntity requestFile)\n        {\n\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <returns></returns>\n        [HttpPost, Route(\"Upload\")]\n        public async Task<MessageEntity> FileSave()\n        {\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"fileInfo\">[name]</param>\n        /// <returns></returns>\n        [HttpPost, Route(\"Merge\")]\n        public async Task<MessageEntity> FileMerge([FromBody]Dictionary<string, object> fileInfo)\n        {\n\n        }\n    }\n```\n**RequestFileUploadEntity****MessageEntity**UtilEntityUtil\n```csharp\n    /// <summary>\n    /// \n    /// </summary>\n    public class RequestFileUploadEntity\n    {\n        private long _size = 0;\n        private int _count = 0;\n        private string _filedata = string.Empty;\n        private string _fileext = string.Empty;\n        private string _filename = string.Empty;\n\n        /// <summary>\n        /// \n        /// </summary>\n        public long size { get => _size; set => _size = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public int count { get => _count; set => _count = value; }\n        /// <summary>\n        /// md5\n        /// </summary>\n        public string filedata { get => _filedata; set => _filedata = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public string fileext { get => _fileext; set => _fileext = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public string filename { get => _filename; set => _filename = value; }\n    }\n```\n\n```csharp\n    /// <summary>\n    /// \n    /// </summary>\n    public class MessageEntity\n    {\n        private int _Code = 0;\n        private string _Msg = string.Empty;\n        private object _Data = new object();\n\n        /// <summary>\n        /// \n        /// </summary>\n        public int Code { get => _Code; set => _Code = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public string Msg { get => _Msg; set => _Msg = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public object Data { get => _Data; set => _Data = value; }\n    }\n```\n\nAlt+Enterso easy\n\n**RequestUploadFile**\n```csharp\n        public MessageEntity RequestUploadFile([FromBody]RequestFileUploadEntity requestFile)\n        {\n            LogUtil.Debug($\"RequestUploadFile {JsonConvert.SerializeObject(requestFile)}\");\n            MessageEntity message = new MessageEntity();\n            if (requestFile.size <= 0 || requestFile.count <= 0 || string.IsNullOrEmpty(requestFile.filedata))\n            {\n                message.Code = -1;\n                message.Msg = \"\";\n            }\n            else\n            {\n                //guid\n                string guidName = Guid.NewGuid().ToString(\"N\");\n\n                //Cacheredis\n                CacheUtil.Set(guidName, requestFile, new TimeSpan(0, 10, 0), true);\n\n                message.Code = 0;\n                message.Msg = \"\";\n                message.Data = new { filename = guidName };\n            }\n            return message;\n        }\n```\n\n**FileSave**\n```csharp\n        public async Task<MessageEntity> FileSave()\n        {\n            var files = Request.Form.Files;\n            long size = files.Sum(f => f.Length);\n            string fileName = Request.Form[\"filename\"];\n\n            int fileIndex = 0;\n            int.TryParse(Request.Form[\"fileindex\"], out fileIndex);\n            LogUtil.Debug($\"FileSave{fileIndex}_{size}\");\n            MessageEntity message = new MessageEntity();\n            if (size <= 0 || string.IsNullOrEmpty(fileName))\n            {\n                message.Code = -1;\n                message.Msg = \"\";\n                return message;\n            }\n\n            if (!CacheUtil.Exists(fileName))\n            {\n                message.Code = -1;\n                message.Msg = \"\";\n                return message;\n            }\n\n            long fileSize = 0;\n            string filePath = $\".{AprilConfig.FilePath}{DateTime.Now.ToString(\"yyyy-MM-dd\")}/{fileName}\";\n            string saveFileName = $\"{fileName}_{fileIndex}\";\n            string dirPath = Path.Combine(filePath, saveFileName);\n            if (!Directory.Exists(filePath))\n            {\n                Directory.CreateDirectory(filePath);\n            }\n\n            foreach (var file in files)\n            {\n                //\n                if (file.Length > 0)\n                {\n                    fileSize = 0;\n                    fileSize = file.Length;\n\n                    using (var stream = new FileStream(dirPath, FileMode.OpenOrCreate))\n                    {\n                        await file.CopyToAsync(stream);\n                    }\n                }\n            }\n\n            message.Code = 0;\n            message.Msg = \"\";\n            return message;\n        }\n```\n\n**FileMerge**\n```csharp\n\t\tpublic async Task<MessageEntity> FileMerge([FromBody]Dictionary<string, object> fileInfo)\n        {\n            MessageEntity message = new MessageEntity();\n            string fileName = string.Empty;\n            if (fileInfo.ContainsKey(\"name\"))\n            {\n                fileName = fileInfo[\"name\"].ToString();\n            }\n            if (string.IsNullOrEmpty(fileName))\n            {\n                message.Code = -1;\n                message.Msg = \"\";\n                return message;\n            }\n\n            //\n            try\n            {\n                RequestFileUploadEntity requestFile = CacheUtil.Get<RequestFileUploadEntity>(fileName);\n                if (requestFile == null)\n                {\n                    message.Code = -1;\n                    message.Msg = \"\";\n                    return message;\n                }\n                string filePath = $\".{AprilConfig.FilePath}{DateTime.Now.ToString(\"yyyy-MM-dd\")}/{fileName}\";\n                string fileExt = requestFile.fileext;\n                string fileMd5 = requestFile.filedata;\n                int fileCount = requestFile.count;\n                long fileSize = requestFile.size;\n\n                LogUtil.Debug($\"{filePath}\");\n                LogUtil.Debug($\"{fileExt}\");\n\n                string savePath = filePath.Replace(fileName, \"\");\n                string saveFileName = $\"{fileName}{fileExt}\";\n                var files = Directory.GetFiles(filePath);\n                string fileFinalName = Path.Combine(savePath, saveFileName);\n                LogUtil.Debug($\"{fileFinalName}\");\n                FileStream fs = new FileStream(fileFinalName, FileMode.Create);\n                LogUtil.Debug($\"{files.Length}\");\n\n                LogUtil.Debug($\"{string.Join(\",\", files.ToArray())}\");\n                LogUtil.Debug($\"{string.Join(\",\", files.OrderBy(x => x.Length).ThenBy(x => x))}\");\n                byte[] finalBytes = new byte[fileSize];\n                foreach (var part in files.OrderBy(x => x.Length).ThenBy(x => x))\n                {\n                    var bytes = System.IO.File.ReadAllBytes(part);\n\n                    await fs.WriteAsync(bytes, 0, bytes.Length);\n                    bytes = null;\n                    System.IO.File.Delete(part);//\n                }\n                fs.Close();\n                //\n                fs = new FileStream(fileFinalName, FileMode.Open);\n                string strMd5 = GetCryptoString(fs);\n                LogUtil.Debug($\"MD5{strMd5}\");\n                LogUtil.Debug($\"{JsonConvert.SerializeObject(requestFile)}\");\n                fs.Close();\n                Directory.Delete(filePath);\n                //MD5MD5\n                if (strMd5 != requestFile.filedata)\n                {\n                    LogUtil.Debug($\"md5{requestFile.filedata},md5{strMd5}\");\n                    message.Code = -1;\n                    message.Msg = \"MD5\";\n                    return message;\n                }\n\n                CacheUtil.Remove(fileInfo[\"name\"].ToString());\n                message.Code = 0;\n                message.Msg = \"\";\n            }\n            catch (Exception ex)\n            {\n                LogUtil.Error($\"{fileName}{ex.Message}\");\n                message.Code = -1;\n                message.Msg = \",\";\n            }\n            return message;\n        }\n```\n\nMergemd5Util\n```csharp\n\t\t/// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"fileStream\"></param>\n        /// <returns></returns>\n        private string GetCryptoString(Stream fileStream)\n        {\n            MD5 md5 = new MD5CryptoServiceProvider();\n            byte[] cryptBytes = md5.ComputeHash(fileStream);\n            return GetCryptoString(cryptBytes);\n        }\n\n        private string GetCryptoString(byte[] cryptBytes)\n        {\n            //string\n            StringBuilder sb = new StringBuilder();\n            for (int i = 0; i < cryptBytes.Length; i++)\n            {\n                sb.Append(cryptBytes[i].ToString(\"x2\"));\n            }\n            return sb.ToString();\n        }\n```\n\n### \n\n\n> KPI1+1=2OK\n\nOPTIONS\n![](net-core-fileuploader-and-cors/1.png)\n### \nnet coreStartup\n\n\n```csharp\n        public IServiceProvider ConfigureServices(IServiceCollection services)\n        {\n        \t//\n        \t\n            services.AddCors(options =>\n            {\n                options.AddPolicy(\"AllowAll\", p =>\n                {\n                    p.AllowAnyOrigin()\n                    .AllowAnyMethod()\n                    .AllowAnyHeader()\n                    .AllowCredentials();\n                });\n            });\n            \n            services.AddAspectCoreContainer();\n            return services.BuildAspectInjectorProvider();\n\n        }\n```\n\n**AddCors****AddPolicy**\n\n||  |\n|--|--|\n| AllowAnyOrigin |  |\n| AllowAnyMethod | GET/POST/PUT/DELETE |\n| AllowAnyHeader |  |\n| AllowCredentials | Cookie |\n\nHeader\n```csharp\n\t\t\t//\n            services.AddCors(options =>\n            {\n                options.AddPolicy(\"AllowSome\", p =>\n                 {\n                     p.WithOrigins(\"https://www.baidu.com\")\n                     .WithMethods(\"GET\", \"POST\")\n                     .WithHeaders(HeaderNames.ContentType, \"x-custom-header\");\n                 });\n            });\n```\n\n**Configure**\n```csharp\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n        \t//\n            app.UseCors(\"AllowAll\");  \n            \n            app.UseHttpsRedirection();\n            app.UseMvc();      \n        }\n```\n\n\n![](net-core-fileuploader-and-cors/2.png)\n[net core WebapiAOP_Part 1](/2019/07/30/aop-and-test-part-1/)\nappsettings.json\n```json\n  \"AllowUrl\": \"/api/Values,/api/File/RequestUpload,/api/File/Upload,/api/File/Merge\"\n```\njssubstring\n![](net-core-fileuploader-and-cors/3.png)\n\n![](net-core-fileuploader-and-cors/4.png)\nappsettings\n![](net-core-fileuploader-and-cors/5.png)\n\n![](net-core-fileuploader-and-cors/6.png)\n\n![](net-core-fileuploader-and-cors/7.png)\n### \n****\n\n\n","slug":"net-core-fileuploader-and-cors","published":1,"updated":"2019-09-30T05:46:17.961Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m4o004b9sv7sq99wq80","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li><strong></strong></li>\n</ul>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<ul>\n<li><strong></strong></li>\n</ul>\n<ol>\n<li></li>\n<li>md5md5</li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p>pstoken</p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>OK</p>\n<p><strong>FileController</strong><strong>RequestUploadFile</strong><strong>FileSave</strong><strong>FileMerge</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Route(<span class=\"meta-string\">\"api/[controller]\"</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">ApiController</span>]</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">FileController</span> : <span class=\"title\">ControllerBase</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"requestFile\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    [<span class=\"meta\">HttpPost, Route(<span class=\"meta-string\">\"RequestUpload\"</span>)</span>]</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> MessageEntity <span class=\"title\">RequestUploadFile</span>(<span class=\"params\">[FromBody]RequestFileUploadEntity requestFile</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    [<span class=\"meta\">HttpPost, Route(<span class=\"meta-string\">\"Upload\"</span>)</span>]</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;MessageEntity&gt; <span class=\"title\">FileSave</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"fileInfo\"&gt;</span>[name]<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    [<span class=\"meta\">HttpPost, Route(<span class=\"meta-string\">\"Merge\"</span>)</span>]</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;MessageEntity&gt; <span class=\"title\">FileMerge</span>(<span class=\"params\">[FromBody]Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; fileInfo</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>RequestFileUploadEntity</strong><strong>MessageEntity</strong>UtilEntityUtil</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">RequestFileUploadEntity</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">long</span> _size = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _count = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _filedata = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _fileext = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _filename = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">long</span> size &#123; <span class=\"keyword\">get</span> =&gt; _size; <span class=\"keyword\">set</span> =&gt; _size = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> count &#123; <span class=\"keyword\">get</span> =&gt; _count; <span class=\"keyword\">set</span> =&gt; _count = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> md5</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> filedata &#123; <span class=\"keyword\">get</span> =&gt; _filedata; <span class=\"keyword\">set</span> =&gt; _filedata = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> fileext &#123; <span class=\"keyword\">get</span> =&gt; _fileext; <span class=\"keyword\">set</span> =&gt; _fileext = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> filename &#123; <span class=\"keyword\">get</span> =&gt; _filename; <span class=\"keyword\">set</span> =&gt; _filename = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">MessageEntity</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _Code = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Msg = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">object</span> _Data = <span class=\"keyword\">new</span> <span class=\"keyword\">object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> Code &#123; <span class=\"keyword\">get</span> =&gt; _Code; <span class=\"keyword\">set</span> =&gt; _Code = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Msg &#123; <span class=\"keyword\">get</span> =&gt; _Msg; <span class=\"keyword\">set</span> =&gt; _Msg = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">object</span> Data &#123; <span class=\"keyword\">get</span> =&gt; _Data; <span class=\"keyword\">set</span> =&gt; _Data = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Alt+Enterso easy</p>\n<p><strong>RequestUploadFile</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> MessageEntity <span class=\"title\">RequestUploadFile</span>(<span class=\"params\">[FromBody]RequestFileUploadEntity requestFile</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    LogUtil.Debug(<span class=\"string\">$\"RequestUploadFile <span class=\"subst\">&#123;JsonConvert.SerializeObject(requestFile)&#125;</span>\"</span>);</span><br><span class=\"line\">    MessageEntity message = <span class=\"keyword\">new</span> MessageEntity();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (requestFile.size &lt;= <span class=\"number\">0</span> || requestFile.count &lt;= <span class=\"number\">0</span> || <span class=\"keyword\">string</span>.IsNullOrEmpty(requestFile.filedata))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">        message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">//guid</span></span><br><span class=\"line\">        <span class=\"keyword\">string</span> guidName = Guid.NewGuid().ToString(<span class=\"string\">\"N\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//Cacheredis</span></span><br><span class=\"line\">        CacheUtil.Set(guidName, requestFile, <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">0</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>), <span class=\"literal\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        message.Code = <span class=\"number\">0</span>;</span><br><span class=\"line\">        message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        message.Data = <span class=\"keyword\">new</span> &#123; filename = guidName &#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>FileSave</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;MessageEntity&gt; <span class=\"title\">FileSave</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> files = Request.Form.Files;</span><br><span class=\"line\">    <span class=\"keyword\">long</span> size = files.Sum(f =&gt; f.Length);</span><br><span class=\"line\">    <span class=\"keyword\">string</span> fileName = Request.Form[<span class=\"string\">\"filename\"</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span> fileIndex = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span>.TryParse(Request.Form[<span class=\"string\">\"fileindex\"</span>], <span class=\"keyword\">out</span> fileIndex);</span><br><span class=\"line\">    LogUtil.Debug(<span class=\"string\">$\"FileSave<span class=\"subst\">&#123;fileIndex&#125;</span>_<span class=\"subst\">&#123;size&#125;</span>\"</span>);</span><br><span class=\"line\">    MessageEntity message = <span class=\"keyword\">new</span> MessageEntity();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (size &lt;= <span class=\"number\">0</span> || <span class=\"keyword\">string</span>.IsNullOrEmpty(fileName))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">        message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!CacheUtil.Exists(fileName))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">        message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">long</span> fileSize = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> filePath = <span class=\"string\">$\".<span class=\"subst\">&#123;AprilConfig.FilePath&#125;</span><span class=\"subst\">&#123;DateTime.Now.ToString(<span class=\"string\">\"yyyy-MM-dd\"</span>)&#125;</span>/<span class=\"subst\">&#123;fileName&#125;</span>\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> saveFileName = <span class=\"string\">$\"<span class=\"subst\">&#123;fileName&#125;</span>_<span class=\"subst\">&#123;fileIndex&#125;</span>\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> dirPath = Path.Combine(filePath, saveFileName);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!Directory.Exists(filePath))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Directory.CreateDirectory(filePath);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> file <span class=\"keyword\">in</span> files)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (file.Length &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            fileSize = <span class=\"number\">0</span>;</span><br><span class=\"line\">            fileSize = file.Length;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> stream = <span class=\"keyword\">new</span> FileStream(dirPath, FileMode.OpenOrCreate))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">await</span> file.CopyToAsync(stream);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    message.Code = <span class=\"number\">0</span>;</span><br><span class=\"line\">    message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>FileMerge</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;MessageEntity&gt; <span class=\"title\">FileMerge</span>(<span class=\"params\">[FromBody]Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; fileInfo</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          MessageEntity message = <span class=\"keyword\">new</span> MessageEntity();</span><br><span class=\"line\">          <span class=\"keyword\">string</span> fileName = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (fileInfo.ContainsKey(<span class=\"string\">\"name\"</span>))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              fileName = fileInfo[<span class=\"string\">\"name\"</span>].ToString();</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(fileName))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">              message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"comment\">//</span></span><br><span class=\"line\">          <span class=\"keyword\">try</span></span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              RequestFileUploadEntity requestFile = CacheUtil.Get&lt;RequestFileUploadEntity&gt;(fileName);</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (requestFile == <span class=\"literal\">null</span>)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">                  message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">                  <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">string</span> filePath = <span class=\"string\">$\".<span class=\"subst\">&#123;AprilConfig.FilePath&#125;</span><span class=\"subst\">&#123;DateTime.Now.ToString(<span class=\"string\">\"yyyy-MM-dd\"</span>)&#125;</span>/<span class=\"subst\">&#123;fileName&#125;</span>\"</span>;</span><br><span class=\"line\">              <span class=\"keyword\">string</span> fileExt = requestFile.fileext;</span><br><span class=\"line\">              <span class=\"keyword\">string</span> fileMd5 = requestFile.filedata;</span><br><span class=\"line\">              <span class=\"keyword\">int</span> fileCount = requestFile.count;</span><br><span class=\"line\">              <span class=\"keyword\">long</span> fileSize = requestFile.size;</span><br><span class=\"line\"></span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;filePath&#125;</span>\"</span>);</span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;fileExt&#125;</span>\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">              <span class=\"keyword\">string</span> savePath = filePath.Replace(fileName, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">              <span class=\"keyword\">string</span> saveFileName = <span class=\"string\">$\"<span class=\"subst\">&#123;fileName&#125;</span><span class=\"subst\">&#123;fileExt&#125;</span>\"</span>;</span><br><span class=\"line\">              <span class=\"keyword\">var</span> files = Directory.GetFiles(filePath);</span><br><span class=\"line\">              <span class=\"keyword\">string</span> fileFinalName = Path.Combine(savePath, saveFileName);</span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;fileFinalName&#125;</span>\"</span>);</span><br><span class=\"line\">              FileStream fs = <span class=\"keyword\">new</span> FileStream(fileFinalName, FileMode.Create);</span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;files.Length&#125;</span>\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;<span class=\"keyword\">string</span>.Join(<span class=\"string\">\",\"</span>, files.ToArray())&#125;</span>\"</span>);</span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;<span class=\"keyword\">string</span>.Join(<span class=\"string\">\",\"</span>, files.OrderBy(x =&gt; x.Length).ThenBy(x =&gt; x))&#125;</span>\"</span>);</span><br><span class=\"line\">              <span class=\"keyword\">byte</span>[] finalBytes = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[fileSize];</span><br><span class=\"line\">              <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> part <span class=\"keyword\">in</span> files.OrderBy(x =&gt; x.Length).ThenBy(x =&gt; x))</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  <span class=\"keyword\">var</span> bytes = System.IO.File.ReadAllBytes(part);</span><br><span class=\"line\"></span><br><span class=\"line\">                  <span class=\"keyword\">await</span> fs.WriteAsync(bytes, <span class=\"number\">0</span>, bytes.Length);</span><br><span class=\"line\">                  bytes = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                  System.IO.File.Delete(part);<span class=\"comment\">//</span></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              fs.Close();</span><br><span class=\"line\">              <span class=\"comment\">//</span></span><br><span class=\"line\">              fs = <span class=\"keyword\">new</span> FileStream(fileFinalName, FileMode.Open);</span><br><span class=\"line\">              <span class=\"keyword\">string</span> strMd5 = GetCryptoString(fs);</span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"MD5<span class=\"subst\">&#123;strMd5&#125;</span>\"</span>);</span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;JsonConvert.SerializeObject(requestFile)&#125;</span>\"</span>);</span><br><span class=\"line\">              fs.Close();</span><br><span class=\"line\">              Directory.Delete(filePath);</span><br><span class=\"line\">              <span class=\"comment\">//MD5MD5</span></span><br><span class=\"line\">              <span class=\"keyword\">if</span> (strMd5 != requestFile.filedata)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  LogUtil.Debug(<span class=\"string\">$\"md5<span class=\"subst\">&#123;requestFile.filedata&#125;</span>,md5<span class=\"subst\">&#123;strMd5&#125;</span>\"</span>);</span><br><span class=\"line\">                  message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">                  message.Msg = <span class=\"string\">\"MD5\"</span>;</span><br><span class=\"line\">                  <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">              CacheUtil.Remove(fileInfo[<span class=\"string\">\"name\"</span>].ToString());</span><br><span class=\"line\">              message.Code = <span class=\"number\">0</span>;</span><br><span class=\"line\">              message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              LogUtil.Error(<span class=\"string\">$\"<span class=\"subst\">&#123;fileName&#125;</span><span class=\"subst\">&#123;ex.Message&#125;</span>\"</span>);</span><br><span class=\"line\">              message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">              message.Msg = <span class=\"string\">\",\"</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<p>Mergemd5Util</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"fileStream\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">string</span> <span class=\"title\">GetCryptoString</span>(<span class=\"params\">Stream fileStream</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          MD5 md5 = <span class=\"keyword\">new</span> MD5CryptoServiceProvider();</span><br><span class=\"line\">          <span class=\"keyword\">byte</span>[] cryptBytes = md5.ComputeHash(fileStream);</span><br><span class=\"line\">          <span class=\"keyword\">return</span> GetCryptoString(cryptBytes);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">string</span> <span class=\"title\">GetCryptoString</span>(<span class=\"params\"><span class=\"keyword\">byte</span>[] cryptBytes</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          <span class=\"comment\">//string</span></span><br><span class=\"line\">          StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">          <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; cryptBytes.Length; i++)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              sb.Append(cryptBytes[i].ToString(<span class=\"string\">\"x2\"</span>));</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> sb.ToString();</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<blockquote>\n<p>KPI1+1=2OK</p>\n</blockquote>\n<p>OPTIONS<br><img src=\"/2019/08/23/net-core-fileuploader-and-cors/1.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net coreStartup</p>\n<p></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> IServiceProvider <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">    services.AddCors(options =&gt;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        options.AddPolicy(<span class=\"string\">\"AllowAll\"</span>, p =&gt;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            p.AllowAnyOrigin()</span><br><span class=\"line\">            .AllowAnyMethod()</span><br><span class=\"line\">            .AllowAnyHeader()</span><br><span class=\"line\">            .AllowCredentials();</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    </span><br><span class=\"line\">    services.AddAspectCoreContainer();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> services.BuildAspectInjectorProvider();</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>AddCors</strong><strong>AddPolicy</strong></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>AllowAnyOrigin</td>\n<td></td>\n</tr>\n<tr>\n<td>AllowAnyMethod</td>\n<td>GET/POST/PUT/DELETE</td>\n</tr>\n<tr>\n<td>AllowAnyHeader</td>\n<td></td>\n</tr>\n<tr>\n<td>AllowCredentials</td>\n<td>Cookie</td>\n</tr>\n</tbody></table>\n<p>Header</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">         services.AddCors(options =&gt;</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">             options.AddPolicy(<span class=\"string\">\"AllowSome\"</span>, p =&gt;</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  p.WithOrigins(<span class=\"string\">\"https://www.baidu.com\"</span>)</span><br><span class=\"line\">                  .WithMethods(<span class=\"string\">\"GET\"</span>, <span class=\"string\">\"POST\"</span>)</span><br><span class=\"line\">                  .WithHeaders(HeaderNames.ContentType, <span class=\"string\">\"x-custom-header\"</span>);</span><br><span class=\"line\">              &#125;);</span><br><span class=\"line\">         &#125;);</span><br></pre></td></tr></table></figure>\n\n<p><strong>Configure</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IHostingEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">    app.UseCors(<span class=\"string\">\"AllowAll\"</span>);  </span><br><span class=\"line\">    </span><br><span class=\"line\">    app.UseHttpsRedirection();</span><br><span class=\"line\">    app.UseMvc();      </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/2019/08/23/net-core-fileuploader-and-cors/2.png\" alt=\"\"><br><a href=\"/2019/07/30/aop-and-test-part-1/\">net core WebapiAOP_Part 1</a><br>appsettings.json</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"AllowUrl\": \"/api/Values,/api/File/RequestUpload,/api/File/Upload,/api/File/Merge\"</span><br></pre></td></tr></table></figure>\n\n<p>jssubstring<br><img src=\"/2019/08/23/net-core-fileuploader-and-cors/3.png\" alt=\"\"><br><br><img src=\"/2019/08/23/net-core-fileuploader-and-cors/4.png\" alt=\"\"><br>appsettings<br><img src=\"/2019/08/23/net-core-fileuploader-and-cors/5.png\" alt=\"\"><br><br><img src=\"/2019/08/23/net-core-fileuploader-and-cors/6.png\" alt=\"\"><br><br><img src=\"/2019/08/23/net-core-fileuploader-and-cors/7.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li><strong></strong></li>\n</ul>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<ul>\n<li><strong></strong></li>\n</ul>\n<ol>\n<li></li>\n<li>md5md5</li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p>pstoken</p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>OK</p>\n<p><strong>FileController</strong><strong>RequestUploadFile</strong><strong>FileSave</strong><strong>FileMerge</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">Route(<span class=\"meta-string\">\"api/[controller]\"</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">ApiController</span>]</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">FileController</span> : <span class=\"title\">ControllerBase</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"requestFile\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    [<span class=\"meta\">HttpPost, Route(<span class=\"meta-string\">\"RequestUpload\"</span>)</span>]</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> MessageEntity <span class=\"title\">RequestUploadFile</span>(<span class=\"params\">[FromBody]RequestFileUploadEntity requestFile</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    [<span class=\"meta\">HttpPost, Route(<span class=\"meta-string\">\"Upload\"</span>)</span>]</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;MessageEntity&gt; <span class=\"title\">FileSave</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"fileInfo\"&gt;</span>[name]<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    [<span class=\"meta\">HttpPost, Route(<span class=\"meta-string\">\"Merge\"</span>)</span>]</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;MessageEntity&gt; <span class=\"title\">FileMerge</span>(<span class=\"params\">[FromBody]Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; fileInfo</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>RequestFileUploadEntity</strong><strong>MessageEntity</strong>UtilEntityUtil</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">RequestFileUploadEntity</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">long</span> _size = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _count = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _filedata = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _fileext = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _filename = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">long</span> size &#123; <span class=\"keyword\">get</span> =&gt; _size; <span class=\"keyword\">set</span> =&gt; _size = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> count &#123; <span class=\"keyword\">get</span> =&gt; _count; <span class=\"keyword\">set</span> =&gt; _count = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> md5</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> filedata &#123; <span class=\"keyword\">get</span> =&gt; _filedata; <span class=\"keyword\">set</span> =&gt; _filedata = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> fileext &#123; <span class=\"keyword\">get</span> =&gt; _fileext; <span class=\"keyword\">set</span> =&gt; _fileext = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> filename &#123; <span class=\"keyword\">get</span> =&gt; _filename; <span class=\"keyword\">set</span> =&gt; _filename = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">MessageEntity</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _Code = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Msg = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">object</span> _Data = <span class=\"keyword\">new</span> <span class=\"keyword\">object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> Code &#123; <span class=\"keyword\">get</span> =&gt; _Code; <span class=\"keyword\">set</span> =&gt; _Code = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Msg &#123; <span class=\"keyword\">get</span> =&gt; _Msg; <span class=\"keyword\">set</span> =&gt; _Msg = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">object</span> Data &#123; <span class=\"keyword\">get</span> =&gt; _Data; <span class=\"keyword\">set</span> =&gt; _Data = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Alt+Enterso easy</p>\n<p><strong>RequestUploadFile</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> MessageEntity <span class=\"title\">RequestUploadFile</span>(<span class=\"params\">[FromBody]RequestFileUploadEntity requestFile</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    LogUtil.Debug(<span class=\"string\">$\"RequestUploadFile <span class=\"subst\">&#123;JsonConvert.SerializeObject(requestFile)&#125;</span>\"</span>);</span><br><span class=\"line\">    MessageEntity message = <span class=\"keyword\">new</span> MessageEntity();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (requestFile.size &lt;= <span class=\"number\">0</span> || requestFile.count &lt;= <span class=\"number\">0</span> || <span class=\"keyword\">string</span>.IsNullOrEmpty(requestFile.filedata))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">        message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">//guid</span></span><br><span class=\"line\">        <span class=\"keyword\">string</span> guidName = Guid.NewGuid().ToString(<span class=\"string\">\"N\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//Cacheredis</span></span><br><span class=\"line\">        CacheUtil.Set(guidName, requestFile, <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">0</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>), <span class=\"literal\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        message.Code = <span class=\"number\">0</span>;</span><br><span class=\"line\">        message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        message.Data = <span class=\"keyword\">new</span> &#123; filename = guidName &#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>FileSave</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;MessageEntity&gt; <span class=\"title\">FileSave</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> files = Request.Form.Files;</span><br><span class=\"line\">    <span class=\"keyword\">long</span> size = files.Sum(f =&gt; f.Length);</span><br><span class=\"line\">    <span class=\"keyword\">string</span> fileName = Request.Form[<span class=\"string\">\"filename\"</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span> fileIndex = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span>.TryParse(Request.Form[<span class=\"string\">\"fileindex\"</span>], <span class=\"keyword\">out</span> fileIndex);</span><br><span class=\"line\">    LogUtil.Debug(<span class=\"string\">$\"FileSave<span class=\"subst\">&#123;fileIndex&#125;</span>_<span class=\"subst\">&#123;size&#125;</span>\"</span>);</span><br><span class=\"line\">    MessageEntity message = <span class=\"keyword\">new</span> MessageEntity();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (size &lt;= <span class=\"number\">0</span> || <span class=\"keyword\">string</span>.IsNullOrEmpty(fileName))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">        message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!CacheUtil.Exists(fileName))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">        message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">long</span> fileSize = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> filePath = <span class=\"string\">$\".<span class=\"subst\">&#123;AprilConfig.FilePath&#125;</span><span class=\"subst\">&#123;DateTime.Now.ToString(<span class=\"string\">\"yyyy-MM-dd\"</span>)&#125;</span>/<span class=\"subst\">&#123;fileName&#125;</span>\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> saveFileName = <span class=\"string\">$\"<span class=\"subst\">&#123;fileName&#125;</span>_<span class=\"subst\">&#123;fileIndex&#125;</span>\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">string</span> dirPath = Path.Combine(filePath, saveFileName);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!Directory.Exists(filePath))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Directory.CreateDirectory(filePath);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> file <span class=\"keyword\">in</span> files)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (file.Length &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            fileSize = <span class=\"number\">0</span>;</span><br><span class=\"line\">            fileSize = file.Length;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> stream = <span class=\"keyword\">new</span> FileStream(dirPath, FileMode.OpenOrCreate))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">await</span> file.CopyToAsync(stream);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    message.Code = <span class=\"number\">0</span>;</span><br><span class=\"line\">    message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>FileMerge</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;MessageEntity&gt; <span class=\"title\">FileMerge</span>(<span class=\"params\">[FromBody]Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; fileInfo</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          MessageEntity message = <span class=\"keyword\">new</span> MessageEntity();</span><br><span class=\"line\">          <span class=\"keyword\">string</span> fileName = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (fileInfo.ContainsKey(<span class=\"string\">\"name\"</span>))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              fileName = fileInfo[<span class=\"string\">\"name\"</span>].ToString();</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(fileName))</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">              message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"comment\">//</span></span><br><span class=\"line\">          <span class=\"keyword\">try</span></span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              RequestFileUploadEntity requestFile = CacheUtil.Get&lt;RequestFileUploadEntity&gt;(fileName);</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (requestFile == <span class=\"literal\">null</span>)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">                  message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">                  <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">string</span> filePath = <span class=\"string\">$\".<span class=\"subst\">&#123;AprilConfig.FilePath&#125;</span><span class=\"subst\">&#123;DateTime.Now.ToString(<span class=\"string\">\"yyyy-MM-dd\"</span>)&#125;</span>/<span class=\"subst\">&#123;fileName&#125;</span>\"</span>;</span><br><span class=\"line\">              <span class=\"keyword\">string</span> fileExt = requestFile.fileext;</span><br><span class=\"line\">              <span class=\"keyword\">string</span> fileMd5 = requestFile.filedata;</span><br><span class=\"line\">              <span class=\"keyword\">int</span> fileCount = requestFile.count;</span><br><span class=\"line\">              <span class=\"keyword\">long</span> fileSize = requestFile.size;</span><br><span class=\"line\"></span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;filePath&#125;</span>\"</span>);</span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;fileExt&#125;</span>\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">              <span class=\"keyword\">string</span> savePath = filePath.Replace(fileName, <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">              <span class=\"keyword\">string</span> saveFileName = <span class=\"string\">$\"<span class=\"subst\">&#123;fileName&#125;</span><span class=\"subst\">&#123;fileExt&#125;</span>\"</span>;</span><br><span class=\"line\">              <span class=\"keyword\">var</span> files = Directory.GetFiles(filePath);</span><br><span class=\"line\">              <span class=\"keyword\">string</span> fileFinalName = Path.Combine(savePath, saveFileName);</span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;fileFinalName&#125;</span>\"</span>);</span><br><span class=\"line\">              FileStream fs = <span class=\"keyword\">new</span> FileStream(fileFinalName, FileMode.Create);</span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;files.Length&#125;</span>\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;<span class=\"keyword\">string</span>.Join(<span class=\"string\">\",\"</span>, files.ToArray())&#125;</span>\"</span>);</span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;<span class=\"keyword\">string</span>.Join(<span class=\"string\">\",\"</span>, files.OrderBy(x =&gt; x.Length).ThenBy(x =&gt; x))&#125;</span>\"</span>);</span><br><span class=\"line\">              <span class=\"keyword\">byte</span>[] finalBytes = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[fileSize];</span><br><span class=\"line\">              <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> part <span class=\"keyword\">in</span> files.OrderBy(x =&gt; x.Length).ThenBy(x =&gt; x))</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  <span class=\"keyword\">var</span> bytes = System.IO.File.ReadAllBytes(part);</span><br><span class=\"line\"></span><br><span class=\"line\">                  <span class=\"keyword\">await</span> fs.WriteAsync(bytes, <span class=\"number\">0</span>, bytes.Length);</span><br><span class=\"line\">                  bytes = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                  System.IO.File.Delete(part);<span class=\"comment\">//</span></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              fs.Close();</span><br><span class=\"line\">              <span class=\"comment\">//</span></span><br><span class=\"line\">              fs = <span class=\"keyword\">new</span> FileStream(fileFinalName, FileMode.Open);</span><br><span class=\"line\">              <span class=\"keyword\">string</span> strMd5 = GetCryptoString(fs);</span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"MD5<span class=\"subst\">&#123;strMd5&#125;</span>\"</span>);</span><br><span class=\"line\">              LogUtil.Debug(<span class=\"string\">$\"<span class=\"subst\">&#123;JsonConvert.SerializeObject(requestFile)&#125;</span>\"</span>);</span><br><span class=\"line\">              fs.Close();</span><br><span class=\"line\">              Directory.Delete(filePath);</span><br><span class=\"line\">              <span class=\"comment\">//MD5MD5</span></span><br><span class=\"line\">              <span class=\"keyword\">if</span> (strMd5 != requestFile.filedata)</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  LogUtil.Debug(<span class=\"string\">$\"md5<span class=\"subst\">&#123;requestFile.filedata&#125;</span>,md5<span class=\"subst\">&#123;strMd5&#125;</span>\"</span>);</span><br><span class=\"line\">                  message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">                  message.Msg = <span class=\"string\">\"MD5\"</span>;</span><br><span class=\"line\">                  <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">              CacheUtil.Remove(fileInfo[<span class=\"string\">\"name\"</span>].ToString());</span><br><span class=\"line\">              message.Code = <span class=\"number\">0</span>;</span><br><span class=\"line\">              message.Msg = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              LogUtil.Error(<span class=\"string\">$\"<span class=\"subst\">&#123;fileName&#125;</span><span class=\"subst\">&#123;ex.Message&#125;</span>\"</span>);</span><br><span class=\"line\">              message.Code = <span class=\"number\">-1</span>;</span><br><span class=\"line\">              message.Msg = <span class=\"string\">\",\"</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<p>Mergemd5Util</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"fileStream\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">      <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">string</span> <span class=\"title\">GetCryptoString</span>(<span class=\"params\">Stream fileStream</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          MD5 md5 = <span class=\"keyword\">new</span> MD5CryptoServiceProvider();</span><br><span class=\"line\">          <span class=\"keyword\">byte</span>[] cryptBytes = md5.ComputeHash(fileStream);</span><br><span class=\"line\">          <span class=\"keyword\">return</span> GetCryptoString(cryptBytes);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">string</span> <span class=\"title\">GetCryptoString</span>(<span class=\"params\"><span class=\"keyword\">byte</span>[] cryptBytes</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>      &#123;</span><br><span class=\"line\">          <span class=\"comment\">//string</span></span><br><span class=\"line\">          StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">          <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; cryptBytes.Length; i++)</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">              sb.Append(cryptBytes[i].ToString(<span class=\"string\">\"x2\"</span>));</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> sb.ToString();</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<blockquote>\n<p>KPI1+1=2OK</p>\n</blockquote>\n<p>OPTIONS<br><img src=\"/2019/08/23/net-core-fileuploader-and-cors/1.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>net coreStartup</p>\n<p></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> IServiceProvider <span class=\"title\">ConfigureServices</span>(<span class=\"params\">IServiceCollection services</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">    services.AddCors(options =&gt;</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        options.AddPolicy(<span class=\"string\">\"AllowAll\"</span>, p =&gt;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            p.AllowAnyOrigin()</span><br><span class=\"line\">            .AllowAnyMethod()</span><br><span class=\"line\">            .AllowAnyHeader()</span><br><span class=\"line\">            .AllowCredentials();</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    </span><br><span class=\"line\">    services.AddAspectCoreContainer();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> services.BuildAspectInjectorProvider();</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>AddCors</strong><strong>AddPolicy</strong></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>AllowAnyOrigin</td>\n<td></td>\n</tr>\n<tr>\n<td>AllowAnyMethod</td>\n<td>GET/POST/PUT/DELETE</td>\n</tr>\n<tr>\n<td>AllowAnyHeader</td>\n<td></td>\n</tr>\n<tr>\n<td>AllowCredentials</td>\n<td>Cookie</td>\n</tr>\n</tbody></table>\n<p>Header</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">         services.AddCors(options =&gt;</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">             options.AddPolicy(<span class=\"string\">\"AllowSome\"</span>, p =&gt;</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                  p.WithOrigins(<span class=\"string\">\"https://www.baidu.com\"</span>)</span><br><span class=\"line\">                  .WithMethods(<span class=\"string\">\"GET\"</span>, <span class=\"string\">\"POST\"</span>)</span><br><span class=\"line\">                  .WithHeaders(HeaderNames.ContentType, <span class=\"string\">\"x-custom-header\"</span>);</span><br><span class=\"line\">              &#125;);</span><br><span class=\"line\">         &#125;);</span><br></pre></td></tr></table></figure>\n\n<p><strong>Configure</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Configure</span>(<span class=\"params\">IApplicationBuilder app, IHostingEnvironment env</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">    app.UseCors(<span class=\"string\">\"AllowAll\"</span>);  </span><br><span class=\"line\">    </span><br><span class=\"line\">    app.UseHttpsRedirection();</span><br><span class=\"line\">    app.UseMvc();      </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/2019/08/23/net-core-fileuploader-and-cors/2.png\" alt=\"\"><br><a href=\"/2019/07/30/aop-and-test-part-1/\">net core WebapiAOP_Part 1</a><br>appsettings.json</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"AllowUrl\": \"/api/Values,/api/File/RequestUpload,/api/File/Upload,/api/File/Merge\"</span><br></pre></td></tr></table></figure>\n\n<p>jssubstring<br><img src=\"/2019/08/23/net-core-fileuploader-and-cors/3.png\" alt=\"\"><br><br><img src=\"/2019/08/23/net-core-fileuploader-and-cors/4.png\" alt=\"\"><br>appsettings<br><img src=\"/2019/08/23/net-core-fileuploader-and-cors/5.png\" alt=\"\"><br><br><img src=\"/2019/08/23/net-core-fileuploader-and-cors/6.png\" alt=\"\"><br><br><img src=\"/2019/08/23/net-core-fileuploader-and-cors/7.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n"},{"title":"net core Webapi_Part 1","date":"2019-07-18T11:31:41.000Z","_content":"\n### \n[net core Webapi](/2019/07/10/net-core-cache/)\n\n### SqlSugar\nEFDappernet coreDapperOkCV**SqlSugar**[](http://www.codeisbug.com/)\n\n> \n**April.Util****April.Service****April.Entity**\n\nServiceEntityNuGet**sqlSugarCore**[net core Webapilog4net](/2019/07/04/net-core-log4net/)\n\nNuGet\n\nEntity**StudentEntity**\n\n```csharp\n    public class StudentEntity\n    {\n        private int _ID = -1;\n        private string _Name = string.Empty;\n        private string _Number = string.Empty;\n        private int _Age = 0;\n        private int _Sex = 0;\n        private string _Address = string.Empty;\n    }\n```\ngetsetIDECtrl+R+E\n![](net-core-sqlsugar-1/1.png)\nEntitySqlSugar\n\n```csharp\n\t[SugarTable(\"test_Student\")]\n    public class StudentEntity\n    {\n        private int _ID = -1;\n        private string _Name = string.Empty;\n        private string _Number = string.Empty;\n        private int _Age = 0;\n        private int _Sex = 0;\n        private string _Address = string.Empty;\n\n        /// <summary>\n        /// \n        /// </summary>\n        [SugarColumn(IsPrimaryKey = true, IsIdentity = true)]\n        public int ID { get => _ID; set => _ID = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public string Name { get => _Name; set => _Name = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public string Number { get => _Number; set => _Number = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public int Age { get => _Age; set => _Age = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public int Sex { get => _Sex; set => _Sex = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        [SugarColumn(ColumnName = \"test_Address\")]\n        public string Address { get => _Address; set => _Address = value; }\n    }\n```\n\n\n\n### Service\n**BaseDbContext**\n```csharp\n\tpublic class BaseDbContext\n    {\n        public SqlSugarClient Db;\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"connStr\"></param>\n        /// <param name=\"sqlType\"></param>\n        public BaseDbContext(string connStr, int sqlType = 1)\n        {\n            InitDataBase(connStr, sqlType);\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"serverIp\">IP</param>\n        /// <param name=\"user\"></param>\n        /// <param name=\"pass\"></param>\n        /// <param name=\"dataBase\"></param>\n        public BaseDbContext(string serverIp, string user, string pass, string dataBase)\n        {\n            string connStr = $\"server={serverIp};user id={user};password={pass};persistsecurityinfo=True;database={dataBase}\";\n            InitDataBase(connStr);\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"listConn\"></param>\n        private void InitDataBase(string connStr, int sqlType = 1)\n        {\n            Db = new SqlSugarClient(new ConnectionConfig()\n            {\n                ConnectionString = connStr,\n                DbType = (DbType)sqlType,\n                IsAutoCloseConnection = true,\n                //SlaveConnectionConfigs = slaveConnectionConfigs\n            });\n            Db.Ado.CommandTimeOut = 30000;//\n            Db.Aop.OnLogExecuted = (sql, pars) => //SQL\n            {\n                //sql\n            };\n            Db.Aop.OnLogExecuting = (sql, pars) => //SQL\n            {\n                //sql\n            };\n            Db.Aop.OnError = (exp) =>//SQL \n            {\n                //sql\n            };\n            Db.Aop.OnExecutingChangeSql = (sql, pars) => //SQL SQL\n            {\n                return new KeyValuePair<string, SugarParameter[]>(sql, pars);\n            };\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        public void BeginTran()\n        {\n            Db.Ado.BeginTran();\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        public void CommitTran()\n        {\n            Db.Ado.CommitTran();\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        public void RollbackTran()\n        {\n            Db.Ado.RollbackTran();\n        }\n    }\n```\n\n\n\n### BaseService\n> net coreRepositorysqlServiceBll\n\nUtil**SqlSqlFilterEntity**lambda\n\n```csharp\n    public class SqlFilterEntity\n    {\n        private string _Filter = string.Empty;\n        private Dictionary<string, object> _Value = null;\n        /// <summary>\n        /// \n        /// </summary>\n        public string Filter { get => _Filter; set => _Filter = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public Dictionary<string, object> Value { get => _Value; set => _Value = value; }\n    }\n```\n\nService**IBaseService**\n```csharp\n    public interface IBaseService<T> : IDisposable\n    {\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"pageIndex\"></param>\n        /// <param name=\"pageSize\"></param>\n        /// <param name=\"strField\"></param>\n        /// <param name=\"filter\"></param>\n        /// <param name=\"strOrder\"></param>\n        /// <param name=\"totalCount\"></param>\n        /// <returns></returns>\n        List<T> GetPageList(int pageIndex, int pageSize, string strField, SqlFilterEntity filter, string strOrder, out int totalCount);\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"field\"></param>\n        /// <param name=\"filter\"></param>\n        /// <returns></returns>\n        ISugarQueryable<T> GetList(string field, SqlFilterEntity filter);\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <returns></returns>\n        ISugarQueryable<T> GetList(int top = 0);\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"field\"></param>\n        /// <param name=\"filter\"></param>\n        /// <returns></returns>\n        T GetEntity(SqlFilterEntity filter, string field = \"\");\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"filter\"></param>\n        /// <returns></returns>\n        bool IsExists(SqlFilterEntity filter);\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"entity\"></param>\n        /// <param name=\"ignoreColumns\"></param>\n        /// <param name=\"isLock\"></param>\n        /// <returns>id</returns>\n        int Insert(T entity, List<string> ignoreColumns = null, bool isLock = false);\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"entity\"></param>\n        /// <param name=\"ignoreColumns\"></param>\n        /// <param name=\"isLock\"></param>\n        /// <returns></returns>\n        bool Update(T entity, List<string> ignoreColumns = null, bool isLock = false);\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"entity\"></param>\n        /// <param name=\"isLock\"></param>\n        /// <returns></returns>\n        bool Delete(T entity, bool isLock = false);\n\n    }\n```\nSqlFilterEntityWhere\n\n**BaseService**\n\n```csharp\n    public class BaseService<T> : IBaseService<T> where T : class, new()\n    {\n        private BaseDbContext baseDb;\n        protected SqlSugarClient db;\n\n        public BaseService()\n        {\n            baseDb = new BaseDbContext(\"\");\n            db = baseDb.Db;\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"pageIndex\"></param>\n        /// <param name=\"pageSize\"></param>\n        /// <param name=\"strField\"></param>\n        /// <param name=\"filter\"></param>\n        /// <param name=\"strOrder\"></param>\n        /// <param name=\"totalCount\"></param>\n        /// <returns></returns>\n        public List<T> GetPageList(int pageIndex, int pageSize, string strField, SqlFilterEntity filter, string strOrder, out int totalCount)\n        {\n            totalCount = 0;\n            if (pageIndex <= 0)\n            {\n                pageIndex = 1;\n            }\n            if (pageSize <= 0)\n            {\n                pageSize = 10;//10\n            }\n            if (string.IsNullOrEmpty(strField))\n            {\n                strField = \"\";\n            }\n            if (string.IsNullOrEmpty(strOrder))\n            {\n                strOrder = string.Format(\"ID asc\");//Config\n            }\n            if (filter == null)\n            {\n                filter = new SqlFilterEntity();\n            }\n            return db.Queryable<T>().With(SqlWith.NoLock).Select(strField).WhereIF(!string.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value).OrderByIF(!string.IsNullOrEmpty(strOrder), strOrder).ToPageList(pageIndex, pageSize, ref totalCount);\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"field\"></param>\n        /// <param name=\"filter\"></param>\n        /// <returns></returns>\n        public ISugarQueryable<T> GetList(string field, SqlFilterEntity filter)\n        {\n            if (string.IsNullOrEmpty(field))\n            {\n                field = \"\";\n            }\n            if (filter == null)\n            {\n                filter = new SqlFilterEntity();\n            }\n            return db.Queryable<T>().With(SqlWith.NoLock).Select(field).WhereIF(!string.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value);\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <returns></returns>\n        public ISugarQueryable<T> GetList(int top = 0)\n        {\n            if (top > 0)\n            {\n                return db.Queryable<T>().With(SqlWith.NoLock).Take(top);\n            }\n            else\n            {\n                return db.Queryable<T>().With(SqlWith.NoLock);\n            }\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"field\"></param>\n        /// <param name=\"filter\"></param>\n        /// <returns></returns>\n        public T GetEntity(SqlFilterEntity filter, string field = \"\")\n        {\n            if (string.IsNullOrEmpty(field))\n            {\n                field = \"\";\n            }\n            if (filter != null)\n            {\n                return db.Queryable<T>().With(SqlWith.NoLock).Select(field).WhereIF(!string.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value).First();\n            }\n            return default(T);\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"filter\"></param>\n        /// <returns></returns>\n        public bool IsExists(SqlFilterEntity filter)\n        {\n            var result = db.Queryable<T>().With(SqlWith.NoLock).WhereIF(!string.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value).Count();\n            return result > 0;\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"entity\"></param>\n        /// <param name=\"ignoreColumns\"></param>\n        /// <param name=\"isLock\"></param>\n        /// <returns>id</returns>\n        public int Insert(T entity, List<string> ignoreColumns = null, bool isLock = false)\n        {\n            if (ignoreColumns == null)\n            {\n                ignoreColumns = new List<string>();\n            }\n            var result = isLock ?\n                db.Insertable(entity).With(SqlWith.UpdLock).IgnoreColumns(ignoreColumns.ToArray()).ExecuteReturnIdentity()\n                : db.Insertable(entity).IgnoreColumns(ignoreColumns.ToArray()).ExecuteReturnIdentity();\n            return result;\n        }\n\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"entity\"></param>\n        /// <param name=\"ignoreColumns\"></param>\n        /// <param name=\"isLock\"></param>\n        /// <returns></returns>\n        public bool Update(T entity, List<string> ignoreColumns = null, bool isLock = false)\n        {\n            if (ignoreColumns == null)\n            {\n                ignoreColumns = new List<string>();\n            }\n            var result = isLock ?\n                db.Updateable(entity).With(SqlWith.UpdLock).IgnoreColumns(ignoreColumns.ToArray()).ExecuteCommand()\n                : db.Updateable(entity).IgnoreColumns(ignoreColumns.ToArray()).ExecuteCommand();\n            return result > 0;\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"entity\"></param>\n        /// <param name=\"isLock\"></param>\n        /// <returns></returns>\n        public bool Delete(T entity, bool isLock = false)\n        {\n            var result = isLock ?\n                db.Deleteable<T>(entity).With(SqlWith.RowLock).ExecuteCommand().ObjToBool()\n                : db.Deleteable<T>(entity).ExecuteCommand().ObjToBool();\n            return result;\n        }\n\n        public void Dispose()\n        {\n\n        }\n    }\n```\n\n### \n**Part 2**","source":"_posts/net-core-sqlsugar-1.md","raw":"---\ntitle: net core Webapi_Part 1\ndate: 2019-07-18 19:31:41\ntags: net core\ncategories: AprilBlank\n---\n\n### \n[net core Webapi](/2019/07/10/net-core-cache/)\n\n### SqlSugar\nEFDappernet coreDapperOkCV**SqlSugar**[](http://www.codeisbug.com/)\n\n> \n**April.Util****April.Service****April.Entity**\n\nServiceEntityNuGet**sqlSugarCore**[net core Webapilog4net](/2019/07/04/net-core-log4net/)\n\nNuGet\n\nEntity**StudentEntity**\n\n```csharp\n    public class StudentEntity\n    {\n        private int _ID = -1;\n        private string _Name = string.Empty;\n        private string _Number = string.Empty;\n        private int _Age = 0;\n        private int _Sex = 0;\n        private string _Address = string.Empty;\n    }\n```\ngetsetIDECtrl+R+E\n![](net-core-sqlsugar-1/1.png)\nEntitySqlSugar\n\n```csharp\n\t[SugarTable(\"test_Student\")]\n    public class StudentEntity\n    {\n        private int _ID = -1;\n        private string _Name = string.Empty;\n        private string _Number = string.Empty;\n        private int _Age = 0;\n        private int _Sex = 0;\n        private string _Address = string.Empty;\n\n        /// <summary>\n        /// \n        /// </summary>\n        [SugarColumn(IsPrimaryKey = true, IsIdentity = true)]\n        public int ID { get => _ID; set => _ID = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public string Name { get => _Name; set => _Name = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public string Number { get => _Number; set => _Number = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public int Age { get => _Age; set => _Age = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public int Sex { get => _Sex; set => _Sex = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        [SugarColumn(ColumnName = \"test_Address\")]\n        public string Address { get => _Address; set => _Address = value; }\n    }\n```\n\n\n\n### Service\n**BaseDbContext**\n```csharp\n\tpublic class BaseDbContext\n    {\n        public SqlSugarClient Db;\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"connStr\"></param>\n        /// <param name=\"sqlType\"></param>\n        public BaseDbContext(string connStr, int sqlType = 1)\n        {\n            InitDataBase(connStr, sqlType);\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"serverIp\">IP</param>\n        /// <param name=\"user\"></param>\n        /// <param name=\"pass\"></param>\n        /// <param name=\"dataBase\"></param>\n        public BaseDbContext(string serverIp, string user, string pass, string dataBase)\n        {\n            string connStr = $\"server={serverIp};user id={user};password={pass};persistsecurityinfo=True;database={dataBase}\";\n            InitDataBase(connStr);\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"listConn\"></param>\n        private void InitDataBase(string connStr, int sqlType = 1)\n        {\n            Db = new SqlSugarClient(new ConnectionConfig()\n            {\n                ConnectionString = connStr,\n                DbType = (DbType)sqlType,\n                IsAutoCloseConnection = true,\n                //SlaveConnectionConfigs = slaveConnectionConfigs\n            });\n            Db.Ado.CommandTimeOut = 30000;//\n            Db.Aop.OnLogExecuted = (sql, pars) => //SQL\n            {\n                //sql\n            };\n            Db.Aop.OnLogExecuting = (sql, pars) => //SQL\n            {\n                //sql\n            };\n            Db.Aop.OnError = (exp) =>//SQL \n            {\n                //sql\n            };\n            Db.Aop.OnExecutingChangeSql = (sql, pars) => //SQL SQL\n            {\n                return new KeyValuePair<string, SugarParameter[]>(sql, pars);\n            };\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        public void BeginTran()\n        {\n            Db.Ado.BeginTran();\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        public void CommitTran()\n        {\n            Db.Ado.CommitTran();\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        public void RollbackTran()\n        {\n            Db.Ado.RollbackTran();\n        }\n    }\n```\n\n\n\n### BaseService\n> net coreRepositorysqlServiceBll\n\nUtil**SqlSqlFilterEntity**lambda\n\n```csharp\n    public class SqlFilterEntity\n    {\n        private string _Filter = string.Empty;\n        private Dictionary<string, object> _Value = null;\n        /// <summary>\n        /// \n        /// </summary>\n        public string Filter { get => _Filter; set => _Filter = value; }\n        /// <summary>\n        /// \n        /// </summary>\n        public Dictionary<string, object> Value { get => _Value; set => _Value = value; }\n    }\n```\n\nService**IBaseService**\n```csharp\n    public interface IBaseService<T> : IDisposable\n    {\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"pageIndex\"></param>\n        /// <param name=\"pageSize\"></param>\n        /// <param name=\"strField\"></param>\n        /// <param name=\"filter\"></param>\n        /// <param name=\"strOrder\"></param>\n        /// <param name=\"totalCount\"></param>\n        /// <returns></returns>\n        List<T> GetPageList(int pageIndex, int pageSize, string strField, SqlFilterEntity filter, string strOrder, out int totalCount);\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"field\"></param>\n        /// <param name=\"filter\"></param>\n        /// <returns></returns>\n        ISugarQueryable<T> GetList(string field, SqlFilterEntity filter);\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <returns></returns>\n        ISugarQueryable<T> GetList(int top = 0);\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"field\"></param>\n        /// <param name=\"filter\"></param>\n        /// <returns></returns>\n        T GetEntity(SqlFilterEntity filter, string field = \"\");\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"filter\"></param>\n        /// <returns></returns>\n        bool IsExists(SqlFilterEntity filter);\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"entity\"></param>\n        /// <param name=\"ignoreColumns\"></param>\n        /// <param name=\"isLock\"></param>\n        /// <returns>id</returns>\n        int Insert(T entity, List<string> ignoreColumns = null, bool isLock = false);\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"entity\"></param>\n        /// <param name=\"ignoreColumns\"></param>\n        /// <param name=\"isLock\"></param>\n        /// <returns></returns>\n        bool Update(T entity, List<string> ignoreColumns = null, bool isLock = false);\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"entity\"></param>\n        /// <param name=\"isLock\"></param>\n        /// <returns></returns>\n        bool Delete(T entity, bool isLock = false);\n\n    }\n```\nSqlFilterEntityWhere\n\n**BaseService**\n\n```csharp\n    public class BaseService<T> : IBaseService<T> where T : class, new()\n    {\n        private BaseDbContext baseDb;\n        protected SqlSugarClient db;\n\n        public BaseService()\n        {\n            baseDb = new BaseDbContext(\"\");\n            db = baseDb.Db;\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"pageIndex\"></param>\n        /// <param name=\"pageSize\"></param>\n        /// <param name=\"strField\"></param>\n        /// <param name=\"filter\"></param>\n        /// <param name=\"strOrder\"></param>\n        /// <param name=\"totalCount\"></param>\n        /// <returns></returns>\n        public List<T> GetPageList(int pageIndex, int pageSize, string strField, SqlFilterEntity filter, string strOrder, out int totalCount)\n        {\n            totalCount = 0;\n            if (pageIndex <= 0)\n            {\n                pageIndex = 1;\n            }\n            if (pageSize <= 0)\n            {\n                pageSize = 10;//10\n            }\n            if (string.IsNullOrEmpty(strField))\n            {\n                strField = \"\";\n            }\n            if (string.IsNullOrEmpty(strOrder))\n            {\n                strOrder = string.Format(\"ID asc\");//Config\n            }\n            if (filter == null)\n            {\n                filter = new SqlFilterEntity();\n            }\n            return db.Queryable<T>().With(SqlWith.NoLock).Select(strField).WhereIF(!string.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value).OrderByIF(!string.IsNullOrEmpty(strOrder), strOrder).ToPageList(pageIndex, pageSize, ref totalCount);\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"field\"></param>\n        /// <param name=\"filter\"></param>\n        /// <returns></returns>\n        public ISugarQueryable<T> GetList(string field, SqlFilterEntity filter)\n        {\n            if (string.IsNullOrEmpty(field))\n            {\n                field = \"\";\n            }\n            if (filter == null)\n            {\n                filter = new SqlFilterEntity();\n            }\n            return db.Queryable<T>().With(SqlWith.NoLock).Select(field).WhereIF(!string.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value);\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <returns></returns>\n        public ISugarQueryable<T> GetList(int top = 0)\n        {\n            if (top > 0)\n            {\n                return db.Queryable<T>().With(SqlWith.NoLock).Take(top);\n            }\n            else\n            {\n                return db.Queryable<T>().With(SqlWith.NoLock);\n            }\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"field\"></param>\n        /// <param name=\"filter\"></param>\n        /// <returns></returns>\n        public T GetEntity(SqlFilterEntity filter, string field = \"\")\n        {\n            if (string.IsNullOrEmpty(field))\n            {\n                field = \"\";\n            }\n            if (filter != null)\n            {\n                return db.Queryable<T>().With(SqlWith.NoLock).Select(field).WhereIF(!string.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value).First();\n            }\n            return default(T);\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"filter\"></param>\n        /// <returns></returns>\n        public bool IsExists(SqlFilterEntity filter)\n        {\n            var result = db.Queryable<T>().With(SqlWith.NoLock).WhereIF(!string.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value).Count();\n            return result > 0;\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"entity\"></param>\n        /// <param name=\"ignoreColumns\"></param>\n        /// <param name=\"isLock\"></param>\n        /// <returns>id</returns>\n        public int Insert(T entity, List<string> ignoreColumns = null, bool isLock = false)\n        {\n            if (ignoreColumns == null)\n            {\n                ignoreColumns = new List<string>();\n            }\n            var result = isLock ?\n                db.Insertable(entity).With(SqlWith.UpdLock).IgnoreColumns(ignoreColumns.ToArray()).ExecuteReturnIdentity()\n                : db.Insertable(entity).IgnoreColumns(ignoreColumns.ToArray()).ExecuteReturnIdentity();\n            return result;\n        }\n\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"entity\"></param>\n        /// <param name=\"ignoreColumns\"></param>\n        /// <param name=\"isLock\"></param>\n        /// <returns></returns>\n        public bool Update(T entity, List<string> ignoreColumns = null, bool isLock = false)\n        {\n            if (ignoreColumns == null)\n            {\n                ignoreColumns = new List<string>();\n            }\n            var result = isLock ?\n                db.Updateable(entity).With(SqlWith.UpdLock).IgnoreColumns(ignoreColumns.ToArray()).ExecuteCommand()\n                : db.Updateable(entity).IgnoreColumns(ignoreColumns.ToArray()).ExecuteCommand();\n            return result > 0;\n        }\n\n        /// <summary>\n        /// \n        /// </summary>\n        /// <param name=\"entity\"></param>\n        /// <param name=\"isLock\"></param>\n        /// <returns></returns>\n        public bool Delete(T entity, bool isLock = false)\n        {\n            var result = isLock ?\n                db.Deleteable<T>(entity).With(SqlWith.RowLock).ExecuteCommand().ObjToBool()\n                : db.Deleteable<T>(entity).ExecuteCommand().ObjToBool();\n            return result;\n        }\n\n        public void Dispose()\n        {\n\n        }\n    }\n```\n\n### \n**Part 2**","slug":"net-core-sqlsugar-1","published":1,"updated":"2019-09-30T05:47:11.049Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck39k3m4p004d9sv7nsv20ec2","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"/2019/07/10/net-core-cache/\">net core Webapi</a></p>\n<h3 id=\"SqlSugar\"><a href=\"#SqlSugar\" class=\"headerlink\" title=\"SqlSugar\"></a>SqlSugar</h3><p>EFDappernet coreDapperOkCV<strong>SqlSugar</strong><a href=\"http://www.codeisbug.com/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<blockquote>\n<p><br><strong>April.Util</strong><strong>April.Service</strong><strong>April.Entity</strong></p>\n</blockquote>\n<p>ServiceEntityNuGet<strong>sqlSugarCore</strong><a href=\"/2019/07/04/net-core-log4net/\">net core Webapilog4net</a></p>\n<p>NuGet</p>\n<p>Entity<strong>StudentEntity</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">StudentEntity</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _ID = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Name = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Number = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _Age = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _Sex = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Address = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>getsetIDECtrl+R+E<br><img src=\"/2019/07/18/net-core-sqlsugar-1/1.png\" alt=\"\"><br>EntitySqlSugar</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">SugarTable(<span class=\"meta-string\">\"test_Student\"</span>)</span>]</span><br><span class=\"line\">   <span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">StudentEntity</span></span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">       <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _ID = <span class=\"number\">-1</span>;</span><br><span class=\"line\">       <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Name = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">       <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Number = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">       <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _Age = <span class=\"number\">0</span>;</span><br><span class=\"line\">       <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _Sex = <span class=\"number\">0</span>;</span><br><span class=\"line\">       <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Address = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       [<span class=\"meta\">SugarColumn(IsPrimaryKey = true, IsIdentity = true)</span>]</span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> ID &#123; <span class=\"keyword\">get</span> =&gt; _ID; <span class=\"keyword\">set</span> =&gt; _ID = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Name &#123; <span class=\"keyword\">get</span> =&gt; _Name; <span class=\"keyword\">set</span> =&gt; _Name = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Number &#123; <span class=\"keyword\">get</span> =&gt; _Number; <span class=\"keyword\">set</span> =&gt; _Number = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> Age &#123; <span class=\"keyword\">get</span> =&gt; _Age; <span class=\"keyword\">set</span> =&gt; _Age = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> Sex &#123; <span class=\"keyword\">get</span> =&gt; _Sex; <span class=\"keyword\">set</span> =&gt; _Sex = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       [<span class=\"meta\">SugarColumn(ColumnName = <span class=\"meta-string\">\"test_Address\"</span>)</span>]</span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Address &#123; <span class=\"keyword\">get</span> =&gt; _Address; <span class=\"keyword\">set</span> =&gt; _Address = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"Service\"><a href=\"#Service\" class=\"headerlink\" title=\"Service\"></a>Service</h3><p><strong>BaseDbContext</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">BaseDbContext</span></span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">       <span class=\"keyword\">public</span> SqlSugarClient Db;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"connStr\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"sqlType\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">BaseDbContext</span>(<span class=\"params\"><span class=\"keyword\">string</span> connStr, <span class=\"keyword\">int</span> sqlType = <span class=\"number\">1</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           InitDataBase(connStr, sqlType);</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"serverIp\"&gt;</span>IP<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"user\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"pass\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"dataBase\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">BaseDbContext</span>(<span class=\"params\"><span class=\"keyword\">string</span> serverIp, <span class=\"keyword\">string</span> user, <span class=\"keyword\">string</span> pass, <span class=\"keyword\">string</span> dataBase</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">string</span> connStr = <span class=\"string\">$\"server=<span class=\"subst\">&#123;serverIp&#125;</span>;user id=<span class=\"subst\">&#123;user&#125;</span>;password=<span class=\"subst\">&#123;pass&#125;</span>;persistsecurityinfo=True;database=<span class=\"subst\">&#123;dataBase&#125;</span>\"</span>;</span><br><span class=\"line\">           InitDataBase(connStr);</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"listConn\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">InitDataBase</span>(<span class=\"params\"><span class=\"keyword\">string</span> connStr, <span class=\"keyword\">int</span> sqlType = <span class=\"number\">1</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           Db = <span class=\"keyword\">new</span> SqlSugarClient(<span class=\"keyword\">new</span> ConnectionConfig()</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               ConnectionString = connStr,</span><br><span class=\"line\">               DbType = (DbType)sqlType,</span><br><span class=\"line\">               IsAutoCloseConnection = <span class=\"literal\">true</span>,</span><br><span class=\"line\">               <span class=\"comment\">//SlaveConnectionConfigs = slaveConnectionConfigs</span></span><br><span class=\"line\">           &#125;);</span><br><span class=\"line\">           Db.Ado.CommandTimeOut = <span class=\"number\">30000</span>;<span class=\"comment\">//</span></span><br><span class=\"line\">           Db.Aop.OnLogExecuted = (sql, pars) =&gt; <span class=\"comment\">//SQL</span></span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"comment\">//sql</span></span><br><span class=\"line\">           &#125;;</span><br><span class=\"line\">           Db.Aop.OnLogExecuting = (sql, pars) =&gt; <span class=\"comment\">//SQL</span></span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"comment\">//sql</span></span><br><span class=\"line\">           &#125;;</span><br><span class=\"line\">           Db.Aop.OnError = (exp) =&gt;<span class=\"comment\">//SQL </span></span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"comment\">//sql</span></span><br><span class=\"line\">           &#125;;</span><br><span class=\"line\">           Db.Aop.OnExecutingChangeSql = (sql, pars) =&gt; <span class=\"comment\">//SQL SQL</span></span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> KeyValuePair&lt;<span class=\"keyword\">string</span>, SugarParameter[]&gt;(sql, pars);</span><br><span class=\"line\">           &#125;;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">BeginTran</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           Db.Ado.BeginTran();</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">CommitTran</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           Db.Ado.CommitTran();</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">RollbackTran</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           Db.Ado.RollbackTran();</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"BaseService\"><a href=\"#BaseService\" class=\"headerlink\" title=\"BaseService\"></a>BaseService</h3><blockquote>\n<p>net coreRepositorysqlServiceBll</p>\n</blockquote>\n<p>Util<strong>SqlSqlFilterEntity</strong>lambda</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">SqlFilterEntity</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Filter = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; _Value = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Filter &#123; <span class=\"keyword\">get</span> =&gt; _Filter; <span class=\"keyword\">set</span> =&gt; _Filter = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; Value &#123; <span class=\"keyword\">get</span> =&gt; _Value; <span class=\"keyword\">set</span> =&gt; _Value = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Service<strong>IBaseService</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public interface IBaseService&lt;T&gt; : IDisposable</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"pageIndex\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"pageSize\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"strField\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"strOrder\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"totalCount\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\">List&lt;T&gt; <span class=\"title\">GetPageList</span>(<span class=\"params\"><span class=\"keyword\">int</span> pageIndex, <span class=\"keyword\">int</span> pageSize, <span class=\"keyword\">string</span> strField, SqlFilterEntity filter, <span class=\"keyword\">string</span> strOrder, <span class=\"keyword\">out</span> <span class=\"keyword\">int</span> totalCount</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"field\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\">ISugarQueryable&lt;T&gt; <span class=\"title\">GetList</span>(<span class=\"params\"><span class=\"keyword\">string</span> field, SqlFilterEntity filter</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\">ISugarQueryable&lt;T&gt; <span class=\"title\">GetList</span>(<span class=\"params\"><span class=\"keyword\">int</span> top = <span class=\"number\">0</span></span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"field\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\">T <span class=\"title\">GetEntity</span>(<span class=\"params\">SqlFilterEntity filter, <span class=\"keyword\">string</span> field = <span class=\"string\">\"\"</span></span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">bool</span> <span class=\"title\">IsExists</span>(<span class=\"params\">SqlFilterEntity filter</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"entity\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"ignoreColumns\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"isLock\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span>id<span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">Insert</span>(<span class=\"params\">T entity, List&lt;<span class=\"keyword\">string</span>&gt; ignoreColumns = <span class=\"literal\">null</span>, <span class=\"keyword\">bool</span> isLock = <span class=\"literal\">false</span></span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"entity\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"ignoreColumns\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"isLock\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">bool</span> <span class=\"title\">Update</span>(<span class=\"params\">T entity, List&lt;<span class=\"keyword\">string</span>&gt; ignoreColumns = <span class=\"literal\">null</span>, <span class=\"keyword\">bool</span> isLock = <span class=\"literal\">false</span></span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"entity\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"isLock\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">bool</span> <span class=\"title\">Delete</span>(<span class=\"params\">T entity, <span class=\"keyword\">bool</span> isLock = <span class=\"literal\">false</span></span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>SqlFilterEntityWhere</p>\n<p><strong>BaseService</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class BaseService&lt;T&gt; : IBaseService&lt;T&gt; where T : class, new()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> BaseDbContext baseDb;</span><br><span class=\"line\">    <span class=\"keyword\">protected</span> SqlSugarClient db;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">BaseService</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        baseDb = <span class=\"keyword\">new</span> BaseDbContext(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        db = baseDb.Db;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"pageIndex\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"pageSize\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"strField\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"strOrder\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"totalCount\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;T&gt; <span class=\"title\">GetPageList</span>(<span class=\"params\"><span class=\"keyword\">int</span> pageIndex, <span class=\"keyword\">int</span> pageSize, <span class=\"keyword\">string</span> strField, SqlFilterEntity filter, <span class=\"keyword\">string</span> strOrder, <span class=\"keyword\">out</span> <span class=\"keyword\">int</span> totalCount</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        totalCount = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pageIndex &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            pageIndex = <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pageSize &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            pageSize = <span class=\"number\">10</span>;<span class=\"comment\">//10</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(strField))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            strField = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(strOrder))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            strOrder = <span class=\"keyword\">string</span>.Format(<span class=\"string\">\"ID asc\"</span>);<span class=\"comment\">//Config</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (filter == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            filter = <span class=\"keyword\">new</span> SqlFilterEntity();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> db.Queryable&lt;T&gt;().With(SqlWith.NoLock).Select(strField).WhereIF(!<span class=\"keyword\">string</span>.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value).OrderByIF(!<span class=\"keyword\">string</span>.IsNullOrEmpty(strOrder), strOrder).ToPageList(pageIndex, pageSize, <span class=\"keyword\">ref</span> totalCount);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"field\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ISugarQueryable&lt;T&gt; <span class=\"title\">GetList</span>(<span class=\"params\"><span class=\"keyword\">string</span> field, SqlFilterEntity filter</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(field))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            field = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (filter == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            filter = <span class=\"keyword\">new</span> SqlFilterEntity();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> db.Queryable&lt;T&gt;().With(SqlWith.NoLock).Select(field).WhereIF(!<span class=\"keyword\">string</span>.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ISugarQueryable&lt;T&gt; <span class=\"title\">GetList</span>(<span class=\"params\"><span class=\"keyword\">int</span> top = <span class=\"number\">0</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (top &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> db.Queryable&lt;T&gt;().With(SqlWith.NoLock).Take(top);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> db.Queryable&lt;T&gt;().With(SqlWith.NoLock);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"field\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> T <span class=\"title\">GetEntity</span>(<span class=\"params\">SqlFilterEntity filter, <span class=\"keyword\">string</span> field = <span class=\"string\">\"\"</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(field))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            field = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (filter != <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> db.Queryable&lt;T&gt;().With(SqlWith.NoLock).Select(field).WhereIF(!<span class=\"keyword\">string</span>.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value).First();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">default</span>(T);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">bool</span> <span class=\"title\">IsExists</span>(<span class=\"params\">SqlFilterEntity filter</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = db.Queryable&lt;T&gt;().With(SqlWith.NoLock).WhereIF(!<span class=\"keyword\">string</span>.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value).Count();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result &gt; <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"entity\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"ignoreColumns\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"isLock\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span>id<span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">Insert</span>(<span class=\"params\">T entity, List&lt;<span class=\"keyword\">string</span>&gt; ignoreColumns = <span class=\"literal\">null</span>, <span class=\"keyword\">bool</span> isLock = <span class=\"literal\">false</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ignoreColumns == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            ignoreColumns = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = isLock ?</span><br><span class=\"line\">            db.Insertable(entity).With(SqlWith.UpdLock).IgnoreColumns(ignoreColumns.ToArray()).ExecuteReturnIdentity()</span><br><span class=\"line\">            : db.Insertable(entity).IgnoreColumns(ignoreColumns.ToArray()).ExecuteReturnIdentity();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"entity\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"ignoreColumns\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"isLock\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">bool</span> <span class=\"title\">Update</span>(<span class=\"params\">T entity, List&lt;<span class=\"keyword\">string</span>&gt; ignoreColumns = <span class=\"literal\">null</span>, <span class=\"keyword\">bool</span> isLock = <span class=\"literal\">false</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ignoreColumns == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            ignoreColumns = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = isLock ?</span><br><span class=\"line\">            db.Updateable(entity).With(SqlWith.UpdLock).IgnoreColumns(ignoreColumns.ToArray()).ExecuteCommand()</span><br><span class=\"line\">            : db.Updateable(entity).IgnoreColumns(ignoreColumns.ToArray()).ExecuteCommand();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result &gt; <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"entity\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"isLock\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">bool</span> <span class=\"title\">Delete</span>(<span class=\"params\">T entity, <span class=\"keyword\">bool</span> isLock = <span class=\"literal\">false</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = isLock ?</span><br><span class=\"line\">            db.Deleteable&lt;T&gt;(entity).With(SqlWith.RowLock).ExecuteCommand().ObjToBool()</span><br><span class=\"line\">            : db.Deleteable&lt;T&gt;(entity).ExecuteCommand().ObjToBool();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Dispose</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>Part 2</strong></p>\n","site":{"data":{"temp":{"language":"zh-CN","description":"3wly ","keywords":"d-107,m-finder,3wly,blank,,","menu":{"":"/","":"/archives","":"/about"},"subnav":{"github":"https://github.com/d-107","qq":"//shang.qq.com/wpa/qunwpa?idkey=7221c889336da3d56c33380b59c0883ea67d0c15f6883fa50d4478ff136a1e0d","mail":"mailto:m@m-finder.com"},"favicon":"/images/favicon.ico","logo":"/images/d-107.png","friends":{"M-finder":"https://www.m-finder.com","AprilBlank":"https://www.cnblogs.com/AprilBlank/","":"http://blog.csdn.net/qq_27948659","Sgclzqq":"http://www.sgclzqq.com/","Wait":"https://93xiaosi.github.io/","WangWeiQiang":"https://thekingstyle.github.io/"},"gitment":{"enable":false,"lazy":false,"admins":["'m-finder'","'AprilBlank'"],"github_user":"d-107","github_repo":"d-107-gitment","client_id":"be9a4c4f23fb136eb563","client_secret":"4d073881c7c960d6eb85082ebd1d33ceed88eab9"},"valine":{"enable":true,"appId":"oxinNxVcEtTnMxQAIoeWWIB8-MdYXbMMI","appKey":"egs7BlX8kO6FuIdaXxDvhe07","notify":false,"verify":false,"placeholder":" ()"},"stylesheets":["/css/sense.css"],"scripts":["/js/jquery-3.4.1.min.js","/js/sense.js","/js/image-view.js"],"sakura":false,"snow":false,"firework":true,"traffic":false}}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"/2019/07/10/net-core-cache/\">net core Webapi</a></p>\n<h3 id=\"SqlSugar\"><a href=\"#SqlSugar\" class=\"headerlink\" title=\"SqlSugar\"></a>SqlSugar</h3><p>EFDappernet coreDapperOkCV<strong>SqlSugar</strong><a href=\"http://www.codeisbug.com/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<blockquote>\n<p><br><strong>April.Util</strong><strong>April.Service</strong><strong>April.Entity</strong></p>\n</blockquote>\n<p>ServiceEntityNuGet<strong>sqlSugarCore</strong><a href=\"/2019/07/04/net-core-log4net/\">net core Webapilog4net</a></p>\n<p>NuGet</p>\n<p>Entity<strong>StudentEntity</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">StudentEntity</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _ID = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Name = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Number = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _Age = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _Sex = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Address = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>getsetIDECtrl+R+E<br><img src=\"/2019/07/18/net-core-sqlsugar-1/1.png\" alt=\"\"><br>EntitySqlSugar</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">SugarTable(<span class=\"meta-string\">\"test_Student\"</span>)</span>]</span><br><span class=\"line\">   <span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">StudentEntity</span></span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">       <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _ID = <span class=\"number\">-1</span>;</span><br><span class=\"line\">       <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Name = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">       <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Number = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">       <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _Age = <span class=\"number\">0</span>;</span><br><span class=\"line\">       <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _Sex = <span class=\"number\">0</span>;</span><br><span class=\"line\">       <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Address = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       [<span class=\"meta\">SugarColumn(IsPrimaryKey = true, IsIdentity = true)</span>]</span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> ID &#123; <span class=\"keyword\">get</span> =&gt; _ID; <span class=\"keyword\">set</span> =&gt; _ID = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Name &#123; <span class=\"keyword\">get</span> =&gt; _Name; <span class=\"keyword\">set</span> =&gt; _Name = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Number &#123; <span class=\"keyword\">get</span> =&gt; _Number; <span class=\"keyword\">set</span> =&gt; _Number = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> Age &#123; <span class=\"keyword\">get</span> =&gt; _Age; <span class=\"keyword\">set</span> =&gt; _Age = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> Sex &#123; <span class=\"keyword\">get</span> =&gt; _Sex; <span class=\"keyword\">set</span> =&gt; _Sex = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       [<span class=\"meta\">SugarColumn(ColumnName = <span class=\"meta-string\">\"test_Address\"</span>)</span>]</span><br><span class=\"line\">       <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Address &#123; <span class=\"keyword\">get</span> =&gt; _Address; <span class=\"keyword\">set</span> =&gt; _Address = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"Service\"><a href=\"#Service\" class=\"headerlink\" title=\"Service\"></a>Service</h3><p><strong>BaseDbContext</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">BaseDbContext</span></span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">       <span class=\"keyword\">public</span> SqlSugarClient Db;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"connStr\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"sqlType\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">BaseDbContext</span>(<span class=\"params\"><span class=\"keyword\">string</span> connStr, <span class=\"keyword\">int</span> sqlType = <span class=\"number\">1</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           InitDataBase(connStr, sqlType);</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"serverIp\"&gt;</span>IP<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"user\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"pass\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"dataBase\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">BaseDbContext</span>(<span class=\"params\"><span class=\"keyword\">string</span> serverIp, <span class=\"keyword\">string</span> user, <span class=\"keyword\">string</span> pass, <span class=\"keyword\">string</span> dataBase</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           <span class=\"keyword\">string</span> connStr = <span class=\"string\">$\"server=<span class=\"subst\">&#123;serverIp&#125;</span>;user id=<span class=\"subst\">&#123;user&#125;</span>;password=<span class=\"subst\">&#123;pass&#125;</span>;persistsecurityinfo=True;database=<span class=\"subst\">&#123;dataBase&#125;</span>\"</span>;</span><br><span class=\"line\">           InitDataBase(connStr);</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"listConn\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">InitDataBase</span>(<span class=\"params\"><span class=\"keyword\">string</span> connStr, <span class=\"keyword\">int</span> sqlType = <span class=\"number\">1</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           Db = <span class=\"keyword\">new</span> SqlSugarClient(<span class=\"keyword\">new</span> ConnectionConfig()</span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               ConnectionString = connStr,</span><br><span class=\"line\">               DbType = (DbType)sqlType,</span><br><span class=\"line\">               IsAutoCloseConnection = <span class=\"literal\">true</span>,</span><br><span class=\"line\">               <span class=\"comment\">//SlaveConnectionConfigs = slaveConnectionConfigs</span></span><br><span class=\"line\">           &#125;);</span><br><span class=\"line\">           Db.Ado.CommandTimeOut = <span class=\"number\">30000</span>;<span class=\"comment\">//</span></span><br><span class=\"line\">           Db.Aop.OnLogExecuted = (sql, pars) =&gt; <span class=\"comment\">//SQL</span></span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"comment\">//sql</span></span><br><span class=\"line\">           &#125;;</span><br><span class=\"line\">           Db.Aop.OnLogExecuting = (sql, pars) =&gt; <span class=\"comment\">//SQL</span></span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"comment\">//sql</span></span><br><span class=\"line\">           &#125;;</span><br><span class=\"line\">           Db.Aop.OnError = (exp) =&gt;<span class=\"comment\">//SQL </span></span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"comment\">//sql</span></span><br><span class=\"line\">           &#125;;</span><br><span class=\"line\">           Db.Aop.OnExecutingChangeSql = (sql, pars) =&gt; <span class=\"comment\">//SQL SQL</span></span><br><span class=\"line\">           &#123;</span><br><span class=\"line\">               <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> KeyValuePair&lt;<span class=\"keyword\">string</span>, SugarParameter[]&gt;(sql, pars);</span><br><span class=\"line\">           &#125;;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">BeginTran</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           Db.Ado.BeginTran();</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">CommitTran</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           Db.Ado.CommitTran();</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">       <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">RollbackTran</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>       &#123;</span><br><span class=\"line\">           Db.Ado.RollbackTran();</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"BaseService\"><a href=\"#BaseService\" class=\"headerlink\" title=\"BaseService\"></a>BaseService</h3><blockquote>\n<p>net coreRepositorysqlServiceBll</p>\n</blockquote>\n<p>Util<strong>SqlSqlFilterEntity</strong>lambda</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">SqlFilterEntity</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">string</span> _Filter = <span class=\"keyword\">string</span>.Empty;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; _Value = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">string</span> Filter &#123; <span class=\"keyword\">get</span> =&gt; _Filter; <span class=\"keyword\">set</span> =&gt; _Filter = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Dictionary&lt;<span class=\"keyword\">string</span>, <span class=\"keyword\">object</span>&gt; Value &#123; <span class=\"keyword\">get</span> =&gt; _Value; <span class=\"keyword\">set</span> =&gt; _Value = <span class=\"keyword\">value</span>; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Service<strong>IBaseService</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public interface IBaseService&lt;T&gt; : IDisposable</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"pageIndex\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"pageSize\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"strField\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"strOrder\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"totalCount\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\">List&lt;T&gt; <span class=\"title\">GetPageList</span>(<span class=\"params\"><span class=\"keyword\">int</span> pageIndex, <span class=\"keyword\">int</span> pageSize, <span class=\"keyword\">string</span> strField, SqlFilterEntity filter, <span class=\"keyword\">string</span> strOrder, <span class=\"keyword\">out</span> <span class=\"keyword\">int</span> totalCount</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"field\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\">ISugarQueryable&lt;T&gt; <span class=\"title\">GetList</span>(<span class=\"params\"><span class=\"keyword\">string</span> field, SqlFilterEntity filter</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\">ISugarQueryable&lt;T&gt; <span class=\"title\">GetList</span>(<span class=\"params\"><span class=\"keyword\">int</span> top = <span class=\"number\">0</span></span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"field\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\">T <span class=\"title\">GetEntity</span>(<span class=\"params\">SqlFilterEntity filter, <span class=\"keyword\">string</span> field = <span class=\"string\">\"\"</span></span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">bool</span> <span class=\"title\">IsExists</span>(<span class=\"params\">SqlFilterEntity filter</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"entity\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"ignoreColumns\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"isLock\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span>id<span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">Insert</span>(<span class=\"params\">T entity, List&lt;<span class=\"keyword\">string</span>&gt; ignoreColumns = <span class=\"literal\">null</span>, <span class=\"keyword\">bool</span> isLock = <span class=\"literal\">false</span></span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"entity\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"ignoreColumns\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"isLock\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">bool</span> <span class=\"title\">Update</span>(<span class=\"params\">T entity, List&lt;<span class=\"keyword\">string</span>&gt; ignoreColumns = <span class=\"literal\">null</span>, <span class=\"keyword\">bool</span> isLock = <span class=\"literal\">false</span></span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"entity\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"isLock\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">bool</span> <span class=\"title\">Delete</span>(<span class=\"params\">T entity, <span class=\"keyword\">bool</span> isLock = <span class=\"literal\">false</span></span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>SqlFilterEntityWhere</p>\n<p><strong>BaseService</strong></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class BaseService&lt;T&gt; : IBaseService&lt;T&gt; where T : class, new()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> BaseDbContext baseDb;</span><br><span class=\"line\">    <span class=\"keyword\">protected</span> SqlSugarClient db;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">BaseService</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        baseDb = <span class=\"keyword\">new</span> BaseDbContext(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        db = baseDb.Db;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"pageIndex\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"pageSize\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"strField\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"strOrder\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"totalCount\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;T&gt; <span class=\"title\">GetPageList</span>(<span class=\"params\"><span class=\"keyword\">int</span> pageIndex, <span class=\"keyword\">int</span> pageSize, <span class=\"keyword\">string</span> strField, SqlFilterEntity filter, <span class=\"keyword\">string</span> strOrder, <span class=\"keyword\">out</span> <span class=\"keyword\">int</span> totalCount</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        totalCount = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pageIndex &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            pageIndex = <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pageSize &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            pageSize = <span class=\"number\">10</span>;<span class=\"comment\">//10</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(strField))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            strField = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(strOrder))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            strOrder = <span class=\"keyword\">string</span>.Format(<span class=\"string\">\"ID asc\"</span>);<span class=\"comment\">//Config</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (filter == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            filter = <span class=\"keyword\">new</span> SqlFilterEntity();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> db.Queryable&lt;T&gt;().With(SqlWith.NoLock).Select(strField).WhereIF(!<span class=\"keyword\">string</span>.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value).OrderByIF(!<span class=\"keyword\">string</span>.IsNullOrEmpty(strOrder), strOrder).ToPageList(pageIndex, pageSize, <span class=\"keyword\">ref</span> totalCount);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"field\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ISugarQueryable&lt;T&gt; <span class=\"title\">GetList</span>(<span class=\"params\"><span class=\"keyword\">string</span> field, SqlFilterEntity filter</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(field))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            field = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (filter == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            filter = <span class=\"keyword\">new</span> SqlFilterEntity();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> db.Queryable&lt;T&gt;().With(SqlWith.NoLock).Select(field).WhereIF(!<span class=\"keyword\">string</span>.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ISugarQueryable&lt;T&gt; <span class=\"title\">GetList</span>(<span class=\"params\"><span class=\"keyword\">int</span> top = <span class=\"number\">0</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (top &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> db.Queryable&lt;T&gt;().With(SqlWith.NoLock).Take(top);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> db.Queryable&lt;T&gt;().With(SqlWith.NoLock);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"field\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> T <span class=\"title\">GetEntity</span>(<span class=\"params\">SqlFilterEntity filter, <span class=\"keyword\">string</span> field = <span class=\"string\">\"\"</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">string</span>.IsNullOrEmpty(field))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            field = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (filter != <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> db.Queryable&lt;T&gt;().With(SqlWith.NoLock).Select(field).WhereIF(!<span class=\"keyword\">string</span>.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value).First();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">default</span>(T);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"filter\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">bool</span> <span class=\"title\">IsExists</span>(<span class=\"params\">SqlFilterEntity filter</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = db.Queryable&lt;T&gt;().With(SqlWith.NoLock).WhereIF(!<span class=\"keyword\">string</span>.IsNullOrEmpty(filter.Filter), filter.Filter, filter.Value).Count();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result &gt; <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"entity\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"ignoreColumns\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"isLock\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span>id<span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">Insert</span>(<span class=\"params\">T entity, List&lt;<span class=\"keyword\">string</span>&gt; ignoreColumns = <span class=\"literal\">null</span>, <span class=\"keyword\">bool</span> isLock = <span class=\"literal\">false</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ignoreColumns == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            ignoreColumns = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = isLock ?</span><br><span class=\"line\">            db.Insertable(entity).With(SqlWith.UpdLock).IgnoreColumns(ignoreColumns.ToArray()).ExecuteReturnIdentity()</span><br><span class=\"line\">            : db.Insertable(entity).IgnoreColumns(ignoreColumns.ToArray()).ExecuteReturnIdentity();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"entity\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"ignoreColumns\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"isLock\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">bool</span> <span class=\"title\">Update</span>(<span class=\"params\">T entity, List&lt;<span class=\"keyword\">string</span>&gt; ignoreColumns = <span class=\"literal\">null</span>, <span class=\"keyword\">bool</span> isLock = <span class=\"literal\">false</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ignoreColumns == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            ignoreColumns = <span class=\"keyword\">new</span> List&lt;<span class=\"keyword\">string</span>&gt;();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = isLock ?</span><br><span class=\"line\">            db.Updateable(entity).With(SqlWith.UpdLock).IgnoreColumns(ignoreColumns.ToArray()).ExecuteCommand()</span><br><span class=\"line\">            : db.Updateable(entity).IgnoreColumns(ignoreColumns.ToArray()).ExecuteCommand();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result &gt; <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"entity\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"isLock\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">bool</span> <span class=\"title\">Delete</span>(<span class=\"params\">T entity, <span class=\"keyword\">bool</span> isLock = <span class=\"literal\">false</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = isLock ?</span><br><span class=\"line\">            db.Deleteable&lt;T&gt;(entity).With(SqlWith.RowLock).ExecuteCommand().ObjToBool()</span><br><span class=\"line\">            : db.Deleteable&lt;T&gt;(entity).ExecuteCommand().ObjToBool();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Dispose</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>    &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>Part 2</strong></p>\n"}],"PostAsset":[{"_id":"source/_posts/laravel-broadcasting/laravel.jpg","slug":"laravel.jpg","post":"ck39k3m1n000b9sv7zuidy2sl","modified":0,"renderable":0},{"_id":"source/_posts/net-core-log4net/1.png","slug":"1.png","post":"ck39k3m2m001b9sv7ee53sshk","modified":0,"renderable":0},{"_id":"source/_posts/net-core-swagger/1.png","slug":"1.png","post":"ck39k3m2l00179sv7u7ejlici","modified":0,"renderable":0},{"_id":"source/_posts/net-core-cache/1.png","slug":"1.png","post":"ck39k3m3g003l9sv7x7kea258","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/13.png","slug":"13.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/24.png","slug":"24.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/25.png","slug":"25.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/31.png","slug":"31.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/laravel-events/laravel.jpg","slug":"laravel.jpg","post":"ck39k3m1r000d9sv78xzcivyf","modified":0,"renderable":0},{"_id":"source/_posts/hello-php/cover.png","slug":"cover.png","post":"ck39k3m0d00019sv7lk362q5o","modified":0,"renderable":0},{"_id":"source/_posts/net-core-log4net/5.png","slug":"5.png","post":"ck39k3m2m001b9sv7ee53sshk","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/9.png","slug":"9.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/23.png","slug":"23.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/laravel-queues/laravel.jpg","slug":"laravel.jpg","post":"ck39k3m2k00159sv7y039seov","modified":0,"renderable":0},{"_id":"source/_posts/laravel-swoole-in-laradock/laradock.png","slug":"laradock.png","post":"ck39k3m1w000g9sv7gp6wsup7","modified":0,"renderable":0},{"_id":"source/_posts/laravel-mix/laravel-mix.png","slug":"laravel-mix.png","post":"ck39k3m22000i9sv7hiueiqcs","modified":0,"renderable":0},{"_id":"source/_posts/tp5-fileupload-requestfile-is-null/1.png","slug":"1.png","post":"ck39k3m2w00229sv7y31462vg","modified":0,"renderable":0},{"_id":"source/_posts/laravel-swoole-socket-in-laradock/demo.png","slug":"demo.png","post":"ck39k3m27000o9sv701f9th0x","modified":0,"renderable":0},{"_id":"source/_posts/laravel-swoole-socket-in-laradock/laradock.png","slug":"laradock.png","post":"ck39k3m27000o9sv701f9th0x","modified":0,"renderable":0},{"_id":"source/_posts/laravel-queues/email.png","slug":"email.png","post":"ck39k3m2k00159sv7y039seov","modified":0,"renderable":0},{"_id":"source/_posts/net-core-unittest/1.png","slug":"1.png","post":"ck39k3m2n001e9sv7sbbbydqs","modified":0,"renderable":0},{"_id":"source/_posts/net-core-unittest/2.png","slug":"2.png","post":"ck39k3m2n001e9sv7sbbbydqs","modified":0,"renderable":0},{"_id":"source/_posts/vmware-nginx/1.png","slug":"1.png","post":"ck39k3m30002c9sv70dphy82o","modified":0,"renderable":0},{"_id":"source/_posts/vmware-nginx/2.png","slug":"2.png","post":"ck39k3m30002c9sv70dphy82o","modified":0,"renderable":0},{"_id":"source/_posts/laravel-broadcasting/mes.png","slug":"mes.png","post":"ck39k3m1n000b9sv7zuidy2sl","modified":0,"renderable":0},{"_id":"source/_posts/laravel-broadcasting/new.png","slug":"new.png","post":"ck39k3m1n000b9sv7zuidy2sl","modified":0,"renderable":0},{"_id":"source/_posts/laravel-events/new-event.png","slug":"new-event.png","post":"ck39k3m1r000d9sv78xzcivyf","modified":0,"renderable":0},{"_id":"source/_posts/laravel-events/out.png","slug":"out.png","post":"ck39k3m1r000d9sv78xzcivyf","modified":0,"renderable":0},{"_id":"source/_posts/vmware-redis/1.png","slug":"1.png","post":"ck39k3m2x00259sv7wlxfvh6c","modified":0,"renderable":0},{"_id":"source/_posts/vmware-redis/2.png","slug":"2.png","post":"ck39k3m2x00259sv7wlxfvh6c","modified":0,"renderable":0},{"_id":"source/_posts/vmware-redis/3.png","slug":"3.png","post":"ck39k3m2x00259sv7wlxfvh6c","modified":0,"renderable":0},{"_id":"source/_posts/net-core-aop-2/1.png","slug":"1.png","post":"ck39k3m2e000w9sv70srinq8d","modified":0,"renderable":0},{"_id":"source/_posts/net-core-aop-2/2.png","slug":"2.png","post":"ck39k3m2e000w9sv70srinq8d","modified":0,"renderable":0},{"_id":"source/_posts/net-core-aop-2/3.png","slug":"3.png","post":"ck39k3m2e000w9sv70srinq8d","modified":0,"renderable":0},{"_id":"source/_posts/net-core-aop-2/4.png","slug":"4.png","post":"ck39k3m2e000w9sv70srinq8d","modified":0,"renderable":0},{"_id":"source/_posts/net-core-createprogram/1.png","slug":"1.png","post":"ck39k3m2j00129sv71s68td3s","modified":0,"renderable":0},{"_id":"source/_posts/net-core-createprogram/2.png","slug":"2.png","post":"ck39k3m2j00129sv71s68td3s","modified":0,"renderable":0},{"_id":"source/_posts/net-core-createprogram/3.png","slug":"3.png","post":"ck39k3m2j00129sv71s68td3s","modified":0,"renderable":0},{"_id":"source/_posts/net-core-createprogram/4.png","slug":"4.png","post":"ck39k3m2j00129sv71s68td3s","modified":0,"renderable":0},{"_id":"source/_posts/net-core-createprogram/5.png","slug":"5.png","post":"ck39k3m2j00129sv71s68td3s","modified":0,"renderable":0},{"_id":"source/_posts/net-core-swagger/2.png","slug":"2.png","post":"ck39k3m2l00179sv7u7ejlici","modified":0,"renderable":0},{"_id":"source/_posts/net-core-swagger/3.png","slug":"3.png","post":"ck39k3m2l00179sv7u7ejlici","modified":0,"renderable":0},{"_id":"source/_posts/net-core-swagger/4.png","slug":"4.png","post":"ck39k3m2l00179sv7u7ejlici","modified":0,"renderable":0},{"_id":"source/_posts/net-core-swagger/5.png","slug":"5.png","post":"ck39k3m2l00179sv7u7ejlici","modified":0,"renderable":0},{"_id":"source/_posts/net-core-swagger/6.png","slug":"6.png","post":"ck39k3m2l00179sv7u7ejlici","modified":0,"renderable":0},{"_id":"source/_posts/net-core-aop-1/1.png","slug":"1.png","post":"ck39k3m2g00109sv7q0kk6866","modified":0,"renderable":0},{"_id":"source/_posts/net-core-aop-1/2.png","slug":"2.png","post":"ck39k3m2g00109sv7q0kk6866","modified":0,"renderable":0},{"_id":"source/_posts/net-core-aop-1/3.png","slug":"3.png","post":"ck39k3m2g00109sv7q0kk6866","modified":0,"renderable":0},{"_id":"source/_posts/net-core-aop-1/4.png","slug":"4.png","post":"ck39k3m2g00109sv7q0kk6866","modified":0,"renderable":0},{"_id":"source/_posts/net-core-aop-1/5.png","slug":"5.png","post":"ck39k3m2g00109sv7q0kk6866","modified":0,"renderable":0},{"_id":"source/_posts/net-core-aop-1/6.png","slug":"6.png","post":"ck39k3m2g00109sv7q0kk6866","modified":0,"renderable":0},{"_id":"source/_posts/net-core-aop-1/7.png","slug":"7.png","post":"ck39k3m2g00109sv7q0kk6866","modified":0,"renderable":0},{"_id":"source/_posts/net-core-aop-1/8.png","slug":"8.png","post":"ck39k3m2g00109sv7q0kk6866","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-swagger/1.png","slug":"1.png","post":"ck39k3m2r001o9sv71jn8c2ec","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-swagger/2.png","slug":"2.png","post":"ck39k3m2r001o9sv71jn8c2ec","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-swagger/3.png","slug":"3.png","post":"ck39k3m2r001o9sv71jn8c2ec","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-swagger/4.png","slug":"4.png","post":"ck39k3m2r001o9sv71jn8c2ec","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-swagger/5.png","slug":"5.png","post":"ck39k3m2r001o9sv71jn8c2ec","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-swagger/6.png","slug":"6.png","post":"ck39k3m2r001o9sv71jn8c2ec","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-swagger/7.png","slug":"7.png","post":"ck39k3m2r001o9sv71jn8c2ec","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-swagger/8.png","slug":"8.png","post":"ck39k3m2r001o9sv71jn8c2ec","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util/1.png","slug":"1.png","post":"ck39k3m2a000t9sv7ehyhy460","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util/2.png","slug":"2.png","post":"ck39k3m2a000t9sv7ehyhy460","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util/3.png","slug":"3.png","post":"ck39k3m2a000t9sv7ehyhy460","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util/4.png","slug":"4.png","post":"ck39k3m2a000t9sv7ehyhy460","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util/5.png","slug":"5.png","post":"ck39k3m2a000t9sv7ehyhy460","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util/6.png","slug":"6.png","post":"ck39k3m2a000t9sv7ehyhy460","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util/7.png","slug":"7.png","post":"ck39k3m2a000t9sv7ehyhy460","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util/8.png","slug":"8.png","post":"ck39k3m2a000t9sv7ehyhy460","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util/9.png","slug":"9.png","post":"ck39k3m2a000t9sv7ehyhy460","modified":0,"renderable":0},{"_id":"source/_posts/net-core-log4net/2.png","slug":"2.png","post":"ck39k3m2m001b9sv7ee53sshk","modified":0,"renderable":0},{"_id":"source/_posts/net-core-log4net/3.png","slug":"3.png","post":"ck39k3m2m001b9sv7ee53sshk","modified":0,"renderable":0},{"_id":"source/_posts/net-core-log4net/4.png","slug":"4.png","post":"ck39k3m2m001b9sv7ee53sshk","modified":0,"renderable":0},{"_id":"source/_posts/net-core-log4net/6.png","slug":"6.png","post":"ck39k3m2m001b9sv7ee53sshk","modified":0,"renderable":0},{"_id":"source/_posts/net-core-log4net/7.png","slug":"7.png","post":"ck39k3m2m001b9sv7ee53sshk","modified":0,"renderable":0},{"_id":"source/_posts/net-core-log4net/8.png","slug":"8.png","post":"ck39k3m2m001b9sv7ee53sshk","modified":0,"renderable":0},{"_id":"source/_posts/net-core-log4net/9.png","slug":"9.png","post":"ck39k3m2m001b9sv7ee53sshk","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/1.png","slug":"1.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/10.png","slug":"10.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/11.png","slug":"11.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/12.png","slug":"12.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/14.png","slug":"14.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/15.png","slug":"15.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/2.png","slug":"2.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/3.png","slug":"3.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/4.png","slug":"4.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/5.png","slug":"5.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/6.png","slug":"6.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/7.png","slug":"7.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-april-webapi/8.png","slug":"8.png","post":"ck39k3m2q001l9sv7zay4q50c","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/1.png","slug":"1.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/10.png","slug":"10.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/11.png","slug":"11.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/12.png","slug":"12.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/13.png","slug":"13.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/14.png","slug":"14.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/15.png","slug":"15.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/16.png","slug":"16.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/17.png","slug":"17.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/18.png","slug":"18.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/19.png","slug":"19.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/2.png","slug":"2.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/20.png","slug":"20.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/21.png","slug":"21.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/22.png","slug":"22.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/26.png","slug":"26.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/27.png","slug":"27.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/28.png","slug":"28.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/29.png","slug":"29.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/3.png","slug":"3.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/30.png","slug":"30.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/32.png","slug":"32.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/33.png","slug":"33.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/34.png","slug":"34.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/35.png","slug":"35.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/36.png","slug":"36.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/4.png","slug":"4.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/5.png","slug":"5.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/6.png","slug":"6.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/7.png","slug":"7.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/8.png","slug":"8.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-use-centos/9.png","slug":"9.png","post":"ck39k3m2y00299sv7tnxl5jj6","modified":0,"renderable":0},{"_id":"source/_posts/vmware-mysql/1.png","slug":"1.png","post":"ck39k3m3d003i9sv7d5oz970h","modified":0,"renderable":0},{"_id":"source/_posts/net-core-filedownload/1.png","slug":"1.png","post":"ck39k3m3e003j9sv7y27n8gpx","modified":0,"renderable":0},{"_id":"source/_posts/net-core-quartz/1.png","slug":"1.png","post":"ck39k3m3l003n9sv7ljahxjfa","modified":0,"renderable":0},{"_id":"source/_posts/net-core-quartz/2.png","slug":"2.png","post":"ck39k3m3l003n9sv7ljahxjfa","modified":0,"renderable":0},{"_id":"source/_posts/net-core-quartz/3.png","slug":"3.png","post":"ck39k3m3l003n9sv7ljahxjfa","modified":0,"renderable":0},{"_id":"source/_posts/net-core-qywx-application/1.png","slug":"1.png","post":"ck39k3m3p003q9sv7ojwxduwe","modified":0,"renderable":0},{"_id":"source/_posts/net-core-qywx-application/2.png","slug":"2.png","post":"ck39k3m3p003q9sv7ojwxduwe","modified":0,"renderable":0},{"_id":"source/_posts/net-core-qywx-application/3.png","slug":"3.png","post":"ck39k3m3p003q9sv7ojwxduwe","modified":0,"renderable":0},{"_id":"source/_posts/net-core-qywx-application/4.png","slug":"4.png","post":"ck39k3m3p003q9sv7ojwxduwe","modified":0,"renderable":0},{"_id":"source/_posts/net-core-qywx-application/5.png","slug":"5.png","post":"ck39k3m3p003q9sv7ojwxduwe","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-npoi/1.png","slug":"1.png","post":"ck39k3m45003z9sv705kdpamw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-npoi/2.png","slug":"2.png","post":"ck39k3m45003z9sv705kdpamw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-npoi/3.png","slug":"3.png","post":"ck39k3m45003z9sv705kdpamw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-npoi/4.png","slug":"4.png","post":"ck39k3m45003z9sv705kdpamw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-npoi/5.png","slug":"5.png","post":"ck39k3m45003z9sv705kdpamw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-npoi/6.png","slug":"6.png","post":"ck39k3m45003z9sv705kdpamw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-sqlsugar-2/1.png","slug":"1.png","post":"ck39k3m41003w9sv79xftjxlw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-sqlsugar-2/2.png","slug":"2.png","post":"ck39k3m41003w9sv79xftjxlw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-sqlsugar-2/3.png","slug":"3.png","post":"ck39k3m41003w9sv79xftjxlw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-sqlsugar-2/4.png","slug":"4.png","post":"ck39k3m41003w9sv79xftjxlw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-sqlsugar-2/5.png","slug":"5.png","post":"ck39k3m41003w9sv79xftjxlw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-sqlsugar-2/6.png","slug":"6.png","post":"ck39k3m41003w9sv79xftjxlw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-sqlsugar-2/7.png","slug":"7.png","post":"ck39k3m41003w9sv79xftjxlw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-sqlsugar-2/8.png","slug":"8.png","post":"ck39k3m41003w9sv79xftjxlw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-sqlsugar-2/9.png","slug":"9.png","post":"ck39k3m41003w9sv79xftjxlw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-cache/10.png","slug":"10.png","post":"ck39k3m3g003l9sv7x7kea258","modified":0,"renderable":0},{"_id":"source/_posts/net-core-cache/11.png","slug":"11.png","post":"ck39k3m3g003l9sv7x7kea258","modified":0,"renderable":0},{"_id":"source/_posts/net-core-cache/2.png","slug":"2.png","post":"ck39k3m3g003l9sv7x7kea258","modified":0,"renderable":0},{"_id":"source/_posts/net-core-cache/3.png","slug":"3.png","post":"ck39k3m3g003l9sv7x7kea258","modified":0,"renderable":0},{"_id":"source/_posts/net-core-cache/4.png","slug":"4.png","post":"ck39k3m3g003l9sv7x7kea258","modified":0,"renderable":0},{"_id":"source/_posts/net-core-cache/5.png","slug":"5.png","post":"ck39k3m3g003l9sv7x7kea258","modified":0,"renderable":0},{"_id":"source/_posts/net-core-cache/6.png","slug":"6.png","post":"ck39k3m3g003l9sv7x7kea258","modified":0,"renderable":0},{"_id":"source/_posts/net-core-cache/7.png","slug":"7.png","post":"ck39k3m3g003l9sv7x7kea258","modified":0,"renderable":0},{"_id":"source/_posts/net-core-cache/8.png","slug":"8.png","post":"ck39k3m3g003l9sv7x7kea258","modified":0,"renderable":0},{"_id":"source/_posts/net-core-cache/9.png","slug":"9.png","post":"ck39k3m3g003l9sv7x7kea258","modified":0,"renderable":0},{"_id":"source/_posts/net-core-redis/1.png","slug":"1.png","post":"ck39k3m3u003t9sv7275oj29e","modified":0,"renderable":0},{"_id":"source/_posts/net-core-redis/10.png","slug":"10.png","post":"ck39k3m3u003t9sv7275oj29e","modified":0,"renderable":0},{"_id":"source/_posts/net-core-redis/11.png","slug":"11.png","post":"ck39k3m3u003t9sv7275oj29e","modified":0,"renderable":0},{"_id":"source/_posts/net-core-redis/2.png","slug":"2.png","post":"ck39k3m3u003t9sv7275oj29e","modified":0,"renderable":0},{"_id":"source/_posts/net-core-redis/3.png","slug":"3.png","post":"ck39k3m3u003t9sv7275oj29e","modified":0,"renderable":0},{"_id":"source/_posts/net-core-redis/4.png","slug":"4.png","post":"ck39k3m3u003t9sv7275oj29e","modified":0,"renderable":0},{"_id":"source/_posts/net-core-redis/5.png","slug":"5.png","post":"ck39k3m3u003t9sv7275oj29e","modified":0,"renderable":0},{"_id":"source/_posts/net-core-redis/6.png","slug":"6.png","post":"ck39k3m3u003t9sv7275oj29e","modified":0,"renderable":0},{"_id":"source/_posts/net-core-redis/7.png","slug":"7.png","post":"ck39k3m3u003t9sv7275oj29e","modified":0,"renderable":0},{"_id":"source/_posts/net-core-redis/8.png","slug":"8.png","post":"ck39k3m3u003t9sv7275oj29e","modified":0,"renderable":0},{"_id":"source/_posts/net-core-redis/9.png","slug":"9.png","post":"ck39k3m3u003t9sv7275oj29e","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/1.png","slug":"1.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/10.png","slug":"10.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/11.png","slug":"11.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/12.png","slug":"12.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/13.png","slug":"13.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/14.png","slug":"14.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/15.png","slug":"15.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/16.png","slug":"16.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/2.png","slug":"2.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/3.png","slug":"3.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/4.png","slug":"4.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/5.png","slug":"5.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/6.png","slug":"6.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/7.png","slug":"7.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/8.png","slug":"8.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-v3-publish/9.png","slug":"9.png","post":"ck39k3m4a00429sv7sm6pkc9j","modified":0,"renderable":0},{"_id":"source/_posts/net-core-sqlsugar-1/1.png","slug":"1.png","post":"ck39k3m4p004d9sv7nsv20ec2","modified":0,"renderable":0},{"_id":"source/_posts/net-core-fileuploader-and-cors/1.png","slug":"1.png","post":"ck39k3m4o004b9sv7sq99wq80","modified":0,"renderable":0},{"_id":"source/_posts/net-core-fileuploader-and-cors/2.png","slug":"2.png","post":"ck39k3m4o004b9sv7sq99wq80","modified":0,"renderable":0},{"_id":"source/_posts/net-core-fileuploader-and-cors/3.png","slug":"3.png","post":"ck39k3m4o004b9sv7sq99wq80","modified":0,"renderable":0},{"_id":"source/_posts/net-core-fileuploader-and-cors/4.png","slug":"4.png","post":"ck39k3m4o004b9sv7sq99wq80","modified":0,"renderable":0},{"_id":"source/_posts/net-core-fileuploader-and-cors/5.png","slug":"5.png","post":"ck39k3m4o004b9sv7sq99wq80","modified":0,"renderable":0},{"_id":"source/_posts/net-core-fileuploader-and-cors/6.png","slug":"6.png","post":"ck39k3m4o004b9sv7sq99wq80","modified":0,"renderable":0},{"_id":"source/_posts/net-core-fileuploader-and-cors/7.png","slug":"7.png","post":"ck39k3m4o004b9sv7sq99wq80","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util-update-1/1.png","slug":"1.png","post":"ck39k3m4n004a9sv7afj5tedw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util-update-1/2.png","slug":"2.png","post":"ck39k3m4n004a9sv7afj5tedw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util-update-1/3.png","slug":"3.png","post":"ck39k3m4n004a9sv7afj5tedw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util-update-1/4.png","slug":"4.png","post":"ck39k3m4n004a9sv7afj5tedw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util-update-1/5.png","slug":"5.png","post":"ck39k3m4n004a9sv7afj5tedw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util-update-1/6.png","slug":"6.png","post":"ck39k3m4n004a9sv7afj5tedw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util-update-1/7.png","slug":"7.png","post":"ck39k3m4n004a9sv7afj5tedw","modified":0,"renderable":0},{"_id":"source/_posts/net-core-april-util-update-1/8.png","slug":"8.png","post":"ck39k3m4n004a9sv7afj5tedw","modified":0,"renderable":0}],"PostCategory":[{"post_id":"ck39k3m0k00039sv778kskwgm","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m0s00099sv7pxuqak8v"},{"post_id":"ck39k3m1n000b9sv7zuidy2sl","category_id":"ck39k3m1v000e9sv7iwv05w3a","_id":"ck39k3m28000q9sv7715z5hk5"},{"post_id":"ck39k3m22000i9sv7hiueiqcs","category_id":"ck39k3m1v000e9sv7iwv05w3a","_id":"ck39k3m2b000u9sv773fksldo"},{"post_id":"ck39k3m25000m9sv7hl15y81v","category_id":"ck39k3m1v000e9sv7iwv05w3a","_id":"ck39k3m2e000x9sv7b39x29l9"},{"post_id":"ck39k3m1r000d9sv78xzcivyf","category_id":"ck39k3m1v000e9sv7iwv05w3a","_id":"ck39k3m2h00119sv78sg3grqq"},{"post_id":"ck39k3m27000o9sv701f9th0x","category_id":"ck39k3m1v000e9sv7iwv05w3a","_id":"ck39k3m2k00139sv7x6zznzht"},{"post_id":"ck39k3m2a000t9sv7ehyhy460","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m2l00169sv75gpsh94h"},{"post_id":"ck39k3m1w000g9sv7gp6wsup7","category_id":"ck39k3m1v000e9sv7iwv05w3a","_id":"ck39k3m2l00189sv7edcdeg0w"},{"post_id":"ck39k3m2e000w9sv70srinq8d","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m2n001c9sv7a6swv2t4"},{"post_id":"ck39k3m2g00109sv7q0kk6866","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m2o001f9sv7zyb77qrk"},{"post_id":"ck39k3m2j00129sv71s68td3s","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m2p001j9sv7seutscsv"},{"post_id":"ck39k3m2k00159sv7y039seov","category_id":"ck39k3m1v000e9sv7iwv05w3a","_id":"ck39k3m2q001m9sv7hzgr9xap"},{"post_id":"ck39k3m2l00179sv7u7ejlici","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m2r001p9sv7mfgxz87s"},{"post_id":"ck39k3m2m001b9sv7ee53sshk","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m2s001s9sv7vvc8126n"},{"post_id":"ck39k3m2n001e9sv7sbbbydqs","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m2u001w9sv7h7bv41v7"},{"post_id":"ck39k3m2p001i9sv7058nq4z7","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m2v001z9sv7jg52we5g"},{"post_id":"ck39k3m2q001l9sv7zay4q50c","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m2w00239sv7b7cvvd5x"},{"post_id":"ck39k3m2r001o9sv71jn8c2ec","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m2x00269sv728rnpqpl"},{"post_id":"ck39k3m2s001r9sv7y9kxn9pu","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m2z002a9sv7sbpssr29"},{"post_id":"ck39k3m2t001v9sv7th7em5nn","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m30002d9sv78legvorg"},{"post_id":"ck39k3m2u001y9sv77vdj2oc2","category_id":"ck39k3m1v000e9sv7iwv05w3a","_id":"ck39k3m31002g9sv7paclrbte"},{"post_id":"ck39k3m2w00229sv7y31462vg","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m31002i9sv7a02kzl9w"},{"post_id":"ck39k3m2x00259sv7wlxfvh6c","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m32002k9sv7fvgcj9ty"},{"post_id":"ck39k3m2y00299sv7tnxl5jj6","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m32002m9sv7o8qvfosl"},{"post_id":"ck39k3m30002c9sv70dphy82o","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m33002o9sv7byghqzba"},{"post_id":"ck39k3m3d003i9sv7d5oz970h","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m3l003o9sv7rfdazqo0"},{"post_id":"ck39k3m3e003j9sv7y27n8gpx","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m3q003r9sv7uhnshohx"},{"post_id":"ck39k3m3g003l9sv7x7kea258","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m3v003u9sv7iduy5x9n"},{"post_id":"ck39k3m3l003n9sv7ljahxjfa","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m42003x9sv7o3r5s9w3"},{"post_id":"ck39k3m3p003q9sv7ojwxduwe","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m4600409sv7m5gk0khc"},{"post_id":"ck39k3m3u003t9sv7275oj29e","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m4a00439sv7ndudv6ck"},{"post_id":"ck39k3m41003w9sv79xftjxlw","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m4e00459sv75hze64es"},{"post_id":"ck39k3m45003z9sv705kdpamw","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m4h00479sv7h49j79i4"},{"post_id":"ck39k3m4a00429sv7sm6pkc9j","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m4i00499sv7u6gkrsz2"},{"post_id":"ck39k3m4n004a9sv7afj5tedw","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m4t004f9sv7jbn2fqwc"},{"post_id":"ck39k3m4o004b9sv7sq99wq80","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m4w004h9sv7pe6p9m4e"},{"post_id":"ck39k3m4p004d9sv7nsv20ec2","category_id":"ck39k3m0m00049sv78byu6ib2","_id":"ck39k3m50004i9sv7flvubb2r"}],"PostTag":[{"post_id":"ck39k3m0400009sv76adr5fdc","tag_id":"ck39k3m0g00029sv70gu3m554","_id":"ck39k3m0q00069sv77hnavv7m"},{"post_id":"ck39k3m0d00019sv7lk362q5o","tag_id":"ck39k3m0g00029sv70gu3m554","_id":"ck39k3m0r00089sv7chz4kvzq"},{"post_id":"ck39k3m0k00039sv778kskwgm","tag_id":"ck39k3m0r00079sv7azvzhalm","_id":"ck39k3m0t000a9sv70ekz9tkm"},{"post_id":"ck39k3m20000h9sv7axlp8zjo","tag_id":"ck39k3m0g00029sv70gu3m554","_id":"ck39k3m24000l9sv7y6aud9vb"},{"post_id":"ck39k3m1n000b9sv7zuidy2sl","tag_id":"ck39k3m1v000f9sv7tjmv69ca","_id":"ck39k3m27000n9sv7576nv55e"},{"post_id":"ck39k3m22000i9sv7hiueiqcs","tag_id":"ck39k3m1v000f9sv7tjmv69ca","_id":"ck39k3m2a000s9sv7snr8k27p"},{"post_id":"ck39k3m25000m9sv7hl15y81v","tag_id":"ck39k3m1v000f9sv7tjmv69ca","_id":"ck39k3m2d000v9sv78ygeu7kq"},{"post_id":"ck39k3m1r000d9sv78xzcivyf","tag_id":"ck39k3m1v000f9sv7tjmv69ca","_id":"ck39k3m2g000z9sv78v6q5e8s"},{"post_id":"ck39k3m2k00159sv7y039seov","tag_id":"ck39k3m1v000f9sv7tjmv69ca","_id":"ck39k3m2m001a9sv7ysa1pfht"},{"post_id":"ck39k3m1w000g9sv7gp6wsup7","tag_id":"ck39k3m1v000f9sv7tjmv69ca","_id":"ck39k3m2n001d9sv7rpcdh7bz"},{"post_id":"ck39k3m1w000g9sv7gp6wsup7","tag_id":"ck39k3m2e000y9sv7sd7phleb","_id":"ck39k3m2o001h9sv7ltbrn0ba"},{"post_id":"ck39k3m1w000g9sv7gp6wsup7","tag_id":"ck39k3m2k00149sv7ujt7l74e","_id":"ck39k3m2q001k9sv7nsf3ersq"},{"post_id":"ck39k3m27000o9sv701f9th0x","tag_id":"ck39k3m1v000f9sv7tjmv69ca","_id":"ck39k3m2s001q9sv7l77o09gs"},{"post_id":"ck39k3m27000o9sv701f9th0x","tag_id":"ck39k3m2e000y9sv7sd7phleb","_id":"ck39k3m2t001t9sv7nxncv5r0"},{"post_id":"ck39k3m27000o9sv701f9th0x","tag_id":"ck39k3m2k00149sv7ujt7l74e","_id":"ck39k3m2u001x9sv7v4cci8q3"},{"post_id":"ck39k3m2r001o9sv71jn8c2ec","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m2v00209sv70itpw480"},{"post_id":"ck39k3m2a000t9sv7ehyhy460","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m2x00249sv7xffduj9n"},{"post_id":"ck39k3m2s001r9sv7y9kxn9pu","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m2y00279sv7ynrvhm02"},{"post_id":"ck39k3m2e000w9sv70srinq8d","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m2z002b9sv7f1ryhgk9"},{"post_id":"ck39k3m2g00109sv7q0kk6866","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m30002e9sv752uszpcu"},{"post_id":"ck39k3m2j00129sv71s68td3s","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m31002h9sv7yk2txss9"},{"post_id":"ck39k3m2l00179sv7u7ejlici","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m32002l9sv7ocle8idl"},{"post_id":"ck39k3m2m001b9sv7ee53sshk","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m33002p9sv7jf497t0n"},{"post_id":"ck39k3m2n001e9sv7sbbbydqs","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m34002r9sv777oyf6uh"},{"post_id":"ck39k3m2p001i9sv7058nq4z7","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m34002t9sv7alv8oz0m"},{"post_id":"ck39k3m2q001l9sv7zay4q50c","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m35002v9sv7msqy03na"},{"post_id":"ck39k3m2t001v9sv7th7em5nn","tag_id":"ck39k3m34002u9sv74zg4hx4o","_id":"ck39k3m35002y9sv7nu5nme22"},{"post_id":"ck39k3m2t001v9sv7th7em5nn","tag_id":"ck39k3m35002w9sv7a4jvh4tl","_id":"ck39k3m35002z9sv75qawpgj7"},{"post_id":"ck39k3m2u001y9sv77vdj2oc2","tag_id":"ck39k3m35002x9sv7uwp6qc0v","_id":"ck39k3m3600319sv7u5oc0an0"},{"post_id":"ck39k3m2u001y9sv77vdj2oc2","tag_id":"ck39k3m1v000f9sv7tjmv69ca","_id":"ck39k3m3600329sv76xrjzxa6"},{"post_id":"ck39k3m2w00229sv7y31462vg","tag_id":"ck39k3m3600309sv7bs05dvds","_id":"ck39k3m3700359sv7ez4c099q"},{"post_id":"ck39k3m2w00229sv7y31462vg","tag_id":"ck39k3m3600339sv7d2fb6ngn","_id":"ck39k3m3700369sv7jfwc667y"},{"post_id":"ck39k3m2x00259sv7wlxfvh6c","tag_id":"ck39k3m34002u9sv74zg4hx4o","_id":"ck39k3m3800399sv7fl63ewg6"},{"post_id":"ck39k3m2x00259sv7wlxfvh6c","tag_id":"ck39k3m35002w9sv7a4jvh4tl","_id":"ck39k3m38003a9sv7jwesu6ds"},{"post_id":"ck39k3m2y00299sv7tnxl5jj6","tag_id":"ck39k3m34002u9sv74zg4hx4o","_id":"ck39k3m39003d9sv7nbaqfm4b"},{"post_id":"ck39k3m2y00299sv7tnxl5jj6","tag_id":"ck39k3m35002w9sv7a4jvh4tl","_id":"ck39k3m39003e9sv7xpiqxm4j"},{"post_id":"ck39k3m30002c9sv70dphy82o","tag_id":"ck39k3m34002u9sv74zg4hx4o","_id":"ck39k3m3a003g9sv79keukjgt"},{"post_id":"ck39k3m30002c9sv70dphy82o","tag_id":"ck39k3m35002w9sv7a4jvh4tl","_id":"ck39k3m3a003h9sv7gj9t1v35"},{"post_id":"ck39k3m3d003i9sv7d5oz970h","tag_id":"ck39k3m34002u9sv74zg4hx4o","_id":"ck39k3m3f003k9sv7t790mkgw"},{"post_id":"ck39k3m3d003i9sv7d5oz970h","tag_id":"ck39k3m35002w9sv7a4jvh4tl","_id":"ck39k3m3k003m9sv7chswdslr"},{"post_id":"ck39k3m3e003j9sv7y27n8gpx","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m3p003p9sv7tumlybec"},{"post_id":"ck39k3m3g003l9sv7x7kea258","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m3u003s9sv7xyz367lr"},{"post_id":"ck39k3m3l003n9sv7ljahxjfa","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m41003v9sv7u52h6uuc"},{"post_id":"ck39k3m3p003q9sv7ojwxduwe","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m45003y9sv7zznh0t86"},{"post_id":"ck39k3m3u003t9sv7275oj29e","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m4900419sv7jr8mpvm9"},{"post_id":"ck39k3m41003w9sv79xftjxlw","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m4d00449sv7rgdk9f89"},{"post_id":"ck39k3m45003z9sv705kdpamw","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m4h00469sv7fyvh2grp"},{"post_id":"ck39k3m4a00429sv7sm6pkc9j","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m4i00489sv72lsdicu7"},{"post_id":"ck39k3m4n004a9sv7afj5tedw","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m4p004c9sv7v9lxqj04"},{"post_id":"ck39k3m4o004b9sv7sq99wq80","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m4s004e9sv7td88cv60"},{"post_id":"ck39k3m4p004d9sv7nsv20ec2","tag_id":"ck39k3m2r001n9sv7h9so3icl","_id":"ck39k3m4w004g9sv7hghg8ykd"}],"Tag":[{"name":"test","_id":"ck39k3m0g00029sv70gu3m554"},{"name":"","_id":"ck39k3m0r00079sv7azvzhalm"},{"name":"laravel","_id":"ck39k3m1v000f9sv7tjmv69ca"},{"name":"swoole","_id":"ck39k3m2e000y9sv7sd7phleb"},{"name":"docker","_id":"ck39k3m2k00149sv7ujt7l74e"},{"name":"net core","_id":"ck39k3m2r001n9sv7h9so3icl"},{"name":"vmware","_id":"ck39k3m34002u9sv74zg4hx4o"},{"name":"","_id":"ck39k3m35002w9sv7a4jvh4tl"},{"name":"vue","_id":"ck39k3m35002x9sv7uwp6qc0v"},{"name":"php","_id":"ck39k3m3600309sv7bs05dvds"},{"name":"","_id":"ck39k3m3600339sv7d2fb6ngn"}]}}